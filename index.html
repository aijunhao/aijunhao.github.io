<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hello, I&#39;m Junhao Ai.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hello, I&#39;m Junhao Ai.">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hello, I&#39;m Junhao Ai.">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hello, I&#39;m Junhao Ai.">
  
    <link rel="alternate" href="/atom.xml" title="Hello, I&#39;m Junhao Ai." type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hello, I&#39;m Junhao Ai.</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-框架——Vuejs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/23/框架——Vuejs/" class="article-date">
  <time datetime="2019-03-23T08:32:51.000Z" itemprop="datePublished">2019-03-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/23/框架——Vuejs/">框架——Vue.js</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#vuejs-简介">Vue.js 简介</a><ul>
<li><a href="#前端三大主流框架">前端三大主流框架</a></li>
<li><a href="#框架和库的区别">框架和库的区别</a></li>
<li><a href="#后端-mvc">后端 <code>MVC</code></a></li>
<li><a href="#前端-mvvm">前端 <code>MVVM</code></a></li>
</ul>
</li>
<li><a href="#起步">起步</a><ul>
<li><a href="#安装">安装</a><ul>
<li><a href="#npm方法">npm方法</a></li>
<li><a href="#js-文件"><code>JS</code> 文件</a></li>
</ul>
</li>
<li><a href="#配置">配置</a></li>
<li><a href="#案例">案例</a></li>
</ul>
</li>
<li><a href="#vue-devtools-调试器">Vue-devtools 调试器</a><ul>
<li><a href="#chrome-浏览器">Chrome 浏览器</a></li>
<li><a href="#firefox-浏览器">FireFox 浏览器</a></li>
<li><a href="#注意点">注意点</a></li>
</ul>
</li>
<li><a href="#vue-实例">Vue 实例</a><ul>
<li><a href="#创建-vue-实例">创建 Vue 实例</a></li>
<li><a href="#生命周期">生命周期</a></li>
</ul>
</li>
<li><a href="#数据与方法">数据与方法</a><ul>
<li><a href="#this"><code>this</code></a></li>
<li><a href="#响应式数据">响应式数据</a></li>
</ul>
</li>
<li><a href="#模板语法">模板语法</a><ul>
<li><a href="#插值">插值</a><ul>
<li><a href="#纯文本">纯文本</a><ul>
<li><a href="#-msg-"><code></code></a></li>
<li><a href="#v-textmsg">v-text=”msg”</a></li>
</ul>
</li>
<li><a href="#html">HTML</a></li>
</ul>
</li>
<li><a href="#javascript-表达式">JavaScript 表达式</a></li>
<li><a href="#插值表达式闪烁问题">插值表达式闪烁问题</a></li>
</ul>
</li>
<li><a href="#指令">指令</a><ul>
<li><a href="#常用指令">常用指令</a><ul>
<li><a href="#v-bind-属性绑定指令"><code>v-bind</code> 属性绑定指令</a></li>
<li><a href="#v-on-事件监听绑定指令"><code>v-on</code> 事件监听绑定指令</a></li>
<li><a href="#条件指令">条件指令</a><ul>
<li><a href="#v-if-与-v-else-与-v-else-if-插入条件指令"><code>v-if</code> 与 <code>v-else</code> 与 <code>v-else-if</code> 插入条件指令</a></li>
<li><a href="#v-show-显示条件指令"><code>v-show</code> 显示条件指令</a></li>
<li><a href="#v-if-与-v-show-比较"><code>v-if</code> 与 <code>v-show</code> 比较</a></li>
<li><a href="#template-条件渲染分组"><code>&lt;template&gt;</code> 条件渲染分组</a></li>
</ul>
</li>
<li><a href="#v-for-循环指令"><code>v-for</code> 循环指令</a></li>
<li><a href="#v-model-表单元素双向数据绑定指令"><code>v-model</code> 表单元素双向数据绑定指令</a></li>
</ul>
</li>
<li><a href="#自定义指令">自定义指令</a><ul>
<li><a href="#全局指令">全局指令</a></li>
<li><a href="#私有指令">私有指令</a></li>
<li><a href="#钩子函数">钩子函数</a></li>
<li><a href="#钩子函数参数">钩子函数参数</a></li>
<li><a href="#bind-和-update-函数简写"><code>bind</code> 和 <code>update</code> 函数简写</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#表单数据绑定">表单数据绑定</a><ul>
<li><a href="#文本">文本</a></li>
<li><a href="#多行文本">多行文本</a></li>
<li><a href="#复选框">复选框</a><ul>
<li><a href="#多复选框">多复选框</a></li>
<li><a href="#单复选框">单复选框</a></li>
</ul>
</li>
<li><a href="#单选按钮">单选按钮</a></li>
<li><a href="#选择框">选择框</a><ul>
<li><a href="#单项选择框">单项选择框</a></li>
<li><a href="#多向选择框">多向选择框</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#修饰符">修饰符</a><ul>
<li><a href="#事件修饰符">事件修饰符</a><ul>
<li><a href="#prevent-阻止默认行为"><code>.prevent</code> 阻止默认行为</a></li>
<li><a href="#stop-阻止事件冒泡"><code>.stop</code> 阻止事件冒泡</a></li>
<li><a href="#capture-事件捕获模式"><code>.capture</code> 事件捕获模式</a></li>
<li><a href="#self-事件只在元素本身触发时回调"><code>.self</code> 事件只在元素本身触发时回调</a></li>
<li><a href="#once-事件单次触发"><code>.once</code> 事件单次触发</a></li>
<li><a href="#passive"><code>.passive</code></a></li>
</ul>
</li>
<li><a href="#键盘按键修饰符">键盘按键修饰符</a><ul>
<li><a href="#常见按键码别名">常见按键码别名</a><ul>
<li><a href="#一般修饰符">一般修饰符</a></li>
<li><a href="#系统修饰符">系统修饰符</a></li>
</ul>
</li>
<li><a href="#exact"><code>.exact</code></a></li>
<li><a href="#自定义按键修饰符别名">自定义按键修饰符别名</a></li>
<li><a href="#按键码">按键码</a></li>
</ul>
</li>
<li><a href="#鼠标按键修饰符">鼠标按键修饰符</a></li>
<li><a href="#表单修饰符">表单修饰符</a><pre><code>- [`.lazy`](#lazy)
- [`.number` 数值转换修饰符](#number-数值转换修饰符)
- [`.trim` 去首尾空格修饰符](#trim-去首尾空格修饰符)
</code></pre></li>
</ul>
</li>
<li><a href="#过滤器">过滤器</a><ul>
<li><a href="#使用过滤器">使用过滤器</a></li>
<li><a href="#定义过滤器">定义过滤器</a><ul>
<li><a href="#全局过滤器">全局过滤器</a></li>
<li><a href="#私有过滤器">私有过滤器</a></li>
</ul>
</li>
<li><a href="#过滤器串联">过滤器串联</a></li>
</ul>
</li>
<li><a href="#计算属性">计算属性</a><ul>
<li><a href="#案例-1">案例</a></li>
<li><a href="#计算属性与方法区别">计算属性与方法区别</a></li>
</ul>
</li>
<li><a href="#class-与-style-绑定"><code>Class</code> 与 <code>Style</code> 绑定</a><ul>
<li><a href="#class-绑定"><code>Class</code> 绑定</a><ul>
<li><a href="#class-对象语法"><code>Class</code> 对象语法</a><ul>
<li><a href="#基本用法">基本用法</a></li>
<li><a href="#class-结合-computed-计算属性"><code>Class</code> 结合 <code>computed</code> 计算属性</a></li>
</ul>
</li>
<li><a href="#class-数组语法"><code>Class</code> 数组语法</a><ul>
<li><a href="#基础用法">基础用法</a></li>
<li><a href="#三元表达式">三元表达式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#style"><code>Style</code></a></li>
</ul>
</li>
<li><a href="#jsonp">JSONP</a></li>
<li><a href="#vue-异步请求">Vue 异步请求</a><ul>
<li><a href="#vue-resourcevue-20-已停止维护仍然即可">vue-resource（vue 2.0 已停止维护，仍然即可）</a><ul>
<li><a href="#安装-1">安装</a></li>
<li><a href="#导包">导包</a></li>
<li><a href="#使用">使用</a></li>
</ul>
</li>
<li><a href="#axios">axios</a><ul>
<li><a href="#安装-2">安装</a></li>
<li><a href="#导包-1">导包</a></li>
<li><a href="#案例-2">案例</a></li>
<li><a href="#get">GET</a></li>
<li><a href="#post">POST</a></li>
<li><a href="#常用配置选项-config">常用配置选项 <code>config</code></a></li>
<li><a href="#配置默认值">配置默认值</a><ul>
<li><a href="#全局的-axios-默认值">全局的 <code>axios</code> 默认值</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#vue-中的过渡动画">Vue 中的过渡动画</a><ul>
<li><a href="#css-过渡的类">CSS 过渡的类</a></li>
<li><a href="#第三方-animatecss-类库">第三方 <code>animate.css</code> 类库</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<font color="red">此文档参考 Vue 2.x 版本</font>

<h2 id="Vue-js-简介"><a href="#Vue-js-简介" class="headerlink" title="Vue.js 简介"></a>Vue.js 简介</h2><p><code>Vue.js</code> 是一套构建用户界面的渐进式框架，与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与现代化的工具链以及各种支持类库结合使用时，<code>Vue</code> 也完全能够为复杂的单页应用提供驱动。</p>
<p>官网：<a href="https://cn.vuejs.org/" target="_blank" rel="noopener">https://cn.vuejs.org/</a></p>
<h3 id="前端三大主流框架"><a href="#前端三大主流框架" class="headerlink" title="前端三大主流框架"></a>前端三大主流框架</h3><ul>
<li><code>Angular.js</code></li>
<li><code>React.js</code>: <code>React</code> 是最流行的前端框架。<code>React</code> 除了可以开发网页，还可以开发手机 <code>App</code> 。</li>
<li><code>Vue.js</code>: <code>Vue.js</code> 是目前最火的前端框架，<code>Vue</code> 借助 <code>Weex</code> 也可以开发手机 <code>App</code> 。</li>
</ul>
<h3 id="框架和库的区别"><a href="#框架和库的区别" class="headerlink" title="框架和库的区别"></a>框架和库的区别</h3><ul>
<li><p>框架：是一套完整的解决方法，对项目的倾入性较大，项目如果需要更换框架，需要重新架构整个项目。</p>
<p>  如：<code>node</code> 中的 <code>express</code></p>
</li>
<li><p>库（插件）：提供某一个小功能，对项目的插入性较小，如果某个库无法完成某些需求，可以很容易切换到其他库实现需求。</p>
<p>  如：<code>jQuery</code></p>
</li>
</ul>
<h3 id="后端-MVC"><a href="#后端-MVC" class="headerlink" title="后端 MVC"></a>后端 <code>MVC</code></h3><p><strong><code>MVC</code></strong> 是 <code>Model-View-Controller</code> 的简写。即模型-视图-控制器。`</p>
<ul>
<li><code>Model</code> : 模型层，负责数据库操作。</li>
<li><code>View</code> : 视图层，用户界面显示，数据的可视化。</li>
<li><code>Controller</code> : 控制层，处理业务逻辑。</li>
</ul>
<p><img src="/2019/03/23/框架——Vuejs/MVC.JPG" alt="MVC.JPG"></p>
<h3 id="前端-MVVM"><a href="#前端-MVVM" class="headerlink" title="前端 MVVM"></a>前端 <code>MVVM</code></h3><p><strong><code>MVVM</code></strong> 是 <code>Model-View-ViewModel</code> 的简写，即模型-视图-视图模型。</p>
<p>MVVM 的出现促进了 GUI 前端开发与后端业务逻辑的分离，极大地提高了前端开发效率。MVVM 的核心是 ViewModel 层，它就像是一个中转站（value converter），负责转换 Model 中的数据对象来让数据变得更容易管理和使用，该层向上与视图层进行双向数据绑定，向下与 Model 层通过接口请求进行数据交互，起呈上启下作用。View 层展现的不是 Model 层的数据，而是 ViewModel 的数据，由 ViewModel 负责与 Model 层交互，这就完全解耦了 View 层和 Model 层，这个解耦是至关重要的，它是前后端分离方案实施的最重要一环。</p>
<p><img src="/2019/03/23/框架——Vuejs/mvvm.png" alt="mvvm.png"></p>
<h2 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="npm方法"><a href="#npm方法" class="headerlink" title="npm方法"></a>npm方法</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 用淘宝镜像会好点</span><br><span class="line">cnpm i vue -S</span><br></pre></td></tr></table></figure>
<h4 id="JS-文件"><a href="#JS-文件" class="headerlink" title="JS 文件"></a><code>JS</code> 文件</h4><p>通过官网或者其他第三方网站下载 <code>JS</code> 文件。大型项目不建议这种方法。</p>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"vue.js 文件路径"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p>导入包之后，就会多出一个 <code>Vue</code> 构造函数，每个 <code>Vue</code> 应用都需要通过实例化 <code>Vue</code> 来实现。</p>
<p><code>Vue.js</code> 的核心是一个允许采用简洁的模板语法来声明式地将数据渲染进 DOM 的系统。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 被 Vue 控制的内容 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 内容替换部分，插值表达式 --&gt;</span></span><br><span class="line">        &#123;&#123; message &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        // 创建 Vue 对象</span></span><br><span class="line"><span class="undefined">        var app = new Vue (&#123;</span></span><br><span class="line"><span class="undefined">            // 类似 id 选择器，获取需要控制内容，这是小写 L 不是数字 1</span></span><br><span class="line"><span class="undefined">            el: '#app',</span></span><br><span class="line"><span class="undefined">            // 替换内容，这里的 data 就是 MVVM 中的 M ，专门用来保存页面的数据</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined">                // 自定义的键值对，会用来给插值表达式提供数据</span></span><br><span class="line"><span class="undefined">                message: "hello 123"</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Vue-devtools-调试器"><a href="#Vue-devtools-调试器" class="headerlink" title="Vue-devtools 调试器"></a>Vue-devtools 调试器</h2><p><code>Vue-devtoos</code> 是 <code>Vue</code> 的调试神器，是一款基于 <code>Chrome</code> 浏览器的插件，用于调试 <code>Vue</code> 应用，可以极大提升我们的开发效率。</p>
<h3 id="Chrome-浏览器"><a href="#Chrome-浏览器" class="headerlink" title="Chrome 浏览器"></a>Chrome 浏览器</h3><p>但是因为被墙了，需要找 <code>github</code> 源码自行编译。</p>
<p><code>github</code> 链接：<a href="https://github.com/vuejs/vue-devtools" target="_blank" rel="noopener">https://github.com/vuejs/vue-devtools</a></p>
<ul>
<li><p>首先在 <code>github</code> 上下载源码，解压到任意目录（但是注意这个解压文件不能删除！！！）</p>
</li>
<li><p>进入解压目录，命令行中执行 <code>npm install</code> 下载资源文件。</p>
</li>
<li><p>执行命令 <code>npm run build</code> 构建插件。</p>
</li>
<li><p>打开谷歌浏览器，点击更多工具 –&gt; 拓展程序 –&gt; 打开开发者模式 –&gt; 加载已解压的拓展程序 –&gt; 选择解压目录下 <code>shells/chrome</code> –&gt; 选择文件夹即可。</p>
</li>
</ul>
<p>这样在 <code>Chrome</code> 上就加入了 <code>Vue-devtools</code> 调试器插件了，但是会一直弹出 <code>请停用以开发者模式运行的拓展程序</code> ，目前我还没找到有效的方法。</p>
<p>参考方法：<a href="https://jingyan.baidu.com/article/c275f6ba12e07ce33d756712.html" target="_blank" rel="noopener">https://jingyan.baidu.com/article/c275f6ba12e07ce33d756712.html</a></p>
<p>还有一种添加白名单的方法，但是好像 win10 家庭版不支持。</p>
<h3 id="FireFox-浏览器"><a href="#FireFox-浏览器" class="headerlink" title="FireFox 浏览器"></a>FireFox 浏览器</h3><p>获取浏览器中下载配置比较简单，点击下方连接即可，或者去插件里自己下。</p>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/vue-js-devtools/" target="_blank" rel="noopener">https://addons.mozilla.org/en-US/firefox/addon/vue-js-devtools/</a></p>
<h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><p>安装完之后，运行使用了 <code>Vue.js</code> 的文件，打开 <code>F12</code> ，即可看到有一个 <code>Vue</code> 标签，这就是我们的 <code>Vue devtools</code> 工具。但是如果使用的 <code>Vue</code> 包为压缩类型的（<code>vue.min.js</code>），无法使用工具，它只能给调试用。</p>
<h2 id="Vue-实例"><a href="#Vue-实例" class="headerlink" title="Vue 实例"></a>Vue 实例</h2><h3 id="创建-Vue-实例"><a href="#创建-Vue-实例" class="headerlink" title="创建 Vue 实例"></a>创建 Vue 实例</h3><p>虽然没有完全遵循 <a href="https://zh.wikipedia.org/wiki/MVVM" target="_blank" rel="noopener">MVVM 模型</a>，但是 <code>Vue</code> 的设计也受到了它的启发。因此在文档中经常会使用 <code>vm</code> ( <code>ViewModel</code> 的缩写) 这个变量名表示 <code>Vue</code> 实例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过 Vue 构造函数创建一个实例</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'id 选择器'</span>,</span><br><span class="line">  data: &#123; 数据对象 &#125;,</span><br><span class="line">  methods: &#123; 方法对象 &#125;,</span><br><span class="line">  filters: &#123; 过滤器对象 &#125;,</span><br><span class="line">  computed: &#123; 计算属性 &#125;,</span><br><span class="line">  directives:&#123; 指令对象 &#125;,</span><br><span class="line">  生命周期函数()&#123;  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>实例创建之后，<code>Vue</code> 对象会保存在 <code>windown</code>。</p>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p><img src="/2019/03/23/框架——Vuejs/声明周期.png" alt="声明周期.png"></p>
<h2 id="数据与方法"><a href="#数据与方法" class="headerlink" title="数据与方法"></a>数据与方法</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一般写法</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'id 选择器'</span>,</span><br><span class="line">  data: &#123; 数据对象 &#125;,</span><br><span class="line">  methods: &#123; 方法对象 &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取数据对象与方法对象</span></span><br><span class="line"><span class="keyword">var</span> data = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> methods = &#123; show(val) &#123;&#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'id 选择器'</span>,</span><br><span class="line">  data: data,</span><br><span class="line">  methods: methods</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="this"><a href="#this" class="headerlink" title="this"></a><code>this</code></h3><p>在 <code>Vue</code> 实例中如果想获取自身 <code>data</code> 中的数据或者调用 <code>methods</code> 中的方法，必须使用 <code>this</code> 。必要是使用箭头函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一般写法</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'id 选择器'</span>,</span><br><span class="line">  data: &#123; </span><br><span class="line">      msg: <span class="string">'hello'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123; </span><br><span class="line">    show() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.msg)</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="响应式数据"><a href="#响应式数据" class="headerlink" title="响应式数据"></a>响应式数据</h3><p>当一个 <code>Vue</code> 实例被<font color="red"><strong>创建时</strong></font>，它向 <code>Vue</code> 的<strong>响应式系统</strong>中加入了其 <code>data</code> 对象中能找到的所有的属性。当这些属性的值发生改变时，视图将会产生“响应”，重新渲染视图，即匹配更新为新的值。</p>
<p>如果在 <code>Vue</code> 实例被<font color="red"><strong>创建后</strong></font>，添加一个新的属性，该属性不具备响应式！！！可以一开始就在 <code>data</code> 对象中添加该属性并设置默认值（空值或者 <code>null</code>）来避免这种情况发生。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 我们的数据对象</span></span><br><span class="line"><span class="keyword">var</span> data = &#123; </span><br><span class="line">  a: <span class="number">1</span>，</span><br><span class="line">  <span class="comment">// 添加空值为初始值</span></span><br><span class="line">  msg: <span class="string">''</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 该对象被加入到一个 Vue 实例中</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  data: data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获得这个实例上的属性</span></span><br><span class="line"><span class="comment">// 返回源数据中对应的字段</span></span><br><span class="line">vm.a == data.a <span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置属性也会影响到原始数据</span></span><br><span class="line">vm.a = <span class="number">2</span></span><br><span class="line">data.a <span class="comment">// =&gt; 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ……反之亦然</span></span><br><span class="line">data.a = <span class="number">3</span></span><br><span class="line">vm.a <span class="comment">// =&gt; 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 有默认值，有响应式</span></span><br><span class="line">data.msg = <span class="string">'hello'</span></span><br><span class="line">vm.msg <span class="comment">// =&gt; 'hello'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 无默认值，无响应，报错</span></span><br><span class="line">data.msg2 = <span class="string">'hello'</span></span><br><span class="line">vm.msg2 <span class="comment">// =&gt; error！</span></span><br></pre></td></tr></table></figure>
<h2 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h2><h3 id="插值"><a href="#插值" class="headerlink" title="插值"></a>插值</h3><h4 id="纯文本"><a href="#纯文本" class="headerlink" title="纯文本"></a>纯文本</h4><h5 id="lt-￼77-gt"><a href="#lt-￼77-gt" class="headerlink" title=""></a><code></code></h5><p>最常见形式，通过双大括号 <code></code>，插入纯文本类型，并且仅 <code></code> 会被替换。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &#123;&#123; msg &#125;&#125; 会被替换，而 ' +++ ' 不会被替换 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span> +++ &#123;&#123; msg &#125;&#125; +++ <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            msg: <span class="string">'hello 123'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="v-text-”msg”"><a href="#v-text-”msg”" class="headerlink" title="v-text=”msg”"></a>v-text=”msg”</h5><p>纯文本全部替换。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span>·</span><br><span class="line">    <span class="comment">&lt;!-- msg 会替换 ' +++ ' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-text</span>=<span class="string">"msg"</span>&gt;</span> +++ <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            msg: <span class="string">'hello 123'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h4><p><code>v-html</code> 指令，使用 <code>v-html=&quot;msg&quot;</code> 的方式，将 <code>msg</code> 字符串编译成 <code>HTML</code> ，并替换。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 编译成 HTML，并替换 '123' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">"msg"</span>&gt;</span>123<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="xml">            msg: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="JavaScript-表达式"><a href="#JavaScript-表达式" class="headerlink" title="JavaScript 表达式"></a>JavaScript 表达式</h3><p>在 <code>Vue.js</code> 中支持 <code>JS</code> 表达式。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 编译成 HTML，并拼接字符串'666'，替换 '123' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">"msg + '666' "</span>&gt;</span>123<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- value: '&lt;h1&gt;hello world&lt;/h1&gt;666' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; msg + '666' &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- value: YES --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; ok ? 'YES' : 'NO' &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- value: 10 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; 5+5 &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            ok: <span class="literal">true</span>,</span></span><br><span class="line"><span class="xml">            msg: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="插值表达式闪烁问题"><a href="#插值表达式闪烁问题" class="headerlink" title="插值表达式闪烁问题"></a>插值表达式闪烁问题</h3><p>在实际开发中，当页面获取服务器 <code>JS</code> 文件时，如果网络较慢或者加载内容过多的情况下，使用插值表达式的地方会有先显示内容未被替换掉的插值，等 <code>JS</code> 文件加载完成之后，然后被替换掉。这就是插值表达式的闪烁问题，只需要在有插值表达式的地方使用属性选择器，使其先隐藏，等 <code>JS</code> 文件被加载出来之后，由于优先级问题，原先隐藏属性被覆盖，自然显示出来。</p>
<p>这里我们使用谷歌浏览器，<code>F12</code> 打开 <code>Network</code> 设置 <code>Throtting</code> 为 <code>Slow 3G</code> （缓慢3G）模式来模拟网络卡顿。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这里使用网络中的 js 文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.staticfile.org/vue/2.4.2/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 添加一个属性选择器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        [v-cloak] &#123;</span></span><br><span class="line"><span class="undefined">            display: none;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 方法一：v-cloak + style --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-cloak</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 方法二：v-text，默认没有闪烁问题 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-text</span>=<span class="string">"message"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                message: <span class="string">"hello 123"</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><p>指令 (Directives) 是带有 <code>v-</code> 前缀的特殊属性。</p>
<p>指令特性的值预期是<strong>单个 JavaScript 表达式</strong> (<code>v-for</code> 除外)。指令的职责是，当表达式的值改变时，将其产生的连带影响，响应式地作用于 DOM。</p>
<h3 id="常用指令"><a href="#常用指令" class="headerlink" title="常用指令"></a>常用指令</h3><h4 id="v-bind-属性绑定指令"><a href="#v-bind-属性绑定指令" class="headerlink" title="v-bind 属性绑定指令"></a><code>v-bind</code> 属性绑定指令</h4><p>在 <code>HTML</code> 中，如果某些标签（<code>a</code>、<code>h1</code>、<code>img</code>等）的属性值需要使用 <code>data</code> 中的数据时，需要在属性前加 <code>v-bind:</code> 或者缩写为冒号 <code>:</code> 绑定该属性，然后属性值就是 <code>data</code> 中的键名。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 绑定 title 属性，这时属性值为 'hello world' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> <span class="attr">v-bind:title</span>=<span class="string">"mytitle"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 缩写形式，这时属性值为 'hello world' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> <span class="attr">:title</span>=<span class="string">"mytitle"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 原来的，title 属性值就是 'mytitle' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> <span class="attr">title</span>=<span class="string">"mytitle"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            mytitle: <span class="string">'hello world'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="v-on-事件监听绑定指令"><a href="#v-on-事件监听绑定指令" class="headerlink" title="v-on 事件监听绑定指令"></a><code>v-on</code> 事件监听绑定指令</h4><p>它用于监听 DOM 事件，在事件前加 <code>v-on:</code> 或者缩写 <code>@</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 监听点击事件，调用 show 方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> <span class="attr">v-on:click</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 缩写形式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> @<span class="attr">click</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 方法对象，不是数组，</span></span></span><br><span class="line"><span class="undefined">        methods: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 一般写法</span></span></span><br><span class="line"><span class="javascript">            show: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">window</span>.alert(<span class="string">'show方法'</span>)</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            <span class="comment">// ES 6 写法</span></span></span><br><span class="line"><span class="undefined">            show() &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">window</span>.alert(<span class="string">'show方法'</span>)</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            xxx,</span></span><br><span class="line"><span class="undefined">            xxx</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="条件指令"><a href="#条件指令" class="headerlink" title="条件指令"></a>条件指令</h4><h5 id="v-if-与-v-else-与-v-else-if-插入条件指令"><a href="#v-if-与-v-else-与-v-else-if-插入条件指令" class="headerlink" title="v-if 与 v-else 与 v-else-if 插入条件指令"></a><code>v-if</code> 与 <code>v-else</code> 与 <code>v-else-if</code> 插入条件指令</h5><p> <code>v-if</code> 指令将根据表达式的<strong>布尔值</strong>来决定是否<strong>插入</strong>该元素，是有和无的区别，源码中只有布尔值为 <code>true</code> 的那块代码。</p>
<p><code>v-else</code> 元素必须紧跟在带 <code>v-if</code> 或者 <code>v-else-if</code> 的元素的后面，否则它将不会被识别。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 如果表达式 seen 的值为 true，则插入 v-if 行元素；为 false，则插入 v-else 行元素 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">"seen"</span>&gt;</span>插入第一个<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span>&gt;</span>插入第二个<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">"type === 'A'"</span>&gt;</span> A <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else-if</span>=<span class="string">"type === 'B'"</span>&gt;</span> B <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span>&gt;</span>Not A / B<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="javascript">        seen: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">        type: <span class="string">'D'</span></span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="v-show-显示条件指令"><a href="#v-show-显示条件指令" class="headerlink" title="v-show 显示条件指令"></a><code>v-show</code> 显示条件指令</h5><p><code>v-show</code> 指令将根据表达式的<strong>布尔值</strong>来决定是否<strong>显示</strong>该元素，源码中有该块代码，布尔值为 <code>true</code> 显示代码，反之，添加代码样式 <code>style=&quot;display: none;&quot;</code> ，设置其为状态不可视。</p>
<p><code>v-show</code> 不能与 <code>v-else</code> <code>v-else-if</code> 连用，也不支持 <code>&lt;template&gt;</code> 元素。</p>
<h5 id="v-if-与-v-show-比较"><a href="#v-if-与-v-show-比较" class="headerlink" title="v-if 与 v-show 比较"></a><code>v-if</code> 与 <code>v-show</code> 比较</h5><ul>
<li><code>v-show</code> 的元素始终会被渲染并保留在 DOM 中，有更高的初始渲染开销。</li>
<li><code>v-if</code> 的元素随着控制量的改变不断插入和删除元素，有更高的切换开销。</li>
<li><code>v-if</code> 是<strong>惰性的</strong>，如果在初始渲染时条件为假，则什么也不做，直到条件第一次变为真时，才会开始渲染条件块。</li>
<li>如果需要非常频繁地切换，则使用 <code>v-show</code> 较好。</li>
<li>如果在运行时条件很少改变，则使用 <code>v-if</code> 较好。</li>
<li>复杂的情况使用 <code>v-if</code> 较好，支持 <code>v-else</code> <code>v-else-if</code> 和 <code>&lt;template&gt;</code> 元素。</li>
</ul>
<h5 id="lt-template-gt-条件渲染分组"><a href="#lt-template-gt-条件渲染分组" class="headerlink" title="&lt;template&gt; 条件渲染分组"></a><code>&lt;template&gt;</code> 条件渲染分组</h5><p>因为 <code>v-if</code> 是一个指令，所以必须将它添加到一个元素上。但是如果想切换多个元素，可以把一个 <code>&lt;template&gt;</code> 元素当做不可见的包裹元素（或者使用 <code>div</code>），并在上面使用 <code>v-if</code>。但是最终的渲染结果将不包含 <code>&lt;template&gt;</code> 元素，这一点比 <code>div</code> 好。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="v-for-循环指令"><a href="#v-for-循环指令" class="headerlink" title="v-for 循环指令"></a><code>v-for</code> 循环指令</h4><p><code>v-for</code> 指令可以绑定数组的数据来渲染一个项目列表，有些像 <code>for-in</code> 循环。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 遍历数组，获取（对象，数组下标） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"(user, i) in users"</span>&gt;</span></span><br><span class="line">        i: &#123;&#123; i &#125;&#125; -- user: &#123;&#123; user &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 遍历对象，获取对象 (键值，键名[，属性序号]) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"(val, key, i) in users[0]"</span>&gt;</span></span><br><span class="line">        i: &#123;&#123; i &#125;&#125; -- key: &#123;&#123; key &#125;&#125; -- val: &#123;&#123; val &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 遍历数字，从 1 开始 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"count in 5"</span>&gt;</span></span><br><span class="line">        这是第 &#123;&#123; count &#125;&#125; 个数字</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">    data: &#123;</span></span><br><span class="line"><span class="undefined">      users: [</span></span><br><span class="line"><span class="javascript">        &#123; <span class="attr">name</span>: <span class="string">'daming'</span>, <span class="attr">age</span>: <span class="number">18</span>, <span class="attr">gender</span>: <span class="string">'men'</span> &#125;,</span></span><br><span class="line"><span class="javascript">        &#123; <span class="attr">name</span>: <span class="string">'erming'</span>, <span class="attr">age</span>: <span class="number">17</span>, <span class="attr">gender</span>: <span class="string">'men'</span> &#125;,</span></span><br><span class="line"><span class="javascript">        &#123; <span class="attr">name</span>: <span class="string">"xiaoming"</span>, <span class="attr">age</span>: <span class="number">16</span>, <span class="attr">gender</span>: <span class="string">"men"</span> &#125;</span></span><br><span class="line"><span class="undefined">      ]</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<font color="red"><code>key</code> 的使用注意：</font>在组件中使用 <code>v-for</code> 循环的时候，或者在一些特殊情况中，使用 <code>v-for</code> 的同时需要将 <code>key</code> 绑定<strong>唯一的字符串或者数字</strong> 。<br><br>如下，在有 <code>checkbox</code> 选中的情况下给数组头部添加数据，如果没有将 <code>key</code> 绑定给 <code>id</code> ，会导致重渲染之后的 <code>checkbox</code> 选择错误。<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        id: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        name: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"添加"</span> @<span class="attr">click</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- v-for 循环的时候，key 属性只能使用 number 或者 string，并用 v-bind 属性绑定 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"user in users"</span> <span class="attr">v-bind:key</span>=<span class="string">"user.id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span> id: &#123;&#123; user.id &#125;&#125; --- name: &#123;&#123; user.name &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                id: <span class="string">''</span>, </span></span><br><span class="line"><span class="javascript">                name: <span class="string">''</span>,</span></span><br><span class="line"><span class="undefined">                users: [</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'daming'</span> &#125;,</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">'erming'</span> &#125;,</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">"xiaoming"</span> &#125;</span></span><br><span class="line"><span class="undefined">                ]</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="undefined">                add () &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.users.unshift(&#123; <span class="attr">id</span>: <span class="keyword">this</span>.id, <span class="attr">name</span>: <span class="keyword">this</span>.name &#125;)</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>#### <code>v-model</code> 表单元素双向数据绑定指令<br><br>更多案例在《表单数据绑定》章节<br><br><code>v-model</code> 指令用来在 <code>input</code> 、<code>select</code>、<code>text</code> 、<code>checkbox</code> 、<code>radio</code> 等表单控件元素上创建双向数据绑定，即既能读取 <code>model</code> （<code>Vue</code> 对象）中的数据，又能通过表单来修改 <code>model</code> 中的数据。<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 输入框的默认文本为 'Hello Vue!'，修改之后，Vue 对象中的 message 值会改变 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"message"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="javascript">        message: <span class="string">'Hello Vue!'</span></span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>### 自定义指令<br><br>指令都是以 <code>v-</code> ，自定义指令也使用这个原则。<br><br>#### 全局指令<br><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 注册一个全局自定义指令。</span></span><br><span class="line"><span class="comment"> * 第一个参数是指令名，在定义时不需要加 `v-`，这部分是默认的</span></span><br><span class="line"><span class="comment"> * 第二个参数是一个对象，对象身上有一些指令相关的函数，称为 `钩子函数`</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Vue.directive(<span class="string">'指令名称'</span>, &#123;</span><br><span class="line">    <span class="comment">// 钩子函数</span></span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 调用自定义指令 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">v-focus</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 注册一个全局自定义指令 `v-focus`</span></span></span><br><span class="line"><span class="javascript">    Vue.directive(<span class="string">'focus'</span>, &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 当被绑定的元素插入到 DOM </span></span></span><br><span class="line"><span class="javascript">      inserted: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 聚焦元素</span></span></span><br><span class="line"><span class="undefined">        el.focus()</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="undefined">        ...</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>#### 私有指令<br><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#'</span>,</span><br><span class="line">    data: &#123;  &#125;</span><br><span class="line">    directives: &#123;</span><br><span class="line">      focus: &#123;</span><br><span class="line">        <span class="comment">// 钩子函数</span></span><br><span class="line">        inserted: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">          el.focus()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>#### 钩子函数<br><br>钩子函数时指令定义对象中的可选内容，用来实现自定义指令的具体操作，不同的钩子函数有不同的使用场景，根据具体需要来选择。<br><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Vue.directive(<span class="string">'指令名称'</span>, &#123;</span><br><span class="line">    <span class="comment">// 钩子函数</span></span><br><span class="line"></span><br><span class="line">	bind: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 只调用一次，指令第一次绑定到元素时调用。在这里可以进行一次性的初始化设置。</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 如果是绑定 css 样式，初始化之后不管是否通过 inserted 插入到页面中，都会以内联样式的方式渲染到页面中。</span></span><br><span class="line">    &#125;,</span><br><span class="line">    inserted: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 被绑定元素插入父节点时调用 (仅保证父节点存在，但不一定已被插入文档中)。</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 如果是与行为有关的操作，都必须通过 inserted 插入到页面中才会生效。</span></span><br><span class="line">    &#125;,</span><br><span class="line">    updated: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 当 VNode 更新时调用。</span></span><br><span class="line">    &#125;,</span><br><span class="line">    componentUpdated: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 指令所在组件的 VNode 及其子 VNode 全部更新后调用。</span></span><br><span class="line">    &#125;,</span><br><span class="line">    unbind: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 只调用一次，指令与元素解绑时调用。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>#### 钩子函数参数<br><br>所有的钩子函数参数都是一样的。<br><br><br>- <code>el</code>（必须）：指令所绑定的元素，可以用来直接操作 <code>DOM</code> 。<br>- <code>binding</code> ：一个对象，用来获取传递进参数，包含以下属性。<br>    - <code>name</code> ：指令名，不包括 <code>v-</code> 前缀。<br><br>    - <code>value</code> ：指令的绑定值（传入参数），例如：<code>v-my-directive=&quot;1 + 1&quot;</code> 中，绑定值为 <code>2</code>。<br><br>    - <code>oldValue</code> ：指令绑定的前一个值，仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。无论值是否改变都可用。<br><br>    - <code>expression</code> ：字符串形式的指令表达式（就是参数字符串，未经过 <code>JS</code> 处理）。例如 <code>v-my-directive=&quot;1 + 1&quot;</code> 中，表达式为 <code>&quot;1 + 1&quot;</code> 。<br>    - <code>arg</code> ：传给指令的参数，可选。例如 <code>v-my-directive:foo</code> 中，参数为 <code>&quot;foo&quot;</code> 。<br><br>    - <code>modifiers</code> ：一个包含修饰符的对象。例如：<code>v-my-directive.foo.bar</code> 中，修饰符对象为 <code>{ foo: true, bar: true }</code> 。<br>- <code>vnode</code> ：<code>Vue</code> 编译生成的虚拟节点。<br>- <code>oldVnode</code> ：上一个虚拟节点，仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 必须这么写，如果直接写 blue ，vue 会到 data 中去找，而不是指令 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-color</span>=<span class="string">"'blue'"</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 传入一个对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-color2</span>=<span class="string">"&#123; color: 'blue'; text: 'hello' &#125;"</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">    directives: &#123;</span></span><br><span class="line"><span class="undefined">      color: &#123;</span></span><br><span class="line"><span class="javascript">        bind: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(binding.value)	<span class="comment">// blue</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(binding.expression)	<span class="comment">// 'blue'</span></span></span><br><span class="line"><span class="undefined">            </span></span><br><span class="line"><span class="undefined">          el.style.color = binding.value</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined">      color2: &#123;</span></span><br><span class="line"><span class="javascript">        bind: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(binding.value.color)	<span class="comment">// blue</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(binding.value.text)	<span class="comment">// hello</span></span></span><br><span class="line"><span class="undefined">            </span></span><br><span class="line"><span class="undefined">          el.style.color = binding.value</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>#### <code>bind</code> 和 <code>update</code> 函数简写<br><br>在 <code>bind</code> 和 <code>update</code> 时触发相同行为，而不关心其它的钩子时，可以简写。这种简写方式就相当于在 <code>bind</code> 和 <code>update</code> 钩子函数中同时写了一遍代码。<br><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简写形式</span></span><br><span class="line">Vue.directive(<span class="string">'指令名称'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span><br><span class="line">  el.style.backgroundColor = binding.value</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 非简写</span></span><br><span class="line">Vue.directive(<span class="string">'指令名称'</span>, &#123;</span><br><span class="line">    bind: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span><br><span class="line">        el.style.backgroundColor = binding.value</span><br><span class="line">    &#125;,</span><br><span class="line">    update: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span><br><span class="line">        el.style.backgroundColor = binding.value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>## 表单数据绑定<br><br>表单数据绑定最重要的就是 <code>v-model</code> 指令，它负责监听用户的输入事件以更新数据，并对一些极端场景进行一些特殊处理。<br><br><code>v-model</code> 会忽略所有表单元素的 <code>value</code>、<code>checked</code>、<code>selected</code> 特性的初始值而总是将 <code>Vue</code> 实例的数据作为数据来源。换句话说，<font color="red"> <code>v-model</code> 将代替表单元素的 <code>value</code>、<code>checked</code>、<code>selected</code> 属性</font>。<br><br>大概体验一下基础的内容绑定。<br><br>### 文本<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"message"</span> <span class="attr">placeholder</span>=<span class="string">"edit me"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Message is: &#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            message: <span class="string">'hello'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>### 多行文本<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">v-model</span>=<span class="string">"message"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 支持换行 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"white-space: pre-line;"</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            message: <span class="string">'hello'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>### 复选框<br><br>#### 多复选框<br><br>多个复选框时，需将 <code>v-model</code> 绑定到同一个数组中。如果复选框 <code>value</code> 与数组内容匹配，则默认选中。<br><br><code>Vue</code> 会根据选择顺序，将选中项复选框的 <code>value</code> 值依次添加到数组尾部，取消选择时，则从数组中删除对应项。<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">'example-3'</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"jack"</span> <span class="attr">value</span>=<span class="string">"Jack"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"jack"</span>&gt;</span>Jack<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"john"</span> <span class="attr">value</span>=<span class="string">"John"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"john"</span>&gt;</span>John<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"mike"</span> <span class="attr">value</span>=<span class="string">"Mike"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"mike"</span>&gt;</span>Mike<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>Checked names: &#123;&#123; checkedNames &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined">            checkedNames: []</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>#### 单复选框<br><br>单个复选框时，需将 <code>v-model</code> 绑定到布尔值，根据布尔值显示是否选中。<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"checked"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"checkbox"</span>&gt;</span>&#123;&#123; checked &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            checked: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>### 单选按钮<br><br>使用单选按钮时，需将 <code>v-model</code> 绑定到字符串。如果初始字符串为空或者不存在与之匹配的单选按钮 <code>value</code> ，则不选中，否则选择与之匹配的单选按钮。<br><br>选择时，将选中项（唯一）的 <code>value</code> 替换到字符串中。<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"one"</span> <span class="attr">value</span>=<span class="string">"One"</span> <span class="attr">v-model</span>=<span class="string">"picked"</span>&gt;</span>One</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"two"</span> <span class="attr">value</span>=<span class="string">"Two"</span> <span class="attr">v-model</span>=<span class="string">"picked"</span>&gt;</span>Two</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Picked: &#123;&#123; picked &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            picked: <span class="string">''</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>### 选择框<br><br>#### 单项选择框<br><br>使用单项选择框时，需将 <code>v-model</code> 绑定到字符串。如果初始字符串为空或者不存在与之匹配的单选框内容，则不选中，否则选择与之匹配的单选框。<br><br>选择时，将选中项（唯一）的内容替换到字符串中。<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">disabled</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>请选择<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>A<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>B<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>C<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Selected: &#123;&#123; selected &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            selected: <span class="string">'B'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>#### 多向选择框<br><br>使用多项选择框时，需将 <code>v-model</code> 绑定到同一个数组中。如果复选框内容与数组内容匹配，则默认选中。<br><br>选中时，会将选中项按选项框顺序放入数组中，取消选择时，则从数组中删除对应项。<br><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span> <span class="attr">multiple</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">disabled</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>请选择<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>A<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>B<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>C<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Selected: &#123;&#123; selected &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            selected: [<span class="string">'A'</span>,<span class="string">'B'</span>]		<span class="comment">// 按 A/B/C 的顺序排列</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br><br>## 修饰符<br><br>修饰符 ( <code>modifier</code> ) 是以半角句号 <code>.</code> 指明的特殊后缀，用于指出一个指令应该以特殊方式绑定。修饰符可以串联。<br><br><font color="red">修饰符可以链式连接，同时有多重修饰符的效果，除了部分会产生相互冲突。</font>

<h3 id="事件修饰符"><a href="#事件修饰符" class="headerlink" title="事件修饰符"></a>事件修饰符</h3><p>使用 <code>v-on:</code> 来监听事件，在事件后添加事件修饰符，进行事件特殊处理。</p>
<h4 id="prevent-阻止默认行为"><a href="#prevent-阻止默认行为" class="headerlink" title=".prevent 阻止默认行为"></a><code>.prevent</code> 阻止默认行为</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DOM 中的阻止默认行为</span></span><br><span class="line">event.preventDefault();</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form v-on:submit.prevent=<span class="string">"onSubmit"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h4 id="stop-阻止事件冒泡"><a href="#stop-阻止事件冒泡" class="headerlink" title=".stop 阻止事件冒泡"></a><code>.stop</code> 阻止事件冒泡</h4><p>事件从里往外传递。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DOM 中的取消冒泡</span></span><br><span class="line">event.cancelBubble = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click</span>=<span class="string">"divHandler"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"点击"</span> @<span class="attr">click.stop</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 方法对象，不是数组</span></span></span><br><span class="line"><span class="undefined">      methods: &#123;</span></span><br><span class="line"><span class="undefined">        divHandler() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'divHandler'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        btnHandler() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'btnHandler'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">       &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 点击按钮</span><br><span class="line">// btnHandler</span><br><span class="line">// divHandler</span><br></pre></td></tr></table></figure>
<h4 id="capture-事件捕获模式"><a href="#capture-事件捕获模式" class="headerlink" title=".capture 事件捕获模式"></a><code>.capture</code> 事件捕获模式</h4><p>事件从外往里传递。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click</span>=<span class="string">"divHandler"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"点击"</span> @<span class="attr">click.capture</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 方法对象，不是数组</span></span></span><br><span class="line"><span class="undefined">      methods: &#123;</span></span><br><span class="line"><span class="undefined">        divHandler() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'divHandler'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        btnHandler() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'btnHandler'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">       &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 点击按钮</span><br><span class="line">// divHandler</span><br><span class="line">// btnHandler</span><br></pre></td></tr></table></figure>
<h4 id="self-事件只在元素本身触发时回调"><a href="#self-事件只在元素本身触发时回调" class="headerlink" title=".self 事件只在元素本身触发时回调"></a><code>.self</code> 事件只在元素本身触发时回调</h4><p>将事件绑定到自身，只有自身才能触发，通常用于避免冒泡事件的影响，但是<code>.self</code> 不会阻止事件冒泡。</p>
<h4 id="once-事件单次触发"><a href="#once-事件单次触发" class="headerlink" title=".once 事件单次触发"></a><code>.once</code> 事件单次触发</h4><p>事件只会触发一次。</p>
<h4 id="passive"><a href="#passive" class="headerlink" title=".passive"></a><code>.passive</code></h4><p>具体作用不详。</p>
<p>该修饰符大概意思用于对DOM的默认事件进行性能优化，根据官网的例子比如超出最大范围的滚动条滚动的。</p>
<p><code>.passive</code> 修饰符尤其能够提升移动端的性能。</p>
<p>不要把 <code>.passive</code> 和 <code>.prevent</code> 一起使用，因为 <code>.prevent</code> 将会被忽略，同时浏览器可能会向你展示一个警告。请记住，<code>.passive</code> 会告诉浏览器你<em>不</em>想阻止事件的默认行为。</p>
<h3 id="键盘按键修饰符"><a href="#键盘按键修饰符" class="headerlink" title="键盘按键修饰符"></a>键盘按键修饰符</h3><p>在监听键盘事件时添加修饰符。</p>
<h4 id="常见按键码别名"><a href="#常见按键码别名" class="headerlink" title="常见按键码别名"></a>常见按键码别名</h4><h5 id="一般修饰符"><a href="#一般修饰符" class="headerlink" title="一般修饰符"></a>一般修饰符</h5><ul>
<li><code>.enter</code> </li>
<li><code>.tab</code></li>
<li><code>.delete</code> </li>
<li><code>.esc</code></li>
<li><code>.space</code></li>
<li><code>.up</code></li>
<li><code>.down</code></li>
<li><code>.left</code></li>
<li><code>.right</code></li>
</ul>
<h5 id="系统修饰符"><a href="#系统修饰符" class="headerlink" title="系统修饰符"></a>系统修饰符</h5><ul>
<li><code>.ctrl</code></li>
<li><code>.alt</code></li>
<li><code>.shift</code></li>
<li><code>.meta</code> （win/cmd）</li>
</ul>
<h4 id="exact"><a href="#exact" class="headerlink" title=".exact"></a><code>.exact</code></h4><p><code>.exact</code> 修饰符允许控制由精确的系统修饰符组合触发的事件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 即使其他键被一同按下时也会触发 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.ctrl</span>=<span class="string">"onClick"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- 有且只有 Ctrl 被按下的时候才触发 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.ctrl.exact</span>=<span class="string">"onCtrlClick"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- 没有任何系统修饰符被按下的时候才触发 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.exact</span>=<span class="string">"onClick"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="自定义按键修饰符别名"><a href="#自定义按键修饰符别名" class="headerlink" title="自定义按键修饰符别名"></a>自定义按键修饰符别名</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以使用 `v-on:keyup.f1`</span></span><br><span class="line">Vue.config.keyCodes = &#123;</span><br><span class="line">  v: <span class="number">86</span>,</span><br><span class="line">  f1: <span class="number">112</span>,</span><br><span class="line">  <span class="comment">// 使用 kebab-case 且用双引号括起来</span></span><br><span class="line">  <span class="string">"media-play-pause"</span>: <span class="number">179</span>,</span><br><span class="line">  up: [<span class="number">38</span>, <span class="number">87</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> @<span class="attr">keyup.media-play-pause</span>=<span class="string">"method"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> @<span class="attr">keyup.u</span>=<span class="string">"method"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="按键码"><a href="#按键码" class="headerlink" title="按键码"></a>按键码</h4><p><code>keyCode</code> 的事件用法已经被废弃了并可能不会被最新的浏览器支持，但是使用 <code>keyCode</code> 特性也是允许的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用 enter 的按键码 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-on:keyup.13</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用 enter 的按键修饰符 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-on:keyup.enter</span>=<span class="string">"submit"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/23/框架——Vuejs/字母数字按键码.png" alt="字母数字按键码.png"></p>
<p><img src="/2019/03/23/框架——Vuejs/控制与多媒体按键码.png" alt="控制与多媒体按键码.png"></p>
<h3 id="鼠标按键修饰符"><a href="#鼠标按键修饰符" class="headerlink" title="鼠标按键修饰符"></a>鼠标按键修饰符</h3><ul>
<li><code>.left</code></li>
<li><code>.right</code></li>
<li><code>.middle</code></li>
</ul>
<h3 id="表单修饰符"><a href="#表单修饰符" class="headerlink" title="表单修饰符"></a>表单修饰符</h3><h5 id="lazy"><a href="#lazy" class="headerlink" title=".lazy"></a><code>.lazy</code></h5><p>在默认情况下，<code>v-model</code> 在每次 <code>input</code> 事件触发后将输入框的值与数据进行同步，<code>input</code> 文本框中的内容改变时，会自动将数值更新到 <code>Vue</code> 实例中。</p>
<p>添加 <code>lazy</code> 修饰符，从而转变为使用 <code>change</code> 事件进行同步，<code>input</code> 文本框中的内容改变后不再会自动保存到 <code>Vue</code> 实例中，需要敲回车进行保存。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 在“change”时而非“input”时更新 --&gt;</span><br><span class="line">&lt;input v-model.lazy=&quot;msg&quot; &gt;</span><br></pre></td></tr></table></figure>
<h5 id="number-数值转换修饰符"><a href="#number-数值转换修饰符" class="headerlink" title=".number 数值转换修饰符"></a><code>.number</code> 数值转换修饰符</h5><p>如果想自动将用户的输入值转为数值类型，可以给 <code>v-model</code> 添加 <code>number</code> 修饰符。</p>
<p>默认情况下传入值是 <code>String</code> 字符串类型，然后直接存储到 <code>Vue</code> 实例，使用 <code>.number</code> 修饰符之后会转换成 <code>number</code> 数值类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input v-model.number=&quot;age&quot; type=&quot;number&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>这通常很有用，因为即使在 <code>type=&quot;number&quot;</code> 时，HTML 输入元素的值也总会返回字符串。如果这个值无法被 <code>parseFloat()</code> 解析，则会返回原始的值。</p>
<h5 id="trim-去首尾空格修饰符"><a href="#trim-去首尾空格修饰符" class="headerlink" title=".trim 去首尾空格修饰符"></a><code>.trim</code> 去首尾空格修饰符</h5><p>如果要自动过滤用户输入的首尾空白字符，可以给 <code>v-model</code> 添加 <code>trim</code> 修饰符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input v-model.trim=&quot;msg&quot;&gt;</span><br></pre></td></tr></table></figure>
<h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><p>过滤器用于一些常见的文本格式化，可以用在两个地方：<strong>双花括号插值表达式</strong> 和 <strong><code>v-bind</code> 表达式</strong> 的尾部，由<strong>管道符号（<code>|</code>）</strong>指示。管道符前是属性键名，管道符后是过滤器名。</p>
<h3 id="使用过滤器"><a href="#使用过滤器" class="headerlink" title="使用过滤器"></a>使用过滤器</h3><p>过滤器的执行过程是将原始数据（如 <code>message</code> ）作为形参传入到过滤器方法中，返回一个处理后的值用以显示。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用过滤器 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 在双花括号中 --&gt;</span></span><br><span class="line">&#123;&#123; message | 过滤器名称 &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 多形参 --&gt;</span></span><br><span class="line">&#123;&#123; message | 过滤器名称( 形参1, 形参2) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 在 `v-bind` 中 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">"rawId | 过滤器名称"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="定义过滤器"><a href="#定义过滤器" class="headerlink" title="定义过滤器"></a>定义过滤器</h3><h4 id="全局过滤器"><a href="#全局过滤器" class="headerlink" title="全局过滤器"></a>全局过滤器</h4><p>全局过滤器是在 <code>Vue</code> 实例创建之前创建的，之后创建的所有 <code>Vue</code> 都可以使用该过滤器。</p>
<p>一般全局定义都不带 s ，私有定义会带 s 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个参数 value 表示的是管道符前传来的数据，就是原始数据，是默认自动传入的，在调用时候不用显式传入该值，直接传入其他形参即可。</span></span><br><span class="line">Vue.filter(<span class="string">'过滤器名称'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">value[, params]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ...</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 Vue 实例</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="私有过滤器"><a href="#私有过滤器" class="headerlink" title="私有过滤器"></a>私有过滤器</h4><p>私有过滤器是指在 <code>Vue</code> 实例内创建的过滤器，只能在当前 <code>Vue</code> 实例中使用。</p>
<p>私有过滤器与全局过滤器重名时，私有过滤器的优先级大于全局过滤器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#'</span>,</span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">    <span class="comment">// 虽然有 s ，但是它是对象，不是数组</span></span><br><span class="line">    filters: &#123;</span><br><span class="line">        过滤器名称: <span class="function"><span class="keyword">function</span>(<span class="params">value[, params]</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> ...</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="过滤器串联"><a href="#过滤器串联" class="headerlink" title="过滤器串联"></a>过滤器串联</h3><p>过滤器串联执行过程是将原始数据传入第一个过滤器，经处理后的结果作为之后过滤器的默认传入值，逐个执行所有过滤器之后，最终结果用以显示。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在双花括号中 --&gt;</span></span><br><span class="line">&#123;&#123; message | 过滤器1 | 过滤器2 &#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#example'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    message: <span class="string">'Hello'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 计算属性</span></span><br><span class="line">  computed: &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>模板语法内的 <code>JS</code> 表达式非常便利，但是设计它们的初衷是用于简单运算的。在模板中放入太多的逻辑会让模板过重且难以维护。所以任何复杂逻辑，你都应当使用<strong>计算属性</strong>。</p>
<h3 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h3><p>首先有一个字符串 <code>message</code> ，我们想得到它的反向字符串  <code>reversedMessage</code> 。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>"&#123;&#123; message &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>"&#123;&#123; reversedMessage &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="javascript">        message: <span class="string">'Hello'</span></span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined">      computed: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 声明一个计算属性 reversedMessage</span></span></span><br><span class="line"><span class="javascript">        reversedMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// this 指向 vm 实例，这里可以不使用 () =&gt; &#123;&#125; 箭头函数形式</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="keyword">this</span>.message.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p> <code>reversedMessage</code> 字符串完全依赖于 <code>message</code> ，其值随着 <code>message</code> 改变而改变，他们之间的依赖也会更新。</p>
<h3 id="计算属性与方法区别"><a href="#计算属性与方法区别" class="headerlink" title="计算属性与方法区别"></a>计算属性与方法区别</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用方法，完全可以实现同样效果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>"&#123;&#123; message &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 调用方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>"&#123;&#123; reversedMessage() &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#example'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">            message: <span class="string">'Hello'</span></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 在组件中</span></span></span><br><span class="line"><span class="undefined">        methods: &#123;</span></span><br><span class="line"><span class="javascript">            reversedMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="keyword">this</span>.message.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>两种方式的最终结果确实是完全相同的。然而，不同的是<strong>计算属性是基于它们的依赖进行缓存的</strong>。只在相关依赖发生改变时它们才会重新求值。这就意味着只要 <code>message</code> 还没有发生改变，多次访问 <code>reversedMessage</code> 计算属性会立即返回之前的计算结果（缓存中），而不必再次执行函数。</p>
<font color="red">简而言之，计算属性有缓存，方法函数没有缓存。</font>

<h2 id="Class-与-Style-绑定"><a href="#Class-与-Style-绑定" class="headerlink" title="Class 与 Style 绑定"></a><code>Class</code> 与 <code>Style</code> 绑定</h2><p><code>Class</code> 与 <code>Style</code> 都是属性，所以我们可以使用 <code>v-bind:</code> 来绑定这些属性，但是<strong>字符串</strong>拼接麻烦且易错。</p>
<p>因此，在将 <code>v-bind</code> 用于 <code>class</code> 和 <code>style</code> 时，<code>Vue.js</code> 做了专门的增强。表达式结果的类型除了字符串之外，还可以是<strong>对象或数组</strong>。</p>
<h3 id="Class-绑定"><a href="#Class-绑定" class="headerlink" title="Class 绑定"></a><code>Class</code> 绑定</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 样例 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .red &#123;</span></span><br><span class="line"><span class="undefined">            color: red;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .thin &#123;</span></span><br><span class="line"><span class="undefined">            font-weight: 200;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .italic &#123;</span></span><br><span class="line"><span class="undefined">            font-style: italic;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .active &#123;</span></span><br><span class="line"><span class="undefined">            letter-spacing: 0.5em;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 原始的 class， 也是 vue 的渲染效果 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"red thin italic active"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                isActive: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                colorClass: <span class="string">'red'</span>,</span></span><br><span class="line"><span class="javascript">                weightClass: <span class="string">'thin'</span>,</span></span><br><span class="line"><span class="javascript">                styleClass: <span class="string">'italic'</span>,</span></span><br><span class="line"><span class="javascript">                activeClass: <span class="string">'active'</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Class-对象语法"><a href="#Class-对象语法" class="headerlink" title="Class 对象语法"></a><code>Class</code> 对象语法</h4><p>直接给 <code>Class</code> 传入一个对象，以动态切换类。</p>
<h5 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h5><p>直接在 <code>Class</code> 中添加一个对象。键名为类名，可以加引号也可以不加；键值为布尔类型，表示是否使用，键值也可以从 <code>data</code> 数据中获取。</p>
<p>让当然，也可以将对象定义在 <code>data</code> 中，然后给 <code>Class</code> 属性，但是这种方式不能直接获取 <code>data</code> 中的其他数据作为对象中的变量，不过可以通过 <code>computed</code> 计算属性来实现。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 内联形式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"&#123; </span></span></span><br><span class="line"><span class="tag"><span class="string">                // 直接写值</span></span></span><br><span class="line"><span class="tag"><span class="string">                red: true, this: true, italic: true,</span></span></span><br><span class="line"><span class="tag"><span class="string">                // 从 data 数据中获取</span></span></span><br><span class="line"><span class="tag"><span class="string">                active : isActive </span></span></span><br><span class="line"><span class="tag"><span class="string">                &#125;"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"classobj"</span>&gt;</span></span><br><span class="line">        这个是一个很大很大的h1</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined">            ...</span></span><br><span class="line"><span class="undefined">            classObj: &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 只能是布尔值</span></span></span><br><span class="line"><span class="javascript">                red: <span class="literal">true</span>, </span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>: <span class="literal">true</span>, </span></span><br><span class="line"><span class="javascript">                italic: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                active: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="Class-结合-computed-计算属性"><a href="#Class-结合-computed-计算属性" class="headerlink" title="Class 结合 computed 计算属性"></a><code>Class</code> 结合 <code>computed</code> 计算属性</h5><p>因为 <code>computed</code> 可以执行复杂操作，并且可以通过 <code>this</code> 获取 <code>Vue</code> 中的数据。 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"classobj"</span>&gt;</span></span><br><span class="line">        这个是一个很大很大的h1</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            isActive: <span class="literal">true</span>,</span></span><br><span class="line"><span class="undefined">            color: &#123;</span></span><br><span class="line"><span class="javascript">                value: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                type: <span class="string">'red'</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        computed: &#123;</span></span><br><span class="line"><span class="javascript">            classobj: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                    active: <span class="keyword">this</span>.isActive,</span></span><br><span class="line"><span class="javascript">                    red: <span class="keyword">this</span>.color.value &amp;&amp; <span class="keyword">this</span>.color.type === <span class="string">'red'</span>,</span></span><br><span class="line"><span class="javascript">                    thin: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                    italic: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Class-数组语法"><a href="#Class-数组语法" class="headerlink" title="Class 数组语法"></a><code>Class</code> 数组语法</h4><p><code>Vue</code>使用数组类型设置  <code>Class</code>  ，将原先的字符串内容改成数组，<strong>类名必须是字符串类型</strong>，支持动态获取 <code>Vue</code> 实例中的 <code>data</code> 数据，这样使得样式操作也具有响应式，更加方便快捷。</p>
<h5 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 原始的 class， 也是 vue 的渲染效果 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"red thin italic active"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- vue 的数组 class --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"['red', 'thin', 'italic', 'active']"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 获取 data 中数据的 vue 数组 class --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"[colorClass, weightClass, styleClass, activeClass]"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            colorClass: <span class="string">'red'</span></span></span><br><span class="line"><span class="javascript">            weightClass: <span class="string">'thin'</span>,</span></span><br><span class="line"><span class="javascript">            styleClass: <span class="string">'italic'</span>,</span></span><br><span class="line"><span class="javascript">            activeClass: <span class="string">'active'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="三元表达式"><a href="#三元表达式" class="headerlink" title="三元表达式"></a>三元表达式</h5><p>在数组可以使用三元表达式，当然仅用数组形式写三元表达式会显得代码比较长，可以使用<strong>对象语法</strong>实现三元表达式的判断效果，让代码简洁一些。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- vue 数组形式的 class 三元表达式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"[ isActive ? activeClass : '' ]"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- vue 数组形式的 class 结合对象实现判断操作，虽然这样写有些奇怪，可以直接使用对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"[&#123; active : isActive &#125;]"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            isActive: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">            activeClass: <span class="string">'active'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Style"><a href="#Style" class="headerlink" title="Style"></a><code>Style</code></h3><p>基本和 <code>Class</code> 类似，不再赘述。</p>
<h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><p>由于浏览器的安全限制，不允许 <code>Ajax</code> 访问协议不同、域名不同、端口号不同的数据接口，浏览器认为这种访问不安全。</p>
<p>可以通过动态创建 <code>script</code> 标签的形式，把 <code>script</code> 标签的 <code>src</code> 属性，指向书接口的地址，因为 <code>script</code> 标签不存在跨域请求限制，这种数据获取方式称为 <code>JSONP</code> ，<code>JSONP</code> 只支持 <code>GET</code> 请求。</p>
<p>实现过程：</p>
<ul>
<li><p>先在客户端定义一个回调方法，预定义对数据的操作。</p>
</li>
<li><p>在把这个回调方法的名称，通过 <code>url</code> 传参的形式，提交到服务器的数据接口。</p>
</li>
<li><p>服务器数据接口组织好要发送给客户端的数据，再拿着客户端传递过来的回调方法名称，拼接处一个调用这个犯法的字符串，发送给客户端去解析执行。</p>
</li>
<li><p>客户端拿到服务器返回的字符串之后，当做 <code>script</code> 脚本去解析执行，这样就能拿到 <code>JSONP</code> 的数据了。</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 获取数据后，调用 'showInfo' 方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">showInfo</span>(<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 请求端口，将回调方法的名称 'showInfo' 提交数据接口 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://127.0.0.1:8888/getscript?callback=showInfo"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'127.0.0.1'</span></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8888</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 访问 '/getscript' </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">app.get(<span class="string">'/getscript'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> query = req.query</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> data = &#123;</span><br><span class="line">    name: <span class="string">'大明'</span>,</span><br><span class="line">    age: <span class="number">18</span>,</span><br><span class="line">    gener: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拼接返回字符串：scriptStri：showInfo(&#123;"name":"大明","age":18,"gener":0&#125;)</span></span><br><span class="line">  <span class="keyword">var</span> scriptStri = <span class="string">`<span class="subst">$&#123;query.callback&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span></span><br><span class="line">  res.send(scriptStri)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(port, hostname, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`服务器启动成功，请查看 http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/ `</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Vue-异步请求"><a href="#Vue-异步请求" class="headerlink" title="Vue 异步请求"></a>Vue 异步请求</h2><p><code>Ajax</code> 是 <code>jQuery</code> 的异步请求方式，但是 <code>Vue</code> 的原则是不操作 <code>DOM</code> 。所以 <code>Vue</code> 要实现异步加载需要使用到 <code>vue-resource</code> 库或者 <code>vue-axios</code>。</p>
<p>他们都是基于 <code>Promise</code> 进行封装的，所以在学之前最好了解下 <code>Promise</code> 。</p>
<h3 id="vue-resource（vue-2-0-已停止维护，仍然即可）"><a href="#vue-resource（vue-2-0-已停止维护，仍然即可）" class="headerlink" title="vue-resource（vue 2.0 已停止维护，仍然即可）"></a>vue-resource（vue 2.0 已停止维护，仍然即可）</h3><p>github：<a href="https://github.com/pagekit/vue-resource" target="_blank" rel="noopener">https://github.com/pagekit/vue-resource</a></p>
<h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i vue-resource -S</span><br></pre></td></tr></table></figure>
<h4 id="导包"><a href="#导包" class="headerlink" title="导包"></a>导包</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue-resource/dist/vue-resource.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>使用 <code>v-on</code> 绑定方法，然后在方法中使用 <code>this.$http</code> 来发起 <code>GET</code> <code>POST</code> 请求，但是注意，这是基于 <code>Promise</code> 绑定的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue-resource/dist/vue-resource.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"getInfo"</span>&gt;</span>get请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"postInfo"</span>&gt;</span>post请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="javascript">                getInfo: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.$http.get(<span class="string">'http://localhost:3000/data'</span>).then(</span></span><br><span class="line"><span class="javascript">                        <span class="comment">// 成功时的回调，data 为正确时数据对象</span></span></span><br><span class="line"><span class="undefined">                        data =&gt; &#123;</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">console</span>.log(data)</span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    )</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="javascript">                postInfo: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 使用第三参数 emulatJSON，将表单数据格式化</span></span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.$http.post(<span class="string">'http://localhost:3000/data'</span>, &#123; &#125;, &#123; <span class="attr">emulatJSON</span>: <span class="literal">true</span>&#125;).then(</span></span><br><span class="line"><span class="undefined">                        data =&gt; &#123;</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">console</span>.log(data)</span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    )</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h3><p><code>Axios</code> 是一个基于 <code>promise</code> 的 <code>HTTP</code> 库，可以用在浏览器和 <code>node.js</code> 中。 不支持跨域</p>
<h4 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i axios -S</span><br></pre></td></tr></table></figure>
<h4 id="导包-1"><a href="#导包-1" class="headerlink" title="导包"></a>导包</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/axios/dist/axios.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="案例-2"><a href="#案例-2" class="headerlink" title="案例"></a>案例</h4><p><code>axios</code> 数据存储在 <code>data</code> 对象中。<code>axios</code> 异步请求操作直接写在方法中即可。如果需要在页面渲染之前就异步加载数据，可以将方法在 <code>created()</code> 生命函数中调用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加载 axios 和 vue --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/axios/dist/axios.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"getInfo()"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="undefined">                getInfo() &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 使用 axios，发送 get 请求</span></span></span><br><span class="line"><span class="javascript">                    axios.get(<span class="string">'http://localhost:3000/message'</span>).then(</span></span><br><span class="line"><span class="undefined">                        res =&gt; &#123;</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">console</span>.log(<span class="string">'成功了，'</span>, res.data)</span></span><br><span class="line"><span class="undefined">                        &#125;,</span></span><br><span class="line"><span class="undefined">                        err =&gt; &#123;</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">console</span>.log(<span class="string">'错误了'</span>)</span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    )</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h4><p>可以通过 <code>axios(config)</code> 向 <code>axios</code> 传递相关配置来创建请求。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    send: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        axios(&#123;</span><br><span class="line">            method: <span class="string">'get'</span>,</span><br><span class="line">            url: <span class="string">'http://localhost:3000/users'</span>,</span><br><span class="line">            params: &#123;</span><br><span class="line">                <span class="comment">// 与请求一起发送的 URL 参数，会自动拼接</span></span><br><span class="line">                ID: <span class="number">12345</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).then(</span><br><span class="line">            res =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            err =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'请求错误'</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过 <code>axios.get(url[, config])</code> 请求方法实现。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    send: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        axios.get(<span class="string">'http://localhost:3000/users'</span>).then(</span><br><span class="line">            res =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            err =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'请求错误'</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h4><p>以前的版本好像不能直接传 <code>json</code> 形式的参数，现在可以。</p>
<p>如果无法传 <code>json</code> 形式参数，则使用如下以下传参方法：</p>
<ul>
<li>自己拼接键值对：’name=大明&amp;age=20’。</li>
<li>使用 <code>transformResponse</code> ，在请求发送前将数据进行转换。</li>
<li>模块化开发中使用 <code>qs</code> 模块</li>
</ul>
<p>可以通过 <code>axios(config)</code> 向 <code>axios</code> 传递相关配置来创建请求。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    send: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        axios(&#123;</span><br><span class="line">            method: <span class="string">'post'</span>,</span><br><span class="line">            url: <span class="string">'http://localhost:3000/users'</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">                name: <span class="string">'xiaohua'</span>,</span><br><span class="line">                gender: <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).then(</span><br><span class="line">            res =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            err =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'输入插入错误'</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过 <code>axios.post(url, data[, config])</code> 请求方法实现。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    send: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        axios.post(<span class="string">'http://localhost:3000/users'</span>,&#123;</span><br><span class="line">            name: <span class="string">'xiaohua'</span>,</span><br><span class="line">            gender: <span class="number">0</span></span><br><span class="line">        &#125;).then(</span><br><span class="line">            res =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            err =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'请求错误'</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="常用配置选项-config"><a href="#常用配置选项-config" class="headerlink" title="常用配置选项 config"></a>常用配置选项 <code>config</code></h4><ul>
<li><p><code>url: &#39;/user&#39;</code> ：用于请求的服务器 <code>URL</code> 字符串。</p>
</li>
<li><p><code>method: &#39;get&#39;</code> ：是创建请求时使用的方法，默认是 ‘get’。</p>
</li>
<li><p><code>baseURL: &#39;https://localhost:3000/&#39;</code> ：<code>baseURL</code> 将自动加在 <code>url</code> 前面，除非 <code>url</code> 是一个绝对 URL。可以直接全写在 <code>url</code> 中，但是不建议这么做！！！</p>
</li>
<li><p><code>transformRequest</code> ：允许<code>PUT</code> 、<code>POST</code> 和 <code>PATCH</code> 这几个请求方在向服务器发送前，修改请求数据。后面数组中的函数必须返回一个字符串，或 <code>ArrayBuffer</code> ，或 <code>Stream</code> ，然后在里面写方法。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">transformRequest: [<span class="function"><span class="keyword">function</span> (<span class="params">data, headers</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对 data 进行任意转换处理</span></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>transformResponse</code> 在传递给 then/catch 前，允许修改响应数据。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">transformResponse: [<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对 data 进行任意转换处理</span></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>headers: {&#39;X-Requested-With&#39;: &#39;XMLHttpRequest&#39;}</code> ： 是即将被发送的自定义请求头。</p>
</li>
<li><p><code>params</code> ：是即将与请求一起发送的 URL 参数。必须是一个无格式对象( <code>plain object</code> )或 <code>URLSearchParams</code> 对象。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">params: &#123;</span><br><span class="line">    ID: <span class="number">12345</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>data</code> ： 是作为请求主体被发送的数据。只适用于这些请求方法 <code>PUT</code>、 <code>POST</code> 和 <code>PATCH</code> 。在没有设置 <code>transformRequest</code> 时，必须是以下类型之一：</p>
<ul>
<li><code>string</code> , <code>plain object</code> , <code>ArrayBuffer</code> , <code>ArrayBufferView</code> , <code>URLSearchParams</code>。</li>
<li>浏览器专属：<code>FormData</code> , <code>File</code> , <code>Blob</code></li>
<li><code>Node</code> 专属：<code>Stream</code></li>
</ul>
</li>
<li><p><code>timeout: 1000</code> 指定请求超时的毫秒数(0 表示无超时时间)。</p>
</li>
<li><p><code>withCredentials: false</code> 表示跨域请求时是否需要使用凭证，默认 <code>false</code>。</p>
</li>
</ul>
<h4 id="配置默认值"><a href="#配置默认值" class="headerlink" title="配置默认值"></a>配置默认值</h4><h5 id="全局的-axios-默认值"><a href="#全局的-axios-默认值" class="headerlink" title="全局的 axios 默认值"></a>全局的 <code>axios</code> 默认值</h5><p>配置全局的 <code>axios</code> 默认值一般写在最前面或者单独放在配置文件中。以 <code>axios.defaults.</code> 开头，之后写需要配置默认值的属性及默认值。默认值的级别一般较低。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 添加配置全局默认的根路径</span></span></span><br><span class="line"><span class="javascript">        axios.defaults.baseURL = <span class="string">'http://127.0.0.1:3000/'</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 默认表单提交类型</span></span></span><br><span class="line"><span class="javascript">        axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded'</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 默认请求等待时间</span></span></span><br><span class="line"><span class="undefined">        axios.defaults.timeout = 2500</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="undefined">                send() &#123;</span></span><br><span class="line"><span class="undefined">                    axios(&#123;</span></span><br><span class="line"><span class="javascript">                        url: <span class="string">'/main'</span>,</span></span><br><span class="line"><span class="javascript">                        <span class="comment">// 在 axios 中添加配置</span></span></span><br><span class="line"><span class="javascript">                        <span class="comment">// baseURL: 'http://127.0.0.1:3000/',</span></span></span><br><span class="line"><span class="javascript">                        method: <span class="string">'get'</span></span></span><br><span class="line"><span class="undefined">                    &#125;).then(</span></span><br><span class="line"><span class="undefined">                        data =&gt; &#123;</span></span><br><span class="line"><span class="undefined">                            </span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    )</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Vue-中的过渡动画"><a href="#Vue-中的过渡动画" class="headerlink" title="Vue 中的过渡动画"></a>Vue 中的过渡动画</h2><p><code>Vue</code> 提供多种不同方式的应用过渡效果。<br>包括以下工具：</p>
<ul>
<li>在 <code>CSS</code> 过渡和动画中自动应用 <code>class</code></li>
<li>可以配合使用第三方 <code>CSS</code> 动画库，如 <code>Animate.css</code></li>
<li>在过渡钩子函数中使用 <code>JavaScript</code> 直接操作 <code>DOM</code></li>
<li>可以配合使用第三方 <code>JavaScript 动画库</code> ，如 <code>Velocity.js</code></li>
</ul>
<p><code>Vue</code> 提供了 <code>transition</code> 元素，在下列情形中，可以给任何元素和组件添加进入/离开过渡</p>
<ul>
<li>条件渲染 (使用 <code>v-if</code>)</li>
<li>条件展示 (使用 <code>v-show</code>)</li>
<li>动态组件</li>
<li>组件根节点</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">        需要的添加动画的元素。</span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="CSS-过渡的类"><a href="#CSS-过渡的类" class="headerlink" title="CSS 过渡的类"></a>CSS 过渡的类</h3><p><strong>进入过程</strong></p>
<ol>
<li><code>v-enter</code> ：定义进入过渡的<strong>开始状态</strong>。在元素被插入之前生效，在元素被插入之后的下一帧移除。</li>
<li><code>v-enter-active</code> ：定义进入过渡生效时的状态。在整个进入过渡的阶段中应用，在元素被插入之前生效，在过渡/动画完成之后移除。这个类可以被用来定义进入过渡的过程时间，延迟和曲线函数。</li>
<li><code>v-enter-to</code> : 定义进入过渡的<strong>结束状态</strong>。在元素被插入之后下一帧生效 (与此同时 <code>v-enter</code> 被移除)，在过渡/动画完成之后移除。</li>
</ol>
<p><strong>退出过程</strong></p>
<ol>
<li><code>v-leave</code> :  定义离开过渡的<strong>开始状态</strong>。在离开过渡被触发时立刻生效，下一帧被移除。</li>
<li><code>v-leave-active</code> ：定义离开过渡生效时的状态。在整个离开过渡的阶段中应用，在离开过渡被触发时立刻生效，在过渡/动画完成之后移除。这个类可以被用来定义离开过渡的过程时间，延迟和曲线函数。</li>
<li><code>v-leave-to</code> : 定义离开过渡的<strong>结束状态</strong>。在离开过渡被触发之后下一帧生效 (与此同时 <code>v-leave</code> 被删除)，在过渡/动画完成之后移除。</li>
</ol>
<p><img src="/2019/03/23/框架——Vuejs/blog\source\_posts\框架——Vuejs\transition.png" alt="transition.png"></p>
<p>实例如下。其中如果给 <code>transition</code> 加一个 <code>name</code> 属性，则其对应的类选择器名就会用 <code>name属性值-</code> 代替 <code>v-</code> 再加六个默认类名其余部分。  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 过渡类名，使用类选择器  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        /** </span></span><br><span class="line"><span class="undefined">         * 在进入之前和离开之后的状态类</span></span><br><span class="line"><span class="undefined">         */</span></span><br><span class="line"><span class="undefined">        .v-enter, .v-leave-to &#123;</span></span><br><span class="line"><span class="undefined">            opacity: 0;</span></span><br><span class="line"><span class="undefined">            /* 添加移入移出效果 */</span></span><br><span class="line"><span class="undefined">            transform: translateX(150px);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        /** </span></span><br><span class="line"><span class="undefined">         * 使用了自定义 name 属性的进入之前和离开之后的状态类</span></span><br><span class="line"><span class="undefined">         */</span></span><br><span class="line"><span class="undefined">        .xxx-enter, .xxx-leave-to &#123;</span></span><br><span class="line"><span class="undefined">            opacity: 0;</span></span><br><span class="line"><span class="undefined">            /* 添加移入移出效果 */</span></span><br><span class="line"><span class="undefined">            transform: translateX(150px);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="undefined">        /**</span></span><br><span class="line"><span class="undefined">         * 两个过渡动画类</span></span><br><span class="line"><span class="undefined">         */</span></span><br><span class="line"><span class="undefined">        .v-enter-active, .v-leave-active &#123;</span></span><br><span class="line"><span class="undefined">            transition: all 0.8s ease;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"flag = !flag"</span>&gt;</span>button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- transition 可以认为自定义添加了6个动画类 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 自定义命名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"xxx"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                flag: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="第三方-animate-css-类库"><a href="#第三方-animate-css-类库" class="headerlink" title="第三方 animate.css 类库"></a>第三方 <code>animate.css</code> 类库</h3><p>官网：<a href="https://daneden.github.io/animate.css/" target="_blank" rel="noopener">https://daneden.github.io/animate.css/</a></p>
<p>所有动画效果都可以在官网首页进行预览。</p>
<p><img src="/2019/03/23/框架——Vuejs/animate.png" alt="animate.png"></p>
<p>可以直接下载 <code>css</code> 文件或者使用 <code>npm</code> 下载。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i animate.css -S</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/animate.css/animate.css"</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/23/框架——Vuejs/" data-id="cjtl8ndgp001d4gutbwuf0rue" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/框架/">框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/移动端/">移动端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-模板引擎——art-template" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/20/模板引擎——art-template/" class="article-date">
  <time datetime="2019-03-20T12:23:36.000Z" itemprop="datePublished">2019-03-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/20/模板引擎——art-template/">模板引擎——art-template</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#简介">简介</a></li>
<li><a href="#安装">安装</a></li>
<li><a href="#语法">语法</a><ul>
<li><a href="#输出">输出</a></li>
<li><a href="#原文输出">原文输出</a></li>
<li><a href="#条件">条件</a></li>
<li><a href="#循环">循环</a></li>
<li><a href="#变量">变量</a></li>
<li><a href="#模板继承">模板继承</a></li>
<li><a href="#子模板">子模板</a></li>
<li><a href="#过滤器">过滤器</a></li>
</ul>
</li>
<li><a href="#调试">调试</a></li>
<li><a href="#模板变量">模板变量</a></li>
<li><a href="#解析规则">解析规则</a></li>
<li><a href="#压缩页面">压缩页面</a></li>
<li><a href="#选项">选项</a></li>
<li><a href="#api">API</a></li>
</ul>
<!-- /TOC -->
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>官方文档：<a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener">https://aui.github.io/art-template/zh-cn/docs/index.html</a></p>
<hr>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><hr>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><h3 id="原文输出"><a href="#原文输出" class="headerlink" title="原文输出"></a>原文输出</h3><h3 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h3><h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><h3 id="模板继承"><a href="#模板继承" class="headerlink" title="模板继承"></a>模板继承</h3><p>使用模板继承将继承模板页中所有内容，并且在查看使用页的源代码时，将有所有代码。</p>
<p>标准语法:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 模板页 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 挖坑（ block块 ） --&gt;</span></span><br><span class="line">&#123;&#123;block 'head'&#125;&#125; 默认内容 &#123;&#123;/block&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用页 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引用模板 --&gt;</span></span><br><span class="line">&#123;&#123;extend './layout.art'&#125;&#125;</span><br><span class="line"><span class="comment">&lt;!-- 填坑（ block块 ） --&gt;</span></span><br><span class="line">&#123;&#123;block 'head'&#125;&#125; 使用页内容 &#123;&#123;/block&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>案例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- layout.html 模板页 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 挖了三个坑（ block块 ） --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;&#123; block 'title' &#125;&#125;模板页默认标题&#123;&#123; /block &#125;&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    &#123;&#123; block 'head' &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"main.css"</span>&gt;</span></span><br><span class="line">    &#123;&#123; /block &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    &#123;&#123; block 'content'&#125;&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>模板页默认内容<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;&#123; /block &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html 使用页 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用模板页 --&gt;</span></span><br><span class="line">&#123;&#123; extend './layout.html' &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 如果要修改模板页坑（ block块 ）中的内容，只需要使用相同的 block块 ，并修改其中默认内容即可 --&gt;</span></span><br><span class="line">&#123;&#123; block 'content'&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>使用页修改模板页中内容<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">&#123;&#123; /block &#125;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="子模板"><a href="#子模板" class="headerlink" title="子模板"></a>子模板</h3><p>标准语法：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用页 --&gt;</span></span><br><span class="line">&#123;&#123;include 'path'&#125;&#125;</span><br><span class="line">&#123;&#123;include 'path' data&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>案例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- header.html 模板页 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>子模板<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html 使用页 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 引用模板 --&gt;</span></span><br><span class="line">        &#123;&#123; include './header.html' &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><hr>
<h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><hr>
<h2 id="模板变量"><a href="#模板变量" class="headerlink" title="模板变量"></a>模板变量</h2><hr>
<h2 id="解析规则"><a href="#解析规则" class="headerlink" title="解析规则"></a>解析规则</h2><hr>
<h2 id="压缩页面"><a href="#压缩页面" class="headerlink" title="压缩页面"></a>压缩页面</h2><hr>
<h2 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h2><hr>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/20/模板引擎——art-template/" data-id="cjtl8ndzv00224gut399emrav" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模板引擎/">模板引擎</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-后端基础——npm常见包" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/19/后端基础——npm常见包/" class="article-date">
  <time datetime="2019-03-19T13:20:46.000Z" itemprop="datePublished">2019-03-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/19/后端基础——npm常见包/">后端基础——npm常见包</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#npm-基础">npm 基础</a><ul>
<li><a href="#项目初始化">项目初始化</a></li>
<li><a href="#下载模块包">下载模块包</a></li>
<li><a href="#其他常用命令">其他常用命令</a></li>
<li><a href="#npm-被墙问题">npm 被墙问题</a></li>
</ul>
</li>
<li><a href="#常用包使用">常用包使用</a><ul>
<li><a href="#json-server">json-server</a><ul>
<li><a href="#安装">安装</a></li>
<li><a href="#创建-json-模拟数据文件">创建 JSON 模拟数据文件</a></li>
<li><a href="#启动服务">启动服务</a></li>
</ul>
</li>
<li><a href="#http-server">http-server</a></li>
<li><a href="#art-template">art-template</a><ul>
<li><a href="#安装-1">安装</a></li>
</ul>
</li>
<li><a href="#express-art-template">express-art-template</a><ul>
<li><a href="#安装-2">安装</a></li>
</ul>
</li>
<li><a href="#body-parser">body-parser</a><ul>
<li><a href="#body-parser-安装">body-parser 安装</a></li>
<li><a href="#body-parser-配置">body-parser 配置</a></li>
<li><a href="#express-获取-post-数据">Express 获取 POST 数据</a></li>
</ul>
</li>
<li><a href="#express-session">express-session</a><ul>
<li><a href="#express-session-安装">express-session 安装</a></li>
<li><a href="#express-session-配置">express-session 配置</a></li>
<li><a href="#express-session-使用">express-session 使用</a></li>
</ul>
</li>
<li><a href="#blueimp-md5">blueimp-md5</a></li>
<li><a href="#axios">axios</a></li>
<li><a href="#vue-axios">vue-axios</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="npm-基础"><a href="#npm-基础" class="headerlink" title="npm 基础"></a>npm 基础</h2><p>NPM（node package manager），是基于Node.js开发的包管理器。是世界上最大的开源库生态系统。</p>
<p>中文文档： <a href="https://www.npmjs.cn/" target="_blank" rel="noopener">https://www.npmjs.cn/</a><br>官网： <a href="https://www.npmjs.com/" target="_blank" rel="noopener">https://www.npmjs.com/</a></p>
<p>一些常用的包都可以在官网查找。</p>
<h3 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h3><p><code>package.json</code> 包描述文件，这个文件会记录我们的项目信息，比如需要的项目依赖、版本号之类，非常重要，访问项目文件被误删导致无法挽回的后果。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 命令，有向导</span><br><span class="line">npm init</span><br><span class="line"></span><br><span class="line">// 跳过向导，快速创建，所有选项默认</span><br><span class="line">npm init -y</span><br></pre></td></tr></table></figure>
<p>执行这个命令之后，如果没有 <code>package.json</code> 包描述文件，就会新建；如果已经有了，当 <code>node_modules</code> 依赖丢失时，会根据 <code>package.json</code> 中的 <code>dependencies</code> 字段重新下载依赖。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">/** </span><br><span class="line"> * 如下为新建包描述文件（初始化项目）全过程</span><br><span class="line"> */</span><br><span class="line"> </span><br><span class="line">// 输入命令，通过命令向导创建</span><br><span class="line"><span class="function">F:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>&gt;<span class="title">npm</span> <span class="title">init</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 自动输出内容</span></span><br><span class="line"><span class="function"><span class="title">This</span> <span class="title">utility</span> <span class="title">will</span> <span class="title">walk</span> <span class="title">you</span> <span class="title">through</span> <span class="title">creating</span> <span class="title">a</span> <span class="title">package.json</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function"><span class="title">It</span> <span class="title">only</span> <span class="title">covers</span> <span class="title">the</span> <span class="title">most</span> <span class="title">common</span> <span class="title">items</span>, <span class="title">and</span> <span class="title">tries</span> <span class="title">to</span> <span class="title">guess</span> <span class="title">sensible</span> <span class="title">defaults</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">See</span> `<span class="title">npm</span> <span class="title">help</span> <span class="title">json</span>` <span class="title">for</span> <span class="title">definitive</span> <span class="title">documentation</span> <span class="title">on</span> <span class="title">these</span> <span class="title">fields</span></span></span><br><span class="line"><span class="function"><span class="title">and</span> <span class="title">exactly</span> <span class="title">what</span> <span class="title">they</span> <span class="title">do</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Use</span> `<span class="title">npm</span> <span class="title">install</span> &lt;<span class="title">pkg</span>&gt;` <span class="title">afterwards</span> <span class="title">to</span> <span class="title">install</span> <span class="title">a</span> <span class="title">package</span> <span class="title">and</span></span></span><br><span class="line"><span class="function"><span class="title">save</span> <span class="title">it</span> <span class="title">as</span> <span class="title">a</span> <span class="title">dependency</span> <span class="title">in</span> <span class="title">the</span> <span class="title">package.json</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Press</span> ^<span class="title">C</span> <span class="title">at</span> <span class="title">any</span> <span class="title">time</span> <span class="title">to</span> <span class="title">quit</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">/**</span></span><br><span class="line"><span class="function"> * 问答式填写项目内容，可以不填，回车直接跳过</span></span><br><span class="line"><span class="function"> */</span></span><br><span class="line"><span class="function">// 包名，默认是我们已经通过 <span class="title">cd</span> 命令进入的文件夹</span></span><br><span class="line"><span class="function"><span class="title">package</span> <span class="title">name</span>: (<span class="title">nodejs</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 版本号，默认为(1.0.0)，我们填写一个较低的版本(0.0.1)</span></span><br><span class="line"><span class="function"><span class="title">version</span>: (1.0.0) 0.0.1</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 项目描述，手动输入</span></span><br><span class="line"><span class="function"><span class="title">description</span>: 这是一个学习项目</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 入口文件，默认是 <span class="title">index.js</span>，我们可以自定义</span></span><br><span class="line"><span class="function"><span class="title">entry</span> <span class="title">point</span>: (<span class="title">index.js</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 测试命令</span></span><br><span class="line"><span class="function"><span class="title">test</span> <span class="title">command</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="title">git</span> 仓库地址</span></span><br><span class="line"><span class="function"><span class="title">git</span> <span class="title">repository</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 关键字，如果想自己的项目通过 <span class="title">npm</span> 被别人下载，就可以填写关键字，供别人下载</span></span><br><span class="line"><span class="function"><span class="title">keywords</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 作者</span></span><br><span class="line"><span class="function"><span class="title">author</span>: <span class="title">AiJunhao</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 软件开源许可证</span></span><br><span class="line"><span class="function"><span class="title">license</span>: (<span class="title">ISC</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 生成的包描述文件内容</span></span><br><span class="line"><span class="function"><span class="title">About</span> <span class="title">to</span> <span class="title">write</span> <span class="title">to</span> <span class="title">F</span>:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>\<span class="title">package.json</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">&#123;</span></span><br><span class="line"><span class="function">  "<span class="title">name</span>": "<span class="title">nodejs</span>",</span></span><br><span class="line"><span class="function">  "<span class="title">version</span>": "0.0.1",</span></span><br><span class="line"><span class="function">  "<span class="title">description</span>": "这是一个学习项目",</span></span><br><span class="line"><span class="function">  "<span class="title">main</span>": "<span class="title">index.js</span>",</span></span><br><span class="line"><span class="function">  "<span class="title">scripts</span>": &#123;</span></span><br><span class="line"><span class="function">    "<span class="title">test</span>": "<span class="title">echo</span> \"<span class="title">Error</span>: <span class="title">no</span> <span class="title">test</span> <span class="title">specified</span>\" &amp;&amp; <span class="title">exit</span> 1"</span></span><br><span class="line"><span class="function">  &#125;,</span></span><br><span class="line"><span class="function">  "<span class="title">author</span>": "<span class="title">AiJunhao</span>",</span></span><br><span class="line"><span class="function">  "<span class="title">license</span>": "<span class="title">ISC</span>"</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 是否同意，输入 <span class="title">yes</span> </span></span><br><span class="line"><span class="function"><span class="title">Is</span> <span class="title">this</span> <span class="title">OK</span>? (<span class="title">yes</span>) <span class="title">yes</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">F</span>:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>此时在项目根目录就创建了 <code>package.json</code> 文件。</p>
<h3 id="下载模块包"><a href="#下载模块包" class="headerlink" title="下载模块包"></a>下载模块包</h3><p>使用 npm 下载的包，放在同级目录下的 “node_modules” 文件夹下。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 语法</span><br><span class="line">npm install 模块关键字 --save</span><br><span class="line"></span><br><span class="line">或者简写：npm i 模块关键字 --save</span><br><span class="line">或者简写：npm i 模块关键字 -S</span><br><span class="line"></span><br><span class="line">// --save：表示将这个下载记录到 package.js 的 dependencies 中。如果不写，则不保存。</span><br></pre></td></tr></table></figure>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 输入mingl</span><br><span class="line"><span class="function">F:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>&gt;<span class="title">npm</span> <span class="title">install</span> <span class="title">art</span>-<span class="title">template</span> --<span class="title">save</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 会有一些 <span class="title">WARN</span> ，不用管它</span></span><br><span class="line"><span class="function"><span class="title">npm</span> <span class="title">notice</span> <span class="title">created</span> <span class="title">a</span> <span class="title">lockfile</span> <span class="title">as</span> <span class="title">package</span>-<span class="title">lock.json</span>. <span class="title">You</span> <span class="title">should</span> <span class="title">commit</span> <span class="title">this</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function"><span class="title">npm</span> <span class="title">WARN</span> <span class="title">nodejs</span>@0.0.1 <span class="title">No</span> <span class="title">repository</span> <span class="title">field</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 表示包已经添加</span></span><br><span class="line"><span class="function">+ <span class="title">art</span>-<span class="title">template</span>@4.13.2</span></span><br><span class="line"><span class="function"><span class="title">added</span> 32 <span class="title">packages</span> <span class="title">from</span> 133 <span class="title">contributors</span> <span class="title">and</span> <span class="title">audited</span> 40 <span class="title">packages</span> <span class="title">in</span> 6.025<span class="title">s</span></span></span><br><span class="line"><span class="function"><span class="title">found</span> 0 <span class="title">vulnerabilities</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">F</span>:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>此时看项目文件夹，就会有 node_modules 文件夹被新建，里面放了所有一级、二级……依赖文件；<code>package.json</code> 文件中会添加 <code>dependencies</code> 字段，记录这次添加的依赖包。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"nodejs"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.0.1"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"这是一个学习项目"</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"app.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"AiJunhao"</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"art-template"</span>: <span class="string">"^4.13.2"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="其他常用命令"><a href="#其他常用命令" class="headerlink" title="其他常用命令"></a>其他常用命令</h3><ul>
<li><p>删除包</p>
  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm unistall 包名       // 只删除，不会删除依赖项中的内容</span><br><span class="line"></span><br><span class="line">简写: npm un 包名</span><br></pre></td></tr></table></figure>
  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm unistall 包名 --save       // 删除包并删除依赖项中的内容</span><br><span class="line"></span><br><span class="line">简写: npm un 包名 -S</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看使用帮助</p>
  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm --<span class="built_in">help</span>      // 查看所有使用帮助</span><br><span class="line"></span><br><span class="line">npm 命令 --<span class="built_in">help</span>     // 查看该命令的具体使用方法</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="npm-被墙问题"><a href="#npm-被墙问题" class="headerlink" title="npm 被墙问题"></a>npm 被墙问题</h3><p>npm 存储包文件的服务器在国外，有时候会被墙，这时候可以使用淘宝镜像 cnpm。</p>
<p><a href="http://npm.taobao.org/" target="_blank" rel="noopener">http://npm.taobao.org/</a> 淘宝的开发团队把 npm 在国内做了一个备份。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 安装淘宝的 cnpm</span><br><span class="line">npm install --global cnpm</span><br><span class="line"></span><br><span class="line">// 然后将正常的 npm 命令中 npm 改成 cnpm 即可</span><br><span class="line">npm install jquery</span><br><span class="line">变成：cpm install jquery</span><br></pre></td></tr></table></figure>
<p>如果不想安装 cnpm 又想使用淘宝镜像下载：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jquery --registry=https://registry.npm.taoba.org</span><br></pre></td></tr></table></figure>
<p>但是这样比较麻烦，可以将这个选项加入配置文件中：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 配置</span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">// 查看配置</span><br><span class="line">npm config list</span><br></pre></td></tr></table></figure>
<p>配置之后，之后所有的下载都是从淘宝镜像下载的。</p>
<hr>
<h2 id="常用包使用"><a href="#常用包使用" class="headerlink" title="常用包使用"></a>常用包使用</h2><p>在开发中，有很多包对我们的测试和开发非常有用，这里做一个积累。</p>
<h3 id="json-server"><a href="#json-server" class="headerlink" title="json-server"></a>json-server</h3><p>使用本地 <code>JSON</code> 文件数据模拟 <code>API</code> 数据的工具。</p>
<p>在开发中很多时候我们并不想使用简单的静态数据，而是希望自己起一个本地的mock-server来完全模拟请求以及请求回来的过程。json-server是一个很好的可以替我们完成这一工作的工具。我们只需要提供一个json文件，或者写几行简单的js脚本就可以模拟出 <code>RESTful API</code> 的接口。</p>
<p>视频教程：<a href="https://egghead.io/lessons/javascript-creating-demo-apis-with-json-server" target="_blank" rel="noopener">https://egghead.io/lessons/javascript-creating-demo-apis-with-json-server</a></p>
<p>git教程：<a href="https://github.com/typicode/json-server" target="_blank" rel="noopener">https://github.com/typicode/json-server</a></p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 安装</span><br><span class="line"><span class="meta">&gt;</span> npm install -g json-server</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 查看版本号</span><br><span class="line"><span class="meta">&gt;</span> json-server -v</span><br></pre></td></tr></table></figure>
<h4 id="创建-JSON-模拟数据文件"><a href="#创建-JSON-模拟数据文件" class="headerlink" title="创建 JSON 模拟数据文件"></a>创建 JSON 模拟数据文件</h4><p>安装之后创建一个 <code>json</code> 文件，用来模拟提供接口数据：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// data.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"users"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"id"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"admin"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">28</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"id"</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"admin"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">28</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"id"</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"admin"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">28</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h4><p>然后就是在 <code>json</code> 文件目录下启动服务了。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 启动服务命令，实时监测 data.json 的变化</span><br><span class="line"><span class="meta">&gt;</span> json-server --watch data.json</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 启动服务命令，不监测变化，data.json 文件内容变化后不重启服务接口内容不变</span><br><span class="line"><span class="meta">&gt;</span> json-server data.json</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">f:\WorkSpace\nodejs\05&gt;json-server --watch data.json</span><br><span class="line"></span><br><span class="line">  \&#123;^_^&#125;/ hi!</span><br><span class="line"></span><br><span class="line">  Loading data.json</span><br><span class="line">  Done</span><br><span class="line"></span><br><span class="line">  Resources</span><br><span class="line">  http://localhost:3000/users</span><br><span class="line"></span><br><span class="line">  Home</span><br><span class="line">  http://localhost:3000</span><br><span class="line"></span><br><span class="line">  Type s + enter at any time to create a snapshot of the database</span><br><span class="line">  Watching...</span><br><span class="line"></span><br><span class="line">GET /db 200 2.483 ms - 608</span><br><span class="line">GET /__rules 404 8.024 ms - 2</span><br></pre></td></tr></table></figure>
<p>然后浏览器访问 <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> 可以查看我们的主页，此时基本满足所有 API 操作。</p>
<p><img src="/2019/03/19/后端基础——npm常见包/json-server.jpg" alt="json-server.jpg"></p>
<hr>
<h3 id="http-server"><a href="#http-server" class="headerlink" title="http-server"></a>http-server</h3><hr>
<h3 id="art-template"><a href="#art-template" class="headerlink" title="art-template"></a>art-template</h3><p>前端模板引擎。</p>
<h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i art-template -S</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="express-art-template"><a href="#express-art-template" class="headerlink" title="express-art-template"></a>express-art-template</h3><p>在 <code>express</code> 中使用的 <code>art-template</code> 模板引擎。</p>
<h4 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i art-template -S</span><br><span class="line">npm i express-art-template -S</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="body-parser"><a href="#body-parser" class="headerlink" title="body-parser"></a>body-parser</h3><p>在 <code>Express</code> 中没有内置获取表单 <code>POST</code> 请求体的API，这里我们需要一个 <code>Express</code> 的第三方包 <code>body-parser</code>。</p>
<p><a href="http://www.expressjs.com.cn/en/resources/middleware/body-parser.html" target="_blank" rel="noopener">http://www.expressjs.com.cn/en/resources/middleware/body-parser.html</a></p>
<h4 id="body-parser-安装"><a href="#body-parser-安装" class="headerlink" title="body-parser 安装"></a>body-parser 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install body-parser</span><br></pre></td></tr></table></figure>
<h4 id="body-parser-配置"><a href="#body-parser-配置" class="headerlink" title="body-parser 配置"></a>body-parser 配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="comment">// 引包</span></span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 body-parser</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line">app.use(bodyParser.json())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载路由</span></span><br><span class="line">app.use(router)</span><br></pre></td></tr></table></figure>
<h4 id="Express-获取-POST-数据"><a href="#Express-获取-POST-数据" class="headerlink" title="Express 获取 POST 数据"></a>Express 获取 POST 数据</h4><p>配置完这个中间件之后，<code>request</code> 中会多出一个 <code>body</code> 属性，通过 <code>body</code> 属性就能获取 <code>post</code> 请求数据了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简单使用，打印出这个 post 数据</span></span><br><span class="line">app.use(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">  response.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>)</span><br><span class="line">  response.write(<span class="string">'you posted;\n'</span>)</span><br><span class="line">  <span class="comment">// post 数据在 request.body 中，将其转为 JSON 数据并打印出来。</span></span><br><span class="line">  response.end(<span class="built_in">JSON</span>.stringify(request.body, <span class="literal">null</span>, <span class="number">2</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="express-session"><a href="#express-session" class="headerlink" title="express-session"></a>express-session</h3><p><code>Express</code> 的 <code>Session</code> 和 <code>Cookie</code> 中间件。</p>
<p><code>Express</code> 文档：<a href="http://www.expressjs.com.cn/en/resources/middleware/session.html" target="_blank" rel="noopener">http://www.expressjs.com.cn/en/resources/middleware/session.html</a></p>
<h4 id="express-session-安装"><a href="#express-session-安装" class="headerlink" title="express-session 安装"></a>express-session 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express-session -S</span><br></pre></td></tr></table></figure>
<h4 id="express-session-配置"><a href="#express-session-配置" class="headerlink" title="express-session 配置"></a>express-session 配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="comment">// 引包</span></span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">'express-session'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 session</span></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  <span class="comment">// 自定义的二次加密字符串</span></span><br><span class="line">  secret: <span class="string">'keyboard cat'</span>,</span><br><span class="line">  resave: <span class="literal">false</span>,</span><br><span class="line">  saveUninitialized: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载路由</span></span><br><span class="line">app.use(router)</span><br></pre></td></tr></table></figure>
<h4 id="express-session-使用"><a href="#express-session-使用" class="headerlink" title="express-session 使用"></a>express-session 使用</h4><p><code>session</code> 参数都存在 <code>request</code> 中，只要通过 <code>request.session.xxx</code> 就能进行 <code>session</code> 信息的存取操作了。</p>
<p>如下页面，先进行注册并自动登录，<code>req</code> 存储登录状态；然后跳转到首页，<code>req</code> 获取到登录状态，进行进一步的处理，保持页面处于登录状态。</p>
<p>但是注意，这种做法的 <code>session</code> 默认是存储在服务器的内存中的，也就是说只要服务器已关闭，所有 <code>session</code> 都会被清除，所以有时候需要进行永久化存储。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js 路由独立页面</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首页</span></span><br><span class="line">router.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.session.user)    <span class="comment">// userObject</span></span><br><span class="line">  <span class="comment">// 将用户对象传入渲染页面</span></span><br><span class="line">  res.render(<span class="string">'index.html'</span>, &#123;</span><br><span class="line">    user: req.session.user</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册页面处理</span></span><br><span class="line">router.post(<span class="string">'/register'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  ……</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 注册成功，保存 session</span></span><br><span class="line">  req.session.user = userObject</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="blueimp-md5"><a href="#blueimp-md5" class="headerlink" title="blueimp-md5"></a>blueimp-md5</h3><p><a href="https://www.npmjs.com/package/blueimp-md5" target="_blank" rel="noopener">https://www.npmjs.com/package/blueimp-md5</a></p>
<p>数据加密。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i blueimp-md5 -S</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> md5 = <span class="built_in">require</span>(<span class="string">'blueimp-md5'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过post获取注册信息等……</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 一般进行两层以上加密</span></span><br><span class="line">body.password = md5(md5(body.pawword))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后保存账号密码到数据库</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 之后，数据库中的加密内容就是乱码了。</span></span><br><span class="line"><span class="string">"password"</span> : <span class="string">"d9b1d7db4cd6e70935368a1efb10e377"</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h3><h3 id="vue-axios"><a href="#vue-axios" class="headerlink" title="vue-axios"></a>vue-axios</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/19/后端基础——npm常见包/" data-id="cjtl8ne1h002q4guto4yqa6sc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node/">Node</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-前端-JavaScript基础-EcamScript6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/18/前端-JavaScript基础-EcamScript6/" class="article-date">
  <time datetime="2019-03-18T08:59:13.000Z" itemprop="datePublished">2019-03-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/18/前端-JavaScript基础-EcamScript6/">前端-JavaScript基础-EcamScript6</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#ecamscript-6-简介">EcamScript 6 简介</a></li>
<li><a href="#声明与表达式">声明与表达式</a></li>
<li><a href="#内置对象">内置对象</a></li>
<li><a href="#运算符与语句">运算符与语句</a></li>
<li><a href="#异步操作">异步操作</a><ul>
<li><a href="#callback-hell-回调地狱">callback hell 回调地狱</a></li>
<li><a href="#promise-对象">Promise 对象</a><ul>
<li><a href="#promise-状态">Promise 状态</a></li>
<li><a href="#then-方法">then() 方法</a></li>
<li><a href="#案例nodejs-中-promise-读取文件数据">案例：Node.js 中 Promise 读取文件数据</a></li>
<li><a href="#案例前端请求数据时的-promise">案例：前端请求数据时的 Promise</a></li>
<li><a href="#案例nodejs-调用-mongoose-时的-promise">案例：Node.js 调用 Mongoose 时的 promise</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="EcamScript-6-简介"><a href="#EcamScript-6-简介" class="headerlink" title="EcamScript 6 简介"></a>EcamScript 6 简介</h2><p>阮一峰教材：<a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noopener">http://es6.ruanyifeng.com/#docs/promise</a></p>
<hr>
<h2 id="声明与表达式"><a href="#声明与表达式" class="headerlink" title="声明与表达式"></a>声明与表达式</h2><hr>
<h2 id="内置对象"><a href="#内置对象" class="headerlink" title="内置对象"></a>内置对象</h2><hr>
<h2 id="运算符与语句"><a href="#运算符与语句" class="headerlink" title="运算符与语句"></a>运算符与语句</h2><hr>
<h2 id="异步操作"><a href="#异步操作" class="headerlink" title="异步操作"></a>异步操作</h2><h3 id="callback-hell-回调地狱"><a href="#callback-hell-回调地狱" class="headerlink" title="callback hell 回调地狱"></a>callback hell 回调地狱</h3><p>在 JS 程序中，程序执行不会等待异步操作执行，而异步操作的时间长短与操作的内容有关，并不一定会按顺序。</p>
<p>如下代码，有三个读取文件的异步操作，其执行结束的顺序与文件大小及其他因素有关，所以控制台输出的结果顺序会不同。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./b.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./c.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果需要将这个程序按先后顺序执行，可以如下修改：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line"></span><br><span class="line">  fs.readFile(<span class="string">'./b.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line"></span><br><span class="line">    fs.readFile(<span class="string">'./c.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果有更多的异步操作，就需要在回调函数中不断地嵌套函数，代码深度将非常恐怖，也非常不利于维护，这就是<font color="red">回调地域</font>。</p>
<h3 id="Promise-对象"><a href="#Promise-对象" class="headerlink" title="Promise 对象"></a>Promise 对象</h3><p><code>Promise</code> 对象用于解决异步操作的回调地狱（函数作为参数层层嵌套）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 虽然解决了异步操作的先后顺序，单数出现了回调地域</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line"></span><br><span class="line">  fs.readFile(<span class="string">'./b.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line"></span><br><span class="line">    fs.readFile(<span class="string">'./c.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Promise-状态"><a href="#Promise-状态" class="headerlink" title="Promise 状态"></a>Promise 状态</h4><p><code>Promise</code> 异步操作有三种状态：<code>pending（进行中）</code>、 <code>resolved（已定型） /fulfilled（已成功）</code> 和  <code>rejected（已失败）</code>。</p>
<p><code>Promise</code>对象只有：从 <code>pending</code> 变为 <code>Resolved</code> 和从 <code>pending</code> 变为 <code>rejected</code> 的状态改变。只要处于 <code>resolved</code> 和 <code>rejected</code> ，状态就不会再变了。</p>
<p><img src="/2019/03/18/前端-JavaScript基础-EcamScript6/Promise.jpg" alt="Promise.jpg"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Promise 对象的使用</span></span><br><span class="line"><span class="keyword">var</span> myPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ... some code</span></span><br><span class="line"></span><br><span class="line">  异步操作方法(xxx, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>Promise</code> 对象一旦新建就会被执行，中途无法被取消。</p>
<h4 id="then-方法"><a href="#then-方法" class="headerlink" title="then() 方法"></a>then() 方法</h4><p><code>then()</code> 方法接收两个回调函数作为参数，两个函数只会有一个被调用。</p>
<ul>
<li><p>第一个参数是 <code>Promise</code> 执行成功 <code>Resolve</code> 成功状态时的回调。</p>
</li>
<li><p>第二个参数是 <code>Promise</code> 执行失败 <code>Reject</code> 失败状态时的回调。</p>
</li>
</ul>
<p><code>then()</code> 方法会在异步操作完成之后执行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单个异步操作</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ... some code</span></span><br><span class="line"></span><br><span class="line">  fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">myPromise.then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;, (err) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>then()</code> 方法可以链式调用，每个 <code>then()</code> 方法的一个回调函数中 <code>return</code> 下一个要执行的异步操作的 <code>Promise</code> 对象，这样第二个异步操作就会在第一个异步操作之后执行，这样就确保了异步操作的执行顺序问题，同时也避免了回调地域问题。</p>
<hr>
<h4 id="案例：Node-js-中-Promise-读取文件数据"><a href="#案例：Node-js-中-Promise-读取文件数据" class="headerlink" title="案例：Node.js 中 Promise 读取文件数据"></a>案例：Node.js 中 Promise 读取文件数据</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Node.js 中多个异步操作依次执行</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  fs.readFile(<span class="string">'./b.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  fs.readFile(<span class="string">'./c.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p1</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> p2</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> p3</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为了简化代码，可以将这个异步操作封装成 API</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pReadFile</span> (<span class="params">filePath</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    fs.readFile(filePath, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">        reject(err)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pReadFile(<span class="string">'./a.txt'</span>)</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> pReadFile(<span class="string">'./b.txt'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> pReadFile(<span class="string">'./c.txt'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="案例：前端请求数据时的-Promise"><a href="#案例：前端请求数据时的-Promise" class="headerlink" title="案例：前端请求数据时的 Promise"></a>案例：前端请求数据时的 Promise</h4><p>这里使用 <code>ajax</code> 请求 <code>API</code> 数据时，有时会出现一个页面需要请求多个不同的 <code>API</code>，少则三五个，多则七八个，因彼此间有先后顺序，此时就需要保证异步请求的先后顺序了，<code>jQuery</code> 中已经支持了 <code>Promise</code>。</p>
<p>这个案例需要 <code>API</code> 数据，可以用 <code>json-server</code> 工具来模拟。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">"user_form"</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 模板内容 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/template"</span> <span class="attr">id</span>=<span class="string">"tpl"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; user.username &#125;&#125;"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; user.age &#125;&#125;"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>职业<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span></span></span><br><span class="line"><span class="undefined">                    &#123;&#123; each jobs&#125;&#125;</span></span><br><span class="line"><span class="javascript">                        &#123;&#123; <span class="keyword">if</span> user.jobId === $value.id&#125;&#125;</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; $value.id &#125;&#125;"</span> <span class="attr">selected</span>&gt;</span>&#123;&#123; $value.name &#125;&#125;<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="javascript">                        &#123;&#123; <span class="keyword">else</span> &#125;&#125;</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; $value.id &#125;&#125;"</span>&gt;</span>&#123;&#123; $value.name &#125;&#125;<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="javascript">                        &#123;&#123; /<span class="keyword">if</span> &#125;&#125;</span></span><br><span class="line"><span class="undefined">                    &#123;&#123; /each &#125;&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="undefined">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 引用模板 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/art-template/lib/template-web.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 引用 jQuery --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/jquery/dist/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 模板渲染 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             *  未用 promise</span></span><br><span class="line"><span class="undefined">             */</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> data = &#123;&#125;;</span></span><br><span class="line"><span class="javascript">            promiseGet(<span class="string">"http://127.0.0.1:3000/users/4"</span>)</span></span><br><span class="line"><span class="javascript">                .then(<span class="function"><span class="params">userData</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="undefined">                    data.user = userData</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> promiseGet(<span class="string">"http://127.0.0.1:3000/jobs"</span>)</span></span><br><span class="line"><span class="undefined">                &#125;)</span></span><br><span class="line"><span class="javascript">                .then(<span class="function"><span class="params">jobsData</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="undefined">                    data.jobs = jobsData</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(data)</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">var</span> htmlStr = template(<span class="string">"tpl"</span>, data)</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">document</span>.querySelector(<span class="string">"#user_form"</span>).innerHTML = htmlStr</span></span><br><span class="line"><span class="undefined">                &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             *  使用 promise 的 jQuery</span></span><br><span class="line"><span class="undefined">             */</span></span><br><span class="line"><span class="javascript">            <span class="comment">// var data = &#123;&#125;;</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// // userData，jobsData 返回时就是对象了</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// $.get("http://127.0.0.1:3000/users/4")</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//     .then(userData =&gt; &#123;</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         data.user = userData</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         return $.get("http://127.0.0.1:3000/jobs")</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//     &#125;)</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//     .then(jobsData =&gt; &#123;</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         data.jobs = jobsData</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         var htmlStr = template("tpl", data)</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         document.querySelector("#user_form").innerHTML = htmlStr</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//     &#125;)</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             * 封装 ajax 获取网络请求的 promise 方法，可以再写个callback，就可以支持多重形式</span></span><br><span class="line"><span class="undefined">             **/</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="keyword">function</span> <span class="title">promiseGet</span>(<span class="params">url</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">var</span> oReq = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 当请求加载成功之后要调用的函数</span></span></span><br><span class="line"><span class="javascript">                    oReq.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                        resolve(<span class="built_in">JSON</span>.parse(oReq.responseText));</span></span><br><span class="line"><span class="undefined">                    &#125;;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 当请求加载失败之后要调用的函数</span></span></span><br><span class="line"><span class="javascript">                    oReq.onerror = <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="undefined">                        reject(err);</span></span><br><span class="line"><span class="undefined">                    &#125;;</span></span><br><span class="line"><span class="javascript">                    oReq.open(<span class="string">"get"</span>, url, <span class="literal">true</span>);</span></span><br><span class="line"><span class="undefined">                    oReq.send();</span></span><br><span class="line"><span class="undefined">                &#125;);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// data.json</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"users"</span>:[</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">1</span>,<span class="attr">"username"</span>:<span class="string">"admin"</span>,<span class="attr">"age"</span>:<span class="number">28</span>,<span class="attr">"jobId"</span>:<span class="number">3</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">2</span>,<span class="attr">"username"</span>:<span class="string">"admin"</span>,<span class="attr">"age"</span>:<span class="number">28</span>,<span class="attr">"jobId"</span>:<span class="number">4</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">3</span>,<span class="attr">"username"</span>:<span class="string">"admin"</span>,<span class="attr">"age"</span>:<span class="number">28</span>,<span class="attr">"jobId"</span>:<span class="number">5</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">4</span>,<span class="attr">"username"</span>:<span class="string">"admin"</span>,<span class="attr">"age"</span>:<span class="number">28</span>,<span class="attr">"jobId"</span>:<span class="number">5</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"jobs"</span>:[</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">1</span>,<span class="attr">"name"</span>:<span class="string">"学生"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">2</span>,<span class="attr">"name"</span>:<span class="string">"老师"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">3</span>,<span class="attr">"name"</span>:<span class="string">"司机"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">4</span>,<span class="attr">"name"</span>:<span class="string">"画家"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">5</span>,<span class="attr">"name"</span>:<span class="string">"演员"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">6</span>,<span class="attr">"name"</span>:<span class="string">"电竞"</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="案例：Node-js-调用-Mongoose-时的-promise"><a href="#案例：Node-js-调用-Mongoose-时的-promise" class="headerlink" title="案例：Node.js 调用 Mongoose 时的 promise"></a>案例：Node.js 调用 Mongoose 时的 promise</h4><p><code>mongoose</code> 所有 <code>API</code> 都支持 <code>promise</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">27017</span></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'127.0.0.1'</span></span><br><span class="line"><span class="keyword">const</span> dbName = <span class="string">'user'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 连接数据库</span></span><br><span class="line">mongoose.connect(<span class="string">`mongodb://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/<span class="subst">$&#123;dbName&#125;</span>`</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数据库连接状态;</span></span><br><span class="line"><span class="keyword">var</span> db = mongoose.connection</span><br><span class="line">db.on(<span class="string">'error'</span>, <span class="built_in">console</span>.error.bind(<span class="built_in">console</span>, <span class="string">'数据库连接失败！'</span>))</span><br><span class="line">db.once(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// we're connected!</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'数据库连接成功！'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Schema 文档结构设计（表结构）</span></span><br><span class="line"><span class="keyword">var</span> userSchema = mongoose.Schema(&#123;</span><br><span class="line">  username: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  password: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  email: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  age: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  gender: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">0</span>,</span><br><span class="line">    enum: [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 把 schema 编译成一个 Model，并返回 Model 对象</span></span><br><span class="line"><span class="keyword">var</span> User = mongoose.model(<span class="string">'User'</span>, userSchema)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> userJson = &#123;</span><br><span class="line">  username: <span class="string">'admin'</span>,</span><br><span class="line">  password: <span class="string">'1234'</span>,</span><br><span class="line">  email: <span class="string">'1234@qq.com'</span>,</span><br><span class="line">  age: <span class="number">17</span>,</span><br><span class="line">  gender: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 mongoose 的 Promise，避免用户重复注册</span></span><br><span class="line">User.findOne(&#123; <span class="attr">username</span>: <span class="string">'admin'</span> &#125;)</span><br><span class="line">  .then(</span><br><span class="line">    <span class="comment">// 查询成功的回调，data 为查找到的对象</span></span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (data) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'用户名已存在'</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'用户名可用'</span>)</span><br><span class="line">        <span class="comment">// 用户不存在，注册</span></span><br><span class="line">        <span class="comment">// return 异步操作 save()</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(userJson).save()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    () =&gt; <span class="built_in">console</span>.log(<span class="string">'数据查询失败'</span>)</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    <span class="comment">// 如果执行 save() 成功，data 返回的是保存的对象</span></span><br><span class="line">    <span class="comment">// 未执行 save() 方法，data 为空</span></span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (data) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'数据保存成功:'</span>, data)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'数据不保存'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    () =&gt; <span class="built_in">console</span>.log(<span class="string">'数据保存失败'</span>)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不使用 Promise</span></span><br><span class="line"><span class="comment">// User.findOne(&#123; username: 'admin' &#125;, (err, data) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   if (err) &#123;</span></span><br><span class="line"><span class="comment">//     return console.log('查询失败')</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   console.log('查找成功，data：', data)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   if (data) &#123;</span></span><br><span class="line"><span class="comment">//     console.log('用户名已存在')</span></span><br><span class="line"><span class="comment">//   &#125; else &#123;</span></span><br><span class="line"><span class="comment">//     console.log('用户名可用')</span></span><br><span class="line"><span class="comment">//     new User(userJson).save((err, data) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//       if (err) &#123;</span></span><br><span class="line"><span class="comment">//         return console.log('保存失败')</span></span><br><span class="line"><span class="comment">//       &#125;</span></span><br><span class="line"><span class="comment">//       console.log('保存成功，data：', data)</span></span><br><span class="line"><span class="comment">//     &#125;)</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;)</span></span><br></pre></td></tr></table></figure>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/18/前端-JavaScript基础-EcamScript6/" data-id="cjtl8ne19002m4gut8apwt8or" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EcamScript6/">EcamScript6</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-数据库——MySQL" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/15/数据库——MySQL/" class="article-date">
  <time datetime="2019-03-15T09:35:10.000Z" itemprop="datePublished">2019-03-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/15/数据库——MySQL/">数据库——MySQL</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#mysql-简介">MySQL 简介</a></li>
<li><a href="#mysql-安装">MySQL 安装</a><ul>
<li><a href="#zip-压缩版">ZIP 压缩版</a></li>
<li><a href="#msi-安装包安装">MSI 安装包安装</a></li>
<li><a href="#第三方可视化工具-patchnavicat">第三方可视化工具 PatchNavicat</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="MySQL-简介"><a href="#MySQL-简介" class="headerlink" title="MySQL 简介"></a>MySQL 简介</h2><p>关系型数据库</p>
<h2 id="MySQL-安装"><a href="#MySQL-安装" class="headerlink" title="MySQL 安装"></a>MySQL 安装</h2><p><a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">https://dev.mysql.com/downloads/mysql/</a></p>
<h3 id="ZIP-压缩版"><a href="#ZIP-压缩版" class="headerlink" title="ZIP 压缩版"></a>ZIP 压缩版</h3><p><img src="/2019/03/15/数据库——MySQL/download.png" alt="download.png"></p>
<p><img src="/2019/03/15/数据库——MySQL/download2.png" alt="download2.png"></p>
<p>详细配置见菜鸟联盟：<a href="http://www.runoob.com/mysql/mysql-install.html" target="_blank" rel="noopener">http://www.runoob.com/mysql/mysql-install.html</a></p>
<h3 id="MSI-安装包安装"><a href="#MSI-安装包安装" class="headerlink" title="MSI 安装包安装"></a>MSI 安装包安装</h3><p>见收藏的百度云视频：</p>
<p>链接：<a href="https://pan.baidu.com/s/1dBn2UqrIvR-5ebJQZ_lOmg" target="_blank" rel="noopener">https://pan.baidu.com/s/1dBn2UqrIvR-5ebJQZ_lOmg</a><br>提取码：d041<br>复制这段内容后打开百度网盘手机App，操作更方便哦</p>
<h3 id="第三方可视化工具-PatchNavicat"><a href="#第三方可视化工具-PatchNavicat" class="headerlink" title="第三方可视化工具 PatchNavicat"></a>第三方可视化工具 PatchNavicat</h3><p>见收藏的百度云视频：</p>
<p>链接：<a href="https://pan.baidu.com/s/1dBn2UqrIvR-5ebJQZ_lOmg" target="_blank" rel="noopener">https://pan.baidu.com/s/1dBn2UqrIvR-5ebJQZ_lOmg</a><br>提取码：d041<br>复制这段内容后打开百度网盘手机App，操作更方便哦</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/15/数据库——MySQL/" data-id="cjtl8ndgr001f4gutn3kuzxpo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-数据库——MongoDB" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/15/数据库——MongoDB/" class="article-date">
  <time datetime="2019-03-15T09:29:23.000Z" itemprop="datePublished">2019-03-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/15/数据库——MongoDB/">数据库——MongoDB</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#mongodb-介绍">MongoDB 介绍</a><ul>
<li><a href="#关系型数据库和非关系型数据库">关系型数据库和非关系型数据库</a><ul>
<li><a href="#关系型数据库特点">关系型数据库特点</a></li>
<li><a href="#非关系型数据库">非关系型数据库</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#mongodb-下载及安装">MongoDB 下载及安装</a><ul>
<li><a href="#下载">下载</a></li>
<li><a href="#安装">安装</a></li>
<li><a href="#配置环境变量">配置环境变量</a></li>
<li><a href="#新建数据目录">新建数据目录</a><ul>
<li><a href="#修改默认数据目录">修改默认数据目录</a></li>
</ul>
</li>
<li><a href="#连接数据库">连接数据库</a></li>
</ul>
</li>
<li><a href="#mongodb-可视化工具-mongodb-compass">MongoDB 可视化工具 MongoDB Compass</a></li>
<li><a href="#mongodb-查">MongoDB 查</a><ul>
<li><a href="#查看所有数据库">查看所有数据库</a></li>
<li><a href="#查看当前所在的数据库">查看当前所在的数据库</a></li>
<li><a href="#查询文档">查询文档</a><ul>
<li><a href="#查询所有">查询所有</a></li>
<li><a href="#单文档查询">单文档查询</a></li>
<li><a href="#格式化显示">格式化显示</a></li>
<li><a href="#条件查询语句">条件查询语句</a></li>
<li><a href="#and-条件">AND 条件</a></li>
<li><a href="#or-条件">OR 条件</a></li>
<li><a href="#type-操作符"><code>$type</code> 操作符</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#mongodb-增">MongoDB 增</a><ul>
<li><a href="#创建切换数据库">创建/切换数据库</a></li>
<li><a href="#创建集合">创建集合</a><ul>
<li><a href="#主动创建集合">主动创建集合</a></li>
<li><a href="#创建集合并插入数据">创建集合并插入数据</a></li>
</ul>
</li>
<li><a href="#插入数据文档">插入数据文档</a></li>
</ul>
</li>
<li><a href="#mongodb-删">MongoDB 删</a><ul>
<li><a href="#删除数据库">删除数据库</a></li>
<li><a href="#删除集合">删除集合</a></li>
<li><a href="#删除文档">删除文档</a></li>
</ul>
</li>
<li><a href="#mongodb-改">MongoDB 改</a><ul>
<li><a href="#update">update()</a></li>
<li><a href="#save-方法">save() 方法</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="MongoDB-介绍"><a href="#MongoDB-介绍" class="headerlink" title="MongoDB 介绍"></a>MongoDB 介绍</h2><p>菜鸟联盟：<a href="http://www.runoob.com/mongodb/mongodb-tutorial.html" target="_blank" rel="noopener">http://www.runoob.com/mongodb/mongodb-tutorial.html</a></p>
<h3 id="关系型数据库和非关系型数据库"><a href="#关系型数据库和非关系型数据库" class="headerlink" title="关系型数据库和非关系型数据库"></a>关系型数据库和非关系型数据库</h3><p>所谓的关系型，表就是关系，就是表与表之间存在关系。</p>
<h4 id="关系型数据库特点"><a href="#关系型数据库特点" class="headerlink" title="关系型数据库特点"></a>关系型数据库特点</h4><p>关系型数据库最典型的数据结构是表，由二维表及其之间的联系所组成的一个数据组织。</p>
<p>优点：</p>
<ul>
<li>易于维护：都是使用表结构，格式一致；</li>
<li>使用方便：SQL语言通用，可用于复杂查询；</li>
<li>复杂操作：支持SQL，可用于一个表以及多个表之间非常复杂的查询。</li>
</ul>
<p>缺点：</p>
<ul>
<li><p>读写性能比较差，尤其是海量数据的高效率读写；</p>
</li>
<li><p>固定的表结构，灵活度稍欠；</p>
</li>
<li><p>高并发读写需求，传统关系型数据库来说，硬盘I/O是一个很大的瓶颈。</p>
</li>
</ul>
<p>常用数据库：</p>
<p>MariaDB/SQL Server/MySQL/SQLite/ORACLE/PostgreSQL</p>
<h4 id="非关系型数据库"><a href="#非关系型数据库" class="headerlink" title="非关系型数据库"></a>非关系型数据库</h4><p>非关系型数据库严格上不是一种数据库，应该是一种数据结构化存储方法的集合，可以是文档或者键值对等。</p>
<p>优点：</p>
<ul>
<li>格式灵活：存储数据的格式可以是key,value形式、文档形式、图片形式等等，文档形式、图片形式等等，使用灵活，应用场景广泛，而关系型数据库则只支持基础类型。</li>
<li>速度快：nosql可以使用硬盘或者随机存储器作为载体，而关系型数据库只能使用硬盘；</li>
<li>高扩展性；</li>
<li>成本低：nosql数据库部署简单，基本都是开源软件。</li>
</ul>
<p>缺点：</p>
<ul>
<li>不提供sql支持，学习和使用成本较高；</li>
<li>无事务处理；</li>
<li>数据结构相对复杂，复杂查询方面稍欠。</li>
</ul>
<p>非关系型数据库的分类和比较：</p>
<ul>
<li>文档型</li>
<li>key-value型</li>
<li>列式数据库</li>
<li>图形数据库</li>
</ul>
<p>常用数据库：</p>
<p>mongoDB/HBASE/redis/Cassandra/CouchDB/Neo4j</p>
<hr>
<h2 id="MongoDB-下载及安装"><a href="#MongoDB-下载及安装" class="headerlink" title="MongoDB 下载及安装"></a>MongoDB 下载及安装</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>官网：<a href="https://www.mongodb.com/" target="_blank" rel="noopener">https://www.mongodb.com/</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>下载安装即可，直到最后一步需要下载安装 <code>MongoDB Compass</code> 可视化界面，哪里将左下角的√取消掉就好。这个下载太慢！！！可视化界面我们自己装。</p>
<p><img src="/2019/03/15/数据库——MongoDB/注意点.jpg" alt="注意点.jpg"></p>
<h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><p>配置环境变量：将安装目录下的 <code>bin</code> 目录添加到用户变量。</p>
<p>然后使用<font color="red">管理员身份</font>进入命令行输入 <code>mongod -v</code> 查看版本，有用即可。</p>
<p><img src="/2019/03/15/数据库——MongoDB/cmd.jpg" alt="cmd.jpg"></p>
<h3 id="新建数据目录"><a href="#新建数据目录" class="headerlink" title="新建数据目录"></a>新建数据目录</h3><p>由于第一次执行需要一个数据库文件目录，默认是 <code>C:/data/db</code> 如果没有这个目录，会执行失败，如下图所示：</p>
<p><img src="/2019/03/15/数据库——MongoDB/第一次执行.jpg" alt="第一次执行.jpg"></p>
<p>新建完目录之后，再次执行，如下，数据库服务启动完成，窗口不能关闭，<code>CTRL + C</code> 退出：</p>
<p><img src="/2019/03/15/数据库——MongoDB/第二次执行.jpg" alt="第二次执行.jpg"></p>
<h4 id="修改默认数据目录"><a href="#修改默认数据目录" class="headerlink" title="修改默认数据目录"></a>修改默认数据目录</h4><p>如果不想放在 C 盘，可以通过命令修改：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod --dbpath xxx:\data\db</span><br></pre></td></tr></table></figure>
<h3 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h3><p>首先使用<font color="red">管理员身份</font>进入命令行输入 <code>mongod</code> 打开服务。</p>
<p>通过如下网址：<a href="http://127.0.0.1:27017/" target="_blank" rel="noopener">http://127.0.0.1:27017/</a> 访问。如果网页内容显示 <code>‘It looks like you are trying to access MongoDB over HTTP on the native driver port.’</code>，表示数据库服务已打开。</p>
<p>然后再使用<font color="red">管理员身份</font>进入命令行输入 <code>mongo</code> 连接数据库，注意原先打开服务的命令窗口不能关闭。</p>
<p>如下，即可：</p>
<p><img src="/2019/03/15/数据库——MongoDB/连接数据库.jpg" alt="连接数据库.jpg"></p>
<hr>
<h2 id="MongoDB-可视化工具-MongoDB-Compass"><a href="#MongoDB-可视化工具-MongoDB-Compass" class="headerlink" title="MongoDB 可视化工具 MongoDB Compass"></a>MongoDB 可视化工具 MongoDB Compass</h2><p>这个可视化工具就是我们之前点击取消的那个，自主官网下载比较快。在官网选择社区版下载。</p>
<hr>
<h2 id="MongoDB-查"><a href="#MongoDB-查" class="headerlink" title="MongoDB 查"></a>MongoDB 查</h2><h3 id="查看所有数据库"><a href="#查看所有数据库" class="headerlink" title="查看所有数据库"></a>查看所有数据库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> show dbs</span></span><br><span class="line">admin   0.000GB</span><br><span class="line">config  0.000GB</span><br><span class="line">local   0.000GB</span><br></pre></td></tr></table></figure>
<p>这些是系统自带的数据库，最好不要动。</p>
<p>MongoDB 中默认的数据库为 test，如果你没有创建新的数据库，集合将存放在 test 数据库中，但是由于初始没数据，不显示。</p>
<h3 id="查看当前所在的数据库"><a href="#查看当前所在的数据库" class="headerlink" title="查看当前所在的数据库"></a>查看当前所在的数据库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db</span></span><br><span class="line">mydbs</span><br></pre></td></tr></table></figure>
<h3 id="查询文档"><a href="#查询文档" class="headerlink" title="查询文档"></a>查询文档</h3><h4 id="查询所有"><a href="#查询所有" class="headerlink" title="查询所有"></a>查询所有</h4><p><code>find()</code> 方法查询所有匹配文档。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 查询文档</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.collection.find(query, projection)</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>query ：可选，使用查询操作符指定查询条件。为空表示查询所有。</p>
</li>
<li><p>projection ：可选，使用投影操作符指定返回的键。查询时返回文档中所有键值， 只需省略该参数即可（默认省略）。</p>
</li>
</ul>
<h4 id="单文档查询"><a href="#单文档查询" class="headerlink" title="单文档查询"></a>单文档查询</h4><p><code>findOne()</code> 方法查询收个匹配文档。可用参数与 <code>find()</code> 方法相同。</p>
<h4 id="格式化显示"><a href="#格式化显示" class="headerlink" title="格式化显示"></a>格式化显示</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 查询文档并以格式化数据</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.find().pretty()</span></span><br></pre></td></tr></table></figure>
<h4 id="条件查询语句"><a href="#条件查询语句" class="headerlink" title="条件查询语句"></a>条件查询语句</h4><table>
<thead>
<tr>
<th>操作</th>
<th>格式</th>
<th>范例</th>
<th>关系型数据库语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>等于</td>
<td>{&lt;key>:&lt;value>}</td>
<td>db.col.find({“by”:”菜鸟教程”}).pretty()</td>
<td>where by = ‘菜鸟教程’</td>
</tr>
<tr>
<td>小于</td>
<td>{&lt;key>:{$lt:&lt;value>}}</td>
<td>db.col.find({“likes”:{$lt:50}}).pretty()</td>
<td>where likes &lt; 50</td>
</tr>
<tr>
<td>小于或等于</td>
<td>{&lt;key>:{$lte:&lt;value>}}</td>
<td>db.col.find({“likes”:{$lte:50}}).pretty()</td>
<td>where likes &lt;= 50</td>
</tr>
<tr>
<td>大于</td>
<td>{&lt;key>:{$gt:&lt;value>}}</td>
<td>db.col.find({“likes”:{$gt:50}}).pretty()</td>
<td>where likes &gt; 50</td>
</tr>
<tr>
<td>大于或等于</td>
<td>{&lt;key>:{$gte:&lt;value>}}</td>
<td>db.col.find({“likes”:{$gte:50}}).pretty()</td>
<td>where likes &gt;= 50</td>
</tr>
<tr>
<td>不等于</td>
<td>{&lt;key>:{$ne:&lt;value>}}</td>
<td>db.col.find({“likes”:{$ne:50}}).pretty()</td>
<td>where likes != 50</td>
</tr>
</tbody>
</table>
<h4 id="AND-条件"><a href="#AND-条件" class="headerlink" title="AND 条件"></a>AND 条件</h4><p><code>find()</code> 方法可以传入多个键(key)，每个键(key)以逗号隔开，即常规 <code>SQL</code> 的 <code>AND</code> 条件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.find(&#123;key1:value1, key2:value2&#125;).pretty()</span></span><br></pre></td></tr></table></figure>
<h4 id="OR-条件"><a href="#OR-条件" class="headerlink" title="OR 条件"></a>OR 条件</h4><p>OR 条件语句使用了关键字 <code>$or</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.find(</span></span><br><span class="line">   &#123;</span><br><span class="line">        $or: [</span><br><span class="line">            &#123;key1: value1&#125;, &#123;key2:value2&#125;</span><br><span class="line">        ]</span><br><span class="line">   &#125;</span><br><span class="line">).pretty()</span><br></pre></td></tr></table></figure>
<h4 id="type-操作符"><a href="#type-操作符" class="headerlink" title="$type 操作符"></a><code>$type</code> 操作符</h4><p>检索集合中匹配的数据类型，并返回结果。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.find(&#123;<span class="string">"键名"</span> : &#123;<span class="variable">$type</span> : 类型字符串/对应的数字标签 &#125;&#125;)</span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>类型</th>
<th>数字</th>
<th>类型</th>
<th>数字</th>
</tr>
</thead>
<tbody>
<tr>
<td>Double</td>
<td>1</td>
<td>Regular Expression</td>
<td>11</td>
</tr>
<tr>
<td>String</td>
<td>2</td>
<td>—</td>
<td>—</td>
</tr>
<tr>
<td>Object</td>
<td>3</td>
<td>JavaScript</td>
<td>13</td>
</tr>
<tr>
<td>Array</td>
<td>4</td>
<td>Symbol</td>
<td>14</td>
</tr>
<tr>
<td>Binary data</td>
<td>5</td>
<td>JavaScript (with scope)</td>
<td>15</td>
</tr>
<tr>
<td>Undefined(已废弃)</td>
<td>6</td>
<td>32-bit integer</td>
<td>16</td>
</tr>
<tr>
<td>Object id</td>
<td>7</td>
<td>Timestamp</td>
<td>17</td>
</tr>
<tr>
<td>Boolean</td>
<td>8</td>
<td>64-bit integer</td>
<td>18</td>
</tr>
<tr>
<td>Date</td>
<td>9</td>
<td>Min key</td>
<td>255</td>
</tr>
<tr>
<td>Null</td>
<td>10</td>
<td>Max key</td>
<td>127</td>
</tr>
</tbody>
</table>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.find()</span></span><br><span class="line">&#123; "_id" : ObjectId("5c8cb31eca4aff6ebfd76983"), "title" : "MongoDB" &#125;</span><br><span class="line">&#123; "_id" : ObjectId("5c8cd26fca4aff6ebfd76984"), "title" : "123", "by" : "asdf" &#125;</span><br><span class="line">&#123; "_id" : ObjectId("5c8cd37cca4aff6ebfd76985"), "title" : 123 &#125;</span><br><span class="line"></span><br><span class="line">// 查询 "title" 数据类型为 'string' 的数据。</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.find(&#123;<span class="string">"title"</span>: &#123;<span class="variable">$type</span>: <span class="string">'string'</span>&#125;&#125;)</span></span><br><span class="line">&#123; "_id" : ObjectId("5c8cb31eca4aff6ebfd76983"), "title" : "MongoDB" &#125;</span><br><span class="line">&#123; "_id" : ObjectId("5c8cd26fca4aff6ebfd76984"), "title" : "123", "by" : "asdf" &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="MongoDB-增"><a href="#MongoDB-增" class="headerlink" title="MongoDB 增"></a>MongoDB 增</h2><h3 id="创建-切换数据库"><a href="#创建-切换数据库" class="headerlink" title="创建/切换数据库"></a>创建/切换数据库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> use mydbs</span></span><br><span class="line">switched to db mydbs</span><br></pre></td></tr></table></figure>
<p>使用 <code>use</code> 创建名为 <code>mydbs</code> 的数据库，如果数据库不存在，则创建数据库，否则切换到指定数据库。</p>
<p>如图，创建 <code>mydbs</code> 数据库，然后查看所有数据库，会发现并没有显示我们刚创建的数据库！！！由于我们创建的数据库里面没有数据，所以不会显示。然后通过 <code>db</code> 命令查看我们所在的数据库，可以发现，我们当前的确创建并切换到了 <code>mydbs</code> 数据库中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> use mydbs</span></span><br><span class="line">switched to db mydbs</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> show dbs</span></span><br><span class="line">admin   0.000GB</span><br><span class="line">config  0.000GB</span><br><span class="line">local   0.000GB</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db</span></span><br><span class="line">mydbs</span><br></pre></td></tr></table></figure>
<h3 id="创建集合"><a href="#创建集合" class="headerlink" title="创建集合"></a>创建集合</h3><h4 id="主动创建集合"><a href="#主动创建集合" class="headerlink" title="主动创建集合"></a>主动创建集合</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 主动创建集合语法</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.createCollection(name, options)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 实例</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.createCollection(<span class="string">"test"</span>)</span></span><br><span class="line">&#123; "ok" : 1 &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.createCollection(<span class="string">"mycol"</span>, &#123; capped : <span class="literal">true</span>, autoIndexId : <span class="literal">true</span>, size : </span></span><br><span class="line">   6142800, max : 10000 &#125; )</span><br><span class="line">   </span><br><span class="line">// 查看集合</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> show collections</span></span><br><span class="line">test</span><br><span class="line">mycol</span><br></pre></td></tr></table></figure>
<ul>
<li><p>name: 要创建的集合名称</p>
</li>
<li><p>options: 可选参数, 指定有关内存大小及索引的选项</p>
<ul>
<li><p>capped: 布尔值。</p>
<p>  如果为 <code>true</code>，则创建固定集合。固定集合是指有着固定大小的集合，当达到最大值时，它会自动覆盖最早的文档。当该值为 <code>true</code> 时，必须指定 <code>size</code> 参数。</p>
</li>
<li><p>autoIndexId: 布尔值。</p>
<p>  如为 <code>true</code>，自动在 <code>_id</code> 字段创建索引。默认为 <code>false</code> 。</p>
</li>
<li><p>size: 数值。</p>
<p>  为固定集合指定一个最大值（以字节计）。如果 <code>capped</code> 为 <code>true</code>，也需要指定该字段。</p>
</li>
<li><p>max: 数值。指定固定集合中包含文档的最大数量。</p>
</li>
</ul>
</li>
</ul>
<h4 id="创建集合并插入数据"><a href="#创建集合并插入数据" class="headerlink" title="创建集合并插入数据"></a>创建集合并插入数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 创建集合并插入数据</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.myCol.insert(&#123;<span class="string">"name"</span>: <span class="string">"test"</span>&#125;)</span></span><br></pre></td></tr></table></figure>
<h3 id="插入数据文档"><a href="#插入数据文档" class="headerlink" title="插入数据文档"></a>插入数据文档</h3><p>MongoDB 使用 insert() 或 save() 方法向集合中插入文档。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 语法</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.COLLECTION_NAME.insert(document)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 插入数据</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.mydbs.insert(&#123;title: <span class="string">'MongoDB'</span>&#125;)</span></span><br><span class="line">WriteResult(&#123; "nInserted" : 1 &#125;)</span><br><span class="line"></span><br><span class="line">// 查询</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.find()</span></span><br><span class="line">&#123; "_id" : ObjectId("5c8cb31eca4aff6ebfd76983"), "title" : "MongoDB" &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="MongoDB-删"><a href="#MongoDB-删" class="headerlink" title="MongoDB 删"></a>MongoDB 删</h2><h3 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3><p>MongoDB 中删除数据库需要先用 <code>use</code> 切换到需要删除的数据库，然后使用 <code>dropDatabase()</code> 方法删除当前数据库。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 切换进需要删除的数据库</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> use DatabaseName</span></span><br><span class="line">switched to db DatabaseName</span><br><span class="line"></span><br><span class="line">// 删除当前数据库</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.dropDatabase()</span></span><br><span class="line">&#123; "dropped" : "DatabaseName", "ok" : 1 &#125;</span><br></pre></td></tr></table></figure>
<h3 id="删除集合"><a href="#删除集合" class="headerlink" title="删除集合"></a>删除集合</h3><p>MongoDB 中使用 <code>drop()</code> 方法来删除当前数据库中的集合。如果成功删除选定集合，返回 true，否则返回 false。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 语法</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.collectionName.drop()</span></span><br><span class="line">true        // 成功</span><br><span class="line">false       // 失败</span><br></pre></td></tr></table></figure>
<h3 id="删除文档"><a href="#删除文档" class="headerlink" title="删除文档"></a>删除文档</h3><p>MongoDB 中使用 <code>remove()</code> 函数是用来移除集合中的数据。在执行 <code>remove()</code> 函数前先执行 <code>find()</code> 命令来判断执行的条件是否正确，这是一个比较好的习惯。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 语法</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.collection.remove(</span></span><br><span class="line">   &lt;query&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">     justOne: &lt;boolean&gt;,</span><br><span class="line">     writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// 删除所有文档</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.remove(&#123;&#125;)</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>query :（可选）删除的文档的条件。</p>
</li>
<li><p>justOne : （可选）如果设为 true 或 1，则只删除一个文档，如果不设置该参数，或使用默认值 false，则删除所有匹配条件的文档。</p>
</li>
<li><p>writeConcern :（可选）抛出异常的级别。</p>
</li>
</ul>
<hr>
<h2 id="MongoDB-改"><a href="#MongoDB-改" class="headerlink" title="MongoDB 改"></a>MongoDB 改</h2><p>MongoDB 使用 update() 和 save() 方法来更新集合中的文档。</p>
<h3 id="update"><a href="#update" class="headerlink" title="update()"></a>update()</h3><p>update() 方法用于更新已存在的文档。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 语法</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.collection.update(</span></span><br><span class="line">   &lt;query&gt;,</span><br><span class="line">   &lt;update&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">        upsert: &lt;boolean&gt;,</span><br><span class="line">        multi: &lt;boolean&gt;,</span><br><span class="line">        writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>query : update的查询条件，类似sql update查询内where后面的。</p>
</li>
<li><p>update : update的对象和一些更新的操作符（如$,$inc…）等，也可以理解为sql update查询内set后面的</p>
</li>
<li><p>upsert : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。</p>
</li>
<li><p>multi : 可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。</p>
</li>
<li><p>writeConcern :可选，抛出异常的级别。</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 插入数据</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.insert(&#123;title: 123, by:<span class="string">'ai'</span>&#125;)</span></span><br><span class="line">WriteResult(&#123; "nInserted" : 1 &#125;)</span><br><span class="line"></span><br><span class="line">// 查询数据，在内存中存储时，键名都是字符串类型的</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.find()</span></span><br><span class="line">&#123; "_id" : ObjectId("5c8cd26fca4aff6ebfd76984"), "title" : 123, "by" : "ai" &#125;</span><br><span class="line"></span><br><span class="line">// 更新</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.col.update(&#123; <span class="string">'title'</span>: 123&#125;, &#123;<span class="variable">$set</span>: &#123;<span class="string">'by'</span>: <span class="string">'asdf'</span>&#125;&#125;)</span></span><br><span class="line">WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="save-方法"><a href="#save-方法" class="headerlink" title="save() 方法"></a>save() 方法</h3><font color="red">save方法有更新和插入两种功能，到底是插入还是更新文档取决于 <code>_id</code> 参数。如果能根据 <code>_id</code> 找到一个已经存在的文档，那么就更新。如果没有传入_id参数或者找不到存在的文档，那么就插入一个新文档。</font>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> db.collection.save(</span></span><br><span class="line">   &lt;document&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">     writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li>document : 文档数据。</li>
<li>writeConcern :可选，抛出异常的级别。</li>
</ul>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/15/数据库——MongoDB/" data-id="cjtl8ne1k002t4gutpk8eze5q" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-MongoDB" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/15/MongoDB/" class="article-date">
  <time datetime="2019-03-15T09:27:29.000Z" itemprop="datePublished">2019-03-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/15/MongoDB/">MongoDB</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/15/MongoDB/" data-id="cjtl8ndfl000c4gutuzochfr0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-后端基础——GET和POST" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/13/后端基础——GET和POST/" class="article-date">
  <time datetime="2019-03-13T07:58:46.000Z" itemprop="datePublished">2019-03-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/13/后端基础——GET和POST/">后端基础——GET和POST</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#前言">前言</a></li>
<li><a href="#网络通信">网络通信</a></li>
<li><a href="#get-和-post-本质">GET 和 POST 本质</a></li>
<li><a href="#get-和-post-表象区别">GET 和 POST 表象区别</a></li>
<li><a href="#get">GET</a></li>
<li><a href="#post">POST</a></li>
</ul>
<!-- /TOC -->
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>关于这一部分，面试考点。</p>
<p>参考内容：</p>
<p><a href="http://www.cnblogs.com/logsharing/p/8448446.html" target="_blank" rel="noopener">http://www.cnblogs.com/logsharing/p/8448446.html</a></p>
<p><a href="https://baijiahao.baidu.com/s?id=1620934682611653374&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">https://baijiahao.baidu.com/s?id=1620934682611653374&amp;wfr=spider&amp;for=pc</a></p>
<hr>
<h2 id="网络通信"><a href="#网络通信" class="headerlink" title="网络通信"></a>网络通信</h2><hr>
<h2 id="GET-和-POST-本质"><a href="#GET-和-POST-本质" class="headerlink" title="GET 和 POST 本质"></a>GET 和 POST 本质</h2><p>GET和POST是什么？HTTP协议中的两种发送请求的方法。</p>
<p>HTTP是什么？HTTP是基于TCP/IP的关于数据如何在万维网中如何通信的协议。</p>
<p>HTTP的底层是TCP/IP。所以GET和POST的底层也是TCP/IP，也就是说，GET/POST都是TCP链接。GET和POST能做的事情是一样一样的。你要给GET加上request body，给POST带上url参数，技术上是完全行的通的。</p>
<hr>
<h2 id="GET-和-POST-表象区别"><a href="#GET-和-POST-表象区别" class="headerlink" title="GET 和 POST 表象区别"></a>GET 和 POST 表象区别</h2><ul>
<li><p>GET在浏览器回退时是无害的，而POST会再次提交请求。</p>
</li>
<li><p>GET产生的URL地址可以被Bookmark，而POST不可以。</p>
</li>
<li><p>GET请求会被浏览器主动cache，而POST不会，除非手动设置。</p>
</li>
<li><p>GET请求只能进行url编码，而POST支持多种编码方式。</p>
</li>
<li><p>GET请求参数会被完整保留在浏览器历史记录里，而POST中的参数不会被保留。</p>
</li>
<li><p>GET请求在URL中传送的参数是有长度限制的，而POST么有。</p>
</li>
<li><p>对参数的数据类型，GET只接受ASCII字符，而POST没有限制。</p>
</li>
<li><p>GET比POST更不安全，因为参数直接暴露在URL上，所以不能用来传递敏感信息。</p>
</li>
<li><p>GET参数通过URL传递，POST放在Request body中。</p>
</li>
</ul>
<hr>
<h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><hr>
<h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/13/后端基础——GET和POST/" data-id="cjtl8ndgh001a4gutk544t7op" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-框架——Express" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/11/框架——Express/" class="article-date">
  <time datetime="2019-03-11T13:54:34.000Z" itemprop="datePublished">2019-03-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/11/框架——Express/">框架——Express</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#express-简介">Express 简介</a></li>
<li><a href="#express-安装及入门">Express 安装及入门</a></li>
<li><a href="#静态服务">静态服务</a><ul>
<li><a href="#相对路径">相对路径</a></li>
<li><a href="#绝对路径推荐使用">绝对路径（推荐使用）</a></li>
</ul>
</li>
<li><a href="#使用-express-art-template-模板引擎">使用 express-art-template 模板引擎</a><ul>
<li><a href="#安装">安装</a></li>
<li><a href="#在-express-中加载-express-art-template-模板">在 Express 中加载 express-art-template 模板</a></li>
<li><a href="#在-express-中使用模板引擎">在 Express 中使用模板引擎</a></li>
</ul>
</li>
<li><a href="#基本路由">基本路由</a><ul>
<li><a href="#get">GET</a></li>
<li><a href="#post">POST</a><ul>
<li><a href="#body-parser-安装">body-parser 安装</a></li>
<li><a href="#body-parser-配置">body-parser 配置</a></li>
<li><a href="#获取-post-数据">获取 POST 数据</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#重定向">重定向</a></li>
<li><a href="#中间件">中间件</a><ul>
<li><a href="#post-信息获取中间件body-parser">POST 信息获取中间件：body-parser</a></li>
<li><a href="#session-和-cookie-中间件express-session">Session 和 Cookie 中间件：express-session</a><ul>
<li><a href="#express-session-安装">express-session 安装</a></li>
<li><a href="#express-session-配置">express-session 配置</a></li>
<li><a href="#express-session-使用">express-session 使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#项目分析">项目分析</a><ul>
<li><a href="#清晰的文档">清晰的文档</a></li>
<li><a href="#路由设计">路由设计</a></li>
<li><a href="#项目结构分离">项目结构分离</a></li>
<li><a href="#代码规范">代码规范</a><ul>
<li><a href="#统一的代码风格">统一的代码风格</a></li>
<li><a href="#代码分离模块职责单一">代码分离，模块职责单一</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="Express-简介"><a href="#Express-简介" class="headerlink" title="Express 简介"></a>Express 简介</h2><p>原生的 http 在某些方面不足以应对我们的开发需求，框架的目的就是提高效率，让我们的代码更高度统一。</p>
<p>Express 是一个保持最小规模的灵活的 Node.js Web 应用程序开发框架，为 Web 和移动应用程序提供一组强大的功能。</p>
<p>官网：<a href="http://www.expressjs.com.cn/" target="_blank" rel="noopener">http://www.expressjs.com.cn/</a></p>
<h2 id="Express-安装及入门"><a href="#Express-安装及入门" class="headerlink" title="Express 安装及入门"></a>Express 安装及入门</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 新建项目文件夹并进入</span><br><span class="line">&gt; <span class="built_in">mkdir</span> express_demo</span><br><span class="line">&gt; <span class="built_in">cd</span> express_demo</span><br><span class="line"></span><br><span class="line">// 创建 package.json 文件</span><br><span class="line">&gt; npm init</span><br><span class="line"></span><br><span class="line">// 安装 Express，最好用cnpm</span><br><span class="line">&gt; npm install express --save</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建服务器应用程序，相当于原生 Node 的 var server =  http.createServer()</span></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8888</span></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'127.0.0.1'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当服务器收到 get 请求 / 的时候，执行回调函数，相当于原生 Node 中解析 get 请求的 request.url === '/'</span></span><br><span class="line">app.get(<span class="string">'/'</span>, (request, response) =&gt; &#123;</span><br><span class="line">  response.send(<span class="string">'hello express'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相当于 server.listen</span></span><br><span class="line">app.listen(port, hostname, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`服务器已启动，通过 http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/ 访问`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>通过这个案例我们大概可以看出来，Express 和原生的 Node 大致相同，但是可以将项目更清晰。</p>
<hr>
<h2 id="静态服务"><a href="#静态服务" class="headerlink" title="静态服务"></a>静态服务</h2><p>为了提供诸如图像、CSS 文件和 JavaScript 文件之类的静态文件，请使用 Express 中的 express.static 内置中间件函数。</p>
<h3 id="相对路径"><a href="#相对路径" class="headerlink" title="相对路径"></a>相对路径</h3><p>在文件操作中，使用相对路径是不可靠的，有时候会出现错误。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当前 js 文件与公共目录同级</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 公开 public 目录</span></span><br><span class="line"><span class="comment">// 通过127.0.0.1:8888/img/1.jpg 路径 public/img 目录下的 1.jpg 图片资源</span></span><br><span class="line">app.use(express.static(<span class="string">'public'</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 公开 public 目录，并通过虚拟路径 '/public' 前缀访问，</span></span><br><span class="line"><span class="comment">// 127.0.0.1:8888/public/img/1.jpg 路径 public/img 目录下的 1.jpg 图片资源</span></span><br><span class="line">app.use(<span class="string">'/public'</span>, express.static(<span class="string">'public'</span>))</span><br></pre></td></tr></table></figure>
<h3 id="绝对路径（推荐使用）"><a href="#绝对路径（推荐使用）" class="headerlink" title="绝对路径（推荐使用）"></a>绝对路径（推荐使用）</h3><ul>
<li><p><code>__dirname</code> ：动态获取当前文件模块所属目录的绝对路径。</p>
</li>
<li><p><code>__filename</code> ：动态获取当前文件的绝对路径。</p>
</li>
<li><p><code>path.join()</code> ： 辅助拼接路径，避免多、少、正反斜杠导致的路径问题。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 路径操作模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">'/static'</span>, express.static(path.join(__dirname, <span class="string">'public'</span>)))</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="使用-express-art-template-模板引擎"><a href="#使用-express-art-template-模板引擎" class="headerlink" title="使用 express-art-template 模板引擎"></a>使用 express-art-template 模板引擎</h2><p>中文文档：<a href="https://aui.github.io/art-template/express/" target="_blank" rel="noopener">https://aui.github.io/art-template/express/</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><code>express-art-template</code> 模板引擎是依赖 <code>art-template</code> 的，所以在安装时需要安装<code>art-template</code>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save art-template</span><br><span class="line">npm install --save express-art-template</span><br></pre></td></tr></table></figure>
<h3 id="在-Express-中加载-express-art-template-模板"><a href="#在-Express-中加载-express-art-template-模板" class="headerlink" title="在 Express 中加载 express-art-template 模板"></a>在 Express 中加载 express-art-template 模板</h3><p>加载 <code>express-art-template</code> 模板方法与加载其他的模块略有不同，在 <code>require</code> 之后还需要配置需要渲染的文件，在官方案例中是使用 <code>art</code> 后缀的文件，但是这种文件编辑时没有语法高亮，我们可以使用 <code>.html</code> 后缀的前端文件来进行渲染。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置使用 art-template 模板引擎，</span></span><br><span class="line"><span class="comment">// 第一个参数：当渲染以该后缀的文件时，使用 art-template 模板引擎</span></span><br><span class="line">app.engine(<span class="string">'html'</span>, <span class="built_in">require</span>(<span class="string">'express-art-template'</span>))</span><br></pre></td></tr></table></figure>
<h3 id="在-Express-中使用模板引擎"><a href="#在-Express-中使用模板引擎" class="headerlink" title="在 Express 中使用模板引擎"></a>在 Express 中使用模板引擎</h3><p><code>express</code> 默认所有的视图渲染存储目录(html文件之类)的路径为 <code>views</code>，需要注意。但是可以使用 <code>app.set()</code> 方法来修改默认的路径。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// node</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8888</span></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'127.0.0.1'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建服务器应用程序，相当于原生 Node 的 http.createServer</span></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置使用 art-template 模板引擎，</span></span><br><span class="line"><span class="comment">// 第一个参数：当渲染以该后缀的文件时，使用 art-template 模板引擎</span></span><br><span class="line">app.engine(<span class="string">'html'</span>, <span class="built_in">require</span>(<span class="string">'express-art-template'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果要修改 views 默认路径</span></span><br><span class="line">app.set(<span class="string">'views'</span>, <span class="string">'模板所在路径'</span>)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 将模板源代码编译成函数并立刻执行，默认是放在 views 目录下</span></span><br><span class="line">  res.render(<span class="string">'index.html'</span>, &#123;</span><br><span class="line">    title: <span class="string">'express模板测试'</span>,</span><br><span class="line">    content: <span class="string">'主页'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 相当于 server.listen</span></span><br><span class="line">app.listen(port, hostname, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`服务器已启动，通过 http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/ 访问`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html 渲染模板文件 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; content &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="基本路由"><a href="#基本路由" class="headerlink" title="基本路由"></a>基本路由</h2><h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><p>在 <code>express</code> 中，<code>GET</code> 方法已经非常方便了，不需要像原生的一样从服务器获取 <code>request</code> 然后获取 <code>request.url</code> 路径标识，之后再进行路由选择。在 <code>express</code> 中 <code>GET</code> 直接进行路由选择，效率大大提高。</p>
<p>同时，原生中使用 <code>response.end()</code> 或者 <code>response.write()</code> 响应页面，在 <code>express</code> 中使用 <code>response.send()</code> 响应页面。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">'/'</span>, (request, response) =&gt; &#123;</span><br><span class="line">    response.send()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><p>在 <code>express</code> 中没有内置获取表单 <code>POST</code> 请求体的API，这里我们需要一个 <code>express</code> 的第三方包 <code>body-parser</code>。</p>
<p><a href="http://www.expressjs.com.cn/en/resources/middleware/body-parser.html" target="_blank" rel="noopener">http://www.expressjs.com.cn/en/resources/middleware/body-parser.html</a></p>
<h4 id="body-parser-安装"><a href="#body-parser-安装" class="headerlink" title="body-parser 安装"></a>body-parser 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install body-parser</span><br></pre></td></tr></table></figure>
<h4 id="body-parser-配置"><a href="#body-parser-配置" class="headerlink" title="body-parser 配置"></a>body-parser 配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="comment">// 引包</span></span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 body-parser</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line">app.use(bodyParser.json())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载路由</span></span><br><span class="line">app.use(router)</span><br></pre></td></tr></table></figure>
<h4 id="获取-POST-数据"><a href="#获取-POST-数据" class="headerlink" title="获取 POST 数据"></a>获取 POST 数据</h4><p>配置完这个中间件之后，<code>request</code> 中会多出一个 <code>body</code> 属性，通过 <code>body</code> 属性就能获取 <code>post</code> 请求数据了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简单使用，打印出这个 post 数据</span></span><br><span class="line">app.use(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">  response.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>)</span><br><span class="line">  response.write(<span class="string">'you posted;\n'</span>)</span><br><span class="line">  <span class="comment">// post 数据在 request.body 中，将其转为 JSON 数据并打印出来。</span></span><br><span class="line">  response.end(<span class="built_in">JSON</span>.stringify(request.body, <span class="literal">null</span>, <span class="number">2</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><p>服务端重定向：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">'/'</span>, (request, response) =&gt; &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// 重定向，不需要再管 statusCode 和 Location 值类的了，只需要使用这个方法传入目的地址即可。</span></span><br><span class="line">  res.redirect(<span class="string">'/'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h2><p>所有的中间件都需要下载安装、引包、在路由之前配置。</p>
<p>中间件本身是一个方法，有三个参数：</p>
<ul>
<li><p>request：请求对象。</p>
</li>
<li><p>response：响应对象。</p>
</li>
<li><p>next()：执行之后第一个可用中间件的方法。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不关心请求路径和方法的中间件</span></span><br><span class="line"><span class="comment">// 任何请求都会进入这个中间件</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'中间件1'</span>)</span><br><span class="line">  <span class="comment">// 进入下一个中间件</span></span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只匹配指定请求路径开头才执行的中间件</span></span><br><span class="line">app.use(<span class="string">'/a'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'中间件2'</span>)</span><br><span class="line">  <span class="comment">// 进入下一个中间件</span></span><br><span class="line">  next()</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 如果在此结束，只需要给res放回数据就行</span></span><br><span class="line">  <span class="comment">// res.send()</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配指定请求路径和方法的中间件</span></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="POST-信息获取中间件：body-parser"><a href="#POST-信息获取中间件：body-parser" class="headerlink" title="POST 信息获取中间件：body-parser"></a>POST 信息获取中间件：body-parser</h3><p>见基本路由中的 <code>POST</code></p>
<h3 id="Session-和-Cookie-中间件：express-session"><a href="#Session-和-Cookie-中间件：express-session" class="headerlink" title="Session 和 Cookie 中间件：express-session"></a>Session 和 Cookie 中间件：express-session</h3><p>express 文档：<a href="http://www.expressjs.com.cn/en/resources/middleware/session.html" target="_blank" rel="noopener">http://www.expressjs.com.cn/en/resources/middleware/session.html</a></p>
<h4 id="express-session-安装"><a href="#express-session-安装" class="headerlink" title="express-session 安装"></a>express-session 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express-session -S</span><br></pre></td></tr></table></figure>
<h4 id="express-session-配置"><a href="#express-session-配置" class="headerlink" title="express-session 配置"></a>express-session 配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="comment">// 引包</span></span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">'express-session'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 session</span></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  <span class="comment">// 自定义的二次加密字符串</span></span><br><span class="line">  secret: <span class="string">'keyboard cat'</span>,</span><br><span class="line">  resave: <span class="literal">false</span>,</span><br><span class="line">  saveUninitialized: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载路由</span></span><br><span class="line">app.use(router)</span><br></pre></td></tr></table></figure>
<h4 id="express-session-使用"><a href="#express-session-使用" class="headerlink" title="express-session 使用"></a>express-session 使用</h4><p><code>session</code> 参数都存在 <code>request</code> 中，只要通过 <code>request.session.xxx</code> 就能进行 <code>session</code> 信息的存取操作了。</p>
<p>如下页面，先进行注册并自动登录，<code>req</code> 存储登录状态；然后跳转到首页，<code>req</code> 获取到登录状态，进行进一步的处理，保持页面处于登录状态。</p>
<p>但是注意，这种做法的 <code>session</code> 默认是存储在服务器的内存中的，也就是说只要服务器已关闭，所有 <code>session</code> 都会被清除，所以有时候需要进行永久化存储。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js 路由独立页面</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首页</span></span><br><span class="line">router.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.session.user)    <span class="comment">// userObject</span></span><br><span class="line">  <span class="comment">// 将用户对象传入渲染页面</span></span><br><span class="line">  res.render(<span class="string">'index.html'</span>, &#123;</span><br><span class="line">    user: req.session.user</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册页面处理</span></span><br><span class="line">router.post(<span class="string">'/register'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  ……</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 注册成功，保存 session</span></span><br><span class="line">  req.session.user = userObject</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="项目分析"><a href="#项目分析" class="headerlink" title="项目分析"></a>项目分析</h2><p>在项目中，不会使用原生的 <code>Node</code> 进行开发。</p>
<h3 id="清晰的文档"><a href="#清晰的文档" class="headerlink" title="清晰的文档"></a>清晰的文档</h3><p>无论如何，开发项目必须写详细的项目文档。</p>
<h3 id="路由设计"><a href="#路由设计" class="headerlink" title="路由设计"></a>路由设计</h3><p>在 WEB 开发中，很关键的一步就是路由设计，清楚的路由设计是大型项目的保证。</p>
<p>如下，为一个只涉及学生信息增删改查的小项目的路由设计，需要写明请求方法、路径、参数和页面功能备注等：</p>
<table>
<thead>
<tr>
<th>请求方法</th>
<th>请求路径</th>
<th>get参数</th>
<th>post 参数</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/students</td>
<td>—</td>
<td>—</td>
<td>渲染首页</td>
</tr>
<tr>
<td>GET</td>
<td>/students/new</td>
<td>—</td>
<td>—</td>
<td>渲染添加学生页面</td>
</tr>
<tr>
<td>POST</td>
<td>/students</td>
<td>—</td>
<td>nameage/gender/hobbies</td>
<td>处理添加学生请求</td>
</tr>
<tr>
<td>GET</td>
<td>/students/edit</td>
<td>id</td>
<td>—</td>
<td>渲染编辑页面</td>
</tr>
<tr>
<td>POST</td>
<td>/students/edit</td>
<td>—</td>
<td>id/name/age/gender/hobbies</td>
<td>处理编辑请求</td>
</tr>
<tr>
<td>GET</td>
<td>/students/delete</td>
<td>id</td>
<td>name/age/gender/hobbies</td>
<td>处理删除请求</td>
</tr>
</tbody>
</table>
<h3 id="项目结构分离"><a href="#项目结构分离" class="headerlink" title="项目结构分离"></a>项目结构分离</h3><p>静态页面和公共资源目录分离</p>
<h3 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h3><h4 id="统一的代码风格"><a href="#统一的代码风格" class="headerlink" title="统一的代码风格"></a>统一的代码风格</h4><p>代码风格不统一会让维护和团队开发比较困难。</p>
<h4 id="代码分离，模块职责单一"><a href="#代码分离，模块职责单一" class="headerlink" title="代码分离，模块职责单一"></a>代码分离，模块职责单一</h4><p>在开发中，会将代码细化，使其功能分离。代码分离会让项目结构更加清晰，便于开发和维护。</p>
<p>在 <code>node</code> 开发中，入口模块 <code>index.js</code> 中只负责创建服务、做服务相关配置、挂载路由、监听端口等功能。至于具体的每个部分的代码将其细化到各个专门的文件中，这样方便大型项目后期开发，让项目更加清晰。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * index.js 入门模块</span></span><br><span class="line"><span class="comment"> * 职责：</span></span><br><span class="line"><span class="comment"> *  创建服务</span></span><br><span class="line"><span class="comment"> *  做服务相关配置</span></span><br><span class="line"><span class="comment"> *      模板引擎</span></span><br><span class="line"><span class="comment"> *      body-parser 解析表单 post 请求体</span></span><br><span class="line"><span class="comment"> *      提供静态资源服务</span></span><br><span class="line"><span class="comment"> *  挂载路由</span></span><br><span class="line"><span class="comment"> *  监听端口启动服务</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入模块</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">'./router'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 端口号及服务器地址</span></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8888</span></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'127.0.0.1'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载模板引擎</span></span><br><span class="line">app.engine(<span class="string">'html'</span>, <span class="built_in">require</span>(<span class="string">'express-art-template'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开放公共空间</span></span><br><span class="line">app.use(<span class="string">'/public/'</span>, express.static(path.join(__dirname, <span class="string">'public'</span>)))</span><br><span class="line">app.use(<span class="string">'/node_modules/'</span>, express.static(path.join(__dirname, <span class="string">'node_modules'</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置模版文件夹的路径</span></span><br><span class="line">app.set(<span class="string">'views'</span>, path.join(__dirname, <span class="string">'views'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把路由容器挂载到 app 服务中</span></span><br><span class="line">app.use(router)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 端口监听</span></span><br><span class="line">app.listen(port, hostname, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`服务器已启动，通过 http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/ 访问`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * router.js 路由模块</span></span><br><span class="line"><span class="comment"> * 职责：</span></span><br><span class="line"><span class="comment"> *  处理路由</span></span><br><span class="line"><span class="comment"> *  根据不同的请求方法和请求路径设置具体的请求处理函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 引入数据操作模块</span></span><br><span class="line"><span class="keyword">var</span> db = <span class="built_in">require</span>(<span class="string">'./db'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 引入 express ，专门用来包装路由的</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 创建一个路由容器</span></span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 把路由挂载到 router 路由容器中</span></span><br><span class="line">router.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.rander(<span class="string">'index.html'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.post(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载异步数据渲染模板</span></span><br><span class="line">router.get(<span class="string">'/xxx'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  db.find(<span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.status(<span class="number">500</span>).send(<span class="string">'Server error.'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 从文件中读取到的数据一定是字符串，所以需要手动转成对象</span></span><br><span class="line">    <span class="keyword">var</span> labels = data.labels</span><br><span class="line">    <span class="keyword">var</span> students = data.students</span><br><span class="line"></span><br><span class="line">    res.render(<span class="string">'index.html'</span>, &#123;</span><br><span class="line">      labels: labels,</span><br><span class="line">      students: students</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 把 router 导出</span></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 封装异步 API</span></span><br><span class="line"><span class="comment"> * 在获取异步操作中的内容时，需要通过回调函数来获取其中的内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * db.js 数据操作文件模块</span></span><br><span class="line"><span class="comment"> * 职责：</span></span><br><span class="line"><span class="comment"> *  操作文件中的数据，只处理数据，不关心业务</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dbPath = <span class="string">'./db.json'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用回调函数返回异步操作结果</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询数据</span></span><br><span class="line"><span class="comment"> * callback 中的参数</span></span><br><span class="line"><span class="comment"> *      第一个参数是 err</span></span><br><span class="line"><span class="comment"> *          成功是 null</span></span><br><span class="line"><span class="comment"> *          错误是 err对象</span></span><br><span class="line"><span class="comment"> *      第二个参数是 数据解析结果</span></span><br><span class="line"><span class="comment"> *          成功是 数组</span></span><br><span class="line"><span class="comment"> *          错误是 underfinded</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exports.find = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">  fs.readFile(dbPath, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(err)</span><br><span class="line">    &#125;</span><br><span class="line">    callback(<span class="literal">null</span>, <span class="built_in">JSON</span>.parse(data))</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 增添数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exports.insert = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 更新数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exports.update = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exports.delete = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/11/框架——Express/" data-id="cjtl8ne1m002v4gutuxugkhtf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node/">Node</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/框架/">框架</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-软件配置" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/10/软件配置/" class="article-date">
  <time datetime="2019-03-10T06:38:45.000Z" itemprop="datePublished">2019-03-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/10/软件配置/">软件配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#visual-sudio-code">Visual Sudio Code</a><ul>
<li><a href="#markdown-文件">MarkDown 文件</a><ul>
<li><a href="#markdown-toc-文件目录插件">Markdown TOC 文件目录插件</a></li>
<li><a href="#paste-image-贴图插件">Paste Image 贴图插件</a></li>
<li><a href="#markdown-preview-enhanced-多功能插件">Markdown Preview Enhanced 多功能插件</a></li>
<li><a href="#实时预览">实时预览</a></li>
</ul>
</li>
<li><a href="#javascript-文件">JavaScript 文件</a><ul>
<li><a href="#standardjs---javascript-standard-style-代码标准化插件">StandardJS - JavaScript Standard Style 代码标准化插件</a></li>
</ul>
</li>
<li><a href="#json-文件">JSON 文件</a><ul>
<li><a href="#json-tools-格式化插件">JSON Tools 格式化插件</a></li>
</ul>
</li>
<li><a href="#html">HTML</a><ul>
<li><a href="#bootstrap-34-snippets">Bootstrap 3/4 Snippets</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h1 id="Visual-Sudio-Code"><a href="#Visual-Sudio-Code" class="headerlink" title="Visual Sudio Code"></a>Visual Sudio Code</h1><h2 id="MarkDown-文件"><a href="#MarkDown-文件" class="headerlink" title="MarkDown 文件"></a>MarkDown 文件</h2><h3 id="Markdown-TOC-文件目录插件"><a href="#Markdown-TOC-文件目录插件" class="headerlink" title="Markdown TOC 文件目录插件"></a>Markdown TOC 文件目录插件</h3><p><img src="/2019/03/10/软件配置/MarkdownTOC.jpg" alt="MarkdownTOC.jpg"></p>
<p>此插件用于自动生成章节目录，使用了之后，会自动生成目录，并动态更新，且有超链接效果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- TOC --&gt;</span><br><span class="line">    目录结构</span><br><span class="line">&lt;!-- /TOC --&gt;</span><br></pre></td></tr></table></figure>
<p>在 markdown 文件中，右键，弹出如下内容：</p>
<p><img src="/2019/03/10/软件配置/MarkdownTOCShow.jpg" alt="MarkdownTOCShow.jpg"></p>
<ul>
<li>Markdown Sections: 在章节头部中添加深度</li>
<li>Markdown TOC：生成章节目录</li>
</ul>
<hr>
<h3 id="Paste-Image-贴图插件"><a href="#Paste-Image-贴图插件" class="headerlink" title="Paste Image 贴图插件"></a>Paste Image 贴图插件</h3><p>自动保存截图面板中的图片到当前目录。</p>
<hr>
<h3 id="Markdown-Preview-Enhanced-多功能插件"><a href="#Markdown-Preview-Enhanced-多功能插件" class="headerlink" title="Markdown Preview Enhanced 多功能插件"></a>Markdown Preview Enhanced 多功能插件</h3><p>超级强大的 Markdown 插件。可惜贴图功能不适用于vsCode。</p>
<p>详细功能见文档：<a href="https://shd101wyy.github.io/markdown-preview-enhanced/#/zh-cn/" target="_blank" rel="noopener">https://shd101wyy.github.io/markdown-preview-enhanced/#/zh-cn/</a></p>
<hr>
<h3 id="实时预览"><a href="#实时预览" class="headerlink" title="实时预览"></a>实时预览</h3><p><code>vsCode</code> 自带插件。</p>
<p>快捷键：<code>CTRL + SHIFT + M</code> 打开侧边预览功能。</p>
<hr>
<h2 id="JavaScript-文件"><a href="#JavaScript-文件" class="headerlink" title="JavaScript 文件"></a>JavaScript 文件</h2><h3 id="StandardJS-JavaScript-Standard-Style-代码标准化插件"><a href="#StandardJS-JavaScript-Standard-Style-代码标准化插件" class="headerlink" title="StandardJS - JavaScript Standard Style 代码标准化插件"></a>StandardJS - JavaScript Standard Style 代码标准化插件</h3><p>将 <code>JavaScript</code> 标准样式集成到 <code>VS</code> 代码中。编写 <code>JS</code> 代码时，会自动校验代码，并提示不符合 <code>JS</code> 代码规范的地方，当保存时，会自动修改为规范代码。</p>
<hr>
<h2 id="JSON-文件"><a href="#JSON-文件" class="headerlink" title="JSON 文件"></a>JSON 文件</h2><h3 id="JSON-Tools-格式化插件"><a href="#JSON-Tools-格式化插件" class="headerlink" title="JSON Tools 格式化插件"></a>JSON Tools 格式化插件</h3><p>次插件用于帮助 <code>vsCode</code> 格式化 <code>JSON</code> 文件。</p>
<p>安装之后 <code>CTRL + SHIFT + P</code> 搜索 <code>json</code> ，会看到 <code>JSON Tools</code> 的两个功能。</p>
<p><img src="/2019/03/10/软件配置/JSONTools.jpg" alt="JSONTools.jpg"></p>
<ul>
<li><p>JSON Tools: Pretty JSON       // 格式化 JSON ，展开 JSON 字符串</p>
</li>
<li><p>JSON Tools: Minify JSON       // 格式化 JSON ，收缩 JSON 字符串</p>
</li>
</ul>
<hr>
<h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><h3 id="Bootstrap-3-4-Snippets"><a href="#Bootstrap-3-4-Snippets" class="headerlink" title="Bootstrap 3/4 Snippets"></a>Bootstrap 3/4 Snippets</h3><p><code>Bootstrap 3 Snippets</code> 和 <code>Bootstrap 4 Snippets</code> 用来给 <code>HTML</code> 项目快速创建 <code>Bootstrap</code> 内容元素。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/10/软件配置/" data-id="cjtl8ndgt001h4gutez0toh11" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/软件配置/">软件配置</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BOM/">BOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DOM/">DOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EcamScript6/">EcamScript6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Html-Css/">Html/Css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/">Node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/echarts/">echarts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后端/">后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/框架/">框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板引擎/">模板引擎</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器兼容/">浏览器兼容</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动端/">移动端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件配置/">软件配置</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 18.75px;">Android</a> <a href="/tags/BOM/" style="font-size: 10px;">BOM</a> <a href="/tags/DOM/" style="font-size: 10px;">DOM</a> <a href="/tags/EcamScript6/" style="font-size: 10px;">EcamScript6</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Html-Css/" style="font-size: 11.25px;">Html/Css</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/Node/" style="font-size: 12.5px;">Node</a> <a href="/tags/Python/" style="font-size: 16.25px;">Python</a> <a href="/tags/blog/" style="font-size: 11.25px;">blog</a> <a href="/tags/echarts/" style="font-size: 10px;">echarts</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/tool/" style="font-size: 10px;">tool</a> <a href="/tags/前端/" style="font-size: 17.5px;">前端</a> <a href="/tags/后端/" style="font-size: 13.75px;">后端</a> <a href="/tags/小程序/" style="font-size: 10px;">小程序</a> <a href="/tags/数据库/" style="font-size: 11.25px;">数据库</a> <a href="/tags/框架/" style="font-size: 12.5px;">框架</a> <a href="/tags/模板引擎/" style="font-size: 10px;">模板引擎</a> <a href="/tags/浏览器兼容/" style="font-size: 10px;">浏览器兼容</a> <a href="/tags/移动端/" style="font-size: 20px;">移动端</a> <a href="/tags/软件配置/" style="font-size: 10px;">软件配置</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/03/23/框架——Vuejs/">框架——Vue.js</a>
          </li>
        
          <li>
            <a href="/2019/03/20/模板引擎——art-template/">模板引擎——art-template</a>
          </li>
        
          <li>
            <a href="/2019/03/19/后端基础——npm常见包/">后端基础——npm常见包</a>
          </li>
        
          <li>
            <a href="/2019/03/18/前端-JavaScript基础-EcamScript6/">前端-JavaScript基础-EcamScript6</a>
          </li>
        
          <li>
            <a href="/2019/03/15/数据库——MySQL/">数据库——MySQL</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Ai Junhao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>