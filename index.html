<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hello, I&#39;m Junhao Ai.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hello, I&#39;m Junhao Ai.">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hello, I&#39;m Junhao Ai.">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hello, I&#39;m Junhao Ai.">
  
    <link rel="alternate" href="/atom.xml" title="Hello, I&#39;m Junhao Ai." type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hello, I&#39;m Junhao Ai.</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-前端-CSS预处理器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/12/前端-CSS预处理器/" class="article-date">
  <time datetime="2019-07-12T11:43:32.000Z" itemprop="datePublished">2019-07-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/12/前端-CSS预处理器/">前端-CSS预处理器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#css-预处理器">CSS 预处理器</a></li>
<li><a href="#less">Less</a><ul>
<li><a href="#安装">安装</a></li>
<li><a href="#使用">使用</a><ul>
<li><a href="#浏览器端">浏览器端</a></li>
</ul>
</li>
<li><a href="#案例">案例</a></li>
<li><a href="#注释">注释</a></li>
<li><a href="#嵌套规则">嵌套规则</a><ul>
<li><a href="#后代元素选择器">后代元素选择器</a></li>
<li><a href="#父级引用">父级引用</a></li>
</ul>
</li>
<li><a href="#变量">变量</a><ul>
<li><a href="#变量拼接属性">变量拼接属性</a></li>
<li><a href="#变量拼接属性名和选择器名不推荐使用">变量拼接属性名和选择器名（不推荐使用）</a></li>
<li><a href="#变量拼接-urls-和-import">变量拼接 URLs 和 Import</a></li>
<li><a href="#变量拼接变量">变量拼接变量</a></li>
<li><a href="#懒加载">懒加载</a></li>
</ul>
</li>
<li><a href="#mixin-混合">Mixin 混合</a><ul>
<li><a href="#带输出的混合">带输出的混合</a></li>
<li><a href="#不带输出的混合">不带输出的混合</a></li>
</ul>
</li>
<li><a href="#继承">继承</a><ul>
<li><a href="#一般继承">一般继承</a></li>
<li><a href="#继承子类">继承子类</a></li>
<li><a href="#多继承">多继承</a></li>
</ul>
</li>
<li><a href="#避免编译">避免编译</a></li>
</ul>
</li>
<li><a href="#stylus">Stylus</a><ul>
<li><a href="#安装-1">安装</a></li>
<li><a href="#使用-1">使用</a><ul>
<li><a href="#浏览器端-1">浏览器端</a></li>
</ul>
</li>
<li><a href="#案例-1">案例</a></li>
<li><a href="#规则">规则</a><ul>
<li><a href="#缩进后代元素选择器">缩进/后代元素选择器</a></li>
<li><a href="#空格">空格</a></li>
<li><a href="#选择器">选择器</a></li>
<li><a href="#父级引用-1">父级引用</a></li>
</ul>
</li>
<li><a href="#变量-1">变量</a></li>
<li><a href="#mixin-混合-1">Mixin 混合</a></li>
<li><a href="#方法">方法</a></li>
<li><a href="#继承-1">继承</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="CSS-预处理器"><a href="#CSS-预处理器" class="headerlink" title="CSS 预处理器"></a>CSS 预处理器</h2><p><code>CSS预处理器</code> 定义了一种新的语言，其基本思想是，用一种专门的编程语言，为 <code>CSS</code> 增加了一些编程的特性，将 <code>CSS</code> 作为目标生成文件，然后开发者就只要使用这种语言进行编码工作。</p>
<p>通俗的说，<code>CSS</code> 预处理器用一种专门的编程语言，进行 <code>Web</code> 页面样式设计，然后再编译成正常的 <code>CSS</code> 文件，以供项目使用。<code>CSS</code> 预处理器为CSS增加一些编程的特性，无需考虑浏览器的兼容性问题，例如你可以在 <code>CSS</code> 中使用变量、简单的逻辑程序、函数等等在编程语言中的一些基本特性，可以让你的 <code>CSS</code> 更加简洁、适应性更强、可读性更佳，更易于代码的维护等诸多好处。</p>
<p><code>CSS</code> 预处理器种类繁多，但是主流的是 <code>Less</code> 、<code>Sass</code> 、<code>Stylus</code> 。</p>
<h2 id="Less"><a href="#Less" class="headerlink" title="Less"></a>Less</h2><p><img src="/2019/07/12/前端-CSS预处理器/less.png" alt=""></p>
<p>中文网：<a href="http://lesscss.cn/Less" target="_blank" rel="noopener">http://lesscss.cn/Less</a> </p>
<p>是一门 <code>CSS</code> 预处理语言，它扩展了 <code>CSS</code> 语言，增加了变量、<code>Mixin</code>、函数等特性，使 <code>CSS</code> 更易维护和扩展。</p>
<p><code>Less</code> 可以运行在 <code>Node</code>  或浏览器端。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 全局安装 less</span><br><span class="line"><span class="meta">$</span> npm i -g less</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 最小化 css 插件</span><br><span class="line"><span class="meta">$</span> npm i -g less-plugin-clean-css</span><br></pre></td></tr></table></figure>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>如果是在 <code>Vue</code> 、<code>Node</code> 之类的环境下，需要额外配置。</p>
<p><code>Less</code> 文件是以 <code>.less</code> 为后缀的文件，经过编译之后变成 <code>.css</code> 后缀的文件。使用时只需在项目中直接使用 <code>.css</code> 文件即可 。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> lessc -h</span><br><span class="line">usage: lessc [option option=parameter ...] &lt;source&gt; [destination]</span><br><span class="line"></span><br><span class="line">If source is set to `-' (dash or hyphen-minus), input is read from stdin.</span><br><span class="line"></span><br><span class="line">options:</span><br><span class="line">  -h, --help                   Prints help (this message) and exit.</span><br><span class="line">  --include-path=PATHS         Sets include paths. Separated by `:'. `;' also supported on windows.</span><br><span class="line">  -M, --depends                Outputs a makefile import dependency list to stdout.</span><br><span class="line">  --no-color                   Disables colorized output.</span><br><span class="line">  --ie-compat                  Enables IE8 compatibility checks.</span><br><span class="line">  --js                         Enables inline JavaScript in less files</span><br><span class="line">  -l, --lint                   Syntax check only (lint).</span><br><span class="line">  -s, --silent                 Suppresses output of error messages.</span><br><span class="line">  --strict-imports             Forces evaluation of imports.</span><br><span class="line">  --insecure                   Allows imports from insecure https hosts.</span><br><span class="line">  -v, --version                Prints version number and exit.</span><br><span class="line">  --verbose                    Be verbose.</span><br><span class="line">  --source-map[=FILENAME]      Outputs a v3 sourcemap to the filename (or output filename.map).</span><br><span class="line">  --source-map-rootpath=X      Adds this path onto the sourcemap filename and less file paths.</span><br><span class="line">  --source-map-basepath=X      Sets sourcemap base path, defaults to current working directory.</span><br><span class="line">  --source-map-include-source  Puts the less files into the map instead of referencing them.</span><br><span class="line">  --source-map-inline          Puts the map (and any less files) as a base64 data uri into the output css file.</span><br><span class="line">  --source-map-url=URL         Sets a custom URL to map file, for sourceMappingURL comment</span><br><span class="line">                               in generated CSS file.</span><br><span class="line">  -rp, --rootpath=URL          Sets rootpath for url rewriting in relative imports and urls</span><br><span class="line">                               Works with or without the relative-urls option.</span><br><span class="line">  -ru=, --rewrite-urls=        Rewrites URLs to make them relative to the base less file.</span><br><span class="line">    all|local|off              'all' rewrites all URLs, 'local' just those starting with a '.'</span><br><span class="line"></span><br><span class="line">  -m=, --math=</span><br><span class="line">     always                    Less will eagerly perform math operations always.</span><br><span class="line">     parens-division           Math performed except for division (/) operator</span><br><span class="line">     parens | strict           Math only performed inside parentheses</span><br><span class="line">     strict-legacy             Parens required in very strict terms (legacy --strict-math)</span><br><span class="line"></span><br><span class="line">  -su=on|off                   Allows mixed units, e.g. 1px+1em or 1px*1px which have units</span><br><span class="line">  --strict-units=on|off        that cannot be represented.</span><br><span class="line">  --global-var='VAR=VALUE'     Defines a variable that can be referenced by the file.</span><br><span class="line">  --modify-var='VAR=VALUE'     Modifies a variable already declared in the file.</span><br><span class="line">  --url-args='QUERYSTRING'     Adds params into url tokens (e.g. 42, cb=42 or 'a=1&amp;b=2')</span><br><span class="line">  --plugin=PLUGIN=OPTIONS      Loads a plugin. You can also omit the --plugin= if the plugin begins</span><br><span class="line">                               less-plugin. E.g. the clean css plugin is called less-plugin-clean-css</span><br><span class="line">                               once installed (npm install less-plugin-clean-css), use either with</span><br><span class="line">                               --plugin=less-plugin-clean-css or just --clean-css</span><br><span class="line">                               specify options afterwards e.g. --plugin=less-plugin-clean-css="advanced"</span><br><span class="line">                               or --clean-css="advanced"</span><br><span class="line"></span><br><span class="line">-------------------------- Deprecated ----------------</span><br><span class="line">  -sm=on|off               Legacy parens-only math. Use --math</span><br><span class="line">  --strict-math=on|off</span><br><span class="line"></span><br><span class="line">  --line-numbers=TYPE      Outputs filename and line numbers.</span><br><span class="line">                           TYPE can be either 'comments', which will output</span><br><span class="line">                           the debug info within comments, 'mediaquery'</span><br><span class="line">                           that will output the information within a fake</span><br><span class="line">                           media query which is compatible with the SASS</span><br><span class="line">                           format, and 'all' which will do both.</span><br><span class="line">  -x, --compress           Compresses output by removing some whitespaces.</span><br><span class="line">                           We recommend you use a dedicated minifer like less-plugin-clean-css</span><br><span class="line"></span><br><span class="line">Report bugs to: http://github.com/less/less.js/issues</span><br><span class="line">Home page: &lt;http://lesscss.org/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="浏览器端"><a href="#浏览器端" class="headerlink" title="浏览器端"></a>浏览器端</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 编译并生成 css 文件（带换行空格）</span><br><span class="line"><span class="meta">$</span> lessc style.less style.css</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 生成最小化 css 文件（不带换行空格），使用前需要安装插件</span><br><span class="line"><span class="meta">$</span> lessc --clean-css style.less style.min.css</span><br></pre></td></tr></table></figure>
<p>在 <code>less</code> 文件所在目录执行如上命令即可生成 <code>css</code> 文件，然后在 <code>html</code> 文件中导入样式表即可。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./style.css"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./style.css"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrap"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// style.less</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.inner</span>&#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">        <span class="attribute">background</span>: pink;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// style.css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p><code>//</code> 编译之后可见的注释</p>
<p><code>/**/</code> 编译之后不可见的注释</p>
<h3 id="嵌套规则"><a href="#嵌套规则" class="headerlink" title="嵌套规则"></a>嵌套规则</h3><p><code>less</code> 中的嵌套规则要与 <code>html</code> 中的嵌套规则相同，在编译时是根据代码所在位置进行嵌套编译的。</p>
<h4 id="后代元素选择器"><a href="#后代元素选择器" class="headerlink" title="后代元素选择器"></a>后代元素选择器</h4><p>后代元素选择器格式为 <code>父元素 + 空格 + 子元素</code> ，要编译成这样的代码，只需要将子元素代码嵌套到父元素的代码中即可。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">    <span class="selector-class">.inner</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="父级引用"><a href="#父级引用" class="headerlink" title="父级引用"></a>父级引用</h4><p>父级引用是将代码写在子级中，但是作用在父级的代码块。</p>
<p>如伪类，伪类格式为 <code>选择器:伪类名</code> ，要编译成这样的代码，需要将伪类代码嵌套到父元素的代码中，并在伪类名前加 <code>$</code> 。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">    <span class="selector-class">.inner</span> &#123;</span><br><span class="line">        <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">            <span class="attribute">background</span>: skyblue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: skyblue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>这里的变量实际就是一个常量，用来解决样式表中的多次使用相同内容，在编译后会将所有存在的变量都替换，<font color="red">所以变量可以在样式中任意拼接</font>。</p>
<h4 id="变量拼接属性"><a href="#变量拼接属性" class="headerlink" title="变量拼接属性"></a>变量拼接属性</h4><p>属性值使用变量时，直接用变量名（<code>@xxx</code>）即可。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="variable">@color:</span> pink;</span><br><span class="line"><span class="variable">@height:</span> <span class="number">100px</span>;</span><br><span class="line"><span class="variable">@width:</span> <span class="number">100px</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.inner</span> &#123;</span><br><span class="line">        <span class="attribute">@&#123;myMargin&#125;</span>: <span class="number">0</span> auto;</span><br><span class="line">        <span class="attribute">background</span>: <span class="variable">@color</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="variable">@height</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="variable">@width</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="变量拼接属性名和选择器名（不推荐使用）"><a href="#变量拼接属性名和选择器名（不推荐使用）" class="headerlink" title="变量拼接属性名和选择器名（不推荐使用）"></a>变量拼接属性名和选择器名（不推荐使用）</h4><p>属性名和选择器使用变量时，需要用 <code>@{xxx}</code> 的格式。</p>
<p>将属性名和选择器名作为变量的确可以用，但是因为编程习惯，一般不会去用，没人傻乎乎的去做这种费力不讨好的事儿。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性名</span></span><br><span class="line"><span class="variable">@myMargin:</span> margin;</span><br><span class="line"><span class="comment">// 部分属性名</span></span><br><span class="line"><span class="variable">@g:</span> ground;</span><br><span class="line"><span class="comment">// 选择器</span></span><br><span class="line"><span class="variable">@idSelect:</span> #wrap;</span><br><span class="line"><span class="variable">@classSelect:</span> .inner;</span><br><span class="line"></span><br><span class="line"><span class="variable">@&#123;idSelect&#125;</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">@&#123;myMargin&#125;</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@&#123;classSelect&#125;</span> &#123;</span><br><span class="line">        <span class="attribute">@&#123;myMargin&#125;</span>: <span class="number">0</span> auto;</span><br><span class="line">        <span class="comment">// 欠拍，容易被人打屎</span></span><br><span class="line">        <span class="selector-tag">back</span><span class="variable">@&#123;g&#125;</span>: <span class="selector-tag">pink</span>;</span><br><span class="line">        <span class="selector-tag">height</span>: <span class="selector-tag">100px</span>;</span><br><span class="line">        <span class="selector-tag">width</span>: <span class="selector-tag">100px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="变量拼接-URLs-和-Import"><a href="#变量拼接-URLs-和-Import" class="headerlink" title="变量拼接 URLs 和 Import"></a>变量拼接 URLs 和 Import</h4><p>地址字符串作为变量，用 <code>@{xxx}</code> 的格式，直接拼接在最终的地址字符串中。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="variable">@images:</span> <span class="string">"../img"</span>;</span><br><span class="line"><span class="variable">@themes:</span> <span class="string">"../../src/themes"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@import</span> <span class="string">"@&#123;themes&#125;/tidal-wave.less"</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#444</span>;</span><br><span class="line">  <span class="attribute">background</span>: url(<span class="string">"@&#123;images&#125;/white-sand.png"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="变量拼接变量"><a href="#变量拼接变量" class="headerlink" title="变量拼接变量"></a>变量拼接变量</h4><p>用变量拼接变量，用 <code>@xxx</code> 格式即可。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="variable">@fnord:</span>  <span class="string">"I am fnord."</span>;</span><br><span class="line"><span class="variable">@var:</span>    <span class="string">"fnord"</span>;</span><br><span class="line"><span class="attribute">content</span>: <span class="variable">@@var</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">content</span>: "<span class="selector-tag">I</span> <span class="selector-tag">am</span> <span class="selector-tag">fnord</span>.";</span><br></pre></td></tr></table></figure>
<h4 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h4><p>变量是延迟加载的，在使用之前不必声明。在加载时，变量的值是当前代码块的最后一次定义的值。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="variable">@var:</span> <span class="number">0</span>;</span><br><span class="line"><span class="selector-class">.class</span> &#123;</span><br><span class="line">  <span class="variable">@var:</span> <span class="number">1</span>;</span><br><span class="line">  <span class="selector-class">.brass</span> &#123;</span><br><span class="line">    <span class="variable">@var:</span> <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">three</span>: <span class="variable">@var</span>;	<span class="comment">// 3</span></span><br><span class="line">    <span class="variable">@var:</span> <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attribute">one</span>: <span class="variable">@var</span>;	<span class="comment">// 1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Mixin-混合"><a href="#Mixin-混合" class="headerlink" title="Mixin 混合"></a>Mixin 混合</h3><p><code>Mixin</code> 混合是将一系列属性从一个规则集引入到另一个规则集的方式，其作用是实现代码块的复用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 演示代码结构 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./style.css"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrap"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="带输出的混合"><a href="#带输出的混合" class="headerlink" title="带输出的混合"></a>带输出的混合</h4><p>利用公共属性类进行混合，是写一个公用的类，然后在需要的类中引入即可。</p>
<p><strong>这种写法有一个缺陷</strong>：编译后会将公用代码也写进 <code>css</code> 代码中，但是公用代码其本身在编译后已经失去作用了，会占据一定空间并消耗代码加载时间。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 公用属性类</span></span><br><span class="line"><span class="selector-class">.common</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">background</span>: pink;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: skyblue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.inner</span> &#123;</span><br><span class="line">        <span class="comment">// 引入公用属性</span></span><br><span class="line">        <span class="selector-class">.common</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.inner2</span> &#123;</span><br><span class="line">        <span class="comment">// 引入公用属性</span></span><br><span class="line">        <span class="selector-class">.common</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line">// 公用代码</span><br><span class="line"><span class="selector-class">.common</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.common</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: skyblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 实际使用代码</span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: skyblue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner2</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner2</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: skyblue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="不带输出的混合"><a href="#不带输出的混合" class="headerlink" title="不带输出的混合"></a>不带输出的混合</h4><p>这种方式解决公共属性类的代码被编译输出到 <code>css</code> 文件的问题。</p>
<p>将公用代码写成 <code>mixin</code> 混合的形式调用，其格式是<font color="red">类似于类选择器结合方法</font> ，可以携带参数进行混合。</p>
<p><strong>注意点：</strong>如果携带参数进行混合，参数没有默认值，且没有传入参数时，编译会报错；传入参数需要按定义顺序传入，或者显示指定参数，如：<code>.common(@bgc: red);</code> ，指定传入值 <code>red</code> 给变量 <code>@bgc</code> 。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 传入四个参数变量，@height 变量的默认值为 100px</span></span><br><span class="line"><span class="selector-class">.common</span>(<span class="variable">@height</span>: <span class="number">100px</span>, <span class="variable">@width</span>, <span class="variable">@bgc</span>, <span class="variable">@hover-bgc</span>) &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">background</span>: <span class="variable">@bgc</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="variable">@height</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="variable">@width</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: <span class="variable">@hover-bgc</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.inner</span> &#123;</span><br><span class="line">        <span class="comment">// 按定义顺序传参</span></span><br><span class="line">        <span class="selector-class">.common</span>(<span class="number">100px</span>, <span class="number">100px</span>, pink, skyblue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.inner2</span> &#123;</span><br><span class="line">        <span class="comment">// 指定参数传参</span></span><br><span class="line">        <span class="selector-class">.common</span>(<span class="number">200px</span>, <span class="number">200px</span>, <span class="variable">@bgc</span>: skyblue, <span class="variable">@hover-bgc</span>: pink);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>有些情况下使用混合会有一些小问题：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./style.css"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrap"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span>(<span class="variable">@h</span>, <span class="variable">@w</span>, <span class="variable">@c</span>) &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto;	</span><br><span class="line">    <span class="attribute">background</span>: <span class="variable">@c</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="variable">@h</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="variable">@w</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.inner</span> &#123;</span><br><span class="line">        <span class="selector-tag">&amp;</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">            <span class="selector-class">.center</span>(<span class="number">150px</span>, <span class="number">150px</span>, pink);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-tag">&amp;</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">            <span class="selector-class">.center</span>(<span class="number">100px</span>, <span class="number">100px</span>, skyblue);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">  // 重复</span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span>;</span><br><span class="line">  <span class="selector-tag">top</span>: 0;</span><br><span class="line">  <span class="selector-tag">bottom</span>: 0;</span><br><span class="line">  <span class="selector-tag">left</span>: 0;</span><br><span class="line">  <span class="selector-tag">right</span>: 0;</span><br><span class="line">  <span class="selector-tag">margin</span>: <span class="selector-tag">auto</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="selector-tag">background</span>: <span class="selector-tag">pink</span>;</span><br><span class="line">  <span class="selector-tag">height</span>: 150<span class="selector-tag">px</span>;</span><br><span class="line">  <span class="selector-tag">width</span>: 150<span class="selector-tag">px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">  // 重复</span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span>;</span><br><span class="line">  <span class="selector-tag">top</span>: 0;</span><br><span class="line">  <span class="selector-tag">bottom</span>: 0;</span><br><span class="line">  <span class="selector-tag">left</span>: 0;</span><br><span class="line">  <span class="selector-tag">right</span>: 0;</span><br><span class="line">  <span class="selector-tag">margin</span>: <span class="selector-tag">auto</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="selector-tag">background</span>: <span class="selector-tag">skyblue</span>;</span><br><span class="line">  <span class="selector-tag">height</span>: 100<span class="selector-tag">px</span>;</span><br><span class="line">  <span class="selector-tag">width</span>: 100<span class="selector-tag">px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当这种情况下，会发现使用混合编译之后的代码高度相同，按我们以往的经验是将相同的代码分离出来，写成如下形式：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line">// 提取公共代码</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(1)</span>,</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: skyblue;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="一般继承"><a href="#一般继承" class="headerlink" title="一般继承"></a>一般继承</h4><p>继承的是类，不是混合，所以定义继承，不能带任何参数。</p>
<p><strong>注意：</strong>这里不同于一般混合，其编译后的格式不同。一般混合是将代码全部复制进去，而一般继承是将相同代码单独提取。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承类</span></span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">    <span class="selector-class">.inner</span> &#123;</span><br><span class="line">        <span class="comment">// 继承，写法一</span></span><br><span class="line">        <span class="selector-tag">&amp;</span><span class="selector-pseudo">:nth-child(1)</span><span class="selector-pseudo">:extend(.center)</span> &#123;</span><br><span class="line">            <span class="comment">// 下面这部分可以使用混合来实现</span></span><br><span class="line">            <span class="attribute">background</span>: pink;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-tag">&amp;</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">            <span class="comment">// 继承，写法二</span></span><br><span class="line">            <span class="selector-tag">&amp;</span><span class="selector-pseudo">:extend(.center)</span>;</span><br><span class="line">            <span class="attribute">background</span>: skyblue;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line">// 公共属性</span><br><span class="line"><span class="selector-class">.center</span>,</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(1)</span>,</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: skyblue;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="继承子类"><a href="#继承子类" class="headerlink" title="继承子类"></a>继承子类</h4><p>如下，要继承某个类及其子类，在继承类后面接子类名即可（不要逗号），如要要继承所有子类，需要使用关键词 <code>all</code> 。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: red;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.my-font</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">15px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">    <span class="selector-class">.inner</span> &#123;</span><br><span class="line">        <span class="selector-tag">&amp;</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">            <span class="comment">// 全部继承</span></span><br><span class="line">            <span class="selector-tag">&amp;</span><span class="selector-pseudo">:extend(.center</span> <span class="keyword">all</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-tag">&amp;</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">            <span class="comment">// 只继承它本身及 .my-font 子类</span></span><br><span class="line">            <span class="selector-tag">&amp;</span><span class="selector-pseudo">:extend(.center</span> <span class="selector-class">.my-font</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span>,</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.center</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(1)</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.center</span> <span class="selector-class">.my-font</span>,</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(1)</span> <span class="selector-class">.my-font</span>,</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="多继承"><a href="#多继承" class="headerlink" title="多继承"></a>多继承</h4><p>如果一个要继承多个类，在类中间加逗号即可。</p>
<h3 id="避免编译"><a href="#避免编译" class="headerlink" title="避免编译"></a>避免编译</h3><p><code>CSS</code> 中有 <code>cacl()</code> 计算方法，让浏览器执行即可，不需要使用 <code>less</code> 进行编译，此时就需要用到了。</p>
<p>语法格式就是 <code>~&quot;xxx&quot;</code> 。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// less</span></span><br><span class="line"></span><br><span class="line">*&#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="string">~"cacl(100px + 100)"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="built_in">cacl</span>(100px + 100);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Stylus"><a href="#Stylus" class="headerlink" title="Stylus"></a>Stylus</h2><p><img src="/2019/07/12/前端-CSS预处理器/stylus.svg" alt="stylus.svg"></p>
<p><code>BootStrap</code> 教程：<a href="https://stylus.bootcss.com/" target="_blank" rel="noopener">https://stylus.bootcss.com/</a></p>
<p>张鑫旭中文教程：<a href="https://www.zhangxinxu.com/jq/stylus/" target="_blank" rel="noopener">https://www.zhangxinxu.com/jq/stylus/</a></p>
<p><code>github</code> 教程：<a href="https://github.com/stylus/stylus/" target="_blank" rel="noopener">https://github.com/stylus/stylus/</a></p>
<p><code>Stylus</code> 使用规则与其他预编译器大致相同，但是在 <code>Stylus</code> 中大括号、冒号和分号是可选的，可以根据个人喜好写或者不写。</p>
<h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> npm i -g stylus</span><br></pre></td></tr></table></figure>
<h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><p>如果是在 <code>Vue</code> 、<code>Node</code> 之类的环境下，需要额外配置。</p>
<p><code>stylus</code> 文件是以 <code>.styl</code> 为后缀名的文件，编译之后变成 <code>.css</code> 文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> stylus -h</span><br><span class="line"></span><br><span class="line">  Usage: stylus [options] [command] [&lt; in [&gt; out]]</span><br><span class="line">                [file|dir ...]</span><br><span class="line"></span><br><span class="line">  Commands:</span><br><span class="line"></span><br><span class="line">    help [&lt;type&gt;:]&lt;prop&gt; Opens help info at MDN for &lt;prop&gt;</span><br><span class="line">in</span><br><span class="line">                         your default browser. Optionally</span><br><span class="line">                         searches other resources of &lt;type&gt;:</span><br><span class="line">                         safari opera w3c ms caniuse quirksmode</span><br><span class="line"></span><br><span class="line">  Options:</span><br><span class="line"></span><br><span class="line">    -i, --interactive       Start interactive REPL</span><br><span class="line">    -u, --use &lt;path&gt;        Utilize the Stylus plugin at &lt;path&gt;</span><br><span class="line">    -U, --inline            Utilize image inlining via data URI support</span><br><span class="line">    -w, --watch             Watch file(s) for changes and re-compile</span><br><span class="line">    -o, --out &lt;dir&gt;         Output to &lt;dir&gt; when passing files</span><br><span class="line">    -C, --css &lt;src&gt; [dest]  Convert CSS input to Stylus</span><br><span class="line">    -I, --include &lt;path&gt;    Add &lt;path&gt; to lookup paths</span><br><span class="line">    -c, --compress          Compress CSS output</span><br><span class="line">    -d, --compare           Display input along with output    -f, --firebug           Emits debug infos in the generated CSS that</span><br><span class="line">                            can be used by the FireStylus Firebug plugin</span><br><span class="line">    -l, --line-numbers      Emits comments in the generated CSS</span><br><span class="line">                            indicating the corresponding Stylus line</span><br><span class="line">    -m, --sourcemap         Generates a sourcemap in sourcemaps v3 format</span><br><span class="line">    --sourcemap-inline      Inlines sourcemap with full source text in base64 format</span><br><span class="line">    --sourcemap-root &lt;url&gt;  "sourceRoot" property of the generated sourcemap</span><br><span class="line">    --sourcemap-base &lt;path&gt; Base &lt;path&gt; from which sourcemap and all sources are relative</span><br><span class="line">    -P, --prefix [prefix]   prefix all css classes</span><br><span class="line">    -p, --print             Print out the compiled CSS</span><br><span class="line">    --import &lt;file&gt;         Import stylus &lt;file&gt;</span><br><span class="line">    --include-css           Include regular CSS on @import</span><br><span class="line">    -D, --deps              Display dependencies of the compiled file</span><br><span class="line">    --disable-cache         Disable caching</span><br><span class="line">    --hoist-atrules         Move @import and @charset to the top    -r, --resolve-url       Resolve relative urls inside imports</span><br><span class="line">    --resolve-url-nocheck   Like --resolve-url but without file existence check    -V, --version           Display the version of Stylus</span><br><span class="line">    -h, --help              Display help information</span><br></pre></td></tr></table></figure>
<h4 id="浏览器端-1"><a href="#浏览器端-1" class="headerlink" title="浏览器端"></a>浏览器端</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 编译 stylus 文件</span><br><span class="line"><span class="meta">$</span> stylus style.styl -o style.css</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 监听并编译 stylus 文件</span><br><span class="line"><span class="meta">$</span> stylus -w style.styl -o style.css</span><br></pre></td></tr></table></figure>
<h3 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./style.css"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrap"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stylus</span></span><br><span class="line"></span><br><span class="line">#wrap</span><br><span class="line">    <span class="attribute">width</span> <span class="number">300px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">400px</span></span><br><span class="line">    <span class="attribute">border</span> <span class="number">1px</span> solid</span><br><span class="line">    <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line"></span><br><span class="line">    .inner</span><br><span class="line">        <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line">        <span class="attribute">background</span> red</span><br><span class="line">        <span class="attribute">height</span> <span class="number">100px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">100px</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h3><p>在 <code>Stylus</code> 中，大括号、冒号和分号是选用的，但是空格和缩进有重要意义。</p>
<h4 id="缩进-后代元素选择器"><a href="#缩进-后代元素选择器" class="headerlink" title="缩进/后代元素选择器"></a>缩进/后代元素选择器</h4><p>每次缩进都是一个层次。</p>
<p>如下：</p>
<ul>
<li>在正确的缩进中，<code>#wrap</code> 的属性和子类都比 <code>#warp</code> 多一个缩进，但是其属性和子类是在同一层缩进中的；<code>.inner</code> 的属性比其多一个缩进。</li>
<li>在错误的缩进中，<code>margin 0 auto</code> 会被认为是 <code>.inner</code> 的父类 <code>#warp</code> 的子类，并且编译不会报错！！！<code>html</code> 渲染结果会出问题。特别要注意。</li>
</ul>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stylus</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确的缩进</span></span><br><span class="line">#wrap</span><br><span class="line">    <span class="attribute">width</span> <span class="number">300px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">400px</span></span><br><span class="line">    <span class="attribute">border</span> <span class="number">1px</span> solid</span><br><span class="line">    <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 子类</span></span><br><span class="line">    .inner</span><br><span class="line">        <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line">        <span class="attribute">background</span> pink</span><br><span class="line">        <span class="attribute">height</span> <span class="number">100px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">100px</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误的缩进</span></span><br><span class="line">#wrap</span><br><span class="line">    <span class="attribute">width</span> <span class="number">300px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">400px</span></span><br><span class="line">    <span class="attribute">border</span> <span class="number">1px</span> solid</span><br><span class="line">    <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line"></span><br><span class="line">        .inner</span><br><span class="line">            <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line">            <span class="attribute">background</span> pink</span><br><span class="line">            <span class="attribute">height</span> <span class="number">100px</span></span><br><span class="line">            <span class="attribute">width</span> <span class="number">100px</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line">// 正确的编译结果</span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ffc0cb</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 错误的编译结果</span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-tag">margin</span> 0 <span class="selector-tag">auto</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ffc0cb</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h4><p>属性中的空格会被编译为冒号。<font color="red">但是注意区分长得像属性的选择器。</font></p>
<p>如属性名后的那个那个空格编译时就会变成冒号。</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stylus</span></span><br><span class="line"></span><br><span class="line">#wrap</span><br><span class="line">    <span class="attribute">width</span> <span class="number">300px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">400px</span></span><br><span class="line">    <span class="attribute">border</span> <span class="number">1px</span> solid</span><br><span class="line">    <span class="attribute">margin</span> <span class="number">0</span> auto</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h4><p>多个选择器之间可以使用逗号或者换行隔开。</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stylus</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// foo bar baz 是一个后代选择器，注意区分属性中空格的编译方法</span></span><br><span class="line">foo bar baz, <span class="selector-tag">textarea</span>, input</span><br><span class="line">    <span class="attribute">border</span> <span class="number">1px</span> solid</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">foo</span> <span class="selector-tag">bar</span> <span class="selector-tag">baz</span>,</span><br><span class="line"><span class="selector-tag">textarea</span>,</span><br><span class="line"><span class="selector-tag">input</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="父级引用-1"><a href="#父级引用-1" class="headerlink" title="父级引用"></a>父级引用</h4><p><code>Stylus</code> 的父级引用写法与 <code>Less</code> 类似，都是使用 <code>&amp;</code> 。</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stylus</span></span><br><span class="line"></span><br><span class="line">#wrap</span><br><span class="line">    &amp;:hover</span><br><span class="line">        <span class="attribute">background</span> skyblue</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#87ceeb</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="变量-1"><a href="#变量-1" class="headerlink" title="变量"></a>变量</h3><p>使用表达式作为变量，变量值可以是列表形式，中间用逗号隔开。</p>
<p>变量名与 <code>css</code> 属性名相同，但是建议使用标识符 <code>$</code> 区分。</p>
<p>在编译时，会把属性值中的变量进行编译，属性名不会编译。</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stylus</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 变量</span></span><br><span class="line"><span class="attribute">font-size</span> = <span class="number">14px</span></span><br><span class="line"><span class="attribute">font</span> = Arial, sans-serif</span><br><span class="line"></span><br><span class="line">body</span><br><span class="line">    <span class="attribute">font</span> font-size font</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 建议写法</span></span><br><span class="line"><span class="variable">$font</span>-size = <span class="number">14px</span></span><br><span class="line"><span class="variable">$font</span> = Arial, sans-serif</span><br><span class="line"></span><br><span class="line">body</span><br><span class="line">    <span class="attribute">font</span> <span class="variable">$font</span>-size <span class="variable">$font</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">14px</span> Arial, sans-serif;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Stylus</code> 有另外一个很酷的独特功能，不需要分配值给变量就可以定义引用属性。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//stylus</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>logo</span><br><span class="line">    width 150px</span><br><span class="line">    height 80px</span><br><span class="line">    background skyblue</span><br><span class="line">    margin-left (@width / 2)</span><br><span class="line">    margin-top (@height / 2)</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#logo</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#87ceeb</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">75px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Mixin-混合-1"><a href="#Mixin-混合-1" class="headerlink" title="Mixin 混合"></a>Mixin 混合</h3><p><code>Stylus</code> 的混合与 <code>Less</code> 不同，<code>Stylus</code> 混合写法与方法写法类似， <code>Less</code> 混合写法是类选择器和方法结合。</p>
<p>如果混合方法与属性名重复，建议使用 <code>$</code> 进行区分。</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stylus</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 混合</span></span><br><span class="line"><span class="function"><span class="title">common</span><span class="params">(<span class="variable">$color</span>)</span></span></span><br><span class="line">    <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line">    <span class="attribute">background</span> pink</span><br><span class="line">    <span class="attribute">height</span> <span class="number">100px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">100px</span></span><br><span class="line"></span><br><span class="line">    &amp;:hover</span><br><span class="line">        <span class="attribute">background</span> <span class="variable">$color</span></span><br><span class="line"></span><br><span class="line">#wrap</span><br><span class="line">    <span class="attribute">width</span> <span class="number">300px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">400px</span></span><br><span class="line">    <span class="attribute">border</span> <span class="number">1px</span> solid</span><br><span class="line">    <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line"></span><br><span class="line">    .inner</span><br><span class="line">        <span class="comment">// 方法的方式使用混合</span></span><br><span class="line">        common(skyblue)</span><br><span class="line"></span><br><span class="line">    .inner2</span><br><span class="line">        <span class="comment">// 属性的方式使用混合</span></span><br><span class="line">        common red</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ffc0cb</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#87ceeb</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner2</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ffc0cb</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span> <span class="selector-class">.inner2</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p><code>Mixin</code> 混合写法与方法类似，而 <code>Stylus</code> 中的方法……和其他语言里面的方法基本无差。</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stylus</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">add</span><span class="params">(a, b)</span></span></span><br><span class="line">    <span class="selector-tag">a</span> + b</span><br><span class="line">body</span><br><span class="line">    <span class="attribute">padding</span> add(<span class="number">10px</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="继承-1"><a href="#继承-1" class="headerlink" title="继承"></a>继承</h3><p><code>Stylus</code> 的继承基本与 <code>Sass</code> 类似。</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// styluss</span></span><br><span class="line"></span><br><span class="line">.message</span><br><span class="line">    <span class="attribute">padding</span> <span class="number">10px</span></span><br><span class="line">    <span class="attribute">border</span> <span class="number">1px</span> solid <span class="number">#eee</span></span><br><span class="line"></span><br><span class="line">.warning</span><br><span class="line">    @extend .message</span><br><span class="line">    <span class="attribute">color</span> <span class="number">#E2E21E</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// css</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.message</span>,</span><br><span class="line"><span class="selector-class">.warning</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.warning</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#e2e21e</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/07/12/前端-CSS预处理器/" data-id="cjy141mui0000n4ut2ox0y216" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-阿里云服务器配置" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/22/阿里云服务器配置/" class="article-date">
  <time datetime="2019-05-22T13:23:26.000Z" itemprop="datePublished">2019-05-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/22/阿里云服务器配置/">阿里云服务器配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#前言">前言</a></li>
<li><a href="#云服务器-esc">云服务器 ESC</a><ul>
<li><a href="#开放端口">开放端口</a></li>
</ul>
</li>
<li><a href="#域名">域名</a></li>
<li><a href="#本地工具">本地工具</a><ul>
<li><a href="#putty">putty</a></li>
<li><a href="#scp">SCP</a></li>
<li><a href="#navicat">Navicat</a></li>
</ul>
</li>
<li><a href="#mysql-配置">MySQL 配置</a><ul>
<li><a href="#修改默认密码">修改默认密码</a></li>
<li><a href="#让本地访问云服务器数据库">让本地访问云服务器数据库</a></li>
</ul>
</li>
<li><a href="#nodejs-配置">Node.js 配置</a><ul>
<li><a href="#node-部署测试项目">Node 部署测试项目</a></li>
<li><a href="#pm2-管理">pm2 管理</a></li>
<li><a href="#安装-pm2-管理">安装 pm2 管理</a><ul>
<li><a href="#pm2-命令">pm2 命令</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#nginx-配置">Nginx 配置</a><ul>
<li><a href="#修改配置">修改配置</a></li>
<li><a href="#history-配置">history 配置</a></li>
<li><a href="#nginx操作">nginx操作</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>当前后端都学会之后，我们就不再满足于在本地运行了，那么，如果需要在浏览器中通过域名来查看我们的页面，就需要用到云服务器了。</p>
<h2 id="云服务器-ESC"><a href="#云服务器-ESC" class="headerlink" title="云服务器 ESC"></a>云服务器 ESC</h2><p>因为我还是学生，我选择使用阿里云的 <code>云服务器ESC</code> ，好处就是……便宜！省钱！学生优惠！</p>
<p>阿里云有一个 <code>云翼计划</code> 24岁以下自动获得学生身份，云服务器价格为 ￥9.5 ，非常适合我们这种学生党开发者。</p>
<p>早在一年前我就开通了学生认证，并购买了云服务器产品，当时只是放置了一个简单静态页，现在终于有用武之地了，默默装逼中。</p>
<p>关于云翼计划的学生认证，自行百度即可，做完这个，就是最关键的购买云服务器及云服务器系统选择。</p>
<p>在经过 nnn 次重置云服务器磁盘之后，我已经发现的最方便的配置方式，购买或者重置云服务器选择镜像时，我们可以在镜像市场中选择所有前后端都配置好的系统……可以节省时间，避免人为的安装配置错误。</p>
<p><img src="/2019/05/22/阿里云服务器配置/选择镜像.png" alt="选择镜像.png"></p>
<p>镜像市场中有很多原生系统及配置好环境的系统，这里我直接搜索 “node+mysql”，使用这个配置好环境的镜像。</p>
<p><img src="/2019/05/22/阿里云服务器配置/云服务器.png" alt="云服务器.png"></p>
<p>这个镜像的环境配置如下，足够我们开发使用了。</p>
<p><img src="/2019/05/22/阿里云服务器配置/服务器配置.png" alt="服务器配置.png"></p>
<p>至此，服务器及环境配置已经完成了，全自动，方便快捷。</p>
<h3 id="开放端口"><a href="#开放端口" class="headerlink" title="开放端口"></a>开放端口</h3><p>打开 <code>云服务器ESC</code> 控制台，点击管理。</p>
<p><img src="/2019/05/22/阿里云服务器配置/云服务器管理控制台.png" alt="云服务器管理控制台.png"></p>
<p>点击 <code>本实例安全组</code> ，点击 <code>配置规则</code> 。</p>
<p><img src="/2019/05/22/阿里云服务器配置/添加安全组.png" alt="添加安全组.png"></p>
<p>点击 <code>添加安全组规则</code> 。</p>
<p><img src="/2019/05/22/阿里云服务器配置/添加安全组规则.png" alt="添加安全组规则.png"></p>
<h2 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h2><p>在阿里云中有 <code>域名服务</code> 可以自行购买域名，购买之后进行域名备案然后就能使用了。</p>
<p>提交域名备案之后，会在20个工作日内处理（说20天就是20天……），耐心等待。</p>
<p>都完成之后打开阿里云域名服务，进行 <code>域名解析</code> 。</p>
<p><img src="/2019/05/22/阿里云服务器配置/域名服务.png" alt="域名服务.png"></p>
<p>如果为我已经配置好的域名解析。需要自己配置的话，点击 “添加记录” 。</p>
<p><img src="/2019/05/22/阿里云服务器配置/域名解析.png" alt="域名解析.png"></p>
<p><img src="/2019/05/22/阿里云服务器配置/添加记录.png" alt="添加记录.png"></p>
<p>基本就是这样，完成之后，访问域名，就能查看我们的云服务后端了，如果云服务器已经配置好了，应该就能查看到 Nginx 默认 80 端口的文件了。</p>
<h2 id="本地工具"><a href="#本地工具" class="headerlink" title="本地工具"></a>本地工具</h2><p>我们需要三个本地工具，用来控制云服务器。</p>
<h3 id="putty"><a href="#putty" class="headerlink" title="putty"></a>putty</h3><p>串行接口连接软件。用来访问云服务器的命令行。使用 IP 、端口号、账号密码即可访问。</p>
<p><img src="/2019/05/22/阿里云服务器配置/putty.png" alt="putty.png"></p>
<p><img src="/2019/05/22/阿里云服务器配置/云服务器命令行.png" alt="云服务器命令行.png"></p>
<h3 id="SCP"><a href="#SCP" class="headerlink" title="SCP"></a>SCP</h3><p>SCP 用来进行本地和云服务器文件传输。</p>
<p><img src="/2019/05/22/阿里云服务器配置/scp.png" alt="scp.png"></p>
<h3 id="Navicat"><a href="#Navicat" class="headerlink" title="Navicat"></a>Navicat</h3><p>Navicat 用来连接云服务器的数据库。</p>
<p><img src="/2019/05/22/阿里云服务器配置/navicat.png" alt="navicat.png"></p>
<h2 id="MySQL-配置"><a href="#MySQL-配置" class="headerlink" title="MySQL 配置"></a>MySQL 配置</h2><h3 id="修改默认密码"><a href="#修改默认密码" class="headerlink" title="修改默认密码"></a>修改默认密码</h3><p>默认密码为 ProphetClouds.com2017， 端口为 3306。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 首先以初始密码登录数据库</span><br><span class="line"><span class="meta">#</span> mysql -uroot -pProphetClouds.com2017</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 选择 mysql 中一个名为 mysql 的数据库</span><br><span class="line"><span class="meta">mysql&gt;</span> use mysql;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 更新 user 表</span><br><span class="line"><span class="meta">mysql&gt;</span> UPDATE user SET Password = PASSWORD('newpass') WHERE user = 'root';</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span> FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<h3 id="让本地访问云服务器数据库"><a href="#让本地访问云服务器数据库" class="headerlink" title="让本地访问云服务器数据库"></a>让本地访问云服务器数据库</h3><p>默认情况下，本地是无法获取云服务器的数据库数据的，如果此时用 Navicat 连接，会报错（应该是1043错误）。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span> grant all privileges on *.* to 'root'@'%' identified by '123456' with grant option;</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span> flush privileges;</span><br></pre></td></tr></table></figure>
<h2 id="Node-js-配置"><a href="#Node-js-配置" class="headerlink" title="Node.js 配置"></a>Node.js 配置</h2><h3 id="Node-部署测试项目"><a href="#Node-部署测试项目" class="headerlink" title="Node 部署测试项目"></a>Node 部署测试项目</h3><ol>
<li><p>新建项目文件example.js。   </p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">touch example.js</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用vim编辑器打开项目文件example.js。   </p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install vim</span><br><span class="line">vim example.js</span><br></pre></td></tr></table></figure>
<p> 输入<code>i</code>，进入编辑模式，将以下项目文件内容粘贴到文件中。按键Esc，退出编辑模式。输入<code>:wq</code>后，按键Enter，保存文件内容并退出。 </p>
<p> 项目文件内容：</p>
</li>
</ol>
<pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'0.0.0.0'</span>;</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123; </span><br><span class="line">    res.statusCode = <span class="number">200</span>;</span><br><span class="line">    res.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>);</span><br><span class="line">    res.end(<span class="string">'Hello World\n'</span>);</span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line">server.listen(port, hostname, () =&gt; &#123; </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Server running at http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</code></pre><ol start="3">
<li><p>运行项目。   </p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node ~/example.js</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>如果没有问题，使用公网ip和端口号应该就能查看到 “Hello World” 。</p>
<h3 id="pm2-管理"><a href="#pm2-管理" class="headerlink" title="pm2 管理"></a>pm2 管理</h3><h3 id="安装-pm2-管理"><a href="#安装-pm2-管理" class="headerlink" title="安装 pm2 管理"></a>安装 pm2 管理</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> npm i -g pm2</span><br></pre></td></tr></table></figure>
<h4 id="pm2-命令"><a href="#pm2-命令" class="headerlink" title="pm2 命令"></a>pm2 命令</h4><p>最简单的启用一个应用:  <code>pm2 start app.js</code> </p>
<p>停止：<code>pm2 stop app_name|app_id</code> </p>
<p>删除：<code>pm2 delete app_name|app_id</code> </p>
<p>重启：<code>pm2 restart app_name|app_id</code> </p>
<p>停止所有：<code>pm2 stop all</code> </p>
<p>查看所有的进程：<code>pm2 list</code> </p>
<p>查看所有的进程状态：<code>pm2 status</code> </p>
<p>查看某一个进程的信息：<code>pm2 describe app_name|app_id</code></p>
<h2 id="Nginx-配置"><a href="#Nginx-配置" class="headerlink" title="Nginx 配置"></a>Nginx 配置</h2><h3 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">// default.conf</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line">    #access_log  /var/log/nginx/host.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">    # redirect server error pages to the static page /50x.html</span><br><span class="line">    #</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    proxy_pass   http://127.0.0.1;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">    #</span><br><span class="line">    #location ~ \.php$ &#123;</span><br><span class="line">    #    root           html;</span><br><span class="line">    #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">    #    fastcgi_index  index.php;</span><br><span class="line">    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">    #    include        fastcgi_params;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">    # deny access to .htaccess files, if Apache&apos;s document root</span><br><span class="line">    # concurs with nginx&apos;s one</span><br><span class="line">    #</span><br><span class="line">    #location ~ /\.ht &#123;</span><br><span class="line">    #    deny  all;</span><br><span class="line">    #&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>nginx 的默认启动端口是 80， 启动文件路径为 <code>/usr/share/nginx/html</code> ，入口文件名为 <code>index.html</code> 或 <code>index.htm</code> 。</p>
<p>我们需要修改其默认配置，配置文件路径为 <code>/etc/nginx/conf.d/default.conf</code> （不同电脑可能不同）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// default.conf</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       3002;	// 默认端口</span><br><span class="line">    server_name  120.79.254.54;		// 服务器地址</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line">    #access_log  /var/log/nginx/host.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /root/dist;		// 文件路径</span><br><span class="line">        index  index.html index.htm;	// 入口文件名</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="history-配置"><a href="#history-配置" class="headerlink" title="history 配置"></a>history 配置</h3><p>vue-router 路由模式有两种，一种是使用hash来控制视图的跳转。另一种是使用 history 模式，使用 history.pushState API 来控制视图的跳转。使用 hash 的缺点是路由的样子会是 #/a/b 这种样子，不美观，而且在微信分享时会出现问题。所以推荐使用history模式的路由。</p>
<p>在 <code>vue+node(express)</code> 项目中使用 <code>history</code> 模式时，当项目部署到服务器上后， 打开前端项目刷新或者使用 <code>url</code> 直接访问某个页面时，会报错，404 not found。</p>
<p>由于使用 <code>history</code> 时的路由是 <a href="https://link.jianshu.com?t=http://www.xxx.com/a/b/c" target="_blank" rel="noopener">www.xxx.com/a/b/c</a> ，<code>url</code> 是指向真实 <code>url</code> 的资源路径。因此回去服务端查询该资源。往往资源是不存在的于是就会报404。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       3002;</span><br><span class="line">    server_name  120.79.254.54;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line">    #access_log  /var/log/nginx/host.access.log  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /root/dist;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line"> 		try_files	$uri  $uri/ @rewrites;		// 添加</span><br><span class="line">    &#125;</span><br><span class="line">    // 添加</span><br><span class="line">    location @rewrites &#123;</span><br><span class="line">		rewrite ^(.+)$ /index.html last;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>try_files 是指当用户请求url资源时 <a href="https://link.jianshu.com?t=http://www.xxx.com/xxx" target="_blank" rel="noopener">www.xxx.com/xxx</a>，try_files 会到硬盘资源根目录里找 xxx。如果存在名为 xxx 的文件就返回，如果找不到在找名为 xxx 的目录，再找不到就会执行@rewrites。（$uri指找文件， $uri/指找目录）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location @rewrites &#123;</span><br><span class="line">     rewrite ^(.+)$ /index.html last;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>rewrite是nginx中的重定向指令。^(.+)$  是重定向规则。/index.html重定向路径。</p>
<p>参考：<a href="https://www.jianshu.com/p/0a9077d8714d" target="_blank" rel="noopener">https://www.jianshu.com/p/0a9077d8714d</a></p>
<h3 id="nginx操作"><a href="#nginx操作" class="headerlink" title="nginx操作"></a>nginx操作</h3><p>记得如果使用端口，一定要开端口</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 查找进行</span><br><span class="line">ps -ef | grep nginx</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 结束进程号</span><br><span class="line">kill -QUIT xxx</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 另一种</span><br><span class="line">service nginx stop/start</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 重新加载配置</span><br><span class="line">/usr/sbin/nginx -s reload</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/05/22/阿里云服务器配置/" data-id="cjy01an6i0048osut2zi6krrr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node/">Node</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/服务器/">服务器</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-框架-Vuex" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/25/框架-Vuex/" class="article-date">
  <time datetime="2019-04-25T09:07:40.000Z" itemprop="datePublished">2019-04-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#vuex">Vuex</a></li>
<li><a href="#状态管理模式">状态管理模式</a><ul>
<li><a href="#状态自管理">状态自管理</a></li>
<li><a href="#vuex-状态管理模式">Vuex 状态管理模式</a><ul>
<li><a href="#vue-组件与-vuex-模块的交互">Vue 组件与 Vuex 模块的交互</a></li>
</ul>
</li>
<li><a href="#什么情况下应该使用-vuex">什么情况下应该使用 Vuex</a></li>
</ul>
</li>
<li><a href="#起步">起步</a><ul>
<li><a href="#安装">安装</a></li>
<li><a href="#配置">配置</a></li>
<li><a href="#基本使用">基本使用</a></li>
</ul>
</li>
<li><a href="#核心概念">核心概念</a><ul>
<li><a href="#store">Store</a><ul>
<li><a href="#最简单的-store">最简单的 Store</a></li>
</ul>
</li>
<li><a href="#action">Action</a><ul>
<li><a href="#分发-action">分发 Action</a></li>
<li><a href="#action-提交-mutation">Action 提交 Mutation</a></li>
<li><a href="#action-异步请求">Action 异步请求</a></li>
</ul>
</li>
<li><a href="#mutation">Mutation</a><ul>
<li><a href="#提交-mutation">提交 Mutation</a></li>
<li><a href="#对象风格的提交方式">对象风格的提交方式</a></li>
<li><a href="#使用常量替代-mutation-事件类型">使用常量替代 Mutation 事件类型</a></li>
<li><a href="#在组件中提交-mutation">在组件中提交 Mutation</a></li>
</ul>
</li>
<li><a href="#state">State</a><ul>
<li><a href="#在组件中返回状态">在组件中返回状态</a></li>
</ul>
</li>
<li><a href="#getter">Getter</a></li>
<li><a href="#module">Module</a></li>
<li><a href="#严格模式">严格模式</a><ul>
<li><a href="#开发环境与发布环境">开发环境与发布环境</a></li>
</ul>
</li>
<li><a href="#表单处理">表单处理</a><ul>
<li><a href="#不使用-v-model">不使用 v-model</a></li>
<li><a href="#使用双向绑定的计算属性">使用双向绑定的计算属性</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h2><p>Vuex 是一个专为 Vue.js 应用程序开发的<strong>状态管理模式</strong> 。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p>
<p>更多参考官方文档：<a href="https://vuex.vuejs.org/zh/" target="_blank" rel="noopener">https://vuex.vuejs.org/zh/</a></p>
<h2 id="状态管理模式"><a href="#状态管理模式" class="headerlink" title="状态管理模式"></a>状态管理模式</h2><h3 id="状态自管理"><a href="#状态自管理" class="headerlink" title="状态自管理"></a>状态自管理</h3><p>一个基本的 <code>Vue</code> 实例或组件就是使用状态自管理，状态自管理应用包含以下几个部分：</p>
<ul>
<li><strong>state</strong>，驱动应用的数据源；</li>
<li><strong>view</strong>，以声明方式将 <strong>state</strong> 映射到视图；</li>
<li><strong>actions</strong>，响应在 <strong>view</strong> 上的用户输入导致的状态变化。</li>
</ul>
<p>如下为一个基本的 <code>Vue</code> 实例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  <span class="comment">// state</span></span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      count: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// view</span></span><br><span class="line">  template: <span class="string">"&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;"</span>,</span><br><span class="line">  <span class="comment">// actions</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    increment () &#123;</span><br><span class="line">      <span class="keyword">this</span>.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>以下是一个官网提供的表示<strong>单向数据流</strong>理念的简单示意：</p>
<p><img src="/2019/04/25/框架-Vuex/Vue状态管理模式.png" alt="Vue状态管理模式"></p>
<p>当执行<code>Actions（methods）</code> 中的方法时（一般是用户通过 <code>View</code> 来操作），修改 <code>State（data）</code> 中数据， <code>View（template）</code> 中数据就会随之变化。</p>
<h3 id="Vuex-状态管理模式"><a href="#Vuex-状态管理模式" class="headerlink" title="Vuex 状态管理模式"></a>Vuex 状态管理模式</h3><p>但是，当我们的应用遇到<strong>多个组件共享状态</strong>时，单向数据流的简洁性很容易被破坏：</p>
<ul>
<li>多个视图依赖于同一状态。</li>
<li>来自不同视图的行为需要变更同一状态。</li>
</ul>
<p>因此，将组件的共享状态抽取出来，以一个全局单例模式管理，在这种模式下，任何组件都能获取状态或者触发行为！这种管理模式就是 <code>Vuex</code> 状态管理模式。</p>
<p>以下是一个官网提供的表示<strong>Vuex 数据流</strong>理念的简单示意：</p>
<p><img src="/2019/04/25/框架-Vuex/Vuex状态管理模式.png" alt="Vue状态管理模式"></p>
<p>一下为我个人绘制的一个比较完善的图。</p>
<p><img src="/2019/04/25/框架-Vuex/Vuex.png" alt="Vue状态管理模式"></p>
<p>这种管理模式就是将 <code>Vue</code> 实例或组件中的 <code>Actions（methods）</code> 和 <code>State（data）</code> 抽取出来单独管理，在这种模式中不再是 <code>Actions</code> 直接更新 <code>State</code> ，而是通过中间增加的 <code>Mutations</code> 来操作。</p>
<h4 id="Vue-组件与-Vuex-模块的交互"><a href="#Vue-组件与-Vuex-模块的交互" class="headerlink" title="Vue 组件与 Vuex 模块的交互"></a>Vue 组件与 Vuex 模块的交互</h4><p>这种模式中， <strong>Vue 实例或组件通过 $store 属性来访问 Vuex 模块</strong>， <code>Vue</code> 实例或组件中的 <code>Actions（methods）</code> 只保留了方法名，用来通知 <code>Vuex</code> 模块执行对应的指令，真正的后端数据请求、数据操作和数据存储都在 <code>Vuex</code> 模块中实现。</p>
<ol>
<li><code>Vue</code> 组件中的  <code>Actions（methods）</code> 通过 <strong>this.$store.dispatch()</strong> 通知 <code>Vuex</code> 执行某项 <code>Action</code> 中的操作（某个回调函数）。</li>
<li><code>Action</code> 中的这个函数方法获取  <code>Backend API</code> 后端数据，然后使用 <strong>commit()</strong> 提交一个函数名到 <code>Mutations</code> 中。</li>
<li>然后在 <code>Mutation</code>s 中<strong>具体的函数中调用 State 中的数据，执行数据操作</strong>，同时<code>Devtools（Vue的浏览器工具）</code> 可以显示数据。</li>
<li><code>State</code> 中的数据发生改变之后，<code>Vue</code> 组件就会在页面中渲染新的数据。</li>
</ol>
<p>这种管理模式不再是 <code>Actions</code> 直接更新 <code>State</code> ，而是通过中间增加的 <code>Mutations</code> 来操作。</p>
<h3 id="什么情况下应该使用-Vuex"><a href="#什么情况下应该使用-Vuex" class="headerlink" title="什么情况下应该使用 Vuex"></a>什么情况下应该使用 Vuex</h3><p><code>Vuex</code> 可以帮助我们管理共享状态，并附带了更多的概念和框架。这需要对短期和长期效益进行权衡。</p>
<ul>
<li>中大型项目：关系复杂，使用组件外部管理状态是更好的选择。</li>
<li>小型项目：如果应用够简单，最好不要使用 <code>Vuex</code> ，一个简单的状态自管理模式就足够所需了。</li>
<li>共享状态：<code>Vuex</code> 能帮助我们更好地管理<strong>共享状态</strong>，但是，如果是组件私有的状态，就没有必要使用了，这部分留在页面中，共享部分提取处理。</li>
</ul>
<h2 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>我们一般将 <code>Vuex</code> 单独封装到 <code>store.js</code> 中，然后导入到 <code>main.js</code> 入口文件中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;&#125;,		<span class="comment">// 状态对象，data</span></span><br><span class="line">  actions: &#123;&#125;,		<span class="comment">// 包含多个应用事件回调函数的对象</span></span><br><span class="line">  mutations: &#123;&#125;,	<span class="comment">// 包含多个更新 state 函数的对象</span></span><br><span class="line">  getters: &#123;&#125;		<span class="comment">// 包含多个 getter 计算属性的对象</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span></span><br><span class="line"><span class="comment">// 导入 store.js</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,	<span class="comment">// 配置 store，所有的组件对象都多出来一个属性：$store</span></span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// App.vue</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &#123;&#123; count &#125;&#125;, count is &#123;&#123; evenOrOdd &#125;&#125;</span><br><span class="line">    &lt;input type=&quot;button&quot; value=&quot;增加&quot; @click=&quot;increment&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; value=&quot;减少&quot; @click=&quot;decrement&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      count: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    increment () &#123;</span><br><span class="line">      this.count++</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement () &#123;</span><br><span class="line">      this.count--</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    evenOrOdd () &#123;</span><br><span class="line">      return this.count % 2 === 0 ? &apos;偶数&apos; : &apos;奇数&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>在完成安装和配置的基础上进行修改。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">// App.vue</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- 获取使用 &#123;&#123; $store.state.count &#125;&#125; --&gt;</span><br><span class="line">    &#123;&#123; count &#125;&#125;, count is &#123;&#123; evenOrOdd &#125;&#125;</span><br><span class="line">    &lt;input type=&quot;button&quot; value=&quot;增加&quot; @click=&quot;increment&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; value=&quot;减少&quot; @click=&quot;decrement&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 导入三个辅助函数</span><br><span class="line">import &#123; mapActions, mapGetters, mapState &#125; from &apos;vuex&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    // 使用辅助函数操作 vuex</span><br><span class="line">    ...mapActions([&apos;increment&apos;, &apos;decrement&apos;])</span><br><span class="line">    // 不适用辅助函数操作 vuex</span><br><span class="line">    // increment () &#123;</span><br><span class="line">    //   // 通知 vuex 执行增加操作</span><br><span class="line">    //   this.$store.dispatch(&apos;increment&apos;)</span><br><span class="line">    // &#125;,</span><br><span class="line">    // decrement () &#123;</span><br><span class="line">    //   // 通知 vuex 执行减少操作</span><br><span class="line">    //   this.$store.dispatch(&apos;decrement&apos;)</span><br><span class="line">    // &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapState([&apos;count&apos;]),</span><br><span class="line">    ...mapGetters([&apos;evenOrOdd&apos;])</span><br><span class="line">    // 第二种辅助函数的用法，vue 中的属性名和 vuex 中的属性名不一致时使用</span><br><span class="line">    // ...mapGetters(&#123;evenOrOdd: &apos;evenOrOdd2&apos;&#125;)</span><br><span class="line">    // count () &#123;</span><br><span class="line">    //   return this.$store.state.count</span><br><span class="line">    // &#125;,</span><br><span class="line">    // evenOrOdd () &#123;</span><br><span class="line">    //   return this.$store.getters.evenOrOdd</span><br><span class="line">    // &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  <span class="comment">// 状态对象</span></span><br><span class="line">  state: &#123;</span><br><span class="line">    <span class="comment">// 初始化状态</span></span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 包含应用事件回调函数的对象</span></span><br><span class="line">  actions: &#123;</span><br><span class="line">    <span class="comment">// 提交 mutation</span></span><br><span class="line">    increment: <span class="function">(<span class="params">&#123; commit &#125;</span>) =&gt;</span> commit(<span class="string">'increment'</span>),</span><br><span class="line">    decrement: <span class="function">(<span class="params">&#123; commit &#125;</span>) =&gt;</span> commit(<span class="string">'decrement'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 更新 state 的函数对象</span></span><br><span class="line">  mutations: &#123;</span><br><span class="line">    <span class="comment">// 增加</span></span><br><span class="line">    increment: <span class="function"><span class="params">state</span> =&gt;</span> state.count++,</span><br><span class="line">    <span class="comment">// 减少</span></span><br><span class="line">    decrement: <span class="function"><span class="params">state</span> =&gt;</span> state.count--</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 包含 getter 计算属性的对象</span></span><br><span class="line">  getters: &#123;</span><br><span class="line">    evenOrOdd (state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count % <span class="number">2</span> === <span class="number">0</span> ? <span class="string">'偶数'</span> : <span class="string">'奇数'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><h3 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h3><p>每一个<strong>Vuex 应用的核心就是 Store（仓库）</strong>。store 基本上就是一个容器，它包含着你的应用中大部分的<strong>状态 (state)</strong>。<code>Vuex</code> 和单纯的全局对象有以下两点不同：</p>
<ol>
<li><code>Vuex</code> 的状态存储是响应式的。当 <code>Vue</code> 组件从 <code>Store</code> 中读取状态的时候，若 <code>Store</code> 中的状态发生变化，那么相应的组件也会相应地得到高效更新。</li>
<li>不能直接改变 <code>Store</code> 中的状态。改变 <code>Store</code>中的状态的唯一途径就是显式地<strong>提交 (commit) mutation</strong>。这样使得我们可以方便地跟踪每一个状态的变化，从而让我们能够实现一些工具帮助我们更好地了解我们的应用</li>
</ol>
<h4 id="最简单的-Store"><a href="#最简单的-Store" class="headerlink" title="最简单的 Store"></a>最简单的 Store</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;&#125;,		<span class="comment">// 状态对象，data</span></span><br><span class="line">  actions: &#123;&#125;,		<span class="comment">// 包含多个应用事件回调函数的对象</span></span><br><span class="line">  mutations: &#123;&#125;,	<span class="comment">// 包含多个更新 state 函数的对象</span></span><br><span class="line">  getters: &#123;&#125;		<span class="comment">// 包含多个 getter 计算属性的对象</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p><code>Action</code> 类似于 <code>mutation</code> ，不同在于：</p>
<ul>
<li><code>Action</code> 提交的是 <code>mutation</code> ，而不是直接变更状态。</li>
<li><code>Action</code> 可以包含任意异步操作。</li>
</ul>
<h4 id="分发-Action"><a href="#分发-Action" class="headerlink" title="分发 Action"></a>分发 Action</h4><p>在 <code>Vue</code> 组件中调用 <code>this.$store.dispatch(&#39;xxx&#39;)</code> 或者使用 <code>mapAction</code> 辅助函数分发 <code>Action</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// App.vue</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 导入三个辅助函数</span><br><span class="line">import &#123; mapActions &#125; from &apos;vuex&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    // 使用辅助函数操作 vuex 分发 mapAction</span><br><span class="line">    ...mapActions([&apos;increment&apos;])</span><br><span class="line">    // 不使用辅助函数操作 vuex 分发 mapAction</span><br><span class="line">    // increment () &#123;</span><br><span class="line">    //   // 通知 vuex 执行增加操作</span><br><span class="line">    //   this.$store.dispatch(&apos;increment&apos;)</span><br><span class="line">    // &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="Action-提交-Mutation"><a href="#Action-提交-Mutation" class="headerlink" title="Action 提交 Mutation"></a>Action 提交 Mutation</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    <span class="comment">// 提交 mutation</span></span><br><span class="line">    increment: <span class="function">(<span class="params">&#123; commit &#125;</span>) =&gt;</span> commit(<span class="string">'increment'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    <span class="comment">// 增加</span></span><br><span class="line">    increment: <span class="function"><span class="params">state</span> =&gt;</span> state.count++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Action-异步请求"><a href="#Action-异步请求" class="headerlink" title="Action 异步请求"></a>Action 异步请求</h4><p>使用 <code>axios</code> ，需要单独导入 <code>axios</code> 模块，组件中的 <code>axios</code> 与这里不共享。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    data: <span class="string">''</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 包含应用事件回调函数的对象</span></span><br><span class="line">  actions: &#123;</span><br><span class="line">    getdata (&#123; commit &#125;) &#123;</span><br><span class="line">      axios(&#123;</span><br><span class="line">        method: <span class="string">'get'</span>,</span><br><span class="line">        url: <span class="string">'/api/data'</span></span><br><span class="line">      &#125;).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data)</span><br><span class="line">        commit(<span class="string">'getdata'</span>, data)</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 更新 state 的函数对象</span></span><br><span class="line">  mutations: &#123;</span><br><span class="line">    getdata (state, data) &#123;</span><br><span class="line">      state.data = data</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h3><p>更改 <code>Vuex</code> 的 <code>store</code> 中的状态的唯一方法是提交 <code>mutation</code> 。</p>
<p><code>Mutation</code> 必须是同步函数，所有异步操作都在 <code>Action</code> 中操作。</p>
<h4 id="提交-Mutation"><a href="#提交-Mutation" class="headerlink" title="提交 Mutation"></a>提交 Mutation</h4><p>回调函数就是我们实际进行状态更改的地方，并且它会接受 <code>state</code> 作为第一个参数，第二个参数是负载对象（可以是单个参数）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment (&#123; commit &#125;) &#123;</span><br><span class="line">      commit(<span class="string">'increment'</span>, <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state, n) &#123;</span><br><span class="line">      <span class="comment">// 变更状态</span></span><br><span class="line">      state.count += n</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="对象风格的提交方式"><a href="#对象风格的提交方式" class="headerlink" title="对象风格的提交方式"></a>对象风格的提交方式</h4><p>当使用对象风格的提交方式，整个对象都作为载荷传给 <code>mutation</code> 函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment (&#123; commit &#125;) &#123;</span><br><span class="line">      commit(&#123;</span><br><span class="line">        type: <span class="string">'increment'</span>, </span><br><span class="line">        n: <span class="number">1</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state, load) &#123;</span><br><span class="line">      <span class="comment">// 变更状态</span></span><br><span class="line">      state.count += load.n</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="使用常量替代-Mutation-事件类型"><a href="#使用常量替代-Mutation-事件类型" class="headerlink" title="使用常量替代 Mutation 事件类型"></a>使用常量替代 Mutation 事件类型</h4><p>使用常量替代 mutation 事件类型在各种 Flux 实现中是很常见的模式。这样可以使 linter 之类的工具发挥作用，同时把这些常量放在单独的文件中可以让你的代码合作者对整个 app 包含的 mutation 一目了然：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// types.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SOME_MUTATION = <span class="string">'SOME_MUTATION'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="keyword">import</span> &#123; SOME_MUTATION &#125; <span class="keyword">from</span> <span class="string">'./types.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    <span class="comment">// 我们可以使用 ES2015 风格的计算属性命名功能来使用一个常量作为函数名</span></span><br><span class="line">    [SOME_MUTATION] (state) &#123;</span><br><span class="line">      <span class="comment">// mutate state</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="在组件中提交-Mutation"><a href="#在组件中提交-Mutation" class="headerlink" title="在组件中提交 Mutation"></a>在组件中提交 Mutation</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    ...mapMutations([</span><br><span class="line">      <span class="string">'increment'</span>, <span class="comment">// 将 `this.increment()` 映射为 `this.$store.commit('increment')`</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// `mapMutations` 也支持载荷：</span></span><br><span class="line">      <span class="string">'incrementBy'</span> <span class="comment">// 将 `this.incrementBy(amount)` 映射为 `this.$store.commit('incrementBy', amount)`</span></span><br><span class="line">    ]),</span><br><span class="line">    ...mapMutations(&#123;</span><br><span class="line">      add: <span class="string">'increment'</span> <span class="comment">// 将 `this.add()` 映射为 `this.$store.commit('increment')`</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p><code>State</code> 状态对象，存放的公共状态。</p>
<h4 id="在组件中返回状态"><a href="#在组件中返回状态" class="headerlink" title="在组件中返回状态"></a>在组件中返回状态</h4><p><code>Vue</code> 组件从 <code>Vuex</code> 中读取状态并展示出来，使用 <code>this.$store.state.xxx</code> 在计算属性中调用或者使用 <code>mapState</code> 辅助函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// 使用 mapState 辅助函数返回状态</span></span><br><span class="line">  computed: mapState(&#123;</span><br><span class="line">    count: <span class="function"><span class="params">state</span> =&gt;</span> state.count,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传字符串参数 'count' 等同于 `state =&gt; state.count`</span></span><br><span class="line">    countAlias: <span class="string">'count'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 为了能够使用 `this` 获取局部状态，必须使用常规函数</span></span><br><span class="line">    countPlusLocalState (state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count + <span class="keyword">this</span>.localCount</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="comment">// 不使用 mapState 辅助函数返回状态</span></span><br><span class="line">  computed: &#123;</span><br><span class="line">    count2 () &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.count</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h3><h3 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h3><p>由于使用单一状态树，应用的所有状态会集中到一个比较大的对象。当应用变得非常复杂时，store 对象就有可能变得相当臃肿。</p>
<p>为了解决以上问题，Vuex 允许我们将 store 分割成<strong>模块（module）</strong>。每个模块拥有自己的 state、mutation、action、getter、甚至是嵌套子模块——从上至下进行同样方式的分割：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;,</span><br><span class="line">  getters: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> moduleB = &#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  modules: &#123;</span><br><span class="line">    a: moduleA,</span><br><span class="line">    b: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">store.state.a <span class="comment">// -&gt; moduleA 的状态</span></span><br><span class="line">store.state.b <span class="comment">// -&gt; moduleB 的状态</span></span><br></pre></td></tr></table></figure>
<h3 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h3><p>开启严格模式，仅需在创建 store 的时候传入 <code>strict: true</code> 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  strict: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>在严格模式下，无论何时发生了状态变更且不是由 mutation 函数引起的，将会抛出错误。这能保证所有的状态变更都能被调试工具跟踪到。</p>
<h4 id="开发环境与发布环境"><a href="#开发环境与发布环境" class="headerlink" title="开发环境与发布环境"></a>开发环境与发布环境</h4><p><strong>不要在发布环境下启用严格模式</strong>！严格模式会深度监测状态树来检测不合规的状态变更——请确保在发布环境下关闭严格模式，以避免性能损失。</p>
<p>类似于插件，我们可以让构建工具来处理这种情况：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  strict: process.env.NODE_ENV !== <span class="string">'production'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="表单处理"><a href="#表单处理" class="headerlink" title="表单处理"></a>表单处理</h3><p>当在严格模式中使用 <code>Vuex</code> 时， <code>v-model</code> 会修改 <code>store</code> 对象，由于不是 <code>mutation</code> 引起的，会被报错。</p>
<h4 id="不使用-v-model"><a href="#不使用-v-model" class="headerlink" title="不使用 v-model"></a>不使用 v-model</h4><p>解决方案就是给 <code>&lt;input&gt;</code> 中绑定 <code>value</code> ，然后侦听 <code>input</code> 或者 <code>change</code> 事件，在事件回调中调用 <code>action</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;input :value=&quot;message&quot; @input=&quot;updateMessage&quot;&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // ...</span><br><span class="line">    computed: &#123;</span><br><span class="line">      ...mapState(&#123;</span><br><span class="line">        message: state =&gt; state.obj.message</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      updateMessage (e) &#123;</span><br><span class="line">        this.$store.commit(&apos;updateMessage&apos;, e.target.value)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="使用双向绑定的计算属性"><a href="#使用双向绑定的计算属性" class="headerlink" title="使用双向绑定的计算属性"></a>使用双向绑定的计算属性</h4><p>使用带有 setter 的双向绑定计算属性，这样就不会损失 <code>v-model</code> 中的特性了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;input v-model=&quot;message&quot;&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  message: &#123;</span><br><span class="line">    get () &#123;</span><br><span class="line">      return this.$store.state.obj.message</span><br><span class="line">    &#125;,</span><br><span class="line">    set (value) &#123;</span><br><span class="line">      this.$store.commit(&apos;updateMessage&apos;, value)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/04/25/框架-Vuex/" data-id="cjy01an83004sosutf2ir4him" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/框架/">框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/移动端/">移动端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-框架-全栈开发" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/11/框架-全栈开发/" class="article-date">
  <time datetime="2019-04-11T09:50:03.000Z" itemprop="datePublished">2019-04-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/11/框架-全栈开发/">Vue+Node+Mongodb全栈开发</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#介绍">介绍</a><ul>
<li><a href="#前端工具">前端工具</a></li>
<li><a href="#后端工具">后端工具</a></li>
<li><a href="#数据库">数据库</a></li>
</ul>
</li>
<li><a href="#git-版本管理工具">Git 版本管理工具</a></li>
<li><a href="#搭建前端础架构">搭建前端础架构</a><ul>
<li><a href="#vuejs-安装">Vue.js 安装</a></li>
<li><a href="#vue-cli-3x-安装">Vue-cli 3.x 安装</a></li>
<li><a href="#生成-vue-基础前端架构">生成 Vue 基础前端架构</a></li>
<li><a href="#添加-element-插件">添加 element 插件</a></li>
<li><a href="#切换前端路由模式">切换前端路由模式</a></li>
<li><a href="#vue-配置">vue 配置</a></li>
<li><a href="#模拟数据-mock">模拟数据 Mock</a></li>
</ul>
</li>
<li><a href="#搭建后端架构">搭建后端架构</a><ul>
<li><a href="#nodejs-安装">Node.js 安装</a></li>
<li><a href="#express-generator-生成器安装">express-generator 生成器安装</a></li>
<li><a href="#生成基础后端架构">生成基础后端架构</a></li>
<li><a href="#删除-express-内置前端模板">删除 express 内置前端模板</a></li>
<li><a href="#后端路由管理">后端路由管理</a></li>
<li><a href="#body-parser-中间件安装及配置">body-Parser 中间件安装及配置</a></li>
<li><a href="#cors-跨域请求">cors 跨域请求</a></li>
<li><a href="#nodemon-辅助工具">nodemon 辅助工具</a></li>
<li><a href="#mongoose-数据库工具">mongoose 数据库工具</a><ul>
<li><a href="#数据库连接操作">数据库连接操作</a></li>
<li><a href="#数据库模式设计">数据库模式设计</a></li>
<li><a href="#封装数据库异步api">封装数据库异步API</a></li>
<li><a href="#路由模块调用">路由模块调用</a></li>
</ul>
</li>
<li><a href="#mysql-模块">MySQL 模块</a><ul>
<li><a href="#使用-promise-封装-mysql">使用 Promise 封装 MySQL</a></li>
<li><a href="#封装-mysql-异步-api">封装 MySQL 异步 API</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#部署到云服务器">部署到云服务器</a></li>
</ul>
<!-- /TOC -->
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>此文介绍我全栈开发项目的一些心得。全栈，前端、后端、数据库实现分离。</p>
<h3 id="前端工具"><a href="#前端工具" class="headerlink" title="前端工具"></a>前端工具</h3><table>
<thead>
<tr>
<th>名称</th>
<th>介绍</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.npmjs.com/package/axios" target="_blank" rel="noopener">Axios</a></td>
<td>一个基于 promise 的 HTTP 库</td>
<td><code>Vue 2.x</code> 之后推荐使用，取代 <code>vue-resoure</code></td>
</tr>
<tr>
<td><a href="http://www.bootcss.com/" target="_blank" rel="noopener">Bootstrap 3/4</a></td>
<td>前端开发框架</td>
<td>代码块</td>
</tr>
<tr>
<td><a href="https://echarts.baidu.com/" target="_blank" rel="noopener">ECharts</a></td>
<td>使用 <code>JavaScript</code> 实现的开源可视化库</td>
<td></td>
</tr>
<tr>
<td><a href="https://element.eleme.cn/#/zh-CN" target="_blank" rel="noopener">Element</a></td>
<td>基于 <code>Vue 2.0</code> 的桌面端组件库</td>
<td></td>
</tr>
<tr>
<td><a href="https://cn.vuejs.org/" target="_blank" rel="noopener">Vue.js</a></td>
<td>是一套用于构建用户界面的渐进式框架</td>
<td></td>
</tr>
<tr>
<td><a href="https://www.iconfont.cn/" target="_blank" rel="noopener">Iconfont</a></td>
<td>阿里巴巴矢量图标库</td>
<td>是图片集</td>
</tr>
<tr>
<td><a href="http://mint-ui.github.io/" target="_blank" rel="noopener">Mint-UI</a></td>
<td>基于 <code>Vue.js</code> 的移动端组件库</td>
<td></td>
</tr>
<tr>
<td><a href="http://dev.dcloud.net.cn/mui/" target="_blank" rel="noopener">MUI</a></td>
<td>前端开发框架</td>
<td>代码块，不支持 npm 下载，不支持 <code>vue-cli 3.x</code></td>
</tr>
<tr>
<td><a href="https://cli.vuejs.org/zh/" target="_blank" rel="noopener">Vue-cli 3.x</a></td>
<td>是 <code>Vue.js</code> 开发的标准工具</td>
<td>俗称脚手架工具</td>
</tr>
<tr>
<td><a href="https://router.vuejs.org/zh/" target="_blank" rel="noopener">Vue Router</a></td>
<td>是 <code>Vue.js</code> 前端路由管理器</td>
<td></td>
</tr>
<tr>
<td><a href="https://www.webpackjs.com/" target="_blank" rel="noopener">Webpack</a></td>
<td>是前端资源模块化管理和打包工具</td>
</tr>
</tbody>
</table>
<h3 id="后端工具"><a href="#后端工具" class="headerlink" title="后端工具"></a>后端工具</h3><p>使用到的内容：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>介绍</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://www.expressjs.com.cn/en/resources/middleware/cors.html" target="_blank" rel="noopener">Cors</a></td>
<td>用于提供一个可用于通过各种选项启用 <code>CORS</code> 的 <code>Connect/Express</code> 中间件</td>
<td>跨域请求工具</td>
</tr>
<tr>
<td><a href="http://www.expressjs.com.cn/" target="_blank" rel="noopener">Express</a></td>
<td>基于 <code>Node.js</code>的 <code>Web</code> 开发框架</td>
<td></td>
</tr>
<tr>
<td><a href="http://nodejs.cn/" target="_blank" rel="noopener">Node.js</a></td>
<td>是一个基于 <code>Chrome V8</code> 引擎的 <code>JavaScript</code> 运行环境</td>
<td></td>
</tr>
<tr>
<td><a href="https://www.npmjs.com.cn/" target="_blank" rel="noopener">NPM</a></td>
<td>是 <code>Node.js</code> 世界的包管理器。</td>
<td></td>
</tr>
<tr>
<td><a href="http://mongoosejs.net/" target="_blank" rel="noopener">Mongoose</a></td>
<td>用于 <code>Node.js</code> 的优雅 <code>MongoDB</code> 对象建模</td>
</tr>
</tbody>
</table>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><table>
<thead>
<tr>
<th>名称</th>
<th>介绍</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://www.mongodb.org.cn/" target="_blank" rel="noopener">MongoDB</a></td>
<td>基于分布式文件存储的数据库</td>
</tr>
</tbody>
</table>
<h2 id="Git-版本管理工具"><a href="#Git-版本管理工具" class="headerlink" title="Git 版本管理工具"></a>Git 版本管理工具</h2><h2 id="搭建前端础架构"><a href="#搭建前端础架构" class="headerlink" title="搭建前端础架构"></a>搭建前端础架构</h2><h3 id="Vue-js-安装"><a href="#Vue-js-安装" class="headerlink" title="Vue.js 安装"></a>Vue.js 安装</h3><p>正式项目中需要全局安装。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 全局安装</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i -g vue</span></span><br></pre></td></tr></table></figure>
<h3 id="Vue-cli-3-x-安装"><a href="#Vue-cli-3-x-安装" class="headerlink" title="Vue-cli 3.x 安装"></a>Vue-cli 3.x 安装</h3><p>使用 <code>Vue-cli</code> 脚手架搭建项目，快速方便。推荐使用当前最新的 <code>Vue-cli</code> 3.x 版本的脚手架工具。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 全局安装 Vue-cli</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i -g @vue/cli</span></span><br></pre></td></tr></table></figure>
<h3 id="生成-Vue-基础前端架构"><a href="#生成-Vue-基础前端架构" class="headerlink" title="生成 Vue 基础前端架构"></a>生成 Vue 基础前端架构</h3><p>使用 <code>Vue-cli 3.x</code> 的工具进行搭建。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> vue ui</span></span><br></pre></td></tr></table></figure>
<font color="red">具体操作及项目目录结构见《框架-Vue-cli 3》</font>

<h3 id="添加-element-插件"><a href="#添加-element-插件" class="headerlink" title="添加 element 插件"></a>添加 element 插件</h3><p><code>Element</code> ，一套为开发者、设计师和产品经理准备的基于<code>Vue 2.0</code> 的桌面端组件库。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> vue add element</span></span><br></pre></td></tr></table></figure>
<h3 id="切换前端路由模式"><a href="#切换前端路由模式" class="headerlink" title="切换前端路由模式"></a>切换前端路由模式</h3><p>默认是 <code>hash</code> 模式的路由，<code>192.168.xx.xx:3000/#/</code> ，多了这个 <code>#</code> ，如果不喜欢，可以使用 <code>history</code> 模式，就和传统的路由地址一样了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  mode: <span class="string">'history'</span>,</span><br><span class="line">  routes: []</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="vue-配置"><a href="#vue-配置" class="headerlink" title="vue 配置"></a>vue 配置</h3><p>在根目录新建 <code>vue.config.js</code> 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 基本路径配置，即原先的 baseUrl，默认是 '/'</span></span><br><span class="line">  publicPath: <span class="string">'/'</span>,</span><br><span class="line">  <span class="comment">// 打包文件输出目录</span></span><br><span class="line">  outputDir: <span class="string">'dist'</span>,</span><br><span class="line">  <span class="comment">// 打包之后静态资源的目录</span></span><br><span class="line">  assetsDir: <span class="string">'assets'</span>,</span><br><span class="line">  <span class="comment">// 是否使用eslint</span></span><br><span class="line">  lintOnSave: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// webpack-dev-server 相关配置</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    <span class="comment">// 运行项目后自动打开浏览器</span></span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 服务器地址</span></span><br><span class="line">    host: <span class="string">'0.0.0.0'</span>,</span><br><span class="line">    <span class="comment">// 端口号</span></span><br><span class="line">    port: <span class="number">8000</span>,</span><br><span class="line">    https: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 热更新</span></span><br><span class="line">    hotOnly: <span class="literal">false</span></span><br><span class="line">    <span class="comment">// 跨域请求</span></span><br><span class="line">    <span class="comment">// proxy: &#123;</span></span><br><span class="line">    <span class="comment">//   '/': &#123;</span></span><br><span class="line">    <span class="comment">//     target: 'http://127.0.0.1:5000',</span></span><br><span class="line">    <span class="comment">//     ws: false,</span></span><br><span class="line">    <span class="comment">//     changeOrigin: true</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 第三方插件配置</span></span><br><span class="line">  pluginOptions: &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 热更新配置</span></span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 修复HMR</span></span><br><span class="line">    config.resolve.symlinks(<span class="literal">true</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  css: &#123;</span><br><span class="line">    <span class="comment">// 是否使用css分离插件 ExtractTextPlugin，开发 false，打包 true</span></span><br><span class="line">    extract: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 开启 CSS source maps?</span></span><br><span class="line">    sourceMap: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// css预设器配置项</span></span><br><span class="line">    loaderOptions: &#123;&#125;,</span><br><span class="line">    <span class="comment">// 启用 CSS modules for all css / pre-processor files.</span></span><br><span class="line">    modules: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="模拟数据-Mock"><a href="#模拟数据-Mock" class="headerlink" title="模拟数据 Mock"></a>模拟数据 Mock</h3><p>在没有后端的情况下使用 <code>Mock</code> 模拟数据方便开发。</p>
<p>在跟目录下新建 <code>mock</code> 文件夹，里面放置一些 <code>json</code> 文件，用来模拟后端数据，注意要保持和真实数据格式相同才行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 json 文件</span></span><br><span class="line"><span class="keyword">const</span> mockData = <span class="built_in">require</span>(<span class="string">'./mock/data.json'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// 配置接口</span></span><br><span class="line">    before (app) &#123;</span><br><span class="line">      app.get(<span class="string">'/api/data'</span>, (req, res) =&gt; &#123;</span><br><span class="line">        res.json(mockData)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// app.vue</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;&#123;&#123; json &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      json: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.getData()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    getData() &#123;</span><br><span class="line">      // 使用 axios 访问请求</span><br><span class="line">      this.$axios</span><br><span class="line">        .get(&apos;/api/data&apos;)</span><br><span class="line">        .then(data =&gt; &#123;</span><br><span class="line">          this.json = data</span><br><span class="line">          console.log(data)</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(err =&gt; &#123;</span><br><span class="line">          console.log(&apos;错误&apos;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="搭建后端架构"><a href="#搭建后端架构" class="headerlink" title="搭建后端架构"></a>搭建后端架构</h2><p>后端起到的作用是提供 api 接口数据、数据库操作。</p>
<h3 id="Node-js-安装"><a href="#Node-js-安装" class="headerlink" title="Node.js 安装"></a>Node.js 安装</h3><p>官网下载安装包，默认安装即可，在 Windows 上安装时务必选择全部组件，包括勾选 <code>Add to Path</code> ，会自动添加到 <code>path</code> ，无需配置。</p>
<p><code>NPM</code> 包管理器无需额外安装，<code>Node.js</code>  有内置安装。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 验证</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> node -v</span></span><br><span class="line">v10.15.2</span><br></pre></td></tr></table></figure>
<h3 id="express-generator-生成器安装"><a href="#express-generator-生成器安装" class="headerlink" title="express-generator 生成器安装"></a>express-generator 生成器安装</h3><p>使用<code>express-generator</code> 生成器。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装 express</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i -S express-generator</span></span><br></pre></td></tr></table></figure>
<h3 id="生成基础后端架构"><a href="#生成基础后端架构" class="headerlink" title="生成基础后端架构"></a>生成基础后端架构</h3><p>使用 <code>Node</code> 开发的项目一般会使用 <code>express</code> 工具，可以使用 <code>express</code> 自行配置，或者使用 <code>express-generator</code> 生成器快速生成后端项目。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 使用 express-generator 生成器生成一个名为 project 的项目</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> express project</span></span><br></pre></td></tr></table></figure>
<p><code>express-generator</code> 生成的项目结构默认是前后端不分离的，并且是使用后端模板构建前端页面，为了适应我们的需求，将前后端项目分离，我们需要进行一定的调整。</p>
<font color="red">具体项目结构见《框架——Express生成器》。</font>

<h3 id="删除-express-内置前端模板"><a href="#删除-express-内置前端模板" class="headerlink" title="删除 express 内置前端模板"></a>删除 express 内置前端模板</h3><ul>
<li><code>views</code> 文件夹为前端模板文件夹，整个删除。</li>
<li><code>app.js</code> 文件中，删除模板引擎设置和模板引擎路径配置；删除错误处理函数中的模板渲染。</li>
<li><code>routes</code> 文件夹中的文件只提供数据。</li>
</ul>
<h3 id="后端路由管理"><a href="#后端路由管理" class="headerlink" title="后端路由管理"></a>后端路由管理</h3><p>后端路由管理工具 <code>express</code> 的 <code>Router()</code> 方法生成。使用生成器后会自动生成路由模块模板，<code>express</code> 对路由模块进行了分级管理，在 <code>app.js</code> 中进行了一级管理，将不同的模块的路由分发到不同的路由模块文件中，在路由模块文件中进行二级路由管理。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ./routes/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page. */</span></span><br><span class="line">router.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  res.send(<span class="string">'index'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>
<h3 id="body-Parser-中间件安装及配置"><a href="#body-Parser-中间件安装及配置" class="headerlink" title="body-Parser 中间件安装及配置"></a>body-Parser 中间件安装及配置</h3><p>安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i -S body-parser</span></span><br></pre></td></tr></table></figure>
<p>配置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入包</span></span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line">app.use(bodyParser.json())</span><br></pre></td></tr></table></figure>
<h3 id="cors-跨域请求"><a href="#cors-跨域请求" class="headerlink" title="cors 跨域请求"></a>cors 跨域请求</h3><p>在前后端分离的项目中，前端和后端不在同一个域内，就需要进行跨域操作。</p>
<p>我们使用 <code>cors</code> 进行跨域请求。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装 cors</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i -S cors</span></span><br></pre></td></tr></table></figure>
<p>在<strong>后端</strong>的 <code>index.js</code> 入口文件进行配置。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入包</span></span><br><span class="line"><span class="keyword">var</span> cors = <span class="built_in">require</span>(<span class="string">'cors'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 cors</span></span><br><span class="line">app.use(cors(&#123;</span><br><span class="line">  origin: [<span class="string">'http://192.168.xx.xx:6000'</span>],  <span class="comment">// 允许访问域，vue 的ip端口</span></span><br><span class="line">  methods: [<span class="string">'GET'</span>, <span class="string">'POST'</span>],   <span class="comment">// 允许 get 和 post</span></span><br><span class="line">  allowedHeaders: [<span class="string">'Content-Type'</span>, <span class="string">'Authorization'</span>]   <span class="comment">// 允许这两种请求头</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>
<h3 id="nodemon-辅助工具"><a href="#nodemon-辅助工具" class="headerlink" title="nodemon 辅助工具"></a>nodemon 辅助工具</h3><p><code>nodemon</code> 是一个基于 <code>Nodejs</code> 开发的一个第三方命令行工具，使用时需要独立安装。</p>
<p><code>nodemon</code> 工具只有一个作用：只要通过 <code>nodemon</code> 启动的服务，其文件就会被监视，当文件发生变化时(保存之后)，自动重启服务器。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装</span></span><br><span class="line">npm i -g nodemon</span><br></pre></td></tr></table></figure>
<p>安装完毕之后运行启动文件即可：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 通过 nodemon 启动服务器</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> nodemon 启动文件</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> nodemon 启动时的打印文件</span></span><br><span class="line">f:\WorkSpace\nodejs\express_demo&gt;nodemon index.js</span><br><span class="line">[nodemon] 1.18.10</span><br><span class="line">[nodemon] to restart at any time, enter `rs`</span><br><span class="line">[nodemon] watching: *.*</span><br><span class="line">[nodemon] starting `node index.js`</span><br></pre></td></tr></table></figure>
<h3 id="mongoose-数据库工具"><a href="#mongoose-数据库工具" class="headerlink" title="mongoose 数据库工具"></a>mongoose 数据库工具</h3><h4 id="数据库连接操作"><a href="#数据库连接操作" class="headerlink" title="数据库连接操作"></a>数据库连接操作</h4><p>数据库连接操作模块如下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dbUtil.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">27017</span></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'127.0.0.1'</span></span><br><span class="line"><span class="keyword">const</span> dbName = <span class="string">'vuedb'</span></span><br><span class="line"><span class="keyword">const</span> userName = <span class="string">'admin'</span></span><br><span class="line"><span class="keyword">const</span> pwd = <span class="string">'root'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 有密码</span></span><br><span class="line"><span class="keyword">const</span> dbUrl = <span class="string">`mongodb://<span class="subst">$&#123;userName&#125;</span>:<span class="subst">$&#123;pwd&#125;</span>@<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/<span class="subst">$&#123;dbName&#125;</span>`</span></span><br><span class="line"><span class="comment">// 无密码</span></span><br><span class="line"><span class="comment">// const dbUrl = `mongodb://$&#123;hostname&#125;:$&#123;port&#125;/$&#123;dbName&#125;`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 连接数据库</span></span><br><span class="line">mongoose.connect(dbUrl)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数据库连接状态对象</span></span><br><span class="line"><span class="keyword">var</span> db = mongoose.connection</span><br><span class="line">db.on(<span class="string">'error'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(dbUrl, <span class="string">' 数据库连接失败！'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">db.once(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(dbUrl, <span class="string">' 数据库连接成功！'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">db.on(<span class="string">'disconnected'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(dbUrl, <span class="string">' 数据库连接中断'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">db.on(<span class="string">'error'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(dbUrl, <span class="string">' 数据库连接异常'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = mongoose</span><br></pre></td></tr></table></figure>
<h4 id="数据库模式设计"><a href="#数据库模式设计" class="headerlink" title="数据库模式设计"></a>数据库模式设计</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GoodsSchame.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">"mongoose"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Schema = mongoose.Schema</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> GoodsSchema = <span class="keyword">new</span> Schema(&#123;</span><br><span class="line">  <span class="comment">// &#123;</span></span><br><span class="line">  <span class="comment">//   "title": "华为 HUAWEI P30",</span></span><br><span class="line">  <span class="comment">//   "publish_time": "2019-04-20T14:17:45.886Z",</span></span><br><span class="line">  <span class="comment">//   "zhaiyao": "华为 HUAWEI P30 超感光徕卡三摄麒麟980AI智能芯片全面屏屏内指纹版手机8GB+64GB亮黑色全网通双4G手机双",</span></span><br><span class="line">  <span class="comment">//   "click": 0,</span></span><br><span class="line">  <span class="comment">//   "img_url": "./public/images/huawei.jpg",</span></span><br><span class="line">  <span class="comment">//   "sell_price": 3988.00,</span></span><br><span class="line">  <span class="comment">//   "old_price": 4988.00,</span></span><br><span class="line">  <span class="comment">//   "stock_quantity": 60</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  title: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    required: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  publish_time: &#123;</span><br><span class="line">    type: <span class="built_in">Date</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="built_in">Date</span>.now</span><br><span class="line">  &#125;,</span><br><span class="line">  zhaiyao: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    required: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  click: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  img_url: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">"http://www.aijunhao.com.cn/images/2.jpg"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  sell_price: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    required: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  old_price: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span></span><br><span class="line">  &#125;,</span><br><span class="line">  stock_quantity: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = mongoose.model(<span class="string">"Good"</span>, GoodsSchema)</span><br></pre></td></tr></table></figure>
<h4 id="封装数据库异步API"><a href="#封装数据库异步API" class="headerlink" title="封装数据库异步API"></a>封装数据库异步API</h4><p>封装数据库异步API，集成所有的数据库操作，这样可以让路由模块更简洁。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// db.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 封装数据库操作</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入设计模式</span></span><br><span class="line"><span class="keyword">var</span> Goods = <span class="built_in">require</span>(<span class="string">'./models/goodsSchema.js'</span>)</span><br><span class="line"><span class="comment">// 导入数据库连接操作</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'./dbUtils'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导出回调函数</span></span><br><span class="line"><span class="comment"> * 回调函数第参数：</span></span><br><span class="line"><span class="comment"> * 		第一个：err 错误对象，如果发生错误，返回错误对象，否则为 null。</span></span><br><span class="line"><span class="comment"> *  	第二个：data 数据对象，如果发生错误，数据对象为空。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exports.findGoods = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">  Goods.find()</span><br><span class="line">    .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> callback(<span class="literal">null</span>, data)</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(err)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="路由模块调用"><a href="#路由模块调用" class="headerlink" title="路由模块调用"></a>路由模块调用</h4><p>路由模块只负责路由操作，及简单逻辑操作，数据库操作则调用数据库模块传入参数即可。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// xxx.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="comment">// 导入数据库模块</span></span><br><span class="line"><span class="keyword">var</span> Db = <span class="built_in">require</span>(<span class="string">'./db.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">'/getgoods'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  Db.findGoods(<span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      res.status(<span class="number">500</span>).send(<span class="string">'服务器错误！请重试！'</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.status(<span class="number">200</span>).send(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>
<h3 id="MySQL-模块"><a href="#MySQL-模块" class="headerlink" title="MySQL 模块"></a>MySQL 模块</h3><h4 id="使用-Promise-封装-MySQL"><a href="#使用-Promise-封装-MySQL" class="headerlink" title="使用 Promise 封装 MySQL"></a>使用 Promise 封装 MySQL</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dbConfig.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">'mysql'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 创建连接</span></span><br><span class="line"><span class="keyword">const</span> pool = mysql.createPool(&#123;</span><br><span class="line">  host: <span class="string">'120.79.254.54'</span>,</span><br><span class="line">  port: <span class="string">'3306'</span>,</span><br><span class="line">  user: <span class="string">'root'</span>,</span><br><span class="line">  password: <span class="string">'Ajh0201.'</span>,</span><br><span class="line">  database: <span class="string">'MyResume'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 进行 promise 封装</span></span><br><span class="line">exports.query = <span class="function">(<span class="params">&#123; sql, values &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    pool.getConnection(<span class="function">(<span class="params">err, connection</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        reject(err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      connection.query(sql, values, (err, result) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          reject(err)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          resolve(result)</span><br><span class="line">        &#125;</span><br><span class="line">        connection.release()</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="封装-MySQL-异步-API"><a href="#封装-MySQL-异步-API" class="headerlink" title="封装 MySQL 异步 API"></a>封装 MySQL 异步 API</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// userDB.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">'./dbConfig.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户登录</span></span><br><span class="line">exports.login = <span class="function">(<span class="params">params, callback</span>) =&gt;</span> &#123;</span><br><span class="line">  db.query(&#123;</span><br><span class="line">    sql: <span class="string">'SELECT User_Id, User_Name FROM Users WHERE Email = ?'</span>,</span><br><span class="line">    values: [params.email]</span><br><span class="line">  &#125;)</span><br><span class="line">    .then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(<span class="literal">null</span>, results)</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(err)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="部署到云服务器"><a href="#部署到云服务器" class="headerlink" title="部署到云服务器"></a>部署到云服务器</h2><p>见《阿里云服务器配置》</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/04/11/框架-全栈开发/" data-id="cjy01an1f003eosut279sqqg9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node/">Node</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/框架/">框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/移动端/">移动端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-框架-Vue-cli3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/10/框架-Vue-cli3/" class="article-date">
  <time datetime="2019-04-10T11:08:17.000Z" itemprop="datePublished">2019-04-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/10/框架-Vue-cli3/">框架-Vue-cli 3.x脚手架</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#vue-cli-3x-简介">vue-cli 3.x 简介</a></li>
<li><a href="#安装">安装</a></li>
<li><a href="#创建项目">创建项目</a><ul>
<li><a href="#代码创建">代码创建</a><ul>
<li><a href="#新建项目">新建项目</a></li>
<li><a href="#选择创建方式">选择创建方式</a></li>
<li><a href="#选择需要的配置">选择需要的配置</a><ul>
<li><a href="#路由选择">路由选择</a></li>
<li><a href="#css-预处理器选择">CSS 预处理器选择</a></li>
<li><a href="#代码风格及格式化选择">代码风格及格式化选择</a></li>
<li><a href="#语法检查时机">语法检查时机</a></li>
<li><a href="#配置文件存放位置">配置文件存放位置</a></li>
<li><a href="#单元测试方法">单元测试方法</a></li>
<li><a href="#记录这一次的配置">记录这一次的配置</a></li>
<li><a href="#使用类风格语法">使用类风格语法</a></li>
<li><a href="#使用浏览器兼容库">使用浏览器兼容库</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#图形化界面创建">图形化界面创建</a></li>
</ul>
</li>
<li><a href="#项目简介">项目简介</a><ul>
<li><a href="#public-文件夹">public 文件夹</a></li>
<li><a href="#components-文件夹">components 文件夹</a></li>
<li><a href="#view-文件夹">view 文件夹</a></li>
<li><a href="#assets-文件夹">assets 文件夹</a></li>
</ul>
</li>
<li><a href="#项目配置">项目配置</a><ul>
<li><a href="#模拟数据-mock">模拟数据 Mock</a></li>
</ul>
</li>
<li><a href="#项目运行">项目运行</a></li>
<li><a href="#构建项目">构建项目</a></li>
</ul>
<!-- /TOC -->
<h2 id="vue-cli-3-x-简介"><a href="#vue-cli-3-x-简介" class="headerlink" title="vue-cli 3.x 简介"></a>vue-cli 3.x 简介</h2><p>官网：<a href="https://cli.vuejs.org/zh/guide/" target="_blank" rel="noopener">https://cli.vuejs.org/zh/guide/</a></p>
<p><code>vue-cli</code> 称为 脚手架， 是一个基于 <code>Vue.js</code> 进行快速开发的完整系统，提供：</p>
<ul>
<li><p>通过 <code>@vue/cli</code> 搭建交互式的项目脚手架。</p>
</li>
<li><p>通过 <code>@vue/cli</code> + <code>@vue/cli-service-global</code> 快速开始零配置原型开发。</p>
</li>
<li><p>一个运行时依赖 (<code>@vue/cli-service</code>)，该依赖： </p>
<ul>
<li>可升级；</li>
<li>基于 webpack 构建，并带有合理的默认配置；</li>
<li>可以通过项目内的配置文件进行配置；</li>
<li>可以通过插件进行扩展。</li>
</ul>
</li>
<li><p>一个丰富的官方插件集合，集成了前端生态中最好的工具。</p>
</li>
<li><p>一套完全图形化的创建和管理 Vue.js 项目的用户界面。</p>
</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>先卸载 2.x 版本的 <code>vue</code> 和 <code>vue-cli</code> 。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue/cli @vue/cli-service-global</span><br></pre></td></tr></table></figure>
<p>检查版本。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue -V</span><br></pre></td></tr></table></figure>
<h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><h3 id="代码创建"><a href="#代码创建" class="headerlink" title="代码创建"></a>代码创建</h3><h4 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h4><p>先新建一个文件夹，然后进入，执行创建项目命令。项目名不能包含大写字母。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> vue create projectname</span><br></pre></td></tr></table></figure>
<h4 id="选择创建方式"><a href="#选择创建方式" class="headerlink" title="选择创建方式"></a>选择创建方式</h4><p>第一个默认选项，<code>default (babel, eslint)</code>， 快速创建一个新项目的原型，没有带任何辅助功能的  <code>npm</code> 包。</p>
<p>第二个选项，<code>Manually select features</code> ，自定义配置。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">? Please pick a preset: (Use arrow keys)</span><br><span class="line"><span class="meta">&gt;</span> default (babel, eslint)</span><br><span class="line">  Manually select features</span><br></pre></td></tr></table></figure>
<h4 id="选择需要的配置"><a href="#选择需要的配置" class="headerlink" title="选择需要的配置"></a>选择需要的配置</h4><p>按需选择。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">? Check the features needed for your project: (Press &lt;space&gt; to select, &lt;a&gt; to toggle all, &lt;i&gt; to invert selection)</span><br><span class="line"><span class="meta">&gt;</span>(*) Babel				# 转码器，可以将ES6代码转为ES5代码，从而在现有环境执行</span><br><span class="line"> ( ) TypeScript			# 使用 TypeScript 书写源码，使用 TypeScript 代替 JavaSCript</span><br><span class="line"> ( ) Progressive Web App (PWA) Support	# PWA 支持</span><br><span class="line"> (*) Router				# vue-router（前端路由）</span><br><span class="line"> (*) Vuex				# vuex（状态管理模式）</span><br><span class="line"> (*) CSS Pre-processors	# CSS 预处理器（如，less、sass、stylus）</span><br><span class="line"> (*) Linter / Formatter	# 代码风格检查和格式化（如，ESlint）</span><br><span class="line"> ( ) Unit Testing		# 单元测试</span><br><span class="line"> ( ) E2E Testing		# E2E 测试</span><br></pre></td></tr></table></figure>
<h5 id="路由选择"><a href="#路由选择" class="headerlink" title="路由选择"></a>路由选择</h5><p>选择了 <code>Router</code> 时需要配置，是否使用 <code>history route</code> 。</p>
<p>Vue-Router 利用了浏览器自身的hash 模式和 history 模式的特性来实现前端路由（通过调用浏览器提供的接口）</p>
<ul>
<li><p>hash： 浏览器url址栏 中的 # 符号（如这个 URL：<a href="http://www.abc.com/#/hello，hash" target="_blank" rel="noopener">http://www.abc.com/#/hello，hash</a> 的值为“ #/hello”），hash 不被包括在 HTTP 请求中（对后端完全没有影响），因此改变 hash 不会重新加载页面</p>
</li>
<li><p>history：利用了 HTML5 History Interface 中新增的 pushState( ) 和 replaceState( ) 方法（需要特定浏览器支持）。单页客户端应用，history mode 需要后台配置支持（详细参见：<a href="https://router.vuejs.org/zh/guide/essentials/history-mode.html）" target="_blank" rel="noopener">https://router.vuejs.org/zh/guide/essentials/history-mode.html）</a></p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? Use history mode for router? (Requires proper server setup for index fallback in production) (Y/n)</span><br></pre></td></tr></table></figure>
<p>配置之后可以在路由模块中看到 <code>mode: &#39;history&#39;</code> 。</p>
<h5 id="CSS-预处理器选择"><a href="#CSS-预处理器选择" class="headerlink" title="CSS 预处理器选择"></a>CSS 预处理器选择</h5><p>选择了 <code>CSS Pre-processors</code> 时需要配置 。</p>
<p>使用 Stylus 预处理 css，较为方便。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">? Pick a CSS pre-processor (PostCSS, Autoprefixer and CSS Modules are supported by default): (Use arrow keys)</span><br><span class="line"><span class="meta">&gt;</span> Sass/SCSS (with dart-sass)</span><br><span class="line">  Sass/SCSS (with node-sass)</span><br><span class="line">  Less</span><br><span class="line">  Stylus</span><br></pre></td></tr></table></figure>
<h5 id="代码风格及格式化选择"><a href="#代码风格及格式化选择" class="headerlink" title="代码风格及格式化选择"></a>代码风格及格式化选择</h5><p>常用的格式化是 <code>ESLint + Prettier</code> ，可以根据个人喜好或者团队开发自行选择。</p>
<ul>
<li><code>Standard</code> ：单引号，无分号格式。</li>
<li><code>Prettier</code> ：双引号，有分号格式。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 使用 ESLint + Prettier 格式化代码</span><br><span class="line">? Pick a linter / formatter config: (Use arrow keys)</span><br><span class="line"><span class="meta">&gt;</span> ESLint with error prevention only</span><br><span class="line">  ESLint + Airbnb config</span><br><span class="line">  ESLint + Standard config</span><br><span class="line">  ESLint + Prettier</span><br></pre></td></tr></table></figure>
<h5 id="语法检查时机"><a href="#语法检查时机" class="headerlink" title="语法检查时机"></a>语法检查时机</h5><p>保存时候检查或者修改提交时候检查。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">? Pick additional lint features: (Press &lt;space&gt; to select,</span><br><span class="line">&lt;a&gt; to toggle all, &lt;i&gt; to invert selection)</span><br><span class="line"><span class="meta">&gt;</span>(*) Lint on save</span><br><span class="line"> ( ) Lint and fix on commit</span><br></pre></td></tr></table></figure>
<h5 id="配置文件存放位置"><a href="#配置文件存放位置" class="headerlink" title="配置文件存放位置"></a>配置文件存放位置</h5><p>单独存放或者放到 <code>package.json</code> 配置文件中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">? Where do you prefer placing config for Babel, PostCSS, ESLint, etc.? (Use arrow keys)</span><br><span class="line"><span class="meta">&gt;</span> In dedicated config files</span><br><span class="line">  In package.json</span><br></pre></td></tr></table></figure>
<h5 id="单元测试方法"><a href="#单元测试方法" class="headerlink" title="单元测试方法"></a>单元测试方法</h5><p>配置了之后，项目根目录会出现 <code>tests</code> 文件夹。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 单元测试，Mocha + Chai</span><br><span class="line">? Pick a unit testing solution: (Use arrow keys)</span><br><span class="line"><span class="meta">&gt;</span> Mocha + Chai</span><br><span class="line">  Jest</span><br></pre></td></tr></table></figure>
<h5 id="记录这一次的配置"><a href="#记录这一次的配置" class="headerlink" title="记录这一次的配置"></a>记录这一次的配置</h5><p>如果记录，则下次创建会使用当前的配置。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? Save this as a preset for future projects? (y/N)</span><br></pre></td></tr></table></figure>
<h5 id="使用类风格语法"><a href="#使用类风格语法" class="headerlink" title="使用类风格语法"></a>使用类风格语法</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? Use class-style component syntax? (Y/n)</span><br></pre></td></tr></table></figure>
<h5 id="使用浏览器兼容库"><a href="#使用浏览器兼容库" class="headerlink" title="使用浏览器兼容库"></a>使用浏览器兼容库</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? Use Babel alongside TypeScript for auto-detected polyfills? (Y/n)</span><br></pre></td></tr></table></figure>
<h3 id="图形化界面创建"><a href="#图形化界面创建" class="headerlink" title="图形化界面创建"></a>图形化界面创建</h3><p>还有一种就是用 <code>UI</code> 界面来创建。输入命令，会以浏览器的方式创建项目。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> vue ui</span><br></pre></td></tr></table></figure>
<p>图形化界面会引导我们创建，比较简单。</p>
<p><img src="/2019/04/10/框架-Vue-cli3/图形化界面.JPG" alt="图形化界面.JPG"></p>
<p><img src="/2019/04/10/框架-Vue-cli3/创建项目.JPG" alt="创建项目.JPG"></p>
<p><img src="/2019/04/10/框架-Vue-cli3/预设.JPG" alt="预设.JPG"></p>
<p><img src="/2019/04/10/框架-Vue-cli3/功能.JPG" alt="功能.JPG"></p>
<p><img src="/2019/04/10/框架-Vue-cli3/配置.JPG" alt="配置.JPG"></p>
<p><img src="/2019/04/10/框架-Vue-cli3/安装.JPG" alt="安装.JPG"></p>
<p><img src="/2019/04/10/框架-Vue-cli3/下载.JPG" alt="下载.JPG"></p>
<h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><p>如下，这是通过 <code>vue-cli 3.x</code> 创建的完整项目目录。</p>
<p><img src="/2019/04/10/框架-Vue-cli3/项目目录.JPG" alt="项目目录.JPG"></p>
<h3 id="public-文件夹"><a href="#public-文件夹" class="headerlink" title="public 文件夹"></a>public 文件夹</h3><p><code>public/index.html</code> 文件是被 <a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener">html-webpack-plugin</a> 处理的模板。</p>
<p>里面放的是一些静态资源。较大的图片之类，打包时不会被打包在一起。</p>
<h3 id="components-文件夹"><a href="#components-文件夹" class="headerlink" title="components 文件夹"></a>components 文件夹</h3><p>里面放的是一些可复用组件，是 <code>.vue</code> 文件。</p>
<h3 id="view-文件夹"><a href="#view-文件夹" class="headerlink" title="view 文件夹"></a>view 文件夹</h3><p>里面放的是页面，也是 <code>.vue</code> 文件，和 <code>components</code> 文件中的内容没有本质的区别，只是一个放的是组件，一个放的是页面。</p>
<h3 id="assets-文件夹"><a href="#assets-文件夹" class="headerlink" title="assets 文件夹"></a>assets 文件夹</h3><p>放的是一些组件静态资源，打包时会被打包在一起，而 <code>public</code> 中的静态资源不会。</p>
<h2 id="项目配置"><a href="#项目配置" class="headerlink" title="项目配置"></a>项目配置</h2><p>默认创建的项目并不是非常完善，有一些配置需要我们自行操作。<code>vue.config.js</code> 项目配置文件，在项目根目录，需要我们手动创建。</p>
<p>注意这里 <code>publicPath</code> 必须设置，不然发布项目会找到不资源。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js vue 项目配置文件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 基本路径配置，即原先的 baseUrl，默认是 '/'，如果改成 './' 会出现 history 模式下刷新空白问题</span></span><br><span class="line">  publicPath: <span class="string">'/'</span>,</span><br><span class="line">  <span class="comment">// 打包文件输出目录</span></span><br><span class="line">  outputDir: <span class="string">'dist'</span>,</span><br><span class="line">  <span class="comment">// 打包之后静态资源的目录</span></span><br><span class="line">  assetsDir: <span class="string">'assets'</span>,</span><br><span class="line">  <span class="comment">// 是否使用eslint</span></span><br><span class="line">  lintOnSave: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// webpack-dev-server 相关配置</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    <span class="comment">// 运行项目后自动打开浏览器</span></span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 服务器地址</span></span><br><span class="line">    host: <span class="string">'0.0.0.0'</span>,</span><br><span class="line">    <span class="comment">// 端口号</span></span><br><span class="line">    port: <span class="number">8000</span>,</span><br><span class="line">    https: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 热更新</span></span><br><span class="line">    hotOnly: <span class="literal">false</span></span><br><span class="line">    <span class="comment">// 跨域请求</span></span><br><span class="line">    <span class="comment">// proxy: &#123;</span></span><br><span class="line">    <span class="comment">//   '/': &#123;</span></span><br><span class="line">    <span class="comment">//     target: 'http://127.0.0.1:5000',</span></span><br><span class="line">    <span class="comment">//     ws: false,</span></span><br><span class="line">    <span class="comment">//     changeOrigin: true</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 第三方插件配置</span></span><br><span class="line">  pluginOptions: &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 热更新配置</span></span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 修复HMR</span></span><br><span class="line">    config.resolve.symlinks(<span class="literal">true</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  css: &#123;</span><br><span class="line">    <span class="comment">// 是否使用css分离插件 ExtractTextPlugin，开发 false，打包 true</span></span><br><span class="line">    extract: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 开启 CSS source maps?</span></span><br><span class="line">    sourceMap: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// css预设器配置项</span></span><br><span class="line">    loaderOptions: &#123;&#125;,</span><br><span class="line">    <span class="comment">// 启用 CSS modules for all css / pre-processor files.</span></span><br><span class="line">    modules: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> debug = process.env.NODE_ENV !== <span class="string">'production'</span></span><br><span class="line"><span class="comment">//const VueConf = require('./src/assets/js/libs/vue_config_class')</span></span><br><span class="line"><span class="comment">//const vueConf = new VueConf(process.argv)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    baseUrl: <span class="string">'./'</span>, <span class="comment">//vueConf.baseUrl, // 根域上下文目录</span></span><br><span class="line">    outputDir: <span class="string">'dist'</span>, <span class="comment">// 构建输出目录</span></span><br><span class="line">    assetsDir: <span class="string">'assets'</span>, <span class="comment">// 静态资源目录 (js, css, img, fonts)</span></span><br><span class="line">    lintOnSave: <span class="literal">true</span>, <span class="comment">// 是否开启eslint保存检测，有效值：ture | false | 'error'</span></span><br><span class="line">    runtimeCompiler: <span class="literal">true</span>, <span class="comment">// 运行时版本是否需要编译</span></span><br><span class="line">    transpileDependencies: [], <span class="comment">// 默认babel-loader忽略mode_modules，这里可增加例外的依赖包名</span></span><br><span class="line">    productionSourceMap: <span class="literal">false</span>, <span class="comment">// 是否在构建生产包时生成 sourceMap 文件，false将提高构建速度</span></span><br><span class="line">    css: &#123; <span class="comment">// 配置高于chainWebpack中关于css loader的配置</span></span><br><span class="line">        <span class="comment">// modules: true, // 是否开启支持‘foo.module.css’样式</span></span><br><span class="line">        <span class="comment">// extract: true, // 是否使用css分离插件 ExtractTextPlugin，采用独立样式文件载入，不采用&lt;style&gt;方式内联至html文件中</span></span><br><span class="line">        sourceMap: <span class="literal">false</span>, <span class="comment">// 是否在构建样式地图，false将提高构建速度</span></span><br><span class="line">        loaderOptions: &#123; <span class="comment">// css预设器配置项</span></span><br><span class="line">            sass: &#123;</span><br><span class="line">                data: <span class="string">''</span><span class="comment">//`@import "@/assets/scss/mixin.scss";`</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    parallel: <span class="built_in">require</span>(<span class="string">'os'</span>).cpus().length &gt; <span class="number">1</span>, <span class="comment">// 构建时开启多进程处理babel编译</span></span><br><span class="line">    pluginOptions: &#123; <span class="comment">// 第三方插件配置</span></span><br><span class="line">    &#125;,</span><br><span class="line">    pwa: &#123; <span class="comment">// 单页插件相关配置 https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-pwa</span></span><br><span class="line">    &#125;,</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        open: <span class="literal">true</span>,</span><br><span class="line">        host: <span class="string">'0.0.0.0'</span>,</span><br><span class="line">        port: <span class="number">8080</span>,</span><br><span class="line">        https: <span class="literal">false</span>,</span><br><span class="line">        hotOnly: <span class="literal">false</span>,</span><br><span class="line">        proxy: <span class="literal">null</span>,</span><br><span class="line">        <span class="comment">// proxy: &#123;</span></span><br><span class="line">        <span class="comment">//     '/api': &#123;</span></span><br><span class="line">        <span class="comment">//         target: '&lt;url&gt;',</span></span><br><span class="line">        <span class="comment">//         ws: true,</span></span><br><span class="line">        <span class="comment">//         changOrigin: true</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line">        <span class="comment">// &#125;,</span></span><br><span class="line">        before: <span class="function"><span class="params">app</span> =&gt;</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="模拟数据-Mock"><a href="#模拟数据-Mock" class="headerlink" title="模拟数据 Mock"></a>模拟数据 Mock</h3><p>在没有后端的情况下使用 <code>Mock</code> 模拟数据方便开发。</p>
<p>在跟目录下新建 <code>mock</code> 文件夹，里面放置一些 <code>json</code> 文件，用来模拟后端数据，注意要保持和真实数据格式相同才行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 json 文件</span></span><br><span class="line"><span class="keyword">const</span> mockData = <span class="built_in">require</span>(<span class="string">'./mock/data.json'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// 配置接口</span></span><br><span class="line">    before (app) &#123;</span><br><span class="line">      app.get(<span class="string">'/api/data'</span>, (req, res) =&gt; &#123;</span><br><span class="line">        res.json(mockData)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// app.vue</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;&#123;&#123; json &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      json: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.getData()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    getData() &#123;</span><br><span class="line">      // 使用 axios 访问请求</span><br><span class="line">      this.$axios</span><br><span class="line">        .get(&apos;/api/data&apos;)</span><br><span class="line">        .then(data =&gt; &#123;</span><br><span class="line">          this.json = data</span><br><span class="line">          console.log(data)</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(err =&gt; &#123;</span><br><span class="line">          console.log(&apos;错误&apos;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="项目运行"><a href="#项目运行" class="headerlink" title="项目运行"></a>项目运行</h2><p>选完配置后，开始下载安装。完成后就能可以进入文件夹直接运行了，给我们有一个初始的页面。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> cd vue-project</span><br><span class="line"><span class="meta">&gt;</span> npm run serve</span><br></pre></td></tr></table></figure>
<p>页面支持实时预览功能。</p>
<h2 id="构建项目"><a href="#构建项目" class="headerlink" title="构建项目"></a>构建项目</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>
<p>构建完之后就能在 <code>dist</code> 目录中查看我们的项目了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/04/10/框架-Vue-cli3/" data-id="cjy01an0j0037osutk5n3909h" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/框架/">框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/移动端/">移动端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-框架-Vuejs-模块化开发" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/04/框架-Vuejs-模块化开发/" class="article-date">
  <time datetime="2019-04-04T13:20:46.000Z" itemprop="datePublished">2019-04-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/04/框架-Vuejs-模块化开发/">框架-Vuejs-Webpack模块化开发</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#项目简介">项目简介</a><ul>
<li><a href="#在网页中常见的静态资源">在网页中常见的静态资源</a></li>
<li><a href="#网页中引入静态资源出现的问题">网页中引入静态资源出现的问题</a></li>
<li><a href="#优化方式">优化方式</a></li>
</ul>
</li>
<li><a href="#webpack-简介">Webpack 简介</a><ul>
<li><a href="#webpack-常用命令总结">Webpack 常用命令总结</a></li>
</ul>
</li>
<li><a href="#开发环境搭建">开发环境搭建</a><ul>
<li><a href="#项目目录结构">项目目录结构</a></li>
<li><a href="#npm-初始化项目">npm 初始化项目</a></li>
<li><a href="#webpack">webpack</a><ul>
<li><a href="#webpack-安装">webpack 安装</a></li>
<li><a href="#webpack-验证">webpack 验证</a></li>
<li><a href="#创建-webpack-配置文件">创建 webpack 配置文件</a></li>
<li><a href="#js-入口文件使用">JS 入口文件使用</a></li>
</ul>
</li>
<li><a href="#webpack-dev-server-服务器">webpack-dev-server 服务器</a><ul>
<li><a href="#webpack-dev-server-安装">webpack-dev-server 安装</a></li>
<li><a href="#配置-webpack-dev-server--服务器">配置 webpack-dev-server  服务器</a></li>
<li><a href="#启动服务器">启动服务器</a></li>
</ul>
</li>
<li><a href="#html-webpack-plugin-插件">html-webpack-plugin 插件</a><ul>
<li><a href="#html-webpack-plugin-安装">html-webpack-plugin 安装</a></li>
<li><a href="#配置-html-webpack-plugin-插件">配置 html-webpack-plugin 插件</a></li>
</ul>
</li>
<li><a href="#静态资源第三方模块加载器">静态资源第三方模块加载器</a><ul>
<li><a href="#第三方模块加载器匹配规则总合">第三方模块加载器匹配规则总合</a></li>
<li><a href="#加载css-样式">加载CSS 样式</a><ul>
<li><a href="#配置">配置</a></li>
<li><a href="#使用">使用</a></li>
</ul>
</li>
<li><a href="#加载图片">加载图片</a><ul>
<li><a href="#配置-1">配置</a></li>
<li><a href="#使用-1">使用</a></li>
</ul>
</li>
<li><a href="#加载字体">加载字体</a><ul>
<li><a href="#配置-2">配置</a></li>
<li><a href="#使用-2">使用</a></li>
</ul>
</li>
<li><a href="#加载-vue">加载 vue</a><ul>
<li><a href="#vue-包下载">Vue 包下载</a></li>
<li><a href="#导入-vuejs-文件">导入 <code>vue.js</code> 文件</a></li>
<li><a href="#vue-文件"><code>.vue</code> 文件</a></li>
<li><a href="#vue-组件加载器下载">Vue 组件加载器下载</a></li>
<li><a href="#配置插件及配置规则">配置插件及配置规则</a></li>
<li><a href="#vue-文件使用"><code>.vue</code> 文件使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#vue-router-路由抽离">vue-router 路由抽离</a><ul>
<li><a href="#安装">安装</a></li>
<li><a href="#导入-vue-router-包">导入 <code>vue-router</code> 包</a></li>
</ul>
</li>
<li><a href="#页面">页面</a></li>
<li><a href="#服务器浏览">服务器浏览</a></li>
<li><a href="#打包">打包</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<font color="red">注意：此节使用 Webpack 打包工具，纯手动创建开发环境，只做了解即可，目前的 Vue 开发都使用 Vue-cli 脚手架工具，里面集成了文本讲的内容。</font>



<h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><h3 id="在网页中常见的静态资源"><a href="#在网页中常见的静态资源" class="headerlink" title="在网页中常见的静态资源"></a>在网页中常见的静态资源</h3><ul>
<li><p><code>JS</code> 脚本</p>
<ul>
<li><code>.JS</code> 、<code>.jsx</code> 、<code>.coffee</code> 、<code>.ts</code> （<code>TypeScript</code> 类 <code>C#</code> 语言） </li>
</ul>
</li>
<li><p><code>CSS</code> 样式文件</p>
<ul>
<li><code>.css</code>、<code>.less</code>、<code>.sass</code>、<code>.scss</code></li>
</ul>
</li>
<li><code>Images</code> 图片<ul>
<li><code>.jpg</code>、<code>.png</code>、<code>.gif</code>、<code>.bmp</code>、<code>.svg</code></li>
</ul>
</li>
<li><code>Fonts</code> 字体文件<ul>
<li><code>.svg</code>、<code>.tff</code>、<code>.eot</code>、<code>.woff</code>、<code>.woff2</code></li>
</ul>
</li>
<li>模板文件<ul>
<li><code>。ejs</code>、<code>.jade</code>、<code>.vue</code> （<code>webpack</code> 中定义的组件方式，推荐使用）</li>
</ul>
</li>
</ul>
<h3 id="网页中引入静态资源出现的问题"><a href="#网页中引入静态资源出现的问题" class="headerlink" title="网页中引入静态资源出现的问题"></a>网页中引入静态资源出现的问题</h3><ul>
<li>发个静态资源都需要发送请求获取，发起多个二次请求，网页加载速度变慢。</li>
<li>要处理多个错综复杂的依赖关系。</li>
</ul>
<h3 id="优化方式"><a href="#优化方式" class="headerlink" title="优化方式"></a>优化方式</h3><p>对于二次请求问题：</p>
<ul>
<li>合并：可以减少 <code>JS</code> 和 <code>CSS</code> 文件的二次请求，</li>
<li>压缩：能提高 <code>JS</code> 和 <code>CSS</code> 文件的加载速度。</li>
<li>压缩：</li>
<li>精灵图：将一些小图片图标合成一张图片，这样只需要发送一次请求就能获取大量图片。</li>
<li>图片的 <code>Base64</code> 编码：一些小图片可以使用 <code>Base64</code> 编码写入文件中，这样就不需要额外的二次请求。</li>
</ul>
<p>对于文件依赖问题：</p>
<ul>
<li>使用 <code>requestJS</code> 或者 <code>webpack</code> 解决各个包之间的依赖关系。</li>
</ul>
<h2 id="Webpack-简介"><a href="#Webpack-简介" class="headerlink" title="Webpack 简介"></a>Webpack 简介</h2><p>本质上，<code>webpack</code> 是一个现代 <code>JavaScript</code> 应用程序的<strong>静态模块打包器(module bundler)</strong>。是基于 <code>Node.js</code> 开发的一个前端项目开发工具。</p>
<p>此处使用的是 <code>webpack4.x</code> 版本</p>
<p><code>github</code> 源码：<a href="https://github.com/webpack/webpack" target="_blank" rel="noopener">https://github.com/webpack/webpack</a></p>
<p>中文官网： <a href="https://www.webpackjs.com/" target="_blank" rel="noopener">https://www.webpackjs.com/</a></p>
<p><code>webpack</code> 中文文档：<a href="https://www.webpackjs.com/concepts/" target="_blank" rel="noopener">https://www.webpackjs.com/concepts/</a></p>
<h3 id="Webpack-常用命令总结"><a href="#Webpack-常用命令总结" class="headerlink" title="Webpack 常用命令总结"></a>Webpack 常用命令总结</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm install webpack -g   // 全局安装webpack</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm init -y              //初始化默认的package.json文件</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm install webpack --save-dev   //下载webpack插件到node_modules 并在package.json文件中加上webpack的配置内容</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> webpack    //对项目进行打包</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> webpack   --watch   // 自动监控文件的改变</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> webpack  --display-modules  //打包时显示隐藏的模块</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> webpack  --display-chunks   //打包时显示chunks</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> webpack  --display-error-details  //显示详细错误信息</span></span><br></pre></td></tr></table></figure>
<h2 id="开发环境搭建"><a href="#开发环境搭建" class="headerlink" title="开发环境搭建"></a>开发环境搭建</h2><h3 id="项目目录结构"><a href="#项目目录结构" class="headerlink" title="项目目录结构"></a>项目目录结构</h3><p>项目文件夹目录如下。</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">project:</span><br><span class="line"></span><br><span class="line">|-- dist				# 用来存放编译打包好的文件，是供浏览器读取的文件。</span><br><span class="line">	|-- bundle.js		# 打包、编译、压缩好的 js 文件</span><br><span class="line">|-- node_modules		# 第三方拓展文件夹</span><br><span class="line">|-- src					# 资源问价夹，用来存放源码文件</span><br><span class="line">	|-- css				# 样式文件夹</span><br><span class="line">	|-- js				# js脚本文件夹</span><br><span class="line">	|-- images			# 图片资源文件夹</span><br><span class="line">	|-- components		# .vue 组件文件夹</span><br><span class="line">		|-- App.vue		# 主页面</span><br><span class="line">	|-- index.js		# 项目入口文件</span><br><span class="line">	|-- index.html		# 单页面文件</span><br><span class="line">|-- package.json		# npm 初始化项目配置文件</span><br><span class="line">|-- package-lock.json	# npm 初始化更详细的项目配置文件</span><br><span class="line">|-- webpack-config.js	# webpack 配置文件</span><br></pre></td></tr></table></figure>
<h3 id="npm-初始化项目"><a href="#npm-初始化项目" class="headerlink" title="npm 初始化项目"></a>npm 初始化项目</h3><p>新建项目文件夹，<code>cd</code> 至文件夹中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 初始化项目</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm init -y</span></span><br></pre></td></tr></table></figure>
<p>生成 <code>package.json</code> 和 <code>package-lock.json</code></p>
<h3 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h3><p><code>webpack</code> 是用来打包 <code>js</code> 文件的。</p>
<h4 id="webpack-安装"><a href="#webpack-安装" class="headerlink" title="webpack 安装"></a>webpack 安装</h4><p>因为它是一个工具，所以我们需要安装。全局安装或者局部安装都行，官网推荐局部安装。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 全局安装</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i webpack -g</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果你使用 webpack 4+ 版本，你还需要安装 CLI。</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i webpack-cli -g</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 局部安装，并添加到工具依赖中</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i webpack webpack-cli --save-dev</span></span><br></pre></td></tr></table></figure>
<h4 id="webpack-验证"><a href="#webpack-验证" class="headerlink" title="webpack 验证"></a>webpack 验证</h4><p>安装成功后，查看版本号验证一下。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 全局</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> webpack -v</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 局部，先切换到项目文件夹下</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> .\node_modules\.bin\webpack -v</span></span><br></pre></td></tr></table></figure>
<p>此时在 <code>package.json</code> 文件中会出现 <code>devDependencies</code> 工具依赖。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"src"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"keywords"</span>: [],</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  // 工具依赖</span><br><span class="line">  "devDependencies": &#123;</span><br><span class="line">    "webpack": "^4.29.6",</span><br><span class="line">    "webpack-cli": "^3.3.0"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="创建-webpack-配置文件"><a href="#创建-webpack-配置文件" class="headerlink" title="创建 webpack 配置文件"></a>创建 webpack 配置文件</h4><p><code>webpack4.x</code> 中 <code>webpack.config.js</code> 这样的配置文件不是必须的，但是推荐使用。 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="comment">// 默认入口文件是 `./src/index.js` ，默认输出文件 `./dist/main.js` 。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="JS-入口文件使用"><a href="#JS-入口文件使用" class="headerlink" title="JS 入口文件使用"></a>JS 入口文件使用</h4><p>默认入口文件 <code>src/index.js</code> 。是整个项目的主文件，在这个文件中可以使用 <code>ES6</code> 、<code>node</code> 等高级语法，所有需要的资源都需要导入到这个文件中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// es6 语法导入</span></span><br><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">'jquery'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// node 语法导入</span></span><br><span class="line"><span class="keyword">const</span> Vue = <span class="built_in">require</span>(<span class="string">'Vue'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体操作使用</span></span><br></pre></td></tr></table></figure>
<h3 id="webpack-dev-server-服务器"><a href="#webpack-dev-server-服务器" class="headerlink" title="webpack-dev-server 服务器"></a>webpack-dev-server 服务器</h3><p><code>webpack-dev-server</code> 提供了一个简单的 web 服务器，并且能够实时重新加载。运行服务器之后会自动生成<strong>虚拟</strong>的 <code>bundle.js</code> 出口文件，用于测试，每当入口文件修改后保存时，会自动更新<strong>虚拟</strong>的 <code>bundle.js</code> 。</p>
<p>这个<strong>虚拟</strong>的 <code>bundle.js</code> 文件并没有存放到物理磁盘中，而是直接托管到了电脑的内存中，我们可以使用服务器地址来访问（<code>/bundle.js</code>）。</p>
<h4 id="webpack-dev-server-安装"><a href="#webpack-dev-server-安装" class="headerlink" title="webpack-dev-server 安装"></a>webpack-dev-server 安装</h4><p>这个工具依赖于 <code>webpack</code> 工具，所以在使用的时候强制要求在本地安装 <code>webpack</code> 。使用局部安装即可。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i webpack-dev-server --save-dev</span></span><br></pre></td></tr></table></figure>
<h4 id="配置-webpack-dev-server-服务器"><a href="#配置-webpack-dev-server-服务器" class="headerlink" title="配置 webpack-dev-server  服务器"></a>配置 webpack-dev-server  服务器</h4><p>服务器需要配置以下几个参数：</p>
<ul>
<li><code>open</code> : 是否自动打开浏览器。默认 <code>false</code> 。</li>
<li><code>port</code> : 端口号。默认 <code>8080</code>。</li>
<li><code>contentBase</code> : 打开路径。默认根路径。</li>
<li><code>hot</code> : 是否热刷新，对 <code>css</code> 样式有效。默认 <code>false</code> 。</li>
</ul>
<p><strong>方法一（推荐）</strong></p>
<p>在 <code>package.json</code> 中添加 <code>script</code> 脚本。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"src"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    // 配置服务器 dev</span><br><span class="line">    "dev": "webpack-dev-server --open --port 4000 --contentBase dist --hot",</span><br><span class="line">  &#125;,</span><br><span class="line">  "keywords": [],</span><br><span class="line">  "author": "",</span><br><span class="line">  "license": "ISC",</span><br><span class="line">  // 工具依赖</span><br><span class="line">  "devDependencies": &#123;</span><br><span class="line">    "webpack": "^4.29.6",</span><br><span class="line">    "webpack-cli": "^3.3.0",</span><br><span class="line">    "webpack-dev-server": "^3.2.1"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>方法二（不推荐）</strong></p>
<p> 在 <code>webpack.config.js</code> 配置文件中配置服务器。</p>
<p>如果只在 <code>package.json</code> 中配置了服务器名 <code>&quot;dev&quot;: &quot;webpack-dev-server&quot;</code>，而在 <code>webpack.config.js</code> 中配置其他信息，需要这样写。比较麻烦，不推荐。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">// 导入 webpack 为了启动热更新</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    open: <span class="literal">true</span>, <span class="comment">// 自动打开浏览器</span></span><br><span class="line">    port: <span class="number">4000</span>, <span class="comment">// 配置端口</span></span><br><span class="line">    contentBase: <span class="string">'dist'</span>, <span class="comment">// 配置打开路径</span></span><br><span class="line">    hot: <span class="literal">true</span> <span class="comment">// 需要用 webpack 来配置</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 添加插件</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// new 一个热更新模块对象，启动热更新</span></span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="启动服务器"><a href="#启动服务器" class="headerlink" title="启动服务器"></a>启动服务器</h4><p>等所有工具插件及 <code>src</code> 静态文件都编辑好之后，使用如下命令启动，进行测试。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm run dev</span></span><br></pre></td></tr></table></figure>
<h3 id="html-webpack-plugin-插件"><a href="#html-webpack-plugin-插件" class="headerlink" title="html-webpack-plugin 插件"></a>html-webpack-plugin 插件</h3><p><code>html-webpack-plugin</code> 插件的功能是根据指定页面生成<strong>虚拟</strong>的 <code>html</code> 页面，并导入 <code>bundle.js</code> 文件。</p>
<p>与 <code>webpack-dev-server</code> 类似，文件都没有存放到物理磁盘中，而是直接托管到了电脑的内存中。使用 <code>html-webpack-plugin</code> 插件生成的这个 <code>html</code> 页面会自动在尾部导入  <code>webpack-dev-server</code> 生成的 <code>bundle.js</code> 文件。</p>
<h4 id="html-webpack-plugin-安装"><a href="#html-webpack-plugin-安装" class="headerlink" title="html-webpack-plugin 安装"></a>html-webpack-plugin 安装</h4><p>使用局部安装即可。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i html-webpack-plugin --save-dev</span></span><br></pre></td></tr></table></figure>
<h4 id="配置-html-webpack-plugin-插件"><a href="#配置-html-webpack-plugin-插件" class="headerlink" title="配置 html-webpack-plugin 插件"></a>配置 html-webpack-plugin 插件</h4><p>配置插件需要在 <code>webpack.config.js</code> 中进行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">// 为了启动热更新</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="comment">// 导入在内存中生成 html 页面的插件</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    open: <span class="literal">true</span>, <span class="comment">// 自动打开浏览器</span></span><br><span class="line">    port: <span class="number">4000</span>, <span class="comment">// 配置端口</span></span><br><span class="line">    contentBase: <span class="string">'./dist'</span>, <span class="comment">// 打开路径</span></span><br><span class="line">    hot: <span class="literal">true</span> <span class="comment">// 需要用 webpack 来配置</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// new 一个热更新模块对象，启动热更新</span></span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">    <span class="comment">// 创建一个再内存中生成 html 的插件对象</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      <span class="comment">// 指定模板页面，会根据指定的页面路径去生成内存中的页面</span></span><br><span class="line">      template: path.join(__dirname, <span class="string">'./src/index.html'</span>),</span><br><span class="line">      <span class="comment">// 指定生成页面的名称</span></span><br><span class="line">      filename: <span class="string">'index.html'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="静态资源第三方模块加载器"><a href="#静态资源第三方模块加载器" class="headerlink" title="静态资源第三方模块加载器"></a>静态资源第三方模块加载器</h3><p><code>webpack</code> 只能处理 <code>js</code> 类型的文件，其他的静态资源都需要通过第三方模块来加载，然后导入到入口文件中给 <code>webpack</code> 处理。所有第三方模块加载器都是以 <code>-loader</code> 结尾的。</p>
<p>第三方模块加载器安装及配置就以下两步。</p>
<ul>
<li>下载并添加到工具依赖。</li>
<li>在 <code>webpack.config.js</code> 文件的 <code>module</code> 中添加配置匹配规则。</li>
</ul>
<p><code>webpack</code> 处理第三方文件类型的过程：</p>
<ol>
<li>在入口文件中发现要处理的不是 <code>JS</code> 文件，就去配置文件中查找对应的第三方 <code>loader</code> 规则。</li>
<li>如果能找到对应的规则，则调用对应的 <code>loader</code> 处理这种文件类型。</li>
<li>在调用 <code>loader</code> 的时候，从后往前调用。</li>
<li>当最后一个 <code>loader</code> 调用完毕，将处理结果交给 <code>webpack</code> 进行打包合并，最终输出到出口文件 <code>bundle.js</code> 中。</li>
</ol>
<h4 id="第三方模块加载器匹配规则总合"><a href="#第三方模块加载器匹配规则总合" class="headerlink" title="第三方模块加载器匹配规则总合"></a>第三方模块加载器匹配规则总合</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.confing.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// 配置所有第三方模块加载器</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 匹配规则</span></span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// 处理 .vue 模板文件</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.vue$/</span>, <span class="attr">use</span>: <span class="string">'vue-loader'</span> &#125;,</span><br><span class="line">      <span class="comment">// 处理 css 样式</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,</span><br><span class="line">      <span class="comment">// 处理 less 样式</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">      <span class="comment">// 处理 scss 样式</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.sass$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;,</span><br><span class="line">      <span class="comment">// 处理图片</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|svg|jpg|gif)$/</span>, <span class="attr">use</span>: [<span class="string">'url-loader'</span>] &#125;,</span><br><span class="line">      <span class="comment">// 处理字体</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.(woff|woff2|eot|ttf|otf|svg)$/</span>, <span class="attr">use</span>: [<span class="string">'url-loader'</span>] &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="加载CSS-样式"><a href="#加载CSS-样式" class="headerlink" title="加载CSS 样式"></a>加载CSS 样式</h4><p><code>css</code> 样式需要添加 <code>style-loader</code> 和 <code>css-loader</code> 工具。如果是 <code>less</code> 、<code>sass</code> 文件，也一样。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm install --save-dev style-loader css-loader</span></span><br></pre></td></tr></table></figure>
<h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.confing.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// 配置所有第三方模块加载器</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 匹配规则</span></span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// 处理 css 样式</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,</span><br><span class="line">      <span class="comment">// 处理 less 样式</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">      <span class="comment">// 处理 scss 样式</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.sass$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><p>样式文件只需要导入到入口文件即可，不需要做其他操作。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 css 样式文件</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./src/indes.js'</span></span><br></pre></td></tr></table></figure>
<h4 id="加载图片"><a href="#加载图片" class="headerlink" title="加载图片"></a>加载图片</h4><p>背景和图标这些小图片需要添加 <code>file-loader</code> 或则 <code>url-loader</code> 工具，可以轻松地将这些内容混到 <code>css</code> 中。 <code>url-loader</code> 内置了 <code>file-loader</code> 。</p>
<p><code>url-loader</code> 有一个 <code>limit</code> 参数：</p>
<ol>
<li><p>文件大小小于 <code>limit</code> 参数，<code>url-loader</code> 将会把文件转为 <code>base64</code> 格式的图片；</p>
</li>
<li><p>文件大小大于 <code>limit</code> ，<code>url-loader</code> 会调用 <code>file-loader</code> 进行处理，使用原先的图片格式。</p>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev url-loader</span><br></pre></td></tr></table></figure>
<h5 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.confing.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// 配置所有第三方模块加载器</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 匹配规则</span></span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// 图片，使用 limit 来限制是否转 base64，图片名为：哈希值前8位-图片名.后缀名</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|svg|jpg|gif)$/</span>, <span class="attr">use</span>: [<span class="string">'url-loader?limit=1000&amp;name=[hash:8]-[name].[ext]'</span>] &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h5><p>在样式表中使用图片。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// index.css</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">'../images/image.jpg'</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在入口文件导入样式表。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 css 样式文件</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./src/indes.js'</span></span><br></pre></td></tr></table></figure>
<h4 id="加载字体"><a href="#加载字体" class="headerlink" title="加载字体"></a>加载字体</h4><p><code>file-loader</code> 和 <code>url-loader</code> 可以接收并加载任何文件，然后将其输出到构建目录。这就是说，我们可以将它们用于任何类型的文件，包括字体。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm install --save-dev url-loader</span></span><br></pre></td></tr></table></figure>
<h5 id="配置-2"><a href="#配置-2" class="headerlink" title="配置"></a>配置</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.confing.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// 配置所有第三方模块加载器</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 匹配规则</span></span><br><span class="line">    rules: [</span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.(woff|woff2|eot|ttf|otf|svg)$/</span>, <span class="attr">use</span>: [<span class="string">'url-loader'</span>] &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="使用-2"><a href="#使用-2" class="headerlink" title="使用"></a>使用</h5><p>我们用 <code>bootstrap</code> 中的图标字体来演示。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// indes.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'bootstrap/dist/css/bootstrap.css'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-search"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="加载-vue"><a href="#加载-vue" class="headerlink" title="加载 vue"></a>加载 vue</h4><h5 id="Vue-包下载"><a href="#Vue-包下载" class="headerlink" title="Vue 包下载"></a>Vue 包下载</h5><p>使用 <code>Vue</code> ，就需要 <code>Vue.js</code> 文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 先下载 vue 包</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i vue -S</span></span><br></pre></td></tr></table></figure>
<h5 id="导入-vue-js-文件"><a href="#导入-vue-js-文件" class="headerlink" title="导入 vue.js 文件"></a>导入 <code>vue.js</code> 文件</h5><p>原先基础的 <code>vue</code> 代码是写在 <code>script</code> 中，所以文件分离之后 <code>vue</code> 代码写在 <code>index.js</code> 项目入口文件中。首先需要导入 <code>vue.js</code> 包。</p>
<p>导包有两种方式：</p>
<ul>
<li><p>第一种是直接引入项目，在项目文件中有会帮我们导入默认的项目文件。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br></pre></td></tr></table></figure>
<p>  注意这种方式，项目默认导入的包是 <code>vue.runtime.common.js</code> ，这是<strong>进行时</strong>的包，并不是我们在网页中使用的包（<code>vue.js</code>），缺少一部分内容。开发中我们需要在手动配置路径。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        <span class="comment">// 修改 vue 被导入时候的路径</span></span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">"vue$"</span>: <span class="string">"vue/dist/vue.js"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二种就是直接用路径导入指定的 <code>vue.js</code> 文件。不建议这样写。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue/dist/vue.js'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="vue-文件"><a href="#vue-文件" class="headerlink" title=".vue 文件"></a><code>.vue</code> 文件</h5><p><code>.vue</code> 文件，是一个自定义的文件类型，用类似 <code>HTML</code> 的语法描述一个 <code>Vue</code> 组件。每个 <code>.vue</code> 文件包含三种类型的顶级语言块 <code>&lt;template&gt;</code> , <code>&lt;script&gt;</code> 和 <code>&lt;style&gt;</code> 。这三个部分分别代表了 <code>html</code> ， <code>js</code> ,  <code>css</code> 。每个组件都有单独的文件，单个文件能包含了所有的组件代码，这样就能加快开发效率了。</p>
<p>其中 <code>&lt;template&gt;</code> 和 <code>&lt;style&gt;</code> 是支持用预编译语言来写的。</p>
<h5 id="Vue-组件加载器下载"><a href="#Vue-组件加载器下载" class="headerlink" title="Vue 组件加载器下载"></a>Vue 组件加载器下载</h5><p><code>Vue</code> 组件加载器需要 <code>vue-loader</code> 及内置模块 <code>vue-template-compiler</code> ，同时又因为其内部有 <code>&lt;style&gt;</code> 部分内容，所以需要 <code>css-loader</code> 、<code>style-loader</code> 。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i vue-loader vue-template-compiler css-loader style-loader --save-dev</span></span><br></pre></td></tr></table></figure>
<h5 id="配置插件及配置规则"><a href="#配置插件及配置规则" class="headerlink" title="配置插件及配置规则"></a>配置插件及配置规则</h5><p><code>Vue</code> 组件除了需要使用需要添加匹配规则外，还需要使用 <code>VueLoaderPlugin</code> 插件（版本问题）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> VueLoaderPlugin = <span class="built_in">require</span>(<span class="string">'vue-loader/lib/plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> VueLoaderPlugin()</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 配置 vue 路径</span></span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.js'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// 处理 .vue 模板文件</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.vue$/</span>, <span class="attr">use</span>: <span class="string">'vue-loader'</span> &#125;,</span><br><span class="line">      <span class="comment">// 处理 css 样式</span></span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="vue-文件使用"><a href="#vue-文件使用" class="headerlink" title=".vue 文件使用"></a><code>.vue</code> 文件使用</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// login.vue</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 写模板 --&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;这是 .vue 中的登录组件，msg: &#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 写方法，使用 es6 的方法暴露成员，export default 只允许暴露一次</span><br><span class="line">export default&#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            msg: &apos;123&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methodes: &#123;</span><br><span class="line">        show() &#123;</span><br><span class="line">            console.log(&apos;调用了 login.vue 中的 show 方法&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">/* 写样式，scoped 表示私有的，只有他本身和子元素可用，不加就是全局的，不建议使用 */</span><br><span class="line">    </span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>之后就需要将该文件导入到 <code>index.js</code> 入口文件中了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 vue 包</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 login 组件。</span></span><br><span class="line"><span class="keyword">import</span> login <span class="keyword">from</span> <span class="string">'./login.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  <span class="comment">// render 渲染方法，将会替代整个 id="app" 的 div，不需要标签</span></span><br><span class="line">  render: <span class="function"><span class="keyword">function</span> (<span class="params">createElements</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> createElements(login)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// es6 语法缩写形式</span></span><br><span class="line">  <span class="comment">// render: c =&gt; c(login)</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>记得区分 <code>components</code> 和 <code>render</code> 的不同。启动服务器，<code>div</code> 部分就会为 <code>.vue</code> 组件替换。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="vue-router-路由抽离"><a href="#vue-router-路由抽离" class="headerlink" title="vue-router 路由抽离"></a>vue-router 路由抽离</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm i -S vue-router</span></span><br></pre></td></tr></table></figure>
<h4 id="导入-vue-router-包"><a href="#导入-vue-router-包" class="headerlink" title="导入 vue-router 包"></a>导入 <code>vue-router</code> 包</h4><p>将路由模块单独放到 <code>router.js</code> 文件中，通过暴露路由对象的方法将路由对象传入到入口文件中挂载到实例对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在路由模块也需要导入 vue-router</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入一堆 vue 模板</span></span><br><span class="line"><span class="keyword">import</span> account <span class="keyword">from</span> <span class="string">'./xxx/Account.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes = [</span><br><span class="line">  	&#123;</span><br><span class="line">  	  path: <span class="string">'/account'</span>,</span><br><span class="line">  	  component: account</span><br><span class="line">  	&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 暴露路由对象</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>
<p>在入口文件中导入路由模块，同时也要导入 <code>vue-router</code> 包，通过 <code>Vue.user()</code> 安装路由功能，然后挂在到实例对象中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="comment">// 导入 vue-router 包</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="comment">// 导入 app.vue 模板文件</span></span><br><span class="line"><span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">'./app.vue'</span></span><br><span class="line"><span class="comment">// 导入路由模块</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 Vue.use() 安装明确路由功能</span></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  <span class="comment">// 路由挂载</span></span><br><span class="line">  router,</span><br><span class="line">  render: <span class="function"><span class="params">c</span> =&gt;</span> c(app)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="页面"><a href="#页面" class="headerlink" title="页面"></a>页面</h3><p>进过一系列的操作之后，主页面只剩下这几个部分了：</p>
<p><code>src\index.html</code> 文件如下。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>src\index.js</code> 文件如下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES6 的语法，过于高级，浏览器不支持。</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  router,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="服务器浏览"><a href="#服务器浏览" class="headerlink" title="服务器浏览"></a>服务器浏览</h3><p>我们已经安装了 <code>webpack-dev-server</code> 和 <code>html-webpack-plugin</code> ，可以创建虚拟的页面和 <code>js</code> 文件，之后我们就可以启动  <code>webpack-dev-server</code> 来实时浏览我们的页面。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> npm run dev</span></span><br></pre></td></tr></table></figure>
<p>当然这一切都是虚拟的，只是在内存中，等测试完成时候我们就需要将真正的内容打包编译到磁盘中。</p>
<h3 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h3><p>打包是将入口文件中的内容合并、编辑、压缩并导出到出口文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 使用全局 webpack 打包</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> webpack</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用局部 webpack 打包</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ./node_modules/.bin/webpack</span></span><br></pre></td></tr></table></figure>
<p>打包完成后会自动生成出口文件，之后 <code>dist/index.html</code> 就能正常使用了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/04/04/框架-Vuejs-模块化开发/" data-id="cjy01an7z004qosutc9datng0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/框架/">框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/移动端/">移动端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-框架-Vuejs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/23/框架-Vuejs/" class="article-date">
  <time datetime="2019-03-23T08:32:51.000Z" itemprop="datePublished">2019-03-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/23/框架-Vuejs/">框架-Vue.js基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#vuejs-简介">Vue.js 简介</a><ul>
<li><a href="#前端三大主流框架">前端三大主流框架</a></li>
<li><a href="#框架和库的区别">框架和库的区别</a></li>
<li><a href="#后端-mvc">后端 <code>MVC</code></a></li>
<li><a href="#前端-mvvm">前端 <code>MVVM</code></a></li>
</ul>
</li>
<li><a href="#起步">起步</a><ul>
<li><a href="#安装">安装</a><ul>
<li><a href="#npm方法">npm方法</a></li>
<li><a href="#js-文件"><code>JS</code> 文件</a></li>
</ul>
</li>
<li><a href="#配置">配置</a></li>
<li><a href="#案例">案例</a></li>
</ul>
</li>
<li><a href="#vue-devtools-调试器">Vue-devtools 调试器</a><ul>
<li><a href="#chrome-浏览器">Chrome 浏览器</a></li>
<li><a href="#firefox-浏览器">FireFox 浏览器</a></li>
<li><a href="#注意点">注意点</a></li>
</ul>
</li>
<li><a href="#vue-实例">Vue 实例</a><ul>
<li><a href="#创建-vue-实例">创建 Vue 实例</a></li>
<li><a href="#生命周期">生命周期</a></li>
</ul>
</li>
<li><a href="#数据与方法">数据与方法</a><ul>
<li><a href="#this"><code>this</code></a></li>
<li><a href="#响应式数据">响应式数据</a></li>
</ul>
</li>
<li><a href="#模板语法">模板语法</a><ul>
<li><a href="#插值">插值</a><ul>
<li><a href="#纯文本">纯文本</a><ul>
<li><a href="#插值表达式">插值表达式</a></li>
<li><a href="#v-textmsg">v-text=”msg”</a></li>
</ul>
</li>
<li><a href="#html">HTML</a></li>
</ul>
</li>
<li><a href="#javascript-表达式">JavaScript 表达式</a></li>
<li><a href="#插值表达式闪烁问题">插值表达式闪烁问题</a></li>
</ul>
</li>
<li><a href="#指令">指令</a><ul>
<li><a href="#常用指令">常用指令</a><ul>
<li><a href="#v-bind-属性绑定指令"><code>v-bind</code> 属性绑定指令</a></li>
<li><a href="#v-on-事件监听绑定指令"><code>v-on</code> 事件监听绑定指令</a></li>
<li><a href="#条件指令">条件指令</a><ul>
<li><a href="#v-if-与-v-else-与-v-else-if-插入条件指令"><code>v-if</code> 与 <code>v-else</code> 与 <code>v-else-if</code> 插入条件指令</a></li>
<li><a href="#v-show-显示条件指令"><code>v-show</code> 显示条件指令</a></li>
<li><a href="#v-if-与-v-show-比较"><code>v-if</code> 与 <code>v-show</code> 比较</a></li>
<li><a href="#template-条件渲染分组"><code>template</code> 条件渲染分组</a></li>
</ul>
</li>
<li><a href="#v-for-循环指令"><code>v-for</code> 循环指令</a></li>
<li><a href="#v-model-表单元素双向数据绑定指令"><code>v-model</code> 表单元素双向数据绑定指令</a></li>
</ul>
</li>
<li><a href="#自定义指令">自定义指令</a><ul>
<li><a href="#全局指令">全局指令</a></li>
<li><a href="#私有指令">私有指令</a></li>
<li><a href="#钩子函数">钩子函数</a></li>
<li><a href="#钩子函数参数">钩子函数参数</a></li>
<li><a href="#bind-和-update-函数简写"><code>bind</code> 和 <code>update</code> 函数简写</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#表单数据绑定">表单数据绑定</a><ul>
<li><a href="#文本">文本</a></li>
<li><a href="#多行文本">多行文本</a></li>
<li><a href="#复选框">复选框</a><ul>
<li><a href="#多复选框">多复选框</a></li>
<li><a href="#单复选框">单复选框</a></li>
</ul>
</li>
<li><a href="#单选按钮">单选按钮</a></li>
<li><a href="#选择框">选择框</a><ul>
<li><a href="#单项选择框">单项选择框</a></li>
<li><a href="#多向选择框">多向选择框</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#修饰符">修饰符</a><ul>
<li><a href="#事件修饰符">事件修饰符</a><ul>
<li><a href="#prevent-阻止默认行为"><code>.prevent</code> 阻止默认行为</a></li>
<li><a href="#stop-阻止事件冒泡"><code>.stop</code> 阻止事件冒泡</a></li>
<li><a href="#capture-事件捕获模式"><code>.capture</code> 事件捕获模式</a></li>
<li><a href="#self-事件只在元素本身触发时回调"><code>.self</code> 事件只在元素本身触发时回调</a></li>
<li><a href="#once-事件单次触发"><code>.once</code> 事件单次触发</a></li>
<li><a href="#passive"><code>.passive</code></a></li>
</ul>
</li>
<li><a href="#键盘按键修饰符">键盘按键修饰符</a><ul>
<li><a href="#常见按键码别名">常见按键码别名</a><ul>
<li><a href="#一般修饰符">一般修饰符</a></li>
<li><a href="#系统修饰符">系统修饰符</a></li>
</ul>
</li>
<li><a href="#exact"><code>.exact</code></a></li>
<li><a href="#自定义按键修饰符别名">自定义按键修饰符别名</a></li>
<li><a href="#按键码">按键码</a></li>
</ul>
</li>
<li><a href="#鼠标按键修饰符">鼠标按键修饰符</a></li>
<li><a href="#表单修饰符">表单修饰符</a><ul>
<li><a href="#lazy"><code>.lazy</code></a></li>
<li><a href="#number-数值转换修饰符"><code>.number</code> 数值转换修饰符</a></li>
<li><a href="#trim-去首尾空格修饰符"><code>.trim</code> 去首尾空格修饰符</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#过滤器">过滤器</a><ul>
<li><a href="#使用过滤器">使用过滤器</a></li>
<li><a href="#定义过滤器">定义过滤器</a><ul>
<li><a href="#全局过滤器">全局过滤器</a></li>
<li><a href="#私有过滤器">私有过滤器</a></li>
</ul>
</li>
<li><a href="#过滤器串联">过滤器串联</a></li>
</ul>
</li>
<li><a href="#计算属性">计算属性</a><ul>
<li><a href="#计算属性与方法区别">计算属性与方法区别</a></li>
</ul>
</li>
<li><a href="#watch-侦听器侦听属性"><code>Watch</code> 侦听器/侦听属性</a><ul>
<li><a href="#监听属性">监听属性</a></li>
<li><a href="#监视路由">监视路由</a></li>
</ul>
</li>
<li><a href="#methods--computed---watch-对比">methods / computed  / watch 对比</a></li>
<li><a href="#class-与-style-绑定"><code>Class</code> 与 <code>Style</code> 绑定</a><ul>
<li><a href="#class-绑定"><code>Class</code> 绑定</a><ul>
<li><a href="#class-对象语法"><code>Class</code> 对象语法</a><ul>
<li><a href="#基本用法">基本用法</a></li>
<li><a href="#class-结合-computed-计算属性"><code>Class</code> 结合 <code>computed</code> 计算属性</a></li>
</ul>
</li>
<li><a href="#class-数组语法"><code>Class</code> 数组语法</a><ul>
<li><a href="#基础用法">基础用法</a></li>
<li><a href="#三元表达式">三元表达式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#style"><code>Style</code></a></li>
</ul>
</li>
<li><a href="#jsonp">JSONP</a></li>
<li><a href="#异步请求">异步请求</a><ul>
<li><a href="#vue-resourcevue-20-已停止维护仍然即可">vue-resource（vue 2.0 已停止维护，仍然即可）</a><ul>
<li><a href="#安装-1">安装</a></li>
<li><a href="#导包">导包</a></li>
<li><a href="#使用">使用</a></li>
</ul>
</li>
<li><a href="#axios">axios</a><ul>
<li><a href="#安装-2">安装</a></li>
<li><a href="#导包-1">导包</a></li>
<li><a href="#案例-1">案例</a></li>
<li><a href="#get">GET</a></li>
<li><a href="#post">POST</a></li>
<li><a href="#常用配置选项-config">常用配置选项 <code>config</code></a></li>
<li><a href="#配置默认值">配置默认值</a><ul>
<li><a href="#全局的-axios-默认值">全局的 <code>axios</code> 默认值</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#过渡动画">过渡动画</a><ul>
<li><a href="#单元素组件的过渡">单元素/组件的过渡</a><ul>
<li><a href="#css-过渡的类">CSS 过渡的类</a></li>
<li><a href="#自定义过渡类名">自定义过渡类名</a></li>
<li><a href="#第三方-animatecss-类库">第三方 <code>animate.css</code> 类库</a></li>
<li><a href="#自定义过渡类名结合-animatecss">自定义过渡类名结合 <code>animate.css</code></a></li>
<li><a href="#javascript-过渡钩子">JavaScript 过渡钩子</a></li>
</ul>
</li>
<li><a href="#appear-初始渲染过渡"><code>appear</code> 初始渲染过渡</a></li>
<li><a href="#多元素的过渡">多元素的过渡</a><ul>
<li><a href="#过渡模式">过渡模式</a></li>
</ul>
</li>
<li><a href="#多组件的过渡">多组件的过渡</a></li>
<li><a href="#列表过渡">列表过渡</a><ul>
<li><a href="#列表的进入离开过渡">列表的进入/离开过渡</a></li>
<li><a href="#列表的排序过渡">列表的排序过渡</a></li>
<li><a href="#列表的交错过渡">列表的交错过渡</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#vue-组件">Vue 组件</a><ul>
<li><a href="#组件注册">组件注册</a><ul>
<li><a href="#组件命名">组件命名</a></li>
<li><a href="#全局注册">全局注册</a></li>
<li><a href="#私有注册">私有注册</a></li>
<li><a href="#html模板分离">HTML模板分离</a></li>
</ul>
</li>
<li><a href="#data-与-prop">data 与 prop</a><ul>
<li><a href="#子组件使用父组件的-data">子组件使用父组件的 data</a></li>
<li><a href="#子组件使用父组件的-methods并向父组件传递-data">子组件使用父组件的 methods，并向父组件传递 data</a></li>
<li><a href="#prop-详解">prop 详解</a><ul>
<li><a href="#prop原理">prop原理</a></li>
<li><a href="#prop-属性名">prop 属性名</a></li>
<li><a href="#prop-定义数据类型及验证">prop 定义数据类型及验证</a></li>
<li><a href="#动态传递-prop-规则">动态传递 prop 规则</a></li>
<li><a href="#静态传递-prop-规则">静态传递 prop 规则</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#动态组件">动态组件</a></li>
</ul>
</li>
<li><a href="#vue-router-前端路由">vue-router 前端路由</a><ul>
<li><a href="#安装-3">安装</a></li>
<li><a href="#引入">引入</a></li>
<li><a href="#起步-1">起步</a></li>
<li><a href="#router-link">router-link</a><ul>
<li><a href="#to-链接属性">to 链接属性</a></li>
<li><a href="#tag-标签属性">tag 标签属性</a></li>
<li><a href="#active-class-激活类">active-class 激活类</a></li>
</ul>
</li>
<li><a href="#路由传参">路由传参</a><ul>
<li><a href="#query-传参">query 传参</a></li>
<li><a href="#params-传参">params 传参</a></li>
<li><a href="#props-解耦">props 解耦</a><ul>
<li><a href="#布尔模式">布尔模式</a></li>
<li><a href="#对象模式">对象模式</a></li>
<li><a href="#函数模式">函数模式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#路由嵌套">路由嵌套</a></li>
<li><a href="#编程式路由">编程式路由</a></li>
<li><a href="#命名路由">命名路由</a></li>
<li><a href="#命名视图">命名视图</a></li>
<li><a href="#重定向">重定向</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<font color="red">此文档参考 Vue 2.x 版本</font>

<h2 id="Vue-js-简介"><a href="#Vue-js-简介" class="headerlink" title="Vue.js 简介"></a>Vue.js 简介</h2><p><code>Vue.js</code> 是一套构建用户界面的渐进式框架，与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与现代化的工具链以及各种支持类库结合使用时，<code>Vue</code> 也完全能够为复杂的单页应用提供驱动。</p>
<p>官网：<a href="https://cn.vuejs.org/" target="_blank" rel="noopener">https://cn.vuejs.org/</a></p>
<h3 id="前端三大主流框架"><a href="#前端三大主流框架" class="headerlink" title="前端三大主流框架"></a>前端三大主流框架</h3><ul>
<li><code>Angular.js</code></li>
<li><code>React.js</code>: <code>React</code> 是最流行的前端框架。<code>React</code> 除了可以开发网页，还可以开发手机 <code>App</code> 。</li>
<li><code>Vue.js</code>: <code>Vue.js</code> 是目前最火的前端框架，<code>Vue</code> 借助 <code>Weex</code> 也可以开发手机 <code>App</code> 。</li>
</ul>
<h3 id="框架和库的区别"><a href="#框架和库的区别" class="headerlink" title="框架和库的区别"></a>框架和库的区别</h3><ul>
<li><p>框架：是一套完整的解决方法，对项目的倾入性较大，项目如果需要更换框架，需要重新架构整个项目。</p>
<p>  如：<code>node</code> 中的 <code>express</code></p>
</li>
<li><p>库（插件）：提供某一个小功能，对项目的插入性较小，如果某个库无法完成某些需求，可以很容易切换到其他库实现需求。</p>
<p>  如：<code>jQuery</code></p>
</li>
</ul>
<h3 id="后端-MVC"><a href="#后端-MVC" class="headerlink" title="后端 MVC"></a>后端 <code>MVC</code></h3><p><strong><code>MVC</code></strong> 是 <code>Model-View-Controller</code> 的简写。即模型-视图-控制器。`</p>
<ul>
<li><code>Model</code> : 模型层，负责数据库操作。</li>
<li><code>View</code> : 视图层，用户界面显示，数据的可视化。</li>
<li><code>Controller</code> : 控制层，处理业务逻辑。</li>
</ul>
<p><img src="/2019/03/23/框架-Vuejs/MVC.JPG" alt="MVC.JPG"></p>
<h3 id="前端-MVVM"><a href="#前端-MVVM" class="headerlink" title="前端 MVVM"></a>前端 <code>MVVM</code></h3><p><strong><code>MVVM</code></strong> 是 <code>Model-View-ViewModel</code> 的简写，即模型-视图-视图模型。</p>
<p>MVVM 的出现促进了 GUI 前端开发与后端业务逻辑的分离，极大地提高了前端开发效率。MVVM 的核心是 ViewModel 层，它就像是一个中转站（value converter），负责转换 Model 中的数据对象来让数据变得更容易管理和使用，该层向上与视图层进行双向数据绑定，向下与 Model 层通过接口请求进行数据交互，起呈上启下作用。View 层展现的不是 Model 层的数据，而是 ViewModel 的数据，由 ViewModel 负责与 Model 层交互，这就完全解耦了 View 层和 Model 层，这个解耦是至关重要的，它是前后端分离方案实施的最重要一环。</p>
<p><img src="/2019/03/23/框架-Vuejs/mvvm.png" alt="mvvm.png"></p>
<h2 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="npm方法"><a href="#npm方法" class="headerlink" title="npm方法"></a>npm方法</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 用淘宝镜像会好点</span><br><span class="line">cnpm i vue -S</span><br></pre></td></tr></table></figure>
<h4 id="JS-文件"><a href="#JS-文件" class="headerlink" title="JS 文件"></a><code>JS</code> 文件</h4><p>通过官网或者其他第三方网站下载 <code>JS</code> 文件。大型项目不建议这种方法。</p>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"vue.js 文件路径"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p>导入包之后，就会多出一个 <code>Vue</code> 构造函数，每个 <code>Vue</code> 应用都需要通过实例化 <code>Vue</code> 来实现。</p>
<p><code>Vue.js</code> 的核心是一个允许采用简洁的模板语法来声明式地将数据渲染进 DOM 的系统。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 被 Vue 控制的内容 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 内容替换部分，插值表达式 --&gt;</span></span><br><span class="line">        &#123;&#123; message &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> app = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 类似 id 选择器，获取需要控制内容，这是小写 L 不是数字 1</span></span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 替换内容，这里的 data 就是 MVVM 中的 M ，专门用来保存页面的数据</span></span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 自定义的键值对，会用来给插值表达式提供数据</span></span></span><br><span class="line"><span class="javascript">                message: <span class="string">"hello 123"</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Vue-devtools-调试器"><a href="#Vue-devtools-调试器" class="headerlink" title="Vue-devtools 调试器"></a>Vue-devtools 调试器</h2><p><code>Vue-devtoos</code> 是 <code>Vue</code> 的调试神器，是一款基于 <code>Chrome</code> 浏览器的插件，用于调试 <code>Vue</code> 应用，可以极大提升我们的开发效率。</p>
<h3 id="Chrome-浏览器"><a href="#Chrome-浏览器" class="headerlink" title="Chrome 浏览器"></a>Chrome 浏览器</h3><p>但是因为被墙了，需要找 <code>github</code> 源码自行编译。</p>
<p><code>github</code> 链接：<a href="https://github.com/vuejs/vue-devtools" target="_blank" rel="noopener">https://github.com/vuejs/vue-devtools</a></p>
<ul>
<li><p>首先在 <code>github</code> 上下载源码，解压到任意目录（但是注意这个解压文件不能删除！！！）</p>
</li>
<li><p>进入解压目录，命令行中执行 <code>npm install</code> 下载资源文件。</p>
</li>
<li><p>执行命令 <code>npm run build</code> 构建插件。</p>
</li>
<li><p>打开谷歌浏览器，点击更多工具 –&gt; 拓展程序 –&gt; 打开开发者模式 –&gt; 加载已解压的拓展程序 –&gt; 选择解压目录下 <code>shells/chrome</code> –&gt; 选择文件夹即可。</p>
</li>
</ul>
<p>这样在 <code>Chrome</code> 上就加入了 <code>Vue-devtools</code> 调试器插件了，但是会一直弹出 <code>请停用以开发者模式运行的拓展程序</code> ，目前我还没找到有效的方法。</p>
<p>参考方法：<a href="https://jingyan.baidu.com/article/c275f6ba12e07ce33d756712.html" target="_blank" rel="noopener">https://jingyan.baidu.com/article/c275f6ba12e07ce33d756712.html</a></p>
<p>还有一种添加白名单的方法，但是好像 win10 家庭版不支持。</p>
<h3 id="FireFox-浏览器"><a href="#FireFox-浏览器" class="headerlink" title="FireFox 浏览器"></a>FireFox 浏览器</h3><p>获取浏览器中下载配置比较简单，点击下方连接即可，或者去插件里自己下。</p>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/vue-js-devtools/" target="_blank" rel="noopener">https://addons.mozilla.org/en-US/firefox/addon/vue-js-devtools/</a></p>
<h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><p>安装完之后，运行使用了 <code>Vue.js</code> 的文件，打开 <code>F12</code> ，即可看到有一个 <code>Vue</code> 标签，这就是我们的 <code>Vue devtools</code> 工具。但是如果使用的 <code>Vue</code> 包为压缩类型的（<code>vue.min.js</code>），无法使用工具，它只能给调试用。</p>
<h2 id="Vue-实例"><a href="#Vue-实例" class="headerlink" title="Vue 实例"></a>Vue 实例</h2><h3 id="创建-Vue-实例"><a href="#创建-Vue-实例" class="headerlink" title="创建 Vue 实例"></a>创建 Vue 实例</h3><p>虽然没有完全遵循 <a href="https://zh.wikipedia.org/wiki/MVVM" target="_blank" rel="noopener">MVVM 模型</a>，但是 <code>Vue</code> 的设计也受到了它的启发。因此在文档中经常会使用 <code>vm</code> ( <code>ViewModel</code> 的缩写) 这个变量名表示 <code>Vue</code> 实例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过 Vue 构造函数创建一个实例</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'id 选择器'</span>,</span><br><span class="line">  data: &#123; 数据对象 &#125;,</span><br><span class="line">  methods: &#123; 方法对象 &#125;,</span><br><span class="line">  filters: &#123; 过滤器对象 &#125;,</span><br><span class="line">  computed: &#123; 计算属性 &#125;,</span><br><span class="line">  directives: &#123; 指令对象 &#125;,</span><br><span class="line">  components: &#123; 私有组件 &#125;,</span><br><span class="line">  watch: &#123; 监视对象 &#125;</span><br><span class="line">  router: <span class="keyword">new</span> VueRouter(),  <span class="comment">// 路由对象实例</span></span><br><span class="line">  生命周期函数()&#123;  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>实例创建之后，<code>Vue</code> 对象会保存在 <code>windown</code>。</p>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p><img src="/2019/03/23/框架-Vuejs/声明周期.png" alt="声明周期.png"></p>
<h2 id="数据与方法"><a href="#数据与方法" class="headerlink" title="数据与方法"></a>数据与方法</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一般写法</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'id 选择器'</span>,</span><br><span class="line">  data: &#123; 数据对象 &#125;,</span><br><span class="line">  methods: &#123; 方法对象 &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取数据对象与方法对象</span></span><br><span class="line"><span class="keyword">var</span> data = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> methods = &#123; show(val) &#123;&#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'id 选择器'</span>,</span><br><span class="line">  data: data,</span><br><span class="line">  methods: methods</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="this"><a href="#this" class="headerlink" title="this"></a><code>this</code></h3><p>在 <code>Vue</code> 实例中如果想获取自身 <code>data</code> 中的数据或者调用 <code>methods</code> 中的方法，必须使用 <code>this</code> 。必要是使用箭头函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一般写法</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'id 选择器'</span>,</span><br><span class="line">  data: &#123; </span><br><span class="line">      msg: <span class="string">'hello'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123; </span><br><span class="line">    show() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.msg)</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="响应式数据"><a href="#响应式数据" class="headerlink" title="响应式数据"></a>响应式数据</h3><p>当一个 <code>Vue</code> 实例被<font color="red"><strong>创建时</strong></font>，它向 <code>Vue</code> 的<strong>响应式系统</strong>中加入了其 <code>data</code> 对象中能找到的所有的属性。当这些属性的值发生改变时，视图将会产生“响应”，重新渲染视图，即匹配更新为新的值。</p>
<p>如果在 <code>Vue</code> 实例被<font color="red"><strong>创建后</strong></font>，添加一个新的属性，该属性不具备响应式！！！可以一开始就在 <code>data</code> 对象中添加该属性并设置默认值（空值或者 <code>null</code>）来避免这种情况发生。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 我们的数据对象</span></span><br><span class="line"><span class="keyword">var</span> data = &#123; </span><br><span class="line">  a: <span class="number">1</span>，</span><br><span class="line">  <span class="comment">// 添加空值为初始值</span></span><br><span class="line">  msg: <span class="string">''</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 该对象被加入到一个 Vue 实例中</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  data: data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获得这个实例上的属性</span></span><br><span class="line"><span class="comment">// 返回源数据中对应的字段</span></span><br><span class="line">vm.a == data.a <span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置属性也会影响到原始数据</span></span><br><span class="line">vm.a = <span class="number">2</span></span><br><span class="line">data.a <span class="comment">// =&gt; 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ……反之亦然</span></span><br><span class="line">data.a = <span class="number">3</span></span><br><span class="line">vm.a <span class="comment">// =&gt; 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 有默认值，有响应式</span></span><br><span class="line">data.msg = <span class="string">'hello'</span></span><br><span class="line">vm.msg <span class="comment">// =&gt; 'hello'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 无默认值，无响应，报错</span></span><br><span class="line">data.msg2 = <span class="string">'hello'</span></span><br><span class="line">vm.msg2 <span class="comment">// =&gt; error！</span></span><br></pre></td></tr></table></figure>
<h2 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h2><h3 id="插值"><a href="#插值" class="headerlink" title="插值"></a>插值</h3><h4 id="纯文本"><a href="#纯文本" class="headerlink" title="纯文本"></a>纯文本</h4><h5 id="插值表达式"><a href="#插值表达式" class="headerlink" title="插值表达式"></a>插值表达式</h5><p>最常见形式，通过双大括号，插入纯文本类型，并且仅该部分内容会被替换。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &#123;&#123; msg &#125;&#125; 会被替换，而 ' +++ ' 不会被替换 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span> +++ &#123;&#123; msg &#125;&#125; +++ <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            msg: <span class="string">'hello 123'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="v-text-”msg”"><a href="#v-text-”msg”" class="headerlink" title="v-text=”msg”"></a>v-text=”msg”</h5><p>纯文本全部替换。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span>·</span><br><span class="line">    <span class="comment">&lt;!-- msg 会替换 ' +++ ' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-text</span>=<span class="string">"msg"</span>&gt;</span> +++ <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            msg: <span class="string">'hello 123'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h4><p><code>v-html</code> 指令，使用 <code>v-html=&quot;msg&quot;</code> 的方式，将 <code>msg</code> 字符串编译成 <code>HTML</code> ，并替换。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 编译成 HTML，并替换 '123' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">"msg"</span>&gt;</span>123<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="xml">            msg: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="JavaScript-表达式"><a href="#JavaScript-表达式" class="headerlink" title="JavaScript 表达式"></a>JavaScript 表达式</h3><p>在 <code>Vue.js</code> 中支持 <code>JS</code> 表达式。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 编译成 HTML，并拼接字符串'666'，替换 '123' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">"msg + '666' "</span>&gt;</span>123<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- value: '&lt;h1&gt;hello world&lt;/h1&gt;666' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; msg + '666' &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- value: YES --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; ok ? 'YES' : 'NO' &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- value: 10 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; 5+5 &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            ok: <span class="literal">true</span>,</span></span><br><span class="line"><span class="xml">            msg: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="插值表达式闪烁问题"><a href="#插值表达式闪烁问题" class="headerlink" title="插值表达式闪烁问题"></a>插值表达式闪烁问题</h3><p>在实际开发中，当页面获取服务器 <code>JS</code> 文件时，如果网络较慢或者加载内容过多的情况下，使用插值表达式的地方会有先显示内容未被替换掉的插值，等 <code>JS</code> 文件加载完成之后，然后被替换掉。这就是插值表达式的闪烁问题，只需要在有插值表达式的地方使用属性选择器，使其先隐藏，等 <code>JS</code> 文件被加载出来之后，由于优先级问题，原先隐藏属性被覆盖，自然显示出来。</p>
<p>这里我们使用谷歌浏览器，<code>F12</code> 打开 <code>Network</code> 设置 <code>Throtting</code> 为 <code>Slow 3G</code> （缓慢3G）模式来模拟网络卡顿。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这里使用网络中的 js 文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.staticfile.org/vue/2.4.2/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 添加一个属性选择器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        [v-cloak] &#123;</span></span><br><span class="line"><span class="undefined">            display: none;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 方法一：v-cloak + style --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-cloak</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 方法二：v-text，默认没有闪烁问题 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-text</span>=<span class="string">"message"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                message: <span class="string">"hello 123"</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><p>指令 (Directives) 是带有 <code>v-</code> 前缀的特殊属性。</p>
<p>指令特性的值预期是<strong>单个 JavaScript 表达式</strong> (<code>v-for</code> 除外)。指令的职责是，当表达式的值改变时，将其产生的连带影响，响应式地作用于 DOM。</p>
<h3 id="常用指令"><a href="#常用指令" class="headerlink" title="常用指令"></a>常用指令</h3><h4 id="v-bind-属性绑定指令"><a href="#v-bind-属性绑定指令" class="headerlink" title="v-bind 属性绑定指令"></a><code>v-bind</code> 属性绑定指令</h4><p>在 <code>HTML</code> 中，如果某些标签（<code>a</code>、<code>h1</code>、<code>img</code>等）的属性值需要使用 <code>data</code> 中的数据时，需要在属性前加 <code>v-bind:</code> 或者缩写为冒号 <code>:</code> 绑定该属性，然后属性值就是 <code>data</code> 中的键名。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 绑定 title 属性，这时属性值为 'hello world' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> <span class="attr">v-bind:title</span>=<span class="string">"mytitle"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 缩写形式，这时属性值为 'hello world' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> <span class="attr">:title</span>=<span class="string">"mytitle"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 原来的，title 属性值就是 'mytitle' --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> <span class="attr">title</span>=<span class="string">"mytitle"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            mytitle: <span class="string">'hello world'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="v-on-事件监听绑定指令"><a href="#v-on-事件监听绑定指令" class="headerlink" title="v-on 事件监听绑定指令"></a><code>v-on</code> 事件监听绑定指令</h4><p>它用于监听 DOM 事件，在事件前加 <code>v-on:</code> 或者缩写 <code>@</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 监听点击事件，调用 show 方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> <span class="attr">v-on:click</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 缩写形式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮"</span> @<span class="attr">click</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建 Vue 对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue (&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 方法对象，不是数组，</span></span></span><br><span class="line"><span class="undefined">        methods: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 一般写法</span></span></span><br><span class="line"><span class="javascript">            show: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">window</span>.alert(<span class="string">'show方法'</span>)</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            <span class="comment">// ES 6 写法</span></span></span><br><span class="line"><span class="undefined">            show() &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">window</span>.alert(<span class="string">'show方法'</span>)</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            xxx,</span></span><br><span class="line"><span class="undefined">            xxx</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="条件指令"><a href="#条件指令" class="headerlink" title="条件指令"></a>条件指令</h4><h5 id="v-if-与-v-else-与-v-else-if-插入条件指令"><a href="#v-if-与-v-else-与-v-else-if-插入条件指令" class="headerlink" title="v-if 与 v-else 与 v-else-if 插入条件指令"></a><code>v-if</code> 与 <code>v-else</code> 与 <code>v-else-if</code> 插入条件指令</h5><p> <code>v-if</code> 指令将根据表达式的<strong>布尔值</strong>来决定是否<strong>插入</strong>该元素，是有和无的区别，源码中只有布尔值为 <code>true</code> 的那块代码。</p>
<p><code>v-else</code> 元素必须紧跟在带 <code>v-if</code> 或者 <code>v-else-if</code> 的元素的后面，否则它将不会被识别。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 如果表达式 seen 的值为 true，则插入 v-if 行元素；为 false，则插入 v-else 行元素 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">"seen"</span>&gt;</span>插入第一个<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span>&gt;</span>插入第二个<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">"type === 'A'"</span>&gt;</span> A <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else-if</span>=<span class="string">"type === 'B'"</span>&gt;</span> B <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span>&gt;</span>Not A / B<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="javascript">        seen: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">        type: <span class="string">'D'</span></span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="v-show-显示条件指令"><a href="#v-show-显示条件指令" class="headerlink" title="v-show 显示条件指令"></a><code>v-show</code> 显示条件指令</h5><p><code>v-show</code> 指令将根据表达式的<strong>布尔值</strong>来决定是否<strong>显示</strong>该元素，源码中有该块代码，布尔值为 <code>true</code> 显示代码，反之，添加代码样式 <code>style=&quot;display: none;&quot;</code> ，设置其为状态不可视。</p>
<p><code>v-show</code> 不能与 <code>v-else</code> <code>v-else-if</code> 连用，也不支持 <code>&lt;template&gt;</code> 元素。</p>
<h5 id="v-if-与-v-show-比较"><a href="#v-if-与-v-show-比较" class="headerlink" title="v-if 与 v-show 比较"></a><code>v-if</code> 与 <code>v-show</code> 比较</h5><ul>
<li><code>v-show</code> 的元素始终会被渲染并保留在 DOM 中，有更高的初始渲染开销。</li>
<li><code>v-if</code> 的元素随着控制量的改变不断插入和删除元素，有更高的切换开销。</li>
<li><code>v-if</code> 是<strong>惰性的</strong>，如果在初始渲染时条件为假，则什么也不做，直到条件第一次变为真时，才会开始渲染条件块。</li>
<li>如果需要非常频繁地切换，则使用 <code>v-show</code> 较好。</li>
<li>如果在运行时条件很少改变，则使用 <code>v-if</code> 较好。</li>
<li>复杂的情况使用 <code>v-if</code> 较好，支持 <code>v-else</code> <code>v-else-if</code> 和 <code>&lt;template&gt;</code> 元素。</li>
</ul>
<h5 id="template-条件渲染分组"><a href="#template-条件渲染分组" class="headerlink" title="template 条件渲染分组"></a><code>template</code> 条件渲染分组</h5><p>因为 <code>v-if</code> 是一个指令，所以必须将它添加到一个元素上。但是如果想切换多个元素，可以把一个 <code>&lt;template&gt;</code> 元素当做不可见的包裹元素（或者使用 <code>div</code>），并在上面使用 <code>v-if</code>。但是最终的渲染结果将不包含 <code>&lt;template&gt;</code> 元素，这一点比 <code>div</code> 好。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="v-for-循环指令"><a href="#v-for-循环指令" class="headerlink" title="v-for 循环指令"></a><code>v-for</code> 循环指令</h4><p><code>v-for</code> 指令可以绑定数组的数据来渲染一个项目列表，有些像 <code>for-in</code> 循环。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 遍历数组，获取（对象，数组下标） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"(user, i) in users"</span>&gt;</span></span><br><span class="line">        i: &#123;&#123; i &#125;&#125; -- user: &#123;&#123; user &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 遍历对象，获取对象 (键值，键名[，属性序号]) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"(val, key, i) in users[0]"</span>&gt;</span></span><br><span class="line">        i: &#123;&#123; i &#125;&#125; -- key: &#123;&#123; key &#125;&#125; -- val: &#123;&#123; val &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 遍历数字，从 1 开始 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"count in 5"</span>&gt;</span></span><br><span class="line">        这是第 &#123;&#123; count &#125;&#125; 个数字</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">    data: &#123;</span></span><br><span class="line"><span class="undefined">        users: [</span></span><br><span class="line"><span class="javascript">            &#123; <span class="attr">name</span>: <span class="string">'daming'</span>, <span class="attr">age</span>: <span class="number">18</span>, <span class="attr">gender</span>: <span class="string">'men'</span> &#125;,</span></span><br><span class="line"><span class="javascript">            &#123; <span class="attr">name</span>: <span class="string">'erming'</span>, <span class="attr">age</span>: <span class="number">17</span>, <span class="attr">gender</span>: <span class="string">'men'</span> &#125;,</span></span><br><span class="line"><span class="javascript">            &#123; <span class="attr">name</span>: <span class="string">"xiaoming"</span>, <span class="attr">age</span>: <span class="number">16</span>, <span class="attr">gender</span>: <span class="string">"men"</span> &#125;</span></span><br><span class="line"><span class="undefined">        ]</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：在组件中使用 <code>v-for</code> 循环的时候，或者在一些特殊情况中，使用 <code>v-for</code> 的同时需要将 <code>key</code> 绑定唯一的字符串或者数字。</p>
<p>如下，在有 <code>checkbox</code> 选中的情况下给数组头部添加数据，如果没有将 <code>key</code> 绑定给 <code>id</code> ，会导致重渲染之后的 <code>checkbox</code> 选择错误。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        id: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        name: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"添加"</span> @<span class="attr">click</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- v-for 循环的时候，key 属性只能使用 number 或者 string，并用 v-bind 属性绑定 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"user in users"</span> <span class="attr">v-bind:key</span>=<span class="string">"user.id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span> id: &#123;&#123; user.id &#125;&#125; --- name: &#123;&#123; user.name &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                id: <span class="string">''</span>,</span></span><br><span class="line"><span class="javascript">                name: <span class="string">''</span>,</span></span><br><span class="line"><span class="undefined">                users: [</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'daming'</span> &#125;,</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">'erming'</span> &#125;,</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">"xiaoming"</span> &#125;</span></span><br><span class="line"><span class="undefined">                ]</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="undefined">                add () &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.users.unshift(&#123; <span class="attr">id</span>: <span class="keyword">this</span>.id, <span class="attr">name</span>: <span class="keyword">this</span>.name &#125;)</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="v-model-表单元素双向数据绑定指令"><a href="#v-model-表单元素双向数据绑定指令" class="headerlink" title="v-model 表单元素双向数据绑定指令"></a><code>v-model</code> 表单元素双向数据绑定指令</h4><p>更多案例在《表单数据绑定》章节</p>
<p><code>v-model</code> 指令用来在 <code>input</code> 、<code>select</code>、<code>text</code> 、<code>checkbox</code> 、<code>radio</code> 等表单控件元素上创建双向数据绑定，即既能读取 <code>model</code> （<code>Vue</code> 对象）中的数据，又能通过表单来修改 <code>model</code> 中的数据。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 输入框的默认文本为 'Hello Vue!'，修改之后，Vue 对象中的 message 值会改变 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"message"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="javascript">        message: <span class="string">'Hello Vue!'</span></span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h3><p>指令都是以 <code>v-</code> 开头，自定义指令也使用这个原则。</p>
<h4 id="全局指令"><a href="#全局指令" class="headerlink" title="全局指令"></a>全局指令</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * 注册一个全局自定义指令。</span></span><br><span class="line"><span class="comment"> * 第一个参数是指令名，在定义时不需要加 `v-`，这部分是默认的</span></span><br><span class="line"><span class="comment"> * 第二个参数是一个对象，对象身上有一些指令相关的函数，称为 `钩子函数`</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Vue.directive(<span class="string">'指令名称'</span>, &#123;</span><br><span class="line">    <span class="comment">// 钩子函数</span></span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 调用自定义指令 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">v-focus</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 注册一个全局自定义指令 `v-focus`</span></span></span><br><span class="line"><span class="javascript">    Vue.directive(<span class="string">'focus'</span>, &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 当被绑定的元素插入到 DOM </span></span></span><br><span class="line"><span class="javascript">      inserted: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 聚焦元素</span></span></span><br><span class="line"><span class="undefined">        el.focus()</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="undefined">        ...</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="私有指令"><a href="#私有指令" class="headerlink" title="私有指令"></a>私有指令</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#'</span>,</span><br><span class="line">    data: &#123;  &#125;</span><br><span class="line">    directives: &#123;</span><br><span class="line">      focus: &#123;</span><br><span class="line">        <span class="comment">// 钩子函数</span></span><br><span class="line">        inserted: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">          el.focus()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="钩子函数"><a href="#钩子函数" class="headerlink" title="钩子函数"></a>钩子函数</h4><p>钩子函数时指令定义对象中的可选内容，用来实现自定义指令的具体操作，不同的钩子函数有不同的使用场景，根据具体需要来选择。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Vue.directive(<span class="string">'指令名称'</span>, &#123;</span><br><span class="line">    <span class="comment">// 钩子函数</span></span><br><span class="line"></span><br><span class="line">	bind: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 只调用一次，指令第一次绑定到元素时调用。在这里可以进行一次性的初始化设置。</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 如果是绑定 css 样式，初始化之后不管是否通过 inserted 插入到页面中，都会以内联样式的方式渲染到页面中。</span></span><br><span class="line">    &#125;,</span><br><span class="line">    inserted: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 被绑定元素插入父节点时调用 (仅保证父节点存在，但不一定已被插入文档中)。</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 如果是与行为有关的操作，都必须通过 inserted 插入到页面中才会生效。</span></span><br><span class="line">    &#125;,</span><br><span class="line">    updated: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 当 VNode 更新时调用。</span></span><br><span class="line">    &#125;,</span><br><span class="line">    componentUpdated: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 指令所在组件的 VNode 及其子 VNode 全部更新后调用。</span></span><br><span class="line">    &#125;,</span><br><span class="line">    unbind: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 只调用一次，指令与元素解绑时调用。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="钩子函数参数"><a href="#钩子函数参数" class="headerlink" title="钩子函数参数"></a>钩子函数参数</h4><p>所有的钩子函数参数都是一样的。</p>
<ul>
<li><code>el</code>（必须）：指令所绑定的元素，可以用来直接操作 <code>DOM</code> 。</li>
<li><p><code>binding</code> ：一个对象，用来获取传递进参数，包含以下属性。</p>
<ul>
<li><p><code>name</code> ：指令名，不包括 <code>v-</code> 前缀。</p>
</li>
<li><p><code>value</code> ：指令的绑定值（传入参数），例如：<code>v-my-directive=&quot;1 + 1&quot;</code> 中，绑定值为 <code>2</code>。</p>
</li>
<li><p><code>oldValue</code> ：指令绑定的前一个值，仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。无论值是否改变都可用。</p>
</li>
<li><p><code>expression</code> ：字符串形式的指令表达式（就是参数字符串，未经过 <code>JS</code> 处理）。例如 <code>v-my-directive=&quot;1 + 1&quot;</code> 中，表达式为 <code>&quot;1 + 1&quot;</code> 。</p>
</li>
<li><p><code>arg</code> ：传给指令的参数，可选。例如 <code>v-my-directive:foo</code> 中，参数为 <code>&quot;foo&quot;</code> 。</p>
</li>
<li><p><code>modifiers</code> ：一个包含修饰符的对象。例如：<code>v-my-directive.foo.bar</code> 中，修饰符对象为 <code>{ foo: true, bar: true }</code> 。</p>
</li>
</ul>
</li>
<li><code>vnode</code> ：<code>Vue</code> 编译生成的虚拟节点。</li>
<li><code>oldVnode</code> ：上一个虚拟节点，仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 必须这么写，如果直接写 blue ，vue 会到 data 中去找，而不是指令 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-color</span>=<span class="string">"'blue'"</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 传入一个对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-color2</span>=<span class="string">"&#123; color: 'blue'; text: 'hello' &#125;"</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">    el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">    directives: &#123;</span></span><br><span class="line"><span class="undefined">      color: &#123;</span></span><br><span class="line"><span class="javascript">        bind: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(binding.value)	<span class="comment">// blue</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(binding.expression)	<span class="comment">// 'blue'</span></span></span><br><span class="line"><span class="undefined">            </span></span><br><span class="line"><span class="undefined">          el.style.color = binding.value</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined">      color2: &#123;</span></span><br><span class="line"><span class="javascript">        bind: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(binding.value.color)	<span class="comment">// blue</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(binding.value.text)	<span class="comment">// hello</span></span></span><br><span class="line"><span class="undefined">            </span></span><br><span class="line"><span class="undefined">          el.style.color = binding.value</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="bind-和-update-函数简写"><a href="#bind-和-update-函数简写" class="headerlink" title="bind 和 update 函数简写"></a><code>bind</code> 和 <code>update</code> 函数简写</h4><p>在 <code>bind</code> 和 <code>update</code> 时触发相同行为，而不关心其它的钩子时，可以简写。这种简写方式就相当于在 <code>bind</code> 和 <code>update</code> 钩子函数中同时写了一遍代码。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简写形式</span></span><br><span class="line">Vue.directive(<span class="string">'指令名称'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span><br><span class="line">  el.style.backgroundColor = binding.value</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 非简写</span></span><br><span class="line">Vue.directive(<span class="string">'指令名称'</span>, &#123;</span><br><span class="line">    bind: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span><br><span class="line">        el.style.backgroundColor = binding.value</span><br><span class="line">    &#125;,</span><br><span class="line">    update: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span><br><span class="line">        el.style.backgroundColor = binding.value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="表单数据绑定"><a href="#表单数据绑定" class="headerlink" title="表单数据绑定"></a>表单数据绑定</h2><p>表单数据绑定最重要的就是 <code>v-model</code> 指令，它负责监听用户的输入事件以更新数据，并对一些极端场景进行一些特殊处理。</p>
<p><code>v-model</code> 会忽略所有表单元素的 <code>value</code>、<code>checked</code>、<code>selected</code> 特性的初始值而总是将 <code>Vue</code> 实例的数据作为数据来源。换句话说，<font color="red"> <code>v-model</code> 将代替表单元素的 <code>value</code>、<code>checked</code>、<code>selected</code> 属性</font>。</p>
<p>大概体验一下基础的内容绑定。</p>
<h3 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"message"</span> <span class="attr">placeholder</span>=<span class="string">"edit me"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Message is: &#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            message: <span class="string">'hello'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="多行文本"><a href="#多行文本" class="headerlink" title="多行文本"></a>多行文本</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">v-model</span>=<span class="string">"message"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 支持换行 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"white-space: pre-line;"</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            message: <span class="string">'hello'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="复选框"><a href="#复选框" class="headerlink" title="复选框"></a>复选框</h3><h4 id="多复选框"><a href="#多复选框" class="headerlink" title="多复选框"></a>多复选框</h4><p>多个复选框时，需将 <code>v-model</code> 绑定到同一个数组中。如果复选框 <code>value</code> 与数组内容匹配，则默认选中。</p>
<p><code>Vue</code> 会根据选择顺序，将选中项复选框的 <code>value</code> 值依次添加到数组尾部，取消选择时，则从数组中删除对应项。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">'example-3'</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"jack"</span> <span class="attr">value</span>=<span class="string">"Jack"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"jack"</span>&gt;</span>Jack<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"john"</span> <span class="attr">value</span>=<span class="string">"John"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"john"</span>&gt;</span>John<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"mike"</span> <span class="attr">value</span>=<span class="string">"Mike"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"mike"</span>&gt;</span>Mike<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>Checked names: &#123;&#123; checkedNames &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined">            checkedNames: []</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="单复选框"><a href="#单复选框" class="headerlink" title="单复选框"></a>单复选框</h4><p>单个复选框时，需将 <code>v-model</code> 绑定到布尔值，根据布尔值显示是否选中。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"checked"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"checkbox"</span>&gt;</span>&#123;&#123; checked &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            checked: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="单选按钮"><a href="#单选按钮" class="headerlink" title="单选按钮"></a>单选按钮</h3><p>使用单选按钮时，需将 <code>v-model</code> 绑定到字符串。如果初始字符串为空或者不存在与之匹配的单选按钮 <code>value</code> ，则不选中，否则选择与之匹配的单选按钮。</p>
<p>选择时，将选中项（唯一）的 <code>value</code> 替换到字符串中。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"one"</span> <span class="attr">value</span>=<span class="string">"One"</span> <span class="attr">v-model</span>=<span class="string">"picked"</span>&gt;</span>One</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"two"</span> <span class="attr">value</span>=<span class="string">"Two"</span> <span class="attr">v-model</span>=<span class="string">"picked"</span>&gt;</span>Two</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Picked: &#123;&#123; picked &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            picked: <span class="string">''</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="选择框"><a href="#选择框" class="headerlink" title="选择框"></a>选择框</h3><h4 id="单项选择框"><a href="#单项选择框" class="headerlink" title="单项选择框"></a>单项选择框</h4><p>使用单项选择框时，需将 <code>v-model</code> 绑定到字符串。如果初始字符串为空或者不存在与之匹配的单选框内容，则不选中，否则选择与之匹配的单选框。</p>
<p>选择时，将选中项（唯一）的内容替换到字符串中。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">disabled</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>请选择<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>A<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>B<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>C<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Selected: &#123;&#123; selected &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            selected: <span class="string">'B'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="多向选择框"><a href="#多向选择框" class="headerlink" title="多向选择框"></a>多向选择框</h4><p>使用多项选择框时，需将 <code>v-model</code> 绑定到同一个数组中。如果复选框内容与数组内容匹配，则默认选中。</p>
<p>选中时，会将选中项按选项框顺序放入数组中，取消选择时，则从数组中删除对应项。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span> <span class="attr">multiple</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">disabled</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>请选择<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>A<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>B<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>C<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>Selected: &#123;&#123; selected &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            selected: [<span class="string">'A'</span>,<span class="string">'B'</span>]		<span class="comment">// 按 A/B/C 的顺序排列</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h2><p>修饰符 ( <code>modifier</code> ) 是以半角句号 <code>.</code> 指明的特殊后缀，用于指出一个指令应该以特殊方式绑定。修饰符可以串联。</p>
<font color="red">修饰符可以链式连接，同时有多重修饰符的效果，除了部分会产生相互冲突。</font>

<h3 id="事件修饰符"><a href="#事件修饰符" class="headerlink" title="事件修饰符"></a>事件修饰符</h3><p>使用 <code>v-on:</code> 来监听事件，在事件后添加事件修饰符，进行事件特殊处理。</p>
<h4 id="prevent-阻止默认行为"><a href="#prevent-阻止默认行为" class="headerlink" title=".prevent 阻止默认行为"></a><code>.prevent</code> 阻止默认行为</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DOM 中的阻止默认行为</span></span><br><span class="line">event.preventDefault();</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form v-on:submit.prevent=<span class="string">"onSubmit"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h4 id="stop-阻止事件冒泡"><a href="#stop-阻止事件冒泡" class="headerlink" title=".stop 阻止事件冒泡"></a><code>.stop</code> 阻止事件冒泡</h4><p>事件从里往外传递。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DOM 中的取消冒泡</span></span><br><span class="line">event.cancelBubble = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click</span>=<span class="string">"divHandler"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"点击"</span> @<span class="attr">click.stop</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 方法对象，不是数组</span></span></span><br><span class="line"><span class="undefined">      methods: &#123;</span></span><br><span class="line"><span class="undefined">        divHandler() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'divHandler'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        btnHandler() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'btnHandler'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">       &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 点击按钮</span><br><span class="line">// btnHandler</span><br><span class="line">// divHandler</span><br></pre></td></tr></table></figure>
<h4 id="capture-事件捕获模式"><a href="#capture-事件捕获模式" class="headerlink" title=".capture 事件捕获模式"></a><code>.capture</code> 事件捕获模式</h4><p>事件从外往里传递。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click</span>=<span class="string">"divHandler"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"点击"</span> @<span class="attr">click.capture</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 方法对象，不是数组</span></span></span><br><span class="line"><span class="undefined">      methods: &#123;</span></span><br><span class="line"><span class="undefined">        divHandler() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'divHandler'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        btnHandler() &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'btnHandler'</span>)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">       &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 点击按钮</span><br><span class="line">// divHandler</span><br><span class="line">// btnHandler</span><br></pre></td></tr></table></figure>
<h4 id="self-事件只在元素本身触发时回调"><a href="#self-事件只在元素本身触发时回调" class="headerlink" title=".self 事件只在元素本身触发时回调"></a><code>.self</code> 事件只在元素本身触发时回调</h4><p>将事件绑定到自身，只有自身才能触发，通常用于避免冒泡事件的影响，但是<code>.self</code> 不会阻止事件冒泡。</p>
<h4 id="once-事件单次触发"><a href="#once-事件单次触发" class="headerlink" title=".once 事件单次触发"></a><code>.once</code> 事件单次触发</h4><p>事件只会触发一次。</p>
<h4 id="passive"><a href="#passive" class="headerlink" title=".passive"></a><code>.passive</code></h4><p>具体作用不详。</p>
<p>该修饰符大概意思用于对DOM的默认事件进行性能优化，根据官网的例子比如超出最大范围的滚动条滚动的。</p>
<p><code>.passive</code> 修饰符尤其能够提升移动端的性能。</p>
<p>不要把 <code>.passive</code> 和 <code>.prevent</code> 一起使用，因为 <code>.prevent</code> 将会被忽略，同时浏览器可能会向你展示一个警告。请记住，<code>.passive</code> 会告诉浏览器你<em>不</em>想阻止事件的默认行为。</p>
<h3 id="键盘按键修饰符"><a href="#键盘按键修饰符" class="headerlink" title="键盘按键修饰符"></a>键盘按键修饰符</h3><p>在监听键盘事件时添加修饰符。</p>
<h4 id="常见按键码别名"><a href="#常见按键码别名" class="headerlink" title="常见按键码别名"></a>常见按键码别名</h4><h5 id="一般修饰符"><a href="#一般修饰符" class="headerlink" title="一般修饰符"></a>一般修饰符</h5><ul>
<li><code>.enter</code> </li>
<li><code>.tab</code></li>
<li><code>.delete</code> </li>
<li><code>.esc</code></li>
<li><code>.space</code></li>
<li><code>.up</code></li>
<li><code>.down</code></li>
<li><code>.left</code></li>
<li><code>.right</code></li>
</ul>
<h5 id="系统修饰符"><a href="#系统修饰符" class="headerlink" title="系统修饰符"></a>系统修饰符</h5><ul>
<li><code>.ctrl</code></li>
<li><code>.alt</code></li>
<li><code>.shift</code></li>
<li><code>.meta</code> （win/cmd）</li>
</ul>
<h4 id="exact"><a href="#exact" class="headerlink" title=".exact"></a><code>.exact</code></h4><p><code>.exact</code> 修饰符允许控制由精确的系统修饰符组合触发的事件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 即使其他键被一同按下时也会触发 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.ctrl</span>=<span class="string">"onClick"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- 有且只有 Ctrl 被按下的时候才触发 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.ctrl.exact</span>=<span class="string">"onCtrlClick"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- 没有任何系统修饰符被按下的时候才触发 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click.exact</span>=<span class="string">"onClick"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="自定义按键修饰符别名"><a href="#自定义按键修饰符别名" class="headerlink" title="自定义按键修饰符别名"></a>自定义按键修饰符别名</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以使用 `v-on:keyup.f1`</span></span><br><span class="line">Vue.config.keyCodes = &#123;</span><br><span class="line">  v: <span class="number">86</span>,</span><br><span class="line">  f1: <span class="number">112</span>,</span><br><span class="line">  <span class="comment">// 使用 kebab-case 且用双引号括起来</span></span><br><span class="line">  <span class="string">"media-play-pause"</span>: <span class="number">179</span>,</span><br><span class="line">  up: [<span class="number">38</span>, <span class="number">87</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> @<span class="attr">keyup.media-play-pause</span>=<span class="string">"method"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> @<span class="attr">keyup.u</span>=<span class="string">"method"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="按键码"><a href="#按键码" class="headerlink" title="按键码"></a>按键码</h4><p><code>keyCode</code> 的事件用法已经被废弃了并可能不会被最新的浏览器支持，但是使用 <code>keyCode</code> 特性也是允许的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用 enter 的按键码 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-on:keyup.13</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用 enter 的按键修饰符 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-on:keyup.enter</span>=<span class="string">"submit"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/23/框架-Vuejs/字母数字按键码.png" alt="字母数字按键码.png"></p>
<p><img src="/2019/03/23/框架-Vuejs/控制与多媒体按键码.png" alt="控制与多媒体按键码.png"></p>
<h3 id="鼠标按键修饰符"><a href="#鼠标按键修饰符" class="headerlink" title="鼠标按键修饰符"></a>鼠标按键修饰符</h3><ul>
<li><code>.left</code></li>
<li><code>.right</code></li>
<li><code>.middle</code></li>
</ul>
<h3 id="表单修饰符"><a href="#表单修饰符" class="headerlink" title="表单修饰符"></a>表单修饰符</h3><h4 id="lazy"><a href="#lazy" class="headerlink" title=".lazy"></a><code>.lazy</code></h4><p>在默认情况下，<code>v-model</code> 在每次 <code>input</code> 事件触发后将输入框的值与数据进行同步，<code>input</code> 文本框中的内容改变时，会自动将数值更新到 <code>Vue</code> 实例中。</p>
<p>添加 <code>lazy</code> 修饰符，从而转变为使用 <code>change</code> 事件进行同步，<code>input</code> 文本框中的内容改变后不再会自动保存到 <code>Vue</code> 实例中，需要敲回车进行保存。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 在“change”时而非“input”时更新 --&gt;</span><br><span class="line">&lt;input v-model.lazy=&quot;msg&quot; &gt;</span><br></pre></td></tr></table></figure>
<h4 id="number-数值转换修饰符"><a href="#number-数值转换修饰符" class="headerlink" title=".number 数值转换修饰符"></a><code>.number</code> 数值转换修饰符</h4><p>如果想自动将用户的输入值转为数值类型，可以给 <code>v-model</code> 添加 <code>number</code> 修饰符。</p>
<p>默认情况下传入值是 <code>String</code> 字符串类型，然后直接存储到 <code>Vue</code> 实例，使用 <code>.number</code> 修饰符之后会转换成 <code>number</code> 数值类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input v-model.number=&quot;age&quot; type=&quot;number&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>这通常很有用，因为即使在 <code>type=&quot;number&quot;</code> 时，HTML 输入元素的值也总会返回字符串。如果这个值无法被 <code>parseFloat()</code> 解析，则会返回原始的值。</p>
<h4 id="trim-去首尾空格修饰符"><a href="#trim-去首尾空格修饰符" class="headerlink" title=".trim 去首尾空格修饰符"></a><code>.trim</code> 去首尾空格修饰符</h4><p>如果要自动过滤用户输入的首尾空白字符，可以给 <code>v-model</code> 添加 <code>trim</code> 修饰符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input v-model.trim=&quot;msg&quot;&gt;</span><br></pre></td></tr></table></figure>
<h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><p>过滤器用于一些常见的文本格式化，可以用在两个地方：<strong>双花括号插值表达式</strong> 和 <strong><code>v-bind</code> 表达式</strong> 的尾部，由<strong>管道符号（<code>|</code>）</strong>指示。管道符前是属性键名，管道符后是过滤器名。</p>
<h3 id="使用过滤器"><a href="#使用过滤器" class="headerlink" title="使用过滤器"></a>使用过滤器</h3><p>过滤器的执行过程是将原始数据（如 <code>message</code> ）作为形参传入到过滤器方法中，返回一个处理后的值用以显示。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用过滤器 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 在双花括号中 --&gt;</span></span><br><span class="line">&#123;&#123; message | 过滤器名称 &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 多形参 --&gt;</span></span><br><span class="line">&#123;&#123; message | 过滤器名称( 形参1, 形参2) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 在 `v-bind` 中 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">"rawId | 过滤器名称"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="定义过滤器"><a href="#定义过滤器" class="headerlink" title="定义过滤器"></a>定义过滤器</h3><h4 id="全局过滤器"><a href="#全局过滤器" class="headerlink" title="全局过滤器"></a>全局过滤器</h4><p>全局过滤器是在 <code>Vue</code> 实例创建之前创建的，之后创建的所有 <code>Vue</code> 都可以使用该过滤器。</p>
<p>一般全局定义都不带 s ，私有定义会带 s 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个参数 value 表示的是管道符前传来的数据，就是原始数据，是默认自动传入的，在调用时候不用显式传入该值，直接传入其他形参即可。</span></span><br><span class="line">Vue.filter(<span class="string">'过滤器名称'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">value[, params]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ...</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 Vue 实例</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="私有过滤器"><a href="#私有过滤器" class="headerlink" title="私有过滤器"></a>私有过滤器</h4><p>私有过滤器是指在 <code>Vue</code> 实例内创建的过滤器，只能在当前 <code>Vue</code> 实例中使用。</p>
<p>私有过滤器与全局过滤器重名时，私有过滤器的优先级大于全局过滤器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#'</span>,</span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">    <span class="comment">// 虽然有 s ，但是它是对象，不是数组</span></span><br><span class="line">    filters: &#123;</span><br><span class="line">        过滤器名称: <span class="function"><span class="keyword">function</span>(<span class="params">value[, params]</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="过滤器串联"><a href="#过滤器串联" class="headerlink" title="过滤器串联"></a>过滤器串联</h3><p>过滤器串联执行过程是将原始数据传入第一个过滤器，经处理后的结果作为之后过滤器的默认传入值，逐个执行所有过滤器之后，最终结果用以显示。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在双花括号中 --&gt;</span></span><br><span class="line">&#123;&#123; message | 过滤器1 | 过滤器2 &#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#example'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    message: <span class="string">'Hello'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 计算属性</span></span><br><span class="line">  computed: &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>模板语法内的 <code>JS</code> 表达式非常便利，但是设计它们的初衷是用于简单运算的。在模板中放入太多的逻辑会让模板过重且难以维护。所以任何复杂逻辑，你都应当使用<strong>计算属性</strong>。</p>
<p><strong>计算属性，它就是一个属性，它是通过函数计算出来的属性，其本质与 data 中的数据属性相同，用法也完全相同。程序在编译时，会在 data 和 computed 中查找属性名。</strong></p>
<p>首先有一个字符串 <code>message</code> ，我们想得到它的反向字符串  <code>reversedMessage</code> 。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>"&#123;&#123; message &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>"&#123;&#123; reversedMessage &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">      data: &#123;</span></span><br><span class="line"><span class="javascript">        message: <span class="string">'Hello'</span></span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined">      computed: &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 声明一个计算属性 reversedMessage，调用方法返回一个值给属性</span></span></span><br><span class="line"><span class="javascript">        reversedMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// this 指向 vm 实例，这里可以不使用 () =&gt; &#123;&#125; 箭头函数形式</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="keyword">this</span>.message.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p> <code>reversedMessage</code> 字符串完全依赖于 <code>message</code> ，其值随着 <code>message</code> 改变而改变，他们之间的依赖也会更新。</p>
<h3 id="计算属性与方法区别"><a href="#计算属性与方法区别" class="headerlink" title="计算属性与方法区别"></a>计算属性与方法区别</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用方法，实现同样效果 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>"&#123;&#123; message &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 调用方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>"&#123;&#123; reversedMessage() &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#example'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">            message: <span class="string">'Hello'</span></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 在组件中</span></span></span><br><span class="line"><span class="undefined">        methods: &#123;</span></span><br><span class="line"><span class="javascript">            reversedMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 不用 return</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.message.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>两种方式的最终结果确实是完全相同的。不同的是<strong>计算属性是基于它们的依赖进行缓存的</strong>。</p>
<p>只要计算属性的函数内部设计的其他属性没有改变，再次访问计算属性会从缓存中获取之前的值进行返回，而 <code>methods</code> 中的方法每次访问都会重新调用。</p>
<h2 id="Watch-侦听器-侦听属性"><a href="#Watch-侦听器-侦听属性" class="headerlink" title="Watch 侦听器/侦听属性"></a><code>Watch</code> 侦听器/侦听属性</h2><p><code>Vue</code> 通过 <code>watch</code> 选项提供了一个更通用的方法，来响应数据的变化。当需要在数据变化时执行异步或开销较大的操作时，这个方式是最有用的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">'#app'</span>,</span><br><span class="line">        <span class="comment">// 监听器</span></span><br><span class="line">        watch: &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="监听属性"><a href="#监听属性" class="headerlink" title="监听属性"></a>监听属性</h3><p>如下是一个简单的监听并相应数据变化的案例。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"firstVal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span> + <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"secondVal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span> = <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"lastVal"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            firstVal: <span class="string">''</span>,</span></span><br><span class="line"><span class="javascript">            secondVal: <span class="string">''</span>,</span></span><br><span class="line"><span class="javascript">            lastVal: <span class="string">''</span></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        watch: &#123;</span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             * 监听 firstVal 属性，当 firstVal 值发生改变的时候调用方法</span></span><br><span class="line"><span class="undefined">             * newVal: 新值</span></span><br><span class="line"><span class="undefined">             * oldVal: 旧值</span></span><br><span class="line"><span class="undefined">             */</span></span><br><span class="line"><span class="javascript">            firstVal: <span class="function"><span class="keyword">function</span>(<span class="params">newVal, oldVal</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.lastVal = newVal + <span class="string">' '</span> + <span class="keyword">this</span>.secondVal</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">            * 监听 secondVal 属性，当 secondVal 值发生改变的时候调用方法</span></span><br><span class="line"><span class="undefined">            */</span></span><br><span class="line"><span class="javascript">            secondVal: <span class="function"><span class="keyword">function</span>(<span class="params">newVal, oldVal</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.lastVal = <span class="keyword">this</span>.firstVal + <span class="string">' '</span> + newVal</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>但是其实这种最基础层面的用法完全可以用 <code>Computed</code> 计算属性来实现，而且更简单。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"firstVal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span> + <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"secondVal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span> = <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"lastVal"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            firstVal: <span class="string">''</span>,</span></span><br><span class="line"><span class="javascript">            secondVal: <span class="string">''</span>,</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        computed: &#123;</span></span><br><span class="line"><span class="javascript">            lastVal: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="keyword">this</span>.firstVal + <span class="string">' '</span> + <span class="keyword">this</span>.secondVal</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<font color="red">注意，计算属性不能在 data 中放属性名，而监听属性需要。</font>

<p>如果给两个 <code>input</code> 添加 <code>keyup</code> 监听事件，然后在 <code>method</code> 中写方法，这样也比使用 <code>watch</code> 方便的多。<code>watch</code> 监听的真谛不在于此。</p>
<h3 id="监视路由"><a href="#监视路由" class="headerlink" title="监视路由"></a>监视路由</h3><p>路由时非 <code>DOM</code> 元素，无法使用其他的事件监听。此时再用 <code>watch</code> 监听路由变化，会非常方便。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    router: routerObj,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        <span class="string">'$route.path'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">newVal, oldVal</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (newVal === <span class="string">'/login'</span>) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'欢迎进入登录页面'</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (newVal === <span class="string">'/register'</span>) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'欢迎进入注册页面'</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="methods-computed-watch-对比"><a href="#methods-computed-watch-对比" class="headerlink" title="methods / computed  / watch 对比"></a>methods / computed  / watch 对比</h2><ul>
<li><code>methods</code> 方法：表示一个具体的操作，侧重于业务逻辑操作。</li>
<li><code>computed</code> 计算属性：是一个响应式的属性，有缓存值。</li>
<li><code>watch</code> 监听属性：主要用来监听一些非 <code>DOM</code> 元素的数据变化，从而进行业务逻辑操作，可以看成是 <code>methods</code> 和 <code>computed</code> 的结合体。</li>
</ul>
<h2 id="Class-与-Style-绑定"><a href="#Class-与-Style-绑定" class="headerlink" title="Class 与 Style 绑定"></a><code>Class</code> 与 <code>Style</code> 绑定</h2><p><code>Class</code> 与 <code>Style</code> 都是属性，所以我们可以使用 <code>v-bind:</code> 来绑定这些属性，但是<strong>字符串</strong>拼接麻烦且易错。</p>
<p>因此，在将 <code>v-bind</code> 用于 <code>class</code> 和 <code>style</code> 时，<code>Vue.js</code> 做了专门的增强。表达式结果的类型除了字符串之外，还可以是<strong>对象或数组</strong>。</p>
<h3 id="Class-绑定"><a href="#Class-绑定" class="headerlink" title="Class 绑定"></a><code>Class</code> 绑定</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 样例 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .red &#123;</span></span><br><span class="line"><span class="undefined">            color: red;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .thin &#123;</span></span><br><span class="line"><span class="undefined">            font-weight: 200;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .italic &#123;</span></span><br><span class="line"><span class="undefined">            font-style: italic;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .active &#123;</span></span><br><span class="line"><span class="undefined">            letter-spacing: 0.5em;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 原始的 class， 也是 vue 的渲染效果 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"red thin italic active"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                isActive: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                colorClass: <span class="string">'red'</span>,</span></span><br><span class="line"><span class="javascript">                weightClass: <span class="string">'thin'</span>,</span></span><br><span class="line"><span class="javascript">                styleClass: <span class="string">'italic'</span>,</span></span><br><span class="line"><span class="javascript">                activeClass: <span class="string">'active'</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Class-对象语法"><a href="#Class-对象语法" class="headerlink" title="Class 对象语法"></a><code>Class</code> 对象语法</h4><p>直接给 <code>Class</code> 传入一个对象，以动态切换类。</p>
<h5 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h5><p>直接在 <code>Class</code> 中添加一个对象。键名为类名，可以加引号也可以不加；键值为布尔类型，表示是否使用，键值也可以从 <code>data</code> 数据中获取。</p>
<p>让当然，也可以将对象定义在 <code>data</code> 中，然后给 <code>Class</code> 属性，但是这种方式不能直接获取 <code>data</code> 中的其他数据作为对象中的变量，不过可以通过 <code>computed</code> 计算属性来实现。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 内联形式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"&#123; </span></span></span><br><span class="line"><span class="tag"><span class="string">                // 直接写值</span></span></span><br><span class="line"><span class="tag"><span class="string">                red: true, this: true, italic: true,</span></span></span><br><span class="line"><span class="tag"><span class="string">                // 从 data 数据中获取</span></span></span><br><span class="line"><span class="tag"><span class="string">                active : isActive </span></span></span><br><span class="line"><span class="tag"><span class="string">                &#125;"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"classobj"</span>&gt;</span></span><br><span class="line">        这个是一个很大很大的h1</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined">            ...</span></span><br><span class="line"><span class="undefined">            classObj: &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 只能是布尔值</span></span></span><br><span class="line"><span class="javascript">                red: <span class="literal">true</span>, </span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>: <span class="literal">true</span>, </span></span><br><span class="line"><span class="javascript">                italic: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                active: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="Class-结合-computed-计算属性"><a href="#Class-结合-computed-计算属性" class="headerlink" title="Class 结合 computed 计算属性"></a><code>Class</code> 结合 <code>computed</code> 计算属性</h5><p>因为 <code>computed</code> 可以执行复杂操作，并且可以通过 <code>this</code> 获取 <code>Vue</code> 中的数据。 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"classobj"</span>&gt;</span></span><br><span class="line">        这个是一个很大很大的h1</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            isActive: <span class="literal">true</span>,</span></span><br><span class="line"><span class="undefined">            color: &#123;</span></span><br><span class="line"><span class="javascript">                value: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                type: <span class="string">'red'</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        computed: &#123;</span></span><br><span class="line"><span class="javascript">            classobj: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                    active: <span class="keyword">this</span>.isActive,</span></span><br><span class="line"><span class="javascript">                    red: <span class="keyword">this</span>.color.value &amp;&amp; <span class="keyword">this</span>.color.type === <span class="string">'red'</span>,</span></span><br><span class="line"><span class="javascript">                    thin: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                    italic: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Class-数组语法"><a href="#Class-数组语法" class="headerlink" title="Class 数组语法"></a><code>Class</code> 数组语法</h4><p><code>Vue</code>使用数组类型设置  <code>Class</code>  ，将原先的字符串内容改成数组，<strong>类名必须是字符串类型</strong>，支持动态获取 <code>Vue</code> 实例中的 <code>data</code> 数据，这样使得样式操作也具有响应式，更加方便快捷。</p>
<h5 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 原始的 class， 也是 vue 的渲染效果 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"red thin italic active"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- vue 的数组 class --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"['red', 'thin', 'italic', 'active']"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 获取 data 中数据的 vue 数组 class --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"[colorClass, weightClass, styleClass, activeClass]"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            colorClass: <span class="string">'red'</span></span></span><br><span class="line"><span class="javascript">            weightClass: <span class="string">'thin'</span>,</span></span><br><span class="line"><span class="javascript">            styleClass: <span class="string">'italic'</span>,</span></span><br><span class="line"><span class="javascript">            activeClass: <span class="string">'active'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="三元表达式"><a href="#三元表达式" class="headerlink" title="三元表达式"></a>三元表达式</h5><p>在数组可以使用三元表达式，当然仅用数组形式写三元表达式会显得代码比较长，可以使用<strong>对象语法</strong>实现三元表达式的判断效果，让代码简洁一些。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- vue 数组形式的 class 三元表达式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"[ isActive ? activeClass : '' ]"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- vue 数组形式的 class 结合对象实现判断操作，虽然这样写有些奇怪，可以直接使用对象 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"[&#123; active : isActive &#125;]"</span>&gt;</span>这个是一个很大很大的h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            isActive: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">            activeClass: <span class="string">'active'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Style"><a href="#Style" class="headerlink" title="Style"></a><code>Style</code></h3><p>基本和 <code>Class</code> 类似，不再赘述。</p>
<h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><p>由于浏览器的安全限制，不允许 <code>Ajax</code> 访问协议不同、域名不同、端口号不同的数据接口，浏览器认为这种访问不安全。</p>
<p>可以通过动态创建 <code>script</code> 标签的形式，把 <code>script</code> 标签的 <code>src</code> 属性，指向书接口的地址，因为 <code>script</code> 标签不存在跨域请求限制，这种数据获取方式称为 <code>JSONP</code> ，<code>JSONP</code> 只支持 <code>GET</code> 请求。</p>
<p>实现过程：</p>
<ul>
<li><p>先在客户端定义一个回调方法，预定义对数据的操作。</p>
</li>
<li><p>在把这个回调方法的名称，通过 <code>url</code> 传参的形式，提交到服务器的数据接口。</p>
</li>
<li><p>服务器数据接口组织好要发送给客户端的数据，再拿着客户端传递过来的回调方法名称，拼接处一个调用这个犯法的字符串，发送给客户端去解析执行。</p>
</li>
<li><p>客户端拿到服务器返回的字符串之后，当做 <code>script</code> 脚本去解析执行，这样就能拿到 <code>JSONP</code> 的数据了。</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 获取数据后，调用 'showInfo' 方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">showInfo</span>(<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 请求端口，将回调方法的名称 'showInfo' 提交数据接口 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://127.0.0.1:8888/getscript?callback=showInfo"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'127.0.0.1'</span></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8888</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 访问 '/getscript' </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">app.get(<span class="string">'/getscript'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> query = req.query</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> data = &#123;</span><br><span class="line">    name: <span class="string">'大明'</span>,</span><br><span class="line">    age: <span class="number">18</span>,</span><br><span class="line">    gener: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拼接返回字符串：scriptStri：showInfo(&#123;"name":"大明","age":18,"gener":0&#125;)</span></span><br><span class="line">  <span class="keyword">var</span> scriptStri = <span class="string">`<span class="subst">$&#123;query.callback&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span></span><br><span class="line">  res.send(scriptStri)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(port, hostname, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`服务器启动成功，请查看 http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/ `</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="异步请求"><a href="#异步请求" class="headerlink" title="异步请求"></a>异步请求</h2><p><code>Ajax</code> 是 <code>jQuery</code> 的异步请求方式，但是 <code>Vue</code> 的原则是不操作 <code>DOM</code> 。所以 <code>Vue</code> 要实现异步加载需要使用到 <code>vue-resource</code> 库或者 <code>vue-axios</code>。</p>
<p>他们都是基于 <code>Promise</code> 进行封装的，所以在学之前最好了解下 <code>Promise</code> 。</p>
<h3 id="vue-resource（vue-2-0-已停止维护，仍然即可）"><a href="#vue-resource（vue-2-0-已停止维护，仍然即可）" class="headerlink" title="vue-resource（vue 2.0 已停止维护，仍然即可）"></a>vue-resource（vue 2.0 已停止维护，仍然即可）</h3><p>github：<a href="https://github.com/pagekit/vue-resource" target="_blank" rel="noopener">https://github.com/pagekit/vue-resource</a></p>
<h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i vue-resource -S</span><br></pre></td></tr></table></figure>
<h4 id="导包"><a href="#导包" class="headerlink" title="导包"></a>导包</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue-resource/dist/vue-resource.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>使用 <code>v-on</code> 绑定方法，然后在方法中使用 <code>this.$http</code> 来发起 <code>GET</code> <code>POST</code> 请求，但是注意，这是基于 <code>Promise</code> 绑定的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue-resource/dist/vue-resource.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"getInfo"</span>&gt;</span>get请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"postInfo"</span>&gt;</span>post请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="javascript">                getInfo: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.$http.get(<span class="string">'http://localhost:3000/data'</span>).then(</span></span><br><span class="line"><span class="javascript">                        <span class="comment">// 成功时的回调，data 为正确时数据对象</span></span></span><br><span class="line"><span class="undefined">                        data =&gt; &#123;</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">console</span>.log(data)</span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    )</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="javascript">                postInfo: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 使用第三参数 emulatJSON，将表单数据格式化</span></span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.$http.post(<span class="string">'http://localhost:3000/data'</span>, &#123; &#125;, &#123; <span class="attr">emulatJSON</span>: <span class="literal">true</span>&#125;).then(</span></span><br><span class="line"><span class="undefined">                        data =&gt; &#123;</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">console</span>.log(data)</span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    )</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h3><p><code>Axios</code> 是一个基于 <code>promise</code> 的 <code>HTTP</code> 库，可以用在浏览器和 <code>node.js</code> 中。 不支持跨域。</p>
<p>注意，在 <code>vue-cli</code> 项目中使用 <code>axios</code> ，需要使用原型链。参考 <a href="https://www.cnblogs.com/hdnav/p/7596644.html" target="_blank" rel="noopener">https://www.cnblogs.com/hdnav/p/7596644.html</a></p>
<h4 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i axios -S</span><br></pre></td></tr></table></figure>
<h4 id="导包-1"><a href="#导包-1" class="headerlink" title="导包"></a>导包</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/axios/dist/axios.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h4><p><code>axios</code> 数据存储在 <code>data</code> 对象中。<code>axios</code> 异步请求操作直接写在方法中即可。如果需要在页面渲染之前就异步加载数据，可以将方法在 <code>created()</code> 生命函数中调用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加载 axios 和 vue --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/axios/dist/axios.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"getInfo()"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="undefined">                getInfo() &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 使用 axios，发送 get 请求</span></span></span><br><span class="line"><span class="javascript">                    axios.get(<span class="string">'http://localhost:3000/message'</span>).then(</span></span><br><span class="line"><span class="undefined">                        res =&gt; &#123;</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">console</span>.log(<span class="string">'成功了，'</span>, res.data)</span></span><br><span class="line"><span class="undefined">                        &#125;,</span></span><br><span class="line"><span class="undefined">                        err =&gt; &#123;</span></span><br><span class="line"><span class="javascript">                            <span class="built_in">console</span>.log(<span class="string">'错误了'</span>)</span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    )</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h4><p>可以通过 <code>axios(config)</code> 向 <code>axios</code> 传递相关配置来创建请求。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    send: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        axios(&#123;</span><br><span class="line">            method: <span class="string">'get'</span>,</span><br><span class="line">            url: <span class="string">'http://localhost:3000/users'</span>,</span><br><span class="line">            params: &#123;</span><br><span class="line">                <span class="comment">// 与请求一起发送的 URL 参数，会自动拼接</span></span><br><span class="line">                ID: <span class="number">12345</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).then(</span><br><span class="line">            res =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            err =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'请求错误'</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过 <code>axios.get(url[, config])</code> 请求方法实现。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    send: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        axios.get(<span class="string">'http://localhost:3000/users'</span>).then(</span><br><span class="line">            res =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            err =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'请求错误'</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h4><p>以前的版本好像不能直接传 <code>json</code> 形式的参数，现在可以。</p>
<p>如果无法传 <code>json</code> 形式参数，则使用如下以下传参方法：</p>
<ul>
<li>自己拼接键值对：’name=大明&amp;age=20’。</li>
<li>使用 <code>transformResponse</code> ，在请求发送前将数据进行转换。</li>
<li>模块化开发中使用 <code>qs</code> 模块</li>
</ul>
<p>可以通过 <code>axios(config)</code> 向 <code>axios</code> 传递相关配置来创建请求。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    send: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        axios(&#123;</span><br><span class="line">            method: <span class="string">'post'</span>,</span><br><span class="line">            url: <span class="string">'http://localhost:3000/users'</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">                name: <span class="string">'xiaohua'</span>,</span><br><span class="line">                gender: <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).then(</span><br><span class="line">            res =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            err =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'输入插入错误'</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过 <code>axios.post(url, data[, config])</code> 请求方法实现。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    send: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        axios.post(<span class="string">'http://localhost:3000/users'</span>,&#123;</span><br><span class="line">            name: <span class="string">'xiaohua'</span>,</span><br><span class="line">            gender: <span class="number">0</span></span><br><span class="line">        &#125;).then(</span><br><span class="line">            res =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            err =&gt; &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'请求错误'</span>, err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="常用配置选项-config"><a href="#常用配置选项-config" class="headerlink" title="常用配置选项 config"></a>常用配置选项 <code>config</code></h4><ul>
<li><p><code>url: &#39;/user&#39;</code> ：用于请求的服务器 <code>URL</code> 字符串。</p>
</li>
<li><p><code>method: &#39;get&#39;</code> ：是创建请求时使用的方法，默认是 ‘get’。</p>
</li>
<li><p><code>baseURL: &#39;https://localhost:3000/&#39;</code> ：<code>baseURL</code> 将自动加在 <code>url</code> 前面，除非 <code>url</code> 是一个绝对 URL。可以直接全写在 <code>url</code> 中，但是不建议这么做！！！</p>
</li>
<li><p><code>transformRequest</code> ：允许<code>PUT</code> 、<code>POST</code> 和 <code>PATCH</code> 这几个请求方在向服务器发送前，修改请求数据。后面数组中的函数必须返回一个字符串，或 <code>ArrayBuffer</code> ，或 <code>Stream</code> ，然后在里面写方法。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">transformRequest: [<span class="function"><span class="keyword">function</span> (<span class="params">data, headers</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对 data 进行任意转换处理</span></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>transformResponse</code> 在传递给 then/catch 前，允许修改响应数据。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">transformResponse: [<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对 data 进行任意转换处理</span></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>headers: {&#39;X-Requested-With&#39;: &#39;XMLHttpRequest&#39;}</code> ： 是即将被发送的自定义请求头。</p>
</li>
<li><p><code>params</code> ：是即将与请求一起发送的 URL 参数。必须是一个无格式对象( <code>plain object</code> )或 <code>URLSearchParams</code> 对象。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">params: &#123;</span><br><span class="line">    ID: <span class="number">12345</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>data</code> ： 是作为请求主体被发送的数据。只适用于这些请求方法 <code>PUT</code>、 <code>POST</code> 和 <code>PATCH</code> 。在没有设置 <code>transformRequest</code> 时，必须是以下类型之一：</p>
<ul>
<li><code>string</code> , <code>plain object</code> , <code>ArrayBuffer</code> , <code>ArrayBufferView</code> , <code>URLSearchParams</code>。</li>
<li>浏览器专属：<code>FormData</code> , <code>File</code> , <code>Blob</code></li>
<li><code>Node</code> 专属：<code>Stream</code></li>
</ul>
</li>
<li><p><code>timeout: 1000</code> 指定请求超时的毫秒数(0 表示无超时时间)。</p>
</li>
<li><p><code>withCredentials: false</code> 表示跨域请求时是否需要使用凭证，默认 <code>false</code>。</p>
</li>
</ul>
<h4 id="配置默认值"><a href="#配置默认值" class="headerlink" title="配置默认值"></a>配置默认值</h4><h5 id="全局的-axios-默认值"><a href="#全局的-axios-默认值" class="headerlink" title="全局的 axios 默认值"></a>全局的 <code>axios</code> 默认值</h5><p>配置全局的 <code>axios</code> 默认值一般写在最前面或者单独放在配置文件中。以 <code>axios.defaults.</code> 开头，之后写需要配置默认值的属性及默认值。默认值的级别一般较低。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 添加配置全局默认的根路径</span></span></span><br><span class="line"><span class="javascript">        axios.defaults.baseURL = <span class="string">'http://127.0.0.1:3000/'</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 默认表单提交类型</span></span></span><br><span class="line"><span class="javascript">        axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded'</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 默认请求等待时间</span></span></span><br><span class="line"><span class="undefined">        axios.defaults.timeout = 2500</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="undefined">                send() &#123;</span></span><br><span class="line"><span class="undefined">                    axios(&#123;</span></span><br><span class="line"><span class="javascript">                        url: <span class="string">'/main'</span>,</span></span><br><span class="line"><span class="javascript">                        <span class="comment">// 在 axios 中添加配置</span></span></span><br><span class="line"><span class="javascript">                        <span class="comment">// baseURL: 'http://127.0.0.1:3000/',</span></span></span><br><span class="line"><span class="javascript">                        method: <span class="string">'get'</span></span></span><br><span class="line"><span class="undefined">                    &#125;).then(</span></span><br><span class="line"><span class="undefined">                        data =&gt; &#123;</span></span><br><span class="line"><span class="undefined">                            </span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    )</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="过渡动画"><a href="#过渡动画" class="headerlink" title="过渡动画"></a>过渡动画</h2><p><code>Vue</code> 提供多种不同方式的应用过渡效果。</p>
<ul>
<li>在 <code>CSS</code> 过渡和动画中自动应用 <code>class</code></li>
<li>可以配合使用第三方 <code>CSS</code> 动画库，如 <code>Animate.css</code></li>
<li>在过渡钩子函数中使用 <code>JavaScript</code> 直接操作 <code>DOM</code></li>
<li>可以配合使用第三方 <code>JavaScript 动画库</code> ，如 <code>Velocity.js</code></li>
</ul>
<p><code>Vue</code> 提供了 <code>transition</code> 组件，在下列情形中，可以给任何元素和组件添加进入/离开过渡</p>
<ul>
<li>条件渲染 (使用 <code>v-if</code>)</li>
<li>条件展示 (使用 <code>v-show</code>)</li>
<li>动态组件</li>
<li>组件根节点</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">        需要的添加动画的元素。</span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="单元素-组件的过渡"><a href="#单元素-组件的过渡" class="headerlink" title="单元素/组件的过渡"></a>单元素/组件的过渡</h3><h4 id="CSS-过渡的类"><a href="#CSS-过渡的类" class="headerlink" title="CSS 过渡的类"></a>CSS 过渡的类</h4><p><strong>进入过程</strong></p>
<ol>
<li><code>v-enter</code> ：定义进入过渡的<strong>开始状态</strong>。在元素被插入之前生效，在元素被插入之后的下一帧移除。</li>
<li><code>v-enter-active</code> ：定义进入过渡生效时的状态。在整个进入过渡的阶段中应用，在元素被插入之前生效，在过渡/动画完成之后移除。这个类可以被用来定义进入过渡的过程时间，延迟和曲线函数。</li>
<li><code>v-enter-to</code> : 定义进入过渡的<strong>结束状态</strong>。在元素被插入之后下一帧生效 (与此同时 <code>v-enter</code> 被移除)，在过渡/动画完成之后移除。</li>
</ol>
<p><strong>退出过程</strong></p>
<ol>
<li><code>v-leave</code> :  定义离开过渡的<strong>开始状态</strong>。在离开过渡被触发时立刻生效，下一帧被移除。</li>
<li><code>v-leave-active</code> ：定义离开过渡生效时的状态。在整个离开过渡的阶段中应用，在离开过渡被触发时立刻生效，在过渡/动画完成之后移除。这个类可以被用来定义离开过渡的过程时间，延迟和曲线函数。</li>
<li><code>v-leave-to</code> : 定义离开过渡的<strong>结束状态</strong>。在离开过渡被触发之后下一帧生效 (与此同时 <code>v-leave</code> 被删除)，在过渡/动画完成之后移除。</li>
</ol>
<p><img src="/2019/03/23/框架-Vuejs/transition.png" alt="transition.png"></p>
<p>实例如下。其中如果给 <code>transition</code> 加一个 <code>name</code> 属性，则其对应的类选择器名就会用 <code>name属性值-</code> 代替 <code>v-</code> 再加六个默认类名其余部分。  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 过渡类名，使用类选择器  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        /** </span></span><br><span class="line"><span class="undefined">         * 在进入之前和离开之后的状态类</span></span><br><span class="line"><span class="undefined">         */</span></span><br><span class="line"><span class="undefined">        .v-enter, .v-leave-to &#123;</span></span><br><span class="line"><span class="undefined">            opacity: 0;</span></span><br><span class="line"><span class="undefined">            /* 添加移入移出效果 */</span></span><br><span class="line"><span class="undefined">            transform: translateX(150px);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        /** </span></span><br><span class="line"><span class="undefined">         * 使用了自定义 name 属性的进入之前和离开之后的状态类</span></span><br><span class="line"><span class="undefined">         */</span></span><br><span class="line"><span class="undefined">        .xxx-enter, .xxx-leave-to &#123;</span></span><br><span class="line"><span class="undefined">            opacity: 0;</span></span><br><span class="line"><span class="undefined">            /* 添加移入移出效果 */</span></span><br><span class="line"><span class="undefined">            transform: translateX(150px);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="undefined">        /**</span></span><br><span class="line"><span class="undefined">         * 两个过渡动画类</span></span><br><span class="line"><span class="undefined">         */</span></span><br><span class="line"><span class="undefined">        .v-enter-active, .v-leave-active &#123;</span></span><br><span class="line"><span class="undefined">            transition: all 0.8s ease;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"flag = !flag"</span>&gt;</span>button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- transition 可以认为自定义添加了6个动画类 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 自定义命名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"xxx"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                flag: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="自定义过渡类名"><a href="#自定义过渡类名" class="headerlink" title="自定义过渡类名"></a>自定义过渡类名</h4><p>我们可以通过以下特性来自定义过渡类名：</p>
<ul>
<li>enter-class</li>
<li>enter-active-class</li>
<li>enter-to-class</li>
<li>leave-class</li>
<li>leave-active-class</li>
<li>leave-to-class</li>
</ul>
<p>他们的优先级高于普通的类名，这对于 <code>Vue</code> 的过渡系统和其他第三方 <code>CSS</code> 动画库，如 <code>Animate.css</code> 结合使用十分有用。</p>
<h4 id="第三方-animate-css-类库"><a href="#第三方-animate-css-类库" class="headerlink" title="第三方 animate.css 类库"></a>第三方 <code>animate.css</code> 类库</h4><p>官网：<a href="https://daneden.github.io/animate.css/" target="_blank" rel="noopener">https://daneden.github.io/animate.css/</a></p>
<p>所有动画效果都可以在官网首页进行预览。</p>
<p><img src="/2019/03/23/框架-Vuejs/animate.png" alt="animate.png"></p>
<p>可以直接下载 <code>css</code> 文件或者使用 <code>npm</code> 下载。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i animate.css -S</span><br></pre></td></tr></table></figure>
<p>导包</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/animate.css/animate.css"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>因为它是 <code>css</code> 类，所以使用非常简单，只需要在 <code>class</code> 中添加指定类名即可。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 添加了四个类：动画类、无限循环类、弹跳类、延迟类 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"animated infinite bounce delay-2s"</span>&gt;</span>Example<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>大概做一个介绍，具体内容见官网。</p>
<h4 id="自定义过渡类名结合-animate-css"><a href="#自定义过渡类名结合-animate-css" class="headerlink" title="自定义过渡类名结合 animate.css"></a>自定义过渡类名结合 <code>animate.css</code></h4><p>我们在 <code>transition</code> 组件中使用自定义过渡类名，使其等于 <code>animate.css</code> 中的类名。</p>
<p>在组件上有 <code>duration</code> 属性可以定制一个过渡持续时间。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">:duration</span>=<span class="string">"1000"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>也可以分别定制进入和移出的持续时间：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">:duration</span>=<span class="string">"&#123; enter: 500, leave: 800 &#125;"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>案例</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/animate.css/animate.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.css"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">v-on:click</span>=<span class="string">"flag = !flag"</span>&gt;</span>button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">            <span class="attr">enter-active-class</span>=<span class="string">"animated slideInRight"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">leave-active-class</span>=<span class="string">"animated slideOutRight"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:duration</span>=<span class="string">"&#123; enter: 500, leave: 1000 &#125;"</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-if</span>=<span class="string">"flag"</span>&gt;</span>Example<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                flag: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="JavaScript-过渡钩子"><a href="#JavaScript-过渡钩子" class="headerlink" title="JavaScript 过渡钩子"></a>JavaScript 过渡钩子</h4><p>在属性中声明 <code>JavaScript</code> 钩子。一共有8个过渡钩子，事件绑定后在 <code>methods</code> 中处理函数。</p>
<p>过渡钩子有一个优势，它能实现半程动画，即它能重复执行多个进入或者移出的过程。而自定义过渡类它操控一个元素进入之后，必须执行移出过程之后才可以再次执行进入动画，如果不设置自定义过渡类移出动画，它只是这个过程没有动画而已，并不是没有这个过程。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app&gt;</span></span></span><br><span class="line"><span class="tag"><span class="string">    &lt;!-- 在 transition 中声明钩子 --&gt;</span></span></span><br><span class="line"><span class="tag"><span class="string">    &lt;transition</span></span></span><br><span class="line"><span class="tag"><span class="string">        v-on:before-enter="</span><span class="attr">beforeEnter</span>"</span></span><br><span class="line"><span class="tag">        <span class="attr">v-on:enter</span>=<span class="string">"enter"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-on:after-enter</span>=<span class="string">"afterEnter"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-on:enter-cancelled</span>=<span class="string">"enterCancelled"</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">v-on:before-leave</span>=<span class="string">"beforeLeave"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-on:leave</span>=<span class="string">"leave"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-on:after-leave</span>=<span class="string">"afterLeave"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-on:leave-cancelled</span>=<span class="string">"leaveCancelled"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        methods: &#123;</span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             * 进入过程</span></span><br><span class="line"><span class="undefined">             */</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            beforeEnter: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 进入之前的函数</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 设置元素开始之前的起始样式</span></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            enter: <span class="function"><span class="keyword">function</span> (<span class="params">el, done</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 进入之前的函数</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 当与 CSS 结合使用时</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 回调函数 done 是可选的</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 当只用 JavaScript 过渡的时候，必须回调</span></span></span><br><span class="line"><span class="undefined">                done()</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            afterEnter: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 进入之后的函数</span></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            enterCancelled: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// ...</span></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             * 离开过程</span></span><br><span class="line"><span class="undefined">             */</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            beforeLeave: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 离开前的函数</span></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            leave: <span class="function"><span class="keyword">function</span> (<span class="params">el, done</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 离开时的函数</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 当与 CSS 结合使用时</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 回调函数 done 是可选的</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 当只用 JavaScript 过渡的时候，必须回调</span></span></span><br><span class="line"><span class="undefined">                done()</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            afterLeave: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 离开之后的函数</span></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            leaveCancelled: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// leaveCancelled 只用于 v-show 中</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：当只用 <code>JavaScript</code> 过渡的时候，在 <code>enter</code> 和 <code>leave</code> 中必须使用 <code>done</code> 进行回调。否则，它们将被同步调用，过渡会立即完成。</p>
<p><strong>注意</strong>：推荐对于仅使用 <code>JavaScript</code> 过渡的元素添加 <code>v-bind:css=&quot;false&quot;</code>，<code>Vue</code> 会跳过 <code>CSS</code> 的检测。这也可以避免过渡过程中 <code>CSS</code> 的影响。</p>
<h3 id="appear-初始渲染过渡"><a href="#appear-初始渲染过渡" class="headerlink" title="appear 初始渲染过渡"></a><code>appear</code> 初始渲染过渡</h3><p><code>appear</code> 属性设置节点在初始渲染的过渡。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">appear</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>也可以和 <code>CSS</code> 过渡/ <code>JavaScript</code> 钩子结合使用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">    <span class="attr">appear</span></span></span><br><span class="line"><span class="tag">    <span class="attr">appear-class</span>=<span class="string">"custom-appear-class"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">appear-to-class</span>=<span class="string">"custom-appear-to-class"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">appear-active-class</span>=<span class="string">"custom-appear-active-class"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">    <span class="attr">appear</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-on:before-appear</span>=<span class="string">"customBeforeAppearHook"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-on:appear</span>=<span class="string">"customAppearHook"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-on:after-appear</span>=<span class="string">"customAfterAppearHook"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-on:appear-cancelled</span>=<span class="string">"customAppearCancelledHook"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="多元素的过渡"><a href="#多元素的过渡" class="headerlink" title="多元素的过渡"></a>多元素的过渡</h3><p>多元素的过渡是指根据条件判断来过渡显示的元素，其最终显示结果有且只有一个元素（不包括子元素）。</p>
<p>对于原生标签可以使用 <code>v-if/v-else</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 根据 items 是否为空来显示内容 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">v-if</span>=<span class="string">"items.length &gt; 0"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span>&gt;</span>Sorry, no items found.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined">            items: [ 1, 2, 3]</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当有<strong>相同标签名</strong>的元素切换时，需要通过 <code>key</code> 特性设置唯一的值来标记以让 <code>Vue</code> 区分它们，否则 Vue 为了效率只会替换相同标签内部的内容（只会有一个元素）。</p>
<p>使用多个 <code>v-if</code> 的多个元素的过渡可以重写为绑定了动态属性的单个元素过渡。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 根据 isEition 来判断显示哪一个 button --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">"isEditing"</span> <span class="attr">key</span>=<span class="string">"save"</span>&gt;</span></span><br><span class="line">        Save</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-else</span> <span class="attr">key</span>=<span class="string">"edit"</span>&gt;</span></span><br><span class="line">        Edit</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 当然有些时候使用三目运算符代替比较方便，然后将 key 绑定动态属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-bind:key</span>=<span class="string">"isEditing"</span>&gt;</span></span><br><span class="line">        &#123;&#123; isEditing ? 'Save' : 'Edit' &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 更复杂的可以使用计算属性完成 --&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="过渡模式"><a href="#过渡模式" class="headerlink" title="过渡模式"></a>过渡模式</h4><p>需要结合 CSS 过渡一起使用。</p>
<ul>
<li><p>in-out：新元素先进行过渡，完成之后当前元素过渡离开。</p>
</li>
<li><p>out-in：当前元素先进行过渡，完成之后新元素过渡进入。</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"fade"</span> <span class="attr">mode</span>=<span class="string">"out-in"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ... the buttons ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="多组件的过渡"><a href="#多组件的过渡" class="headerlink" title="多组件的过渡"></a>多组件的过渡</h3><p>动态组件即可，见组件部分。</p>
<p>多组件过渡很简单，使用普通的过渡类即可，然后使用过渡模式避免突兀。</p>
<h3 id="列表过渡"><a href="#列表过渡" class="headerlink" title="列表过渡"></a>列表过渡</h3><p>列表 <code>ul</code>。</p>
<p>在实现列表过的的时候，入股哦需要过渡的元素是通过 <code>v-for</code> 循环渲染出来的，不能使用 <code>transition</code> 组件包裹，需要使用 <code>transition-group</code> ，因为它不是一个，而是多个。</p>
<p><code>&lt;transition-group&gt;</code> 组件特点：</p>
<ul>
<li><p><code>&lt;transition&gt;</code> 是一个框，没有实际元素；<code>&lt;transition-group&gt;</code> 会以一个真实元素呈现，默认为一个 <code>&lt;span&gt;</code> 。你也可以通过 <code>tag</code> 特性更换为其他元素。</p>
</li>
<li><p>过渡模式不可用，因为我们不再相互切换特有的元素。</p>
</li>
<li><p>内部元素<strong>总是需要</strong>提供唯一的 <code>key</code> 属性值。</p>
</li>
<li><p><code>&lt;transition-group&gt;</code> 组件还有一个特殊之处是使用 <code>v-move</code> 特性可以改变定位。</p>
</li>
</ul>
<h4 id="列表的进入-离开过渡"><a href="#列表的进入-离开过渡" class="headerlink" title="列表的进入/离开过渡"></a>列表的进入/离开过渡</h4><p>进入和离开的过渡使用之前一样的 CSS 类名。</p>
<p>通过 <code>v-enter</code>，<code>v-enter-active</code>, <code>v-enter-to</code>，<code>v-leave</code>，<code>v-leave-active</code>，<code>v-leave-to</code>，六个过渡的类名来控制列表内容的添加和删除。但是这六种方式只能实现进入/离开内容的过渡，对于其他已有的内容，它们还是显得比较突兀。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        li &#123;</span></span><br><span class="line"><span class="undefined">            border: 1px dashed #999;</span></span><br><span class="line"><span class="undefined">            margin: 5px;</span></span><br><span class="line"><span class="undefined">            line-height: 35px;</span></span><br><span class="line"><span class="undefined">            padding: 5px;</span></span><br><span class="line"><span class="undefined">            font-size: 15px;</span></span><br><span class="line"><span class="undefined">            width: 100%</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        li:hover &#123;</span></span><br><span class="line"><span class="undefined">            background-color: yellow;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="undefined">        ul &#123;</span></span><br><span class="line"><span class="undefined">            list-style-type:none</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .v-enter,</span></span><br><span class="line"><span class="undefined">        .v-leave-to &#123;</span></span><br><span class="line"><span class="undefined">            opacity: 0;</span></span><br><span class="line"><span class="undefined">            transform: translateY(80px);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .v-enter-active,</span></span><br><span class="line"><span class="undefined">        .v-leave-active &#123;</span></span><br><span class="line"><span class="undefined">            transition: all 1s ease;</span></span><br><span class="line"><span class="undefined">            // position: absolute;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 添加的控件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"panel-title"</span>&gt;</span>Panel title<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body  form-inline"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                        Id:</span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">"input"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">required</span>=<span class="string">"required"</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">pattern</span>=<span class="string">""</span> <span class="attr">title</span>=<span class="string">""</span> <span class="attr">v-model</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                        Name:</span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">"input"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">required</span>=<span class="string">"required"</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">pattern</span>=<span class="string">""</span> <span class="attr">title</span>=<span class="string">""</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span> @<span class="attr">click</span>=<span class="string">"add()"</span>&gt;</span>添加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- tag设置渲染为列表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transition-group</span> <span class="attr">appear</span> <span class="attr">tag</span>=<span class="string">"ul"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, i) in items"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></span><br><span class="line">                &#123;&#123; item.id &#125;&#125; --- &#123;&#123; item.name &#125;&#125; --- <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span> @<span class="attr">click</span>=<span class="string">"remove(i)"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                id: <span class="string">''</span>,</span></span><br><span class="line"><span class="javascript">                name: <span class="string">''</span>,</span></span><br><span class="line"><span class="undefined">                items: [</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'daming'</span>&#125;,</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">'erming'</span>&#125;,</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">'sanming'</span>&#125;,</span></span><br><span class="line"><span class="javascript">                    &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">name</span>: <span class="string">'siming'</span>&#125;</span></span><br><span class="line"><span class="undefined">                ]</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            methods: &#123;</span></span><br><span class="line"><span class="undefined">                add() &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.items.push(&#123; <span class="attr">id</span>: <span class="keyword">this</span>.id, <span class="attr">name</span>: <span class="keyword">this</span>.name&#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="undefined">                remove(index) &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.items.splice(index, <span class="number">1</span>)</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/23/框架-Vuejs/列表进入和移出.gif" alt="列表进入和移出.gif"></p>
<h4 id="列表的排序过渡"><a href="#列表的排序过渡" class="headerlink" title="列表的排序过渡"></a>列表的排序过渡</h4><p><code>&lt;transition-group&gt;</code> 组件还有一个特殊之处。不仅可以进入和离开动画，还可以改变定位。要使用这个新功能只需了解新增的 <code>v-move</code> 特性，它会在元素的改变定位的过程中应用。像之前的类名一样，可以通过 <code>name</code> 属性来自定义前缀，也可以通过 <code>move-class</code> 属性手动设置。</p>
<p>在原先的案例中修改:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    ...</span></span><br><span class="line"><span class="undefined">    .v-leave-active &#123;</span></span><br><span class="line"><span class="undefined">        transition: all 1s ease;</span></span><br><span class="line"><span class="undefined">        // 添加内容</span></span><br><span class="line"><span class="undefined">        position: absolute;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    .v-move &#123;</span></span><br><span class="line"><span class="undefined">        transition: all 1s ease;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用 <code>.v-move</code> 和 <code>.v-leave-active</code> 配合使用，能完善之前的原有元素突兀的地方，这是一个固定搭配。</p>
<p><img src="/2019/03/23/框架-Vuejs/列表的排序过渡.gif" alt="列表的排序过渡.gif"></p>
<h4 id="列表的交错过渡"><a href="#列表的交错过渡" class="headerlink" title="列表的交错过渡"></a>列表的交错过渡</h4><p>通过 <code>data</code> 属性与 <code>JavaScript</code> 通信 ，就可以实现列表的交错过渡。</p>
<h2 id="Vue-组件"><a href="#Vue-组件" class="headerlink" title="Vue 组件"></a>Vue 组件</h2><ul>
<li><p>组件化：如 <code>Vue</code>，从 UI 界面的角度进行划分的；前端的组件化，方便 UI 组件的重用。</p>
</li>
<li><p>模块化：如 <code>Node</code>，从代码逻辑的角度进行划分的；方便代码分展开发，保证每个功能模块的职能单一。</p>
</li>
</ul>
<p>组件是带有名字可复用的 <code>Vue</code> 实例，所以它们与 <code>new Vue</code> 接收相同的选项，例如 <code>data</code>、<code>computed</code>、<code>watch</code>、<code>methods</code> 以及生命周期钩子等。仅有的例外是像 <code>el</code> 这样根实例特有的选项。</p>
<p><strong>注意</strong>：组件中的 data 必须是一个函数，并且返回一个对象。但是 data 的用法与 Vue 实例一样。这样处理后 data 内部数据会被独立维护，组件复用后不会互相影响。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个名为 button-counter 的新组件</span></span><br><span class="line">Vue.component(<span class="string">'button-counter'</span>, &#123;</span><br><span class="line">    <span class="comment">// 组件中没有 el</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 组件中的 data 必须是一个函数，并且返回一个对象。</span></span><br><span class="line">    data: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            msg: <span class="string">'hello'</span>,</span><br><span class="line">            count: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// template 指定组件要展示的 HTML 结构</span></span><br><span class="line">    template: <span class="string">'&lt;button&gt;按钮&lt;/button&gt;'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>我们可以在一个通过 <code>new Vue</code> 创建的 <code>Vue</code> 根实例中，把这个组件作为自定义元素来使用，即组件具有重用性，它是一个模板。</p>
<h3 id="组件注册"><a href="#组件注册" class="headerlink" title="组件注册"></a>组件注册</h3><h4 id="组件命名"><a href="#组件命名" class="headerlink" title="组件命名"></a>组件命名</h4><p>在注册一个组件的时候，我们始终需要给它一个名字，我们需要使用这个名字来创建组件。</p>
<p><strong>帕斯卡命名法</strong></p>
<p>当使用 <code>PascalCase</code> (首字母大写命名) 定义一个组件时，你在引用这个自定义元素时两种命名法都可以使用。也就是说 <code>&lt;my-component-name&gt;</code> 和 <code>&lt;MyComponentName&gt;</code> 都是可接受的。注意，尽管如此，直接在 <code>DOM</code> (即非字符串的模板) 中使用时只有 <code>kebab-case</code> 是有效的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span> ... <span class="tag">&lt;<span class="name">my-component-name</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 不一定有用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MyComponentName</span>&gt;</span> ... <span class="tag">&lt;<span class="name">MyComponentName</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 帕斯卡命名法</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'MyComponentName'</span>, &#123; <span class="comment">/* ... */</span> &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>短横线分隔命名法</strong></p>
<font color="red">推荐使用，不易出错</font>

<p>当使用 <code>kebab-case</code> (短横线分隔命名) 定义一个组件时，你也必须在引用这个自定义元素时使用 <code>kebab-case</code>，例如 <code>&lt;my-component-name&gt;</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 短横线分隔命名法</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'my-component-name'</span>, &#123; <span class="comment">/* ... */</span> &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>但是在使用组件时，只能用短横线式名称，哪怕在定义时是用驼峰式命名法命名。</p>
<h4 id="全局注册"><a href="#全局注册" class="headerlink" title="全局注册"></a>全局注册</h4><p>用过 <code>Vue.component</code> 来创建组建。</p>
<p><strong>注意</strong>：这个 <code>template</code> 中只能有一个根元素。</p>
<p>全局注册的组件在所有组件内部或者 <code>Vue</code> 根实例 (<code>new Vue</code>) 中都可以使用，也就是可以组件套组件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- app 组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 可用 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- app2 组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app2"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 可用 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    /**</span></span><br><span class="line"><span class="undefined">     * 直接粗暴一步搞定</span></span><br><span class="line"><span class="undefined">     */</span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'my-component-name'</span>, &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 组件模板对象</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    /**</span></span><br><span class="line"><span class="undefined">     * 分步</span></span><br><span class="line"><span class="undefined">     */</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 先创建组件模板对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> com = &#123;</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 传入组件名和模板对象</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'my-component-name'</span>, com)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm2 = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app2'</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="私有注册"><a href="#私有注册" class="headerlink" title="私有注册"></a>私有注册</h4><p>只能自当前的组件中使用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- app 组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 可用 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app2"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 报错，app 私有组件中可用 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        components: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="string">'my-component-name'</span>: &#123;</span></span><br><span class="line"><span class="xml">                template: '<span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm2 = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app2'</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：局部注册的组件在其子组件中不可用。</p>
<p>有点迷，以后再说。</p>
<h4 id="HTML模板分离"><a href="#HTML模板分离" class="headerlink" title="HTML模板分离"></a>HTML模板分离</h4><p><code>template</code> 属性对应跟 <code>HTML</code> 的模板结构，但是如果是直接在后面拼接字符串的话，短的还好说，长的话不仅代码难看，而且容易出错。所以我们可以用额外的 <code>HTML</code> 模板来传入。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"temp"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>第一个h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>第二个h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>第三个h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'MyComponentName'</span>, &#123;</span></span><br><span class="line"><span class="javascript">        template: <span class="string">'#temp'</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        methods: &#123;</span></span><br><span class="line"><span class="undefined">                </span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="data-与-prop"><a href="#data-与-prop" class="headerlink" title="data 与 prop"></a>data 与 prop</h3><p>从之前的知识可以了解，<code>Vue</code> 实例（<code>new Vue()</code>）中的 <code>data</code> 是一个对象，而组件中的 <code>data</code> 是一个函数，返回一个对象。</p>
<p>当在 <code>Vue</code> 实例中创建组件，或者组件中创建组件时，子组件不能直接使用父组件中的 <code>data</code> 值。</p>
<h4 id="子组件使用父组件的-data"><a href="#子组件使用父组件的-data" class="headerlink" title="子组件使用父组件的 data"></a>子组件使用父组件的 data</h4><p>如果要在子组件中使用父组件 <code>data</code> 中的数据只要以下几步即可：</p>
<ul>
<li>第一步：在子组件的 <code>prop</code> 数组中传递一个自定义属性，<code>prop</code> 定义的内容是只读的。</li>
<li>第二步：调用子组件时使用自定义属性用 <code>v-bind</code> 绑定父组件的属性。</li>
<li>第三步：在子组件模板中使用该自定义属性名，获取父组件属性值。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 第一步：将 parentmsg 属性绑定父组件的 msg 属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com</span> <span class="attr">v-bind:parentmsg</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">com</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"temp"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 第三步：在子组件模板中使用该自定义属性名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>这是子组件，获取父组件的 msg 值：&#123;&#123; parentmsg &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 私有 data 中的值可读可改 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>这是子组件，获取其私有的 content 值：&#123;&#123; content &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            msg: <span class="string">'父组件 data 中的值'</span></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 子组件默认无法访问到父组件 data 中的数据和 methods 中的方法</span></span></span><br><span class="line"><span class="undefined">        components: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 定义组件</span></span></span><br><span class="line"><span class="undefined">            com: &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 子组件中的 data 是私有的</span></span></span><br><span class="line"><span class="undefined">                data() &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                        content: <span class="string">'私有的 data 中的值'</span></span></span><br><span class="line"><span class="undefined">                    &#125;</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="javascript">                template: <span class="string">'#temp'</span>,</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 第二步：在子组件 props 数组中定义 parentmsg 属性</span></span></span><br><span class="line"><span class="javascript">                props: [<span class="string">'parentmsg'</span>]</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="子组件使用父组件的-methods，并向父组件传递-data"><a href="#子组件使用父组件的-methods，并向父组件传递-data" class="headerlink" title="子组件使用父组件的 methods，并向父组件传递 data"></a>子组件使用父组件的 methods，并向父组件传递 data</h4><ul>
<li><p>调用子组件时使用自定义事件名用 <code>v-on</code> 绑定父组件的方法。</p>
</li>
<li><p>在子组件的 <code>methods</code> 中定义方法，并使用 <code>this.$emit(自定义事件名[, 参数])</code> 触发自定义事件。</p>
</li>
<li><p>在子组件模板中使用该自定义方法名，它会触发自定义事件绑定的父组件中的方法。</p>
</li>
</ul>
<p>父组件给子组件传递一个方法供子组件调用。因为子组件可以调用自身私有的 <code>data</code> 数据，子组件将私有 <code>data</code> 作为参数传入父组件的方法，而父组件的方法本身就可以访问父组件的 <code>data</code> 数据，所以这样就实现了子组件给父组件传递数据的操作。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 第一步：将 my-event 属性绑定父组件的 msg 属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com</span> <span class="attr">v-on:my-event</span>=<span class="string">"show"</span>&gt;</span><span class="tag">&lt;/<span class="name">com</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"temp"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 第三步：在子组件模板中使用该自定义属性名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span> @<span class="attr">click</span>=<span class="string">"myclick"</span>&gt;</span>调用父组件方法<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            msg: <span class="string">'父组件 data 中的值'</span>,</span></span><br><span class="line"><span class="javascript">            sonContent: <span class="literal">null</span></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        methods: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 父组件的方法</span></span></span><br><span class="line"><span class="undefined">            show(data) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 父组件保存子组件的 data 值</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.sonContent = data</span></span><br><span class="line"><span class="javascript">                <span class="built_in">window</span>.alert(<span class="string">'父容器的方法'</span> + data)</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 子组件默认无法访问到父组件 data 中的数据和 methods 中的方法</span></span></span><br><span class="line"><span class="undefined">        components: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 定义组件</span></span></span><br><span class="line"><span class="undefined">            com: &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 子组件中的 data 是私有的</span></span></span><br><span class="line"><span class="undefined">                data() &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">                        content: <span class="string">'私有的 data 中的值'</span></span></span><br><span class="line"><span class="undefined">                    &#125;</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="javascript">                template: <span class="string">'#temp'</span>,</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 第二步：在子组件 methods 中触发自定义事件</span></span></span><br><span class="line"><span class="undefined">                methods: &#123;</span></span><br><span class="line"><span class="undefined">                    myclick() &#123;</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">this</span>.$emit(<span class="string">'my-event'</span>, <span class="keyword">this</span>.content)</span></span><br><span class="line"><span class="undefined">                    &#125;</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="prop-详解"><a href="#prop-详解" class="headerlink" title="prop 详解"></a>prop 详解</h4><p>在之前的案例中，<code>props</code> 数组作为子组件接收父组件 <code>data</code> 值的定义列表。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 第二步 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">blog-post</span> <span class="attr">v-bind:title</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">blog-post</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'blog-post'</span>, &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 第一步</span></span></span><br><span class="line"><span class="javascript">        props: [<span class="string">'title'</span>],</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 第三步</span></span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            msg: <span class="string">'hello'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="prop原理"><a href="#prop原理" class="headerlink" title="prop原理"></a>prop原理</h5><p><code>Prop</code> 是你可以在组件上注册的一些自定义特性。当一个值传递给一个 <code>prop</code> 特性的时候，它就变成了那个组件实例的一个属性。</p>
<p>所以，其实的使用方式实际上就是先通过 <code>prop</code> 给子组件定义了一个属性，然后该属性动态绑定父组件的属性，最后在 <code>template</code> 模板中使用该属性，这样就实现了<strong>父组件向子组件传递数据</strong>。</p>
<p>那么，其实我们也可以直接给 <code>prop</code> 定义的属性传递静态数据。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 给 title 属性传递静态数据 ‘msg’--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">blog-post</span> <span class="attr">title</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">blog-post</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'blog-post'</span>, &#123;</span></span><br><span class="line"><span class="javascript">        props: [<span class="string">'title'</span>],</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="prop-属性名"><a href="#prop-属性名" class="headerlink" title="prop 属性名"></a>prop 属性名</h5><p>建议统一使用短横线分隔命名法。</p>
<h5 id="prop-定义数据类型及验证"><a href="#prop-定义数据类型及验证" class="headerlink" title="prop 定义数据类型及验证"></a>prop 定义数据类型及验证</h5><p>之前我们用 <code>props</code> 数组来定义属性，那种方法并没有具体定义该属性是什么类型的，如果严格的来说，我们最好在定义属性时就规定其数据类型。此时就要使用对象来定义属性。</p>
<p>如果传入值不符合规范，<code>Vue</code> 会报错提示。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只定义属性名，用数组即可</span></span><br><span class="line">props: [<span class="string">'title'</span>, <span class="string">'likes'</span>...]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义属性名和数据类型时，需要用对象来实现</span></span><br><span class="line">props: &#123;</span><br><span class="line">  title: <span class="built_in">String</span>,</span><br><span class="line">  likes: <span class="built_in">Number</span>,</span><br><span class="line">  isPublished: <span class="built_in">Boolean</span>,</span><br><span class="line">  commentIds: <span class="built_in">Array</span>,</span><br><span class="line">  author: ObjectName,</span><br><span class="line">  callback: <span class="built_in">Function</span>,</span><br><span class="line">  contactsPromise: <span class="built_in">Promise</span>, <span class="comment">// or any other constructor</span></span><br><span class="line">  <span class="comment">// 多个可能值</span></span><br><span class="line">  gender: [<span class="built_in">Number</span>, <span class="built_in">String</span>],</span><br><span class="line">  <span class="comment">// 必填选项</span></span><br><span class="line">  id: &#123;</span><br><span class="line">    tpye: <span class="built_in">String</span>,</span><br><span class="line">    required: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 默认值</span></span><br><span class="line">  age: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="动态传递-prop-规则"><a href="#动态传递-prop-规则" class="headerlink" title="动态传递 prop 规则"></a>动态传递 prop 规则</h5><p>所有的动态传递 <code>prop</code> 都必须使用 <code>v-bind</code> 绑定。</p>
<font color="red">父组件向子组件传递数据就是使用动态传递。</font>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">blog-post</span> <span class="attr">v-bind:msg</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">blog-post</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="静态传递-prop-规则"><a href="#静态传递-prop-规则" class="headerlink" title="静态传递 prop 规则"></a>静态传递 prop 规则</h5><p><strong>传入一个数字</strong></p>
<p>无论数字（<code>Number</code> 类型）是动态传递还是静态传递，都需要使用 <code>v-bind</code> 绑定。</p>
<p><strong>传入一个布尔值</strong></p>
<p> <code>true</code> 值，默认值，可以不需要 <code>v-bind</code> 绑定。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- flag 为 true --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">blog-post</span> <span class="attr">flag</span>&gt;</span><span class="tag">&lt;/<span class="name">blog-post</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>false</code> 值，无论是动态还是静态都要 <code>v-bind</code> 绑定。</p>
<p><strong>传入一个数组</strong></p>
<p>无论数组是动态传递还是静态传递，都需要使用 <code>v-bind</code> 绑定。</p>
<p><strong>传入一个对象</strong></p>
<p>无论对象是动态传递还是静态传递，都需要使用 <code>v-bind</code> 绑定。</p>
<h3 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h3><p>动态组件通过 <code>Vue</code> 的 <code>&lt;component&gt;</code> 元素绑定 <code>is</code> 特性来实现。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 组件会在 `currentTabComponent` 改变时改变 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">"currentTabComponent"</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 点击按钮切换 tab的值 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"tab='register'"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-info"</span> @<span class="attr">click</span>=<span class="string">"tab='login'"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 动态组件，板顶 tab 属性，此时的 tab 表示组件名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">"tab"</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"login"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        这是登录界面</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"register"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        这是注册界面</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'login'</span>, &#123;</span></span><br><span class="line"><span class="javascript">        template: <span class="string">'#login'</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'register'</span>, &#123;</span></span><br><span class="line"><span class="javascript">    template: <span class="string">'#register'</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            tab: <span class="string">'login'</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="vue-router-前端路由"><a href="#vue-router-前端路由" class="headerlink" title="vue-router 前端路由"></a>vue-router 前端路由</h2><p>官网：<a href="https://router.vuejs.org/zh/" target="_blank" rel="noopener">https://router.vuejs.org/zh/</a></p>
<p><code>API</code> 参考：<a href="https://router.vuejs.org/zh/api/" target="_blank" rel="noopener">https://router.vuejs.org/zh/api/</a></p>
<ul>
<li><strong>后端路由</strong>: 对于普通的网站，所有的超链接都是 <code>URL</code> 地址，所有的 <code>URL</code> 地址都对应服务器上的资源。</li>
<li><strong>前端路由</strong>: 对于单页面应用程序来说，主要通过 <code>URL</code> 中的<code>hash(#号)</code> 来实现不同页面之间的切换，同时，<code>hash</code> 有一个特点：<code>HTTP</code> 请求中不会包含 <code>hash</code> 相关的内容；所以，单页面程序中的页面跳转主要用 <code>hash</code> 实现；在单页面应用程序中，这种通过hash改变来切换页面的方式，称作前端路由。</li>
</ul>
<h3 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i vue-router -S</span><br></pre></td></tr></table></figure>
<h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 不论在什么环境中开发，vue-router.js 都要在 vue.js 引入之后引入 --&gt;</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue-router/dist/vue-router.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>一旦引入了 <code>vue-router.js</code> 原先的 <code>url</code> 路径最后就会自动添加上 <code>#/</code> 。</p>
<h3 id="起步-1"><a href="#起步-1" class="headerlink" title="起步"></a>起步</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 第一步：导包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/vue-router/dist/vue-router.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 自定义的连接，注意这里的连接地址，使用的是 '#/' 开头 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">href</span>=<span class="string">"#/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">href</span>=<span class="string">"#/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- vue-router 提供的元素，to="连接地址"，这里没有 '#/' --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- router-link 的默认渲染标签是 a，可以使用 tag 来修改渲染标签，无论怎么改都有一个点击事件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 第五步：显示。vue-router 提供的元素，路由组件占位符 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 第二步：定义路由组件模板对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> login = &#123; <span class="attr">template</span>: <span class="string">'&lt;p&gt;登录&lt;/p&gt;'</span> &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> register = &#123; <span class="attr">template</span>: <span class="string">'&lt;p&gt;注册&lt;/p&gt;'</span> &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 第三步：定义路由 &#123; '路径': 组件模板对象 &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> routes = [</span></span><br><span class="line"><span class="javascript">        &#123; <span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">redirect</span>: <span class="string">'/login'</span> &#125;,      <span class="comment">// 手动修改默认 hash 值，与后端 redirect 重定向不同，虽然效果一样</span></span></span><br><span class="line"><span class="javascript">        &#123; <span class="attr">path</span>: <span class="string">'/login'</span>, <span class="attr">component</span>: login &#125;,</span></span><br><span class="line"><span class="javascript">        &#123; <span class="attr">path</span>: <span class="string">'/register'</span>, <span class="attr">component</span>: register &#125;</span></span><br><span class="line"><span class="undefined">    ]</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">//  第四步：创建路由对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> routerObj = <span class="keyword">new</span> VueRouter(&#123;</span></span><br><span class="line"><span class="javascript">        routes: routes      <span class="comment">// 重名可缩写</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 第五步：将 routerObj 路由对象挂载到根实例中</span></span></span><br><span class="line"><span class="undefined">        router: routerObj</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="router-link"><a href="#router-link" class="headerlink" title="router-link"></a>router-link</h3><p>更详细见 <code>API</code> 文档：<a href="https://router.vuejs.org/zh/api/" target="_blank" rel="noopener">https://router.vuejs.org/zh/api/</a></p>
<p>组件支持用户在具有路由功能的应用中 (点击) 导航。 通过 <code>to</code> 属性指定目标地址，默认渲染成带有正确链接的 <code>&lt;a&gt;</code> 标签，可以通过配置 tag 属性生成别的标签.。另外，当目标路由成功激活时，链接元素自动设置一个表示激活的 <code>CSS</code> 类名。</p>
<h4 id="to-链接属性"><a href="#to-链接属性" class="headerlink" title="to 链接属性"></a>to 链接属性</h4><p>必须值。</p>
<p>路径的写法有很多，但是用字符串的方法最简单方便。</p>
<p>还有一种常见的就是用路径的方式，那个也没有问题。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 字符串，相对路径 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 从根路径出发 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 命名的路由，需要绑定属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"&#123; name: 'user', params: &#123; userId: 123 &#125;&#125;"</span>&gt;</span>User<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="tag-标签属性"><a href="#tag-标签属性" class="headerlink" title="tag 标签属性"></a>tag 标签属性</h4><p>默认值: <code>&lt;a&gt;</code></p>
<p>有时候想要 <code>&lt;router-link&gt;</code> 渲染成某种标签，就使用 <code>tag</code> 等于该种标签即可。但是无论它改成什么变迁，它还是会监听点击，用以触发导航。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 字符串 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"home"</span> <span class="attr">tag</span>=<span class="string">"button"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="active-class-激活类"><a href="#active-class-激活类" class="headerlink" title="active-class 激活类"></a>active-class 激活类</h4><p>默认值: “router-link-active”</p>
<p>设置链接激活时使用的 <code>CSS</code> 类名。默认值可以通过路由的构造选项 <code>linkActiveClass</code> 来全局配置。</p>
<p>这种方式就方便我们使用 <code>bootstrap</code> 中的样式或者自定义样式类。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  第四步：创建路由对象</span></span><br><span class="line"><span class="keyword">var</span> routerObj = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    routes: routes,</span><br><span class="line">    <span class="comment">// 全局配置修改 router-link 激活类为 "btn btn-primary"</span></span><br><span class="line">    linkActiveClass: <span class="string">"btn btn-primary"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h3><h4 id="query-传参"><a href="#query-传参" class="headerlink" title="query 传参"></a>query 传参</h4><p>如果在路由中使用 <code>query</code> 查询字符串，给路由传递参数，则不需要修改路由规则的 <code>path</code> 属性。</p>
<p>传递参数</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 传入 id=10 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"login?id=10&amp;name=123"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>接收参数，通过 <code>this.$route</code> 对象来获取参数，它的作用就相当于后端的 <code>request</code> 对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第二步：定义路由组件模板对象</span></span><br><span class="line"><span class="keyword">var</span> login = &#123;</span><br><span class="line">    template: <span class="string">'&lt;p&gt;登录&lt;/p&gt;'</span>,</span><br><span class="line">        <span class="comment">// 组件的生命周期钩子函数</span></span><br><span class="line">    created()&#123;</span><br><span class="line">        <span class="comment">// this.$route 相当于 后端中的 request 数据对象</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$route)</span><br><span class="line">        <span class="comment">// 获取 query 参数，我们传入的参数都在这里面</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$route.query)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/23/框架-Vuejs/query传参.JPG" alt="query传参.JPG"></p>
<h4 id="params-传参"><a href="#params-传参" class="headerlink" title="params 传参"></a>params 传参</h4><p>使用 <code>params</code> 传参方式，是先在 <code>matched</code> 中正则匹配 <code>path</code><br>中的值，然后存放到 <code>params</code> 中。</p>
<p>在定义路由的使用就使用 <code>/:xxx</code> 占位符确定参数位置，传参的时候也必须准确，不能缺少。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"login/10/ls"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 第二步：定义路由组件模板对象</span></span><br><span class="line">    <span class="keyword">var</span> login = &#123;</span><br><span class="line">        template: <span class="string">'&lt;p&gt;登录&lt;/p&gt;'</span>,</span><br><span class="line">        <span class="comment">// 组件的生命周期钩子函数</span></span><br><span class="line">        created()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.$route)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 第三步：定义路由 &#123; '路径': 组件模板对象 &#125;</span></span><br><span class="line">    <span class="keyword">var</span> routes = [</span><br><span class="line">        <span class="comment">// 使用 :id 占位符</span></span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/login/:id/:name'</span>, <span class="attr">component</span>: login &#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/03/23/框架-Vuejs/params传参.JPG" alt="params传参.JPG"></p>
<h4 id="props-解耦"><a href="#props-解耦" class="headerlink" title="props 解耦"></a>props 解耦</h4><p>在组件中使用 <code>this.$route</code> 会使之与其对应路由形成高度耦合，从而使组件只能在某些特定的 <code>URL</code> 上使用，限制了其灵活性。</p>
<p>只需要两步：</p>
<ul>
<li><p>在定义路由时设置 <code>props</code> 。</p>
</li>
<li><p>在 <code>template</code> 模板中使用 <code>props</code> 数组定义。</p>
</li>
</ul>
<h5 id="布尔模式"><a href="#布尔模式" class="headerlink" title="布尔模式"></a>布尔模式</h5><p>如果 <code>props</code> 被设置为 <code>true</code> ，<code>route.params</code> 将会被设置为组件属性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 给命名的路由传递对象那个，此时 to 需要绑定属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">v-bind:to</span>=<span class="string">"&#123; name: 'login', params: &#123; id: 123, name: 'h' &#125;&#125;"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="javascript">        props: [<span class="string">'id'</span>, <span class="string">'name'</span>],</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">p</span>&gt;</span>id: &#123;&#123; id &#125;&#125;，name: &#123;&#123; name &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 定义路由</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> routes = [</span></span><br><span class="line"><span class="undefined">        &#123;</span></span><br><span class="line"><span class="javascript">            path: <span class="string">'/login/:id/:name'</span>,</span></span><br><span class="line"><span class="javascript">            name: <span class="string">'login'</span>,</span></span><br><span class="line"><span class="undefined">            component: login,</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 第一步：设置 props 为 true</span></span></span><br><span class="line"><span class="javascript">            props: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    ]</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    ......</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="对象模式"><a href="#对象模式" class="headerlink" title="对象模式"></a>对象模式</h5><p>如果 <code>props</code> 是一个对象，它会被按原样设置为组件属性。当 <code>props</code> 是静态的时候有用。</p>
<h5 id="函数模式"><a href="#函数模式" class="headerlink" title="函数模式"></a>函数模式</h5><p>创建一个函数返回 <code>props</code> ，便可以将参数转换成另一种类型，将静态值与基于路由的值结合等等。</p>
<h3 id="路由嵌套"><a href="#路由嵌套" class="headerlink" title="路由嵌套"></a>路由嵌套</h3><p>嵌套路由需要注意三点：</p>
<ul>
<li><p>第一点：在父路由模板中需要添加 <code>&lt;router-view&gt;&lt;/router-view&gt;</code> 作为子路由模板的占位符。</p>
</li>
<li><p>第二点：子路由的路由定义（路径和模板对象）要写在父路由的路由定义的 <code>children</code> 属性中。</p>
</li>
<li><p>第三点：要注意子路由定义的路径需要使用相对路径（前面不能有 ‘/‘），相对于父路由之下，这样就不会显得突兀。在 <code>&lt;router-link to=&quot;/account/login&quot;&gt;&lt;/router-link&gt;</code> 点击导航的 <code>to</code> 路径设置中需要拼接父路由路径和子路由路径，因为我们再之前定义子路由路径是用相对路径的。</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/account"</span>&gt;</span>Account<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- accoutn 的组件占位 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"temp"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是 Account 组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 这里 to 接的路径是 '/account' 路径下的 '/login'，不能直接使用根路径 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/account/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/account/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 嵌套的登录注册组件占位符 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 组件模板对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> account = &#123;</span></span><br><span class="line"><span class="javascript">        template: <span class="string">'#temp'</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是 login 组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> register = &#123;</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是 register 组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 定义路由</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> routes = [</span></span><br><span class="line"><span class="undefined">        &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 此处使用的是根路径，需要加 '/'</span></span></span><br><span class="line"><span class="javascript">            path: <span class="string">'/account'</span>,</span></span><br><span class="line"><span class="undefined">            component: account,</span></span><br><span class="line"><span class="undefined">            children: [</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 这里 path 不能加 '/' ，表示是在 '/account' 路径下，否则就是根路径</span></span></span><br><span class="line"><span class="javascript">                &#123; <span class="attr">path</span>: <span class="string">'login'</span>, <span class="attr">component</span>: login &#125;,</span></span><br><span class="line"><span class="javascript">                &#123; <span class="attr">path</span>: <span class="string">'register'</span>, <span class="attr">component</span>: register &#125;</span></span><br><span class="line"><span class="undefined">            ]</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    ]</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 创建路由对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> routerObj = <span class="keyword">new</span> VueRouter(&#123;</span></span><br><span class="line"><span class="undefined">        routes: routes</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 挂载路由</span></span></span><br><span class="line"><span class="undefined">        router: routerObj</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="编程式路由"><a href="#编程式路由" class="headerlink" title="编程式路由"></a>编程式路由</h3><p>编程式路由是通过 JS 来实现页面的跳转。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$router.push(<span class="string">"name"</span>)</span><br><span class="line"></span><br><span class="line">$router.push(&#123;<span class="attr">path</span>:<span class="string">"name"</span>&#125;)</span><br><span class="line"></span><br><span class="line">$router.push(&#123;<span class="attr">path</span>:<span class="string">"name?a=123"</span>&#125;)</span><br><span class="line"></span><br><span class="line">$router.push(&#123;<span class="attr">paht</span>:<span class="string">"name"</span>,<span class="attr">query</span>:&#123;<span class="attr">a</span>:<span class="number">123</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line">$router.go(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="命名路由"><a href="#命名路由" class="headerlink" title="命名路由"></a>命名路由</h3><p>通过一个名称来标识一个路由显得更方便一些，特别是在链接一个路由，或者是执行一些跳转的时候。只需要在 <code>routes</code> 配置中给某个路由设置名称。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 给命名的路由传递对象那个，此时 to 需要绑定属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">v-bind:to</span>=<span class="string">"&#123; name: 'login', params: &#123; id: 123, name: 'h' &#125;&#125;"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">p</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">p</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 定义路由</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> routes = [</span></span><br><span class="line"><span class="undefined">        &#123;</span></span><br><span class="line"><span class="javascript">            path: <span class="string">'/login/:id/:name'</span>,</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 给路由命名</span></span></span><br><span class="line"><span class="javascript">            name: <span class="string">'login'</span>,</span></span><br><span class="line"><span class="undefined">            component: login</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    ]</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    ......</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="命名视图"><a href="#命名视图" class="headerlink" title="命名视图"></a>命名视图</h3><p>有时候想同时 (同级) 展示多个视图，而不是嵌套展示，例如创建一个布局，有 <code>sidebar</code> (侧导航) 和 <code>main</code> (主内容) 两个视图，这个时候命名视图就派上用场了。你可以在界面中拥有多个单独命名的视图，而不是只有一个单独的出口。如果 <code>router-view</code> 没有设置名字，那么默认为 <code>default</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 三个同级视图 --&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 默认的视图 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- name 为 left 的视图 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span> <span class="attr">name</span>=<span class="string">"left"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- name 为 main 的视图 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span> <span class="attr">name</span>=<span class="string">"main"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 第二步：定义路由组件模板对象</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> headerBox = &#123;</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>头部<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> leftBox = &#123;</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>左侧<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> mainBox = &#123;</span></span><br><span class="line"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>主体<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 第三步：定义路由 &#123; '路径': 组件模板对象 &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> routes = [&#123;</span></span><br><span class="line"><span class="javascript">        path: <span class="string">'/'</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 使用 components 设置多个组件模板对象，注意有 s</span></span></span><br><span class="line"><span class="undefined">        components: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">default</span>: headerBox,</span></span><br><span class="line"><span class="undefined">            left: leftBox,</span></span><br><span class="line"><span class="undefined">            main: mainBox</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;]</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined">    ......</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    routes: [</span><br><span class="line">        <span class="comment">// 重定向路径</span></span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/a'</span>, <span class="attr">redirect</span>: <span class="string">'/b'</span> &#125;,</span><br><span class="line">        <span class="comment">// 重定向命名</span></span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/a'</span>, <span class="attr">redirect</span>: &#123; <span class="attr">name</span>: <span class="string">'b'</span> &#125; &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/23/框架-Vuejs/" data-id="cjy01antf006gosutp5xwdvps" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/框架/">框架</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/移动端/">移动端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-后端基础——npm常见包" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/19/后端基础——npm常见包/" class="article-date">
  <time datetime="2019-03-19T13:20:46.000Z" itemprop="datePublished">2019-03-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/19/后端基础——npm常见包/">后端基础——npm常见包</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#npm-基础">npm 基础</a><ul>
<li><a href="#项目初始化">项目初始化</a></li>
<li><a href="#下载模块包">下载模块包</a></li>
<li><a href="#其他常用命令">其他常用命令</a></li>
<li><a href="#npm-被墙问题">npm 被墙问题</a></li>
</ul>
</li>
<li><a href="#常用包使用">常用包使用</a><ul>
<li><a href="#json-server">json-server</a><ul>
<li><a href="#安装">安装</a></li>
<li><a href="#创建-json-模拟数据文件">创建 JSON 模拟数据文件</a></li>
<li><a href="#启动服务">启动服务</a></li>
</ul>
</li>
<li><a href="#http-server">http-server</a></li>
<li><a href="#art-template">art-template</a><ul>
<li><a href="#安装-1">安装</a></li>
</ul>
</li>
<li><a href="#express-art-template">express-art-template</a><ul>
<li><a href="#安装-2">安装</a></li>
</ul>
</li>
<li><a href="#body-parser">body-parser</a><ul>
<li><a href="#body-parser-安装">body-parser 安装</a></li>
<li><a href="#body-parser-配置">body-parser 配置</a></li>
<li><a href="#express-获取-post-数据">Express 获取 POST 数据</a></li>
</ul>
</li>
<li><a href="#express-session">express-session</a></li>
<li><a href="#blueimp-md5">blueimp-md5</a></li>
<li><a href="#axios">axios</a></li>
<li><a href="#animatecss">animate.css</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="npm-基础"><a href="#npm-基础" class="headerlink" title="npm 基础"></a>npm 基础</h2><p>NPM（node package manager），是基于Node.js开发的包管理器。是世界上最大的开源库生态系统。</p>
<p>中文文档： <a href="https://www.npmjs.cn/" target="_blank" rel="noopener">https://www.npmjs.cn/</a><br>官网： <a href="https://www.npmjs.com/" target="_blank" rel="noopener">https://www.npmjs.com/</a></p>
<p>一些常用的包都可以在官网查找。</p>
<h3 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h3><p><code>package.json</code> 包描述文件，这个文件会记录我们的项目信息，比如需要的项目依赖、版本号之类，非常重要，访问项目文件被误删导致无法挽回的后果。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 命令，有向导</span><br><span class="line">npm init</span><br><span class="line"></span><br><span class="line">// 跳过向导，快速创建，所有选项默认</span><br><span class="line">npm init -y</span><br></pre></td></tr></table></figure>
<p>执行这个命令之后，如果没有 <code>package.json</code> 包描述文件，就会新建；如果已经有了，当 <code>node_modules</code> 依赖丢失时，会根据 <code>package.json</code> 中的 <code>dependencies</code> 字段重新下载依赖。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">/** </span><br><span class="line"> * 如下为新建包描述文件（初始化项目）全过程</span><br><span class="line"> */</span><br><span class="line"> </span><br><span class="line">// 输入命令，通过命令向导创建</span><br><span class="line"><span class="function">F:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>&gt;<span class="title">npm</span> <span class="title">init</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 自动输出内容</span></span><br><span class="line"><span class="function"><span class="title">This</span> <span class="title">utility</span> <span class="title">will</span> <span class="title">walk</span> <span class="title">you</span> <span class="title">through</span> <span class="title">creating</span> <span class="title">a</span> <span class="title">package.json</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function"><span class="title">It</span> <span class="title">only</span> <span class="title">covers</span> <span class="title">the</span> <span class="title">most</span> <span class="title">common</span> <span class="title">items</span>, <span class="title">and</span> <span class="title">tries</span> <span class="title">to</span> <span class="title">guess</span> <span class="title">sensible</span> <span class="title">defaults</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">See</span> `<span class="title">npm</span> <span class="title">help</span> <span class="title">json</span>` <span class="title">for</span> <span class="title">definitive</span> <span class="title">documentation</span> <span class="title">on</span> <span class="title">these</span> <span class="title">fields</span></span></span><br><span class="line"><span class="function"><span class="title">and</span> <span class="title">exactly</span> <span class="title">what</span> <span class="title">they</span> <span class="title">do</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Use</span> `<span class="title">npm</span> <span class="title">install</span> &lt;<span class="title">pkg</span>&gt;` <span class="title">afterwards</span> <span class="title">to</span> <span class="title">install</span> <span class="title">a</span> <span class="title">package</span> <span class="title">and</span></span></span><br><span class="line"><span class="function"><span class="title">save</span> <span class="title">it</span> <span class="title">as</span> <span class="title">a</span> <span class="title">dependency</span> <span class="title">in</span> <span class="title">the</span> <span class="title">package.json</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Press</span> ^<span class="title">C</span> <span class="title">at</span> <span class="title">any</span> <span class="title">time</span> <span class="title">to</span> <span class="title">quit</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">/**</span></span><br><span class="line"><span class="function"> * 问答式填写项目内容，可以不填，回车直接跳过</span></span><br><span class="line"><span class="function"> */</span></span><br><span class="line"><span class="function">// 包名，默认是我们已经通过 <span class="title">cd</span> 命令进入的文件夹</span></span><br><span class="line"><span class="function"><span class="title">package</span> <span class="title">name</span>: (<span class="title">nodejs</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 版本号，默认为(1.0.0)，我们填写一个较低的版本(0.0.1)</span></span><br><span class="line"><span class="function"><span class="title">version</span>: (1.0.0) 0.0.1</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 项目描述，手动输入</span></span><br><span class="line"><span class="function"><span class="title">description</span>: 这是一个学习项目</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 入口文件，默认是 <span class="title">index.js</span>，我们可以自定义</span></span><br><span class="line"><span class="function"><span class="title">entry</span> <span class="title">point</span>: (<span class="title">index.js</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 测试命令</span></span><br><span class="line"><span class="function"><span class="title">test</span> <span class="title">command</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="title">git</span> 仓库地址</span></span><br><span class="line"><span class="function"><span class="title">git</span> <span class="title">repository</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 关键字，如果想自己的项目通过 <span class="title">npm</span> 被别人下载，就可以填写关键字，供别人下载</span></span><br><span class="line"><span class="function"><span class="title">keywords</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 作者</span></span><br><span class="line"><span class="function"><span class="title">author</span>: <span class="title">AiJunhao</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 软件开源许可证</span></span><br><span class="line"><span class="function"><span class="title">license</span>: (<span class="title">ISC</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 生成的包描述文件内容</span></span><br><span class="line"><span class="function"><span class="title">About</span> <span class="title">to</span> <span class="title">write</span> <span class="title">to</span> <span class="title">F</span>:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>\<span class="title">package.json</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">&#123;</span></span><br><span class="line"><span class="function">  "<span class="title">name</span>": "<span class="title">nodejs</span>",</span></span><br><span class="line"><span class="function">  "<span class="title">version</span>": "0.0.1",</span></span><br><span class="line"><span class="function">  "<span class="title">description</span>": "这是一个学习项目",</span></span><br><span class="line"><span class="function">  "<span class="title">main</span>": "<span class="title">index.js</span>",</span></span><br><span class="line"><span class="function">  "<span class="title">scripts</span>": &#123;</span></span><br><span class="line"><span class="function">    "<span class="title">test</span>": "<span class="title">echo</span> \"<span class="title">Error</span>: <span class="title">no</span> <span class="title">test</span> <span class="title">specified</span>\" &amp;&amp; <span class="title">exit</span> 1"</span></span><br><span class="line"><span class="function">  &#125;,</span></span><br><span class="line"><span class="function">  "<span class="title">author</span>": "<span class="title">AiJunhao</span>",</span></span><br><span class="line"><span class="function">  "<span class="title">license</span>": "<span class="title">ISC</span>"</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 是否同意，输入 <span class="title">yes</span> </span></span><br><span class="line"><span class="function"><span class="title">Is</span> <span class="title">this</span> <span class="title">OK</span>? (<span class="title">yes</span>) <span class="title">yes</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">F</span>:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>此时在项目根目录就创建了 <code>package.json</code> 文件。</p>
<h3 id="下载模块包"><a href="#下载模块包" class="headerlink" title="下载模块包"></a>下载模块包</h3><p>使用 npm 下载的包，放在同级目录下的 “node_modules” 文件夹下。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 根据配置文件自动下载包</span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line">// 语法</span><br><span class="line">npm install 模块关键字 --save</span><br><span class="line"></span><br><span class="line">或者简写：npm i 模块关键字 --save</span><br><span class="line">或者简写：npm i 模块关键字 -S</span><br><span class="line"></span><br><span class="line">// --save：表示将这个下载记录到 package.js 的 dependencies 中。如果不写，则不保存。</span><br></pre></td></tr></table></figure>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 输入mingl</span><br><span class="line"><span class="function">F:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>&gt;<span class="title">npm</span> <span class="title">install</span> <span class="title">art</span>-<span class="title">template</span> --<span class="title">save</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 会有一些 <span class="title">WARN</span> ，不用管它</span></span><br><span class="line"><span class="function"><span class="title">npm</span> <span class="title">notice</span> <span class="title">created</span> <span class="title">a</span> <span class="title">lockfile</span> <span class="title">as</span> <span class="title">package</span>-<span class="title">lock.json</span>. <span class="title">You</span> <span class="title">should</span> <span class="title">commit</span> <span class="title">this</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function"><span class="title">npm</span> <span class="title">WARN</span> <span class="title">nodejs</span>@0.0.1 <span class="title">No</span> <span class="title">repository</span> <span class="title">field</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 表示包已经添加</span></span><br><span class="line"><span class="function">+ <span class="title">art</span>-<span class="title">template</span>@4.13.2</span></span><br><span class="line"><span class="function"><span class="title">added</span> 32 <span class="title">packages</span> <span class="title">from</span> 133 <span class="title">contributors</span> <span class="title">and</span> <span class="title">audited</span> 40 <span class="title">packages</span> <span class="title">in</span> 6.025<span class="title">s</span></span></span><br><span class="line"><span class="function"><span class="title">found</span> 0 <span class="title">vulnerabilities</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">F</span>:\<span class="title">WorkSpace</span>\<span class="title">nodejs</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>此时看项目文件夹，就会有 node_modules 文件夹被新建，里面放了所有一级、二级……依赖文件；<code>package.json</code> 文件中会添加 <code>dependencies</code> 字段，记录这次添加的依赖包。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"nodejs"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.0.1"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"这是一个学习项目"</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"app.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"AiJunhao"</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"art-template"</span>: <span class="string">"^4.13.2"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="其他常用命令"><a href="#其他常用命令" class="headerlink" title="其他常用命令"></a>其他常用命令</h3><ul>
<li><p>删除包</p>
  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm unistall 包名       // 只删除，不会删除依赖项中的内容</span><br><span class="line"></span><br><span class="line">简写: npm un 包名</span><br></pre></td></tr></table></figure>
  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm unistall 包名 --save       // 删除包并删除依赖项中的内容</span><br><span class="line"></span><br><span class="line">简写: npm un 包名 -S</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看使用帮助</p>
  <figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm --<span class="built_in">help</span>      // 查看所有使用帮助</span><br><span class="line"></span><br><span class="line">npm 命令 --<span class="built_in">help</span>     // 查看该命令的具体使用方法</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="npm-被墙问题"><a href="#npm-被墙问题" class="headerlink" title="npm 被墙问题"></a>npm 被墙问题</h3><p>npm 存储包文件的服务器在国外，有时候会被墙，这时候可以使用淘宝镜像 cnpm。</p>
<p><a href="http://npm.taobao.org/" target="_blank" rel="noopener">http://npm.taobao.org/</a> 淘宝的开发团队把 npm 在国内做了一个备份。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 安装淘宝的 cnpm</span><br><span class="line">npm install --global cnpm</span><br><span class="line"></span><br><span class="line">// 然后将正常的 npm 命令中 npm 改成 cnpm 即可</span><br><span class="line">npm install jquery</span><br><span class="line">变成：cpm install jquery</span><br></pre></td></tr></table></figure>
<p>如果不想安装 cnpm 又想使用淘宝镜像下载：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jquery --registry=https://registry.npm.taoba.org</span><br></pre></td></tr></table></figure>
<p>但是这样比较麻烦，可以将这个选项加入配置文件中：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 配置</span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">// 查看配置</span><br><span class="line">npm config list</span><br></pre></td></tr></table></figure>
<p>配置之后，之后所有的下载都是从淘宝镜像下载的。</p>
<hr>
<h2 id="常用包使用"><a href="#常用包使用" class="headerlink" title="常用包使用"></a>常用包使用</h2><p>在开发中，有很多包对我们的测试和开发非常有用，这里做一个积累。</p>
<h3 id="json-server"><a href="#json-server" class="headerlink" title="json-server"></a>json-server</h3><p>使用本地 <code>JSON</code> 文件数据模拟 <code>API</code> 数据的工具。</p>
<p>在开发中很多时候我们并不想使用简单的静态数据，而是希望自己起一个本地的mock-server来完全模拟请求以及请求回来的过程。json-server是一个很好的可以替我们完成这一工作的工具。我们只需要提供一个json文件，或者写几行简单的js脚本就可以模拟出 <code>RESTful API</code> 的接口。</p>
<p>视频教程：<a href="https://egghead.io/lessons/javascript-creating-demo-apis-with-json-server" target="_blank" rel="noopener">https://egghead.io/lessons/javascript-creating-demo-apis-with-json-server</a></p>
<p>git教程：<a href="https://github.com/typicode/json-server" target="_blank" rel="noopener">https://github.com/typicode/json-server</a></p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> npm install -g json-server</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看版本号</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> json-server -v</span></span><br></pre></td></tr></table></figure>
<h4 id="创建-JSON-模拟数据文件"><a href="#创建-JSON-模拟数据文件" class="headerlink" title="创建 JSON 模拟数据文件"></a>创建 JSON 模拟数据文件</h4><p>安装之后创建一个 <code>json</code> 文件，用来模拟提供接口数据：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// data.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"users"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"id"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"admin"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">28</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"id"</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"admin"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">28</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"id"</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"admin"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="number">28</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h4><p>然后就是在 <code>json</code> 文件目录下启动服务了。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动服务命令，实时监测 data.json 的变化</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> json-server --watch data.json</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动服务命令，不监测变化，data.json 文件内容变化后不重启服务接口内容不变</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> json-server data.json</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">f:\WorkSpace\nodejs\05&gt;json-server --watch data.json</span><br><span class="line"></span><br><span class="line">  \&#123;^_^&#125;/ hi!</span><br><span class="line"></span><br><span class="line">  Loading data.json</span><br><span class="line">  Done</span><br><span class="line"></span><br><span class="line">  Resources</span><br><span class="line">  http://localhost:3000/users</span><br><span class="line"></span><br><span class="line">  Home</span><br><span class="line">  http://localhost:3000</span><br><span class="line"></span><br><span class="line">  Type s + enter at any time to create a snapshot of the database</span><br><span class="line">  Watching...</span><br><span class="line"></span><br><span class="line">GET /db 200 2.483 ms - 608</span><br><span class="line">GET /__rules 404 8.024 ms - 2</span><br></pre></td></tr></table></figure>
<p>然后浏览器访问 <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> 可以查看我们的主页，此时基本满足所有 API 操作。</p>
<p><img src="/2019/03/19/后端基础——npm常见包/json-server.jpg" alt="json-server.jpg"></p>
<hr>
<h3 id="http-server"><a href="#http-server" class="headerlink" title="http-server"></a>http-server</h3><hr>
<h3 id="art-template"><a href="#art-template" class="headerlink" title="art-template"></a>art-template</h3><p>前端模板引擎。</p>
<h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i art-template -S</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="express-art-template"><a href="#express-art-template" class="headerlink" title="express-art-template"></a>express-art-template</h3><p>在 <code>express</code> 中使用的 <code>art-template</code> 模板引擎。</p>
<h4 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i art-template -S</span><br><span class="line">npm i express-art-template -S</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="body-parser"><a href="#body-parser" class="headerlink" title="body-parser"></a>body-parser</h3><p>在 <code>Express</code> 中没有内置获取表单 <code>POST</code> 请求体的API，这里我们需要一个 <code>Express</code> 的第三方包 <code>body-parser</code>。</p>
<p><a href="http://www.expressjs.com.cn/en/resources/middleware/body-parser.html" target="_blank" rel="noopener">http://www.expressjs.com.cn/en/resources/middleware/body-parser.html</a></p>
<h4 id="body-parser-安装"><a href="#body-parser-安装" class="headerlink" title="body-parser 安装"></a>body-parser 安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install body-parser</span><br></pre></td></tr></table></figure>
<h4 id="body-parser-配置"><a href="#body-parser-配置" class="headerlink" title="body-parser 配置"></a>body-parser 配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="comment">// 引包</span></span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 body-parser</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line">app.use(bodyParser.json())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载路由</span></span><br><span class="line">app.use(router)</span><br></pre></td></tr></table></figure>
<h4 id="Express-获取-POST-数据"><a href="#Express-获取-POST-数据" class="headerlink" title="Express 获取 POST 数据"></a>Express 获取 POST 数据</h4><p>配置完这个中间件之后，<code>request</code> 中会多出一个 <code>body</code> 属性，通过 <code>body</code> 属性就能获取 <code>post</code> 请求数据了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简单使用，打印出这个 post 数据</span></span><br><span class="line">app.use(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">  response.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>)</span><br><span class="line">  response.write(<span class="string">'you posted;\n'</span>)</span><br><span class="line">  <span class="comment">// post 数据在 request.body 中，将其转为 JSON 数据并打印出来。</span></span><br><span class="line">  response.end(<span class="built_in">JSON</span>.stringify(request.body, <span class="literal">null</span>, <span class="number">2</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="express-session"><a href="#express-session" class="headerlink" title="express-session"></a>express-session</h3><p><code>Express</code> 的 <code>Session</code> 和 <code>Cookie</code> 中间件。</p>
<p><code>Express</code> 文档：<a href="http://www.expressjs.com.cn/en/resources/middleware/session.html" target="_blank" rel="noopener">http://www.expressjs.com.cn/en/resources/middleware/session.html</a></p>
<p><strong>安装</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express-session -S</span><br></pre></td></tr></table></figure>
<p><strong>配置</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="comment">// 引包</span></span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">'express-session'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 session</span></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  <span class="comment">// 自定义的二次加密字符串</span></span><br><span class="line">  secret: <span class="string">'keyboard cat'</span>,</span><br><span class="line">  resave: <span class="literal">false</span>,</span><br><span class="line">  saveUninitialized: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载路由</span></span><br><span class="line">app.use(router)</span><br></pre></td></tr></table></figure>
<p><strong>使用</strong></p>
<p><code>session</code> 参数都存在 <code>request</code> 中，只要通过 <code>request.session.xxx</code> 就能进行 <code>session</code> 信息的存取操作了。</p>
<p>如下页面，先进行注册并自动登录，<code>req</code> 存储登录状态；然后跳转到首页，<code>req</code> 获取到登录状态，进行进一步的处理，保持页面处于登录状态。</p>
<p>但是注意，这种做法的 <code>session</code> 默认是存储在服务器的内存中的，也就是说只要服务器已关闭，所有 <code>session</code> 都会被清除，所以有时候需要进行永久化存储。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js 路由独立页面</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> router = express.Router()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首页</span></span><br><span class="line">router.get(<span class="string">'/'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.session.user)    <span class="comment">// userObject</span></span><br><span class="line">  <span class="comment">// 将用户对象传入渲染页面</span></span><br><span class="line">  res.render(<span class="string">'index.html'</span>, &#123;</span><br><span class="line">    user: req.session.user</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册页面处理</span></span><br><span class="line">router.post(<span class="string">'/register'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  </span><br><span class="line">  ……</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 注册成功，保存 session</span></span><br><span class="line">  req.session.user = userObject</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="blueimp-md5"><a href="#blueimp-md5" class="headerlink" title="blueimp-md5"></a>blueimp-md5</h3><p><a href="https://www.npmjs.com/package/blueimp-md5" target="_blank" rel="noopener">https://www.npmjs.com/package/blueimp-md5</a></p>
<p>数据加密。</p>
<p><strong>安装</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i blueimp-md5 -S</span><br></pre></td></tr></table></figure>
<p><strong>配置及使用</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> md5 = <span class="built_in">require</span>(<span class="string">'blueimp-md5'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过post获取注册信息等……</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 一般进行两层以上加密</span></span><br><span class="line">body.password = md5(md5(body.pawword))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后保存账号密码到数据库</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 之后，数据库中的加密内容就是乱码了。</span></span><br><span class="line"><span class="string">"password"</span> : <span class="string">"d9b1d7db4cd6e70935368a1efb10e377"</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h3><p><code>axios</code> 是基于 <code>promise</code> 的异步请求。</p>
<p><code>npm</code> 教程：<a href="https://www.npmjs.com/package/axios" target="_blank" rel="noopener">https://www.npmjs.com/package/axios</a></p>
<p><strong>安装</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i axios -S</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="animate-css"><a href="#animate-css" class="headerlink" title="animate.css"></a>animate.css</h3><p><code>animate.css</code> 是一组很酷、有趣的跨浏览器动画，供您在项目中使用。</p>
<p>官网： <a href="https://daneden.github.io/animate.css/" target="_blank" rel="noopener">https://daneden.github.io/animate.css/</a></p>
<p>所有动画效果都可以在官网首页进行预览。</p>
<p><img src="/2019/03/19/后端基础——npm常见包/animate.png" alt="animate.png"></p>
<p><strong>安装</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i animate.css -S</span><br></pre></td></tr></table></figure>
<p><strong>配置</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/animate.css/animate.css"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>因为它是 <code>css</code> 类，所以使用非常简单，只需要在 <code>class</code> 中添加指定类名即可。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 添加了四个类：动画执行类、无限循环类、弹跳类、延迟类 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"animated infinite bounce delay-2s"</span>&gt;</span>Example<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其他更详细内容见官网介绍。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/19/后端基础——npm常见包/" data-id="cjy01an0g0034osutq3kud7sm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node/">Node</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后端/">后端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-前端-JavaScript基础-EcamScript6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/18/前端-JavaScript基础-EcamScript6/" class="article-date">
  <time datetime="2019-03-18T08:59:13.000Z" itemprop="datePublished">2019-03-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/18/前端-JavaScript基础-EcamScript6/">前端-JavaScript基础-ES6-Promise</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#异步操作">异步操作</a><ul>
<li><a href="#callback-hell-回调地狱">callback hell 回调地狱</a></li>
<li><a href="#promise-对象">Promise 对象</a><ul>
<li><a href="#promise-状态">Promise 状态</a></li>
<li><a href="#then-方法">then() 方法</a></li>
<li><a href="#案例nodejs-中-promise-读取文件数据">案例：Node.js 中 Promise 读取文件数据</a></li>
<li><a href="#案例前端请求数据时的-promise">案例：前端请求数据时的 Promise</a></li>
<li><a href="#案例nodejs-调用-mongoose-时的-promise">案例：Node.js 调用 Mongoose 时的 promise</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<p>参考阮一峰教材：<a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noopener">http://es6.ruanyifeng.com/#docs/promise</a></p>
<hr>
<h2 id="异步操作"><a href="#异步操作" class="headerlink" title="异步操作"></a>异步操作</h2><h3 id="callback-hell-回调地狱"><a href="#callback-hell-回调地狱" class="headerlink" title="callback hell 回调地狱"></a>callback hell 回调地狱</h3><p>在 JS 程序中，程序执行不会等待异步操作执行，而异步操作的时间长短与操作的内容有关，并不一定会按顺序。</p>
<p>如下代码，有三个读取文件的异步操作，其执行结束的顺序与文件大小及其他因素有关，所以控制台输出的结果顺序会不同。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./b.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./c.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果需要将这个程序按先后顺序执行，可以如下修改：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line"></span><br><span class="line">  fs.readFile(<span class="string">'./b.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line"></span><br><span class="line">    fs.readFile(<span class="string">'./c.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果有更多的异步操作，就需要在回调函数中不断地嵌套函数，代码深度将非常恐怖，也非常不利于维护，这就是<font color="red">回调地域</font>。</p>
<h3 id="Promise-对象"><a href="#Promise-对象" class="headerlink" title="Promise 对象"></a>Promise 对象</h3><p><code>Promise</code> 对象用于解决异步操作的回调地狱（函数作为参数层层嵌套）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 虽然解决了异步操作的先后顺序，单数出现了回调地域</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line"></span><br><span class="line">  fs.readFile(<span class="string">'./b.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line"></span><br><span class="line">    fs.readFile(<span class="string">'./c.txt'</span>, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="Promise-状态"><a href="#Promise-状态" class="headerlink" title="Promise 状态"></a>Promise 状态</h4><p><code>Promise</code> 异步操作有三种状态：<code>pending（进行中）</code>、 <code>resolved（已定型） /fulfilled（已成功）</code> 和  <code>rejected（已失败）</code>。</p>
<p><code>Promise</code>对象只有：从 <code>pending</code> 变为 <code>Resolved</code> 和从 <code>pending</code> 变为 <code>rejected</code> 的状态改变。只要处于 <code>resolved</code> 和 <code>rejected</code> ，状态就不会再变了。</p>
<p><img src="/2019/03/18/前端-JavaScript基础-EcamScript6/Promise.jpg" alt="Promise.jpg"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Promise 对象的使用</span></span><br><span class="line"><span class="keyword">var</span> myPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ... some code</span></span><br><span class="line"></span><br><span class="line">  异步操作方法(xxx, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>Promise</code> 对象一旦新建就会被执行，中途无法被取消。</p>
<h4 id="then-方法"><a href="#then-方法" class="headerlink" title="then() 方法"></a>then() 方法</h4><p><code>then()</code> 方法接收两个回调函数作为参数，两个函数只会有一个被调用。</p>
<ul>
<li><p>第一个参数是 <code>Promise</code> 执行成功 <code>Resolve</code> 成功状态时的回调。</p>
</li>
<li><p>第二个参数是 <code>Promise</code> 执行失败 <code>Reject</code> 失败状态时的回调。</p>
</li>
</ul>
<p><code>then()</code> 方法会在异步操作完成之后执行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单个异步操作</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ... some code</span></span><br><span class="line"></span><br><span class="line">  fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">myPromise.then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;, (err) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>then()</code> 方法可以链式调用，每个 <code>then()</code> 方法的一个回调函数中 <code>return</code> 下一个要执行的异步操作的 <code>Promise</code> 对象，这样第二个异步操作就会在第一个异步操作之后执行，这样就确保了异步操作的执行顺序问题，同时也避免了回调地域问题。</p>
<hr>
<h4 id="案例：Node-js-中-Promise-读取文件数据"><a href="#案例：Node-js-中-Promise-读取文件数据" class="headerlink" title="案例：Node.js 中 Promise 读取文件数据"></a>案例：Node.js 中 Promise 读取文件数据</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Node.js 中多个异步操作依次执行</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  fs.readFile(<span class="string">'./a.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  fs.readFile(<span class="string">'./b.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  fs.readFile(<span class="string">'./c.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p1</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> p2</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> p3</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为了简化代码，可以将这个异步操作封装成 API</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pReadFile</span> (<span class="params">filePath</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    fs.readFile(filePath, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="comment">// 承诺任务失败，Pending 状态变成 Rejected</span></span><br><span class="line">        reject(err)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 承诺任务完成，Pending 状态变成 Resolve</span></span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pReadFile(<span class="string">'./a.txt'</span>)</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> pReadFile(<span class="string">'./b.txt'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">      <span class="keyword">return</span> pReadFile(<span class="string">'./c.txt'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;,</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'文件读取失败，错误对象：'</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="案例：前端请求数据时的-Promise"><a href="#案例：前端请求数据时的-Promise" class="headerlink" title="案例：前端请求数据时的 Promise"></a>案例：前端请求数据时的 Promise</h4><p>这里使用 <code>ajax</code> 请求 <code>API</code> 数据时，有时会出现一个页面需要请求多个不同的 <code>API</code>，少则三五个，多则七八个，因彼此间有先后顺序，此时就需要保证异步请求的先后顺序了，<code>jQuery</code> 中已经支持了 <code>Promise</code>。</p>
<p>这个案例需要 <code>API</code> 数据，可以用 <code>json-server</code> 工具来模拟。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">"user_form"</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 模板内容 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/template"</span> <span class="attr">id</span>=<span class="string">"tpl"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; user.username &#125;&#125;"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; user.age &#125;&#125;"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>职业<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span></span></span><br><span class="line"><span class="undefined">                    &#123;&#123; each jobs&#125;&#125;</span></span><br><span class="line"><span class="javascript">                        &#123;&#123; <span class="keyword">if</span> user.jobId === $value.id&#125;&#125;</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; $value.id &#125;&#125;"</span> <span class="attr">selected</span>&gt;</span>&#123;&#123; $value.name &#125;&#125;<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="javascript">                        &#123;&#123; <span class="keyword">else</span> &#125;&#125;</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"&#123;&#123; $value.id &#125;&#125;"</span>&gt;</span>&#123;&#123; $value.name &#125;&#125;<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="javascript">                        &#123;&#123; /<span class="keyword">if</span> &#125;&#125;</span></span><br><span class="line"><span class="undefined">                    &#123;&#123; /each &#125;&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="undefined">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 引用模板 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/art-template/lib/template-web.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 引用 jQuery --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/jquery/dist/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 模板渲染 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             *  未用 promise</span></span><br><span class="line"><span class="undefined">             */</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> data = &#123;&#125;;</span></span><br><span class="line"><span class="javascript">            promiseGet(<span class="string">"http://127.0.0.1:3000/users/4"</span>)</span></span><br><span class="line"><span class="javascript">                .then(<span class="function"><span class="params">userData</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="undefined">                    data.user = userData</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> promiseGet(<span class="string">"http://127.0.0.1:3000/jobs"</span>)</span></span><br><span class="line"><span class="undefined">                &#125;)</span></span><br><span class="line"><span class="javascript">                .then(<span class="function"><span class="params">jobsData</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="undefined">                    data.jobs = jobsData</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(data)</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">var</span> htmlStr = template(<span class="string">"tpl"</span>, data)</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">document</span>.querySelector(<span class="string">"#user_form"</span>).innerHTML = htmlStr</span></span><br><span class="line"><span class="undefined">                &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             *  使用 promise 的 jQuery</span></span><br><span class="line"><span class="undefined">             */</span></span><br><span class="line"><span class="javascript">            <span class="comment">// var data = &#123;&#125;;</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// // userData，jobsData 返回时就是对象了</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// $.get("http://127.0.0.1:3000/users/4")</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//     .then(userData =&gt; &#123;</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         data.user = userData</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         return $.get("http://127.0.0.1:3000/jobs")</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//     &#125;)</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//     .then(jobsData =&gt; &#123;</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         data.jobs = jobsData</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         var htmlStr = template("tpl", data)</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//         document.querySelector("#user_form").innerHTML = htmlStr</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">//     &#125;)</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            /**</span></span><br><span class="line"><span class="undefined">             * 封装 ajax 获取网络请求的 promise 方法，可以再写个callback，就可以支持多重形式</span></span><br><span class="line"><span class="undefined">             **/</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="keyword">function</span> <span class="title">promiseGet</span>(<span class="params">url</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">var</span> oReq = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 当请求加载成功之后要调用的函数</span></span></span><br><span class="line"><span class="javascript">                    oReq.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                        resolve(<span class="built_in">JSON</span>.parse(oReq.responseText));</span></span><br><span class="line"><span class="undefined">                    &#125;;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">// 当请求加载失败之后要调用的函数</span></span></span><br><span class="line"><span class="javascript">                    oReq.onerror = <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="undefined">                        reject(err);</span></span><br><span class="line"><span class="undefined">                    &#125;;</span></span><br><span class="line"><span class="javascript">                    oReq.open(<span class="string">"get"</span>, url, <span class="literal">true</span>);</span></span><br><span class="line"><span class="undefined">                    oReq.send();</span></span><br><span class="line"><span class="undefined">                &#125;);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// data.json</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"users"</span>:[</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">1</span>,<span class="attr">"username"</span>:<span class="string">"admin"</span>,<span class="attr">"age"</span>:<span class="number">28</span>,<span class="attr">"jobId"</span>:<span class="number">3</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">2</span>,<span class="attr">"username"</span>:<span class="string">"admin"</span>,<span class="attr">"age"</span>:<span class="number">28</span>,<span class="attr">"jobId"</span>:<span class="number">4</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">3</span>,<span class="attr">"username"</span>:<span class="string">"admin"</span>,<span class="attr">"age"</span>:<span class="number">28</span>,<span class="attr">"jobId"</span>:<span class="number">5</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">4</span>,<span class="attr">"username"</span>:<span class="string">"admin"</span>,<span class="attr">"age"</span>:<span class="number">28</span>,<span class="attr">"jobId"</span>:<span class="number">5</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"jobs"</span>:[</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">1</span>,<span class="attr">"name"</span>:<span class="string">"学生"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">2</span>,<span class="attr">"name"</span>:<span class="string">"老师"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">3</span>,<span class="attr">"name"</span>:<span class="string">"司机"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">4</span>,<span class="attr">"name"</span>:<span class="string">"画家"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">5</span>,<span class="attr">"name"</span>:<span class="string">"演员"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"id"</span>:<span class="number">6</span>,<span class="attr">"name"</span>:<span class="string">"电竞"</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="案例：Node-js-调用-Mongoose-时的-promise"><a href="#案例：Node-js-调用-Mongoose-时的-promise" class="headerlink" title="案例：Node.js 调用 Mongoose 时的 promise"></a>案例：Node.js 调用 Mongoose 时的 promise</h4><p><code>mongoose</code> 所有 <code>API</code> 都支持 <code>promise</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">27017</span></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">'127.0.0.1'</span></span><br><span class="line"><span class="keyword">const</span> dbName = <span class="string">'user'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 连接数据库</span></span><br><span class="line">mongoose.connect(<span class="string">`mongodb://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/<span class="subst">$&#123;dbName&#125;</span>`</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数据库连接状态;</span></span><br><span class="line"><span class="keyword">var</span> db = mongoose.connection</span><br><span class="line">db.on(<span class="string">'error'</span>, <span class="built_in">console</span>.error.bind(<span class="built_in">console</span>, <span class="string">'数据库连接失败！'</span>))</span><br><span class="line">db.once(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// we're connected!</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'数据库连接成功！'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Schema 文档结构设计（表结构）</span></span><br><span class="line"><span class="keyword">var</span> userSchema = mongoose.Schema(&#123;</span><br><span class="line">  username: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  password: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  email: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  age: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  gender: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">0</span>,</span><br><span class="line">    enum: [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 把 schema 编译成一个 Model，并返回 Model 对象</span></span><br><span class="line"><span class="keyword">var</span> User = mongoose.model(<span class="string">'User'</span>, userSchema)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> userJson = &#123;</span><br><span class="line">  username: <span class="string">'admin'</span>,</span><br><span class="line">  password: <span class="string">'1234'</span>,</span><br><span class="line">  email: <span class="string">'1234@qq.com'</span>,</span><br><span class="line">  age: <span class="number">17</span>,</span><br><span class="line">  gender: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 mongoose 的 Promise，避免用户重复注册</span></span><br><span class="line">User.findOne(&#123; <span class="attr">username</span>: <span class="string">'admin'</span> &#125;)</span><br><span class="line">  .then(</span><br><span class="line">    <span class="comment">// 查询成功的回调，data 为查找到的对象</span></span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (data) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'用户名已存在'</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'用户名可用'</span>)</span><br><span class="line">        <span class="comment">// 用户不存在，注册</span></span><br><span class="line">        <span class="comment">// return 异步操作 save()</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(userJson).save()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    () =&gt; <span class="built_in">console</span>.log(<span class="string">'数据查询失败'</span>)</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    <span class="comment">// 如果执行 save() 成功，data 返回的是保存的对象</span></span><br><span class="line">    <span class="comment">// 未执行 save() 方法，data 为空</span></span><br><span class="line">    data =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (data) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'数据保存成功:'</span>, data)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'数据不保存'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    () =&gt; <span class="built_in">console</span>.log(<span class="string">'数据保存失败'</span>)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不使用 Promise</span></span><br><span class="line"><span class="comment">// User.findOne(&#123; username: 'admin' &#125;, (err, data) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   if (err) &#123;</span></span><br><span class="line"><span class="comment">//     return console.log('查询失败')</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   console.log('查找成功，data：', data)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   if (data) &#123;</span></span><br><span class="line"><span class="comment">//     console.log('用户名已存在')</span></span><br><span class="line"><span class="comment">//   &#125; else &#123;</span></span><br><span class="line"><span class="comment">//     console.log('用户名可用')</span></span><br><span class="line"><span class="comment">//     new User(userJson).save((err, data) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//       if (err) &#123;</span></span><br><span class="line"><span class="comment">//         return console.log('保存失败')</span></span><br><span class="line"><span class="comment">//       &#125;</span></span><br><span class="line"><span class="comment">//       console.log('保存成功，data：', data)</span></span><br><span class="line"><span class="comment">//     &#125;)</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;)</span></span><br></pre></td></tr></table></figure>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/18/前端-JavaScript基础-EcamScript6/" data-id="cjy01amzx0030osutxou2hqi0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EcamScript6/">EcamScript6</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-数据库——MySQL" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/15/数据库——MySQL/" class="article-date">
  <time datetime="2019-03-15T09:35:10.000Z" itemprop="datePublished">2019-03-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/15/数据库——MySQL/">数据库——MySQL</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#mysql-简介">MySQL 简介</a></li>
<li><a href="#mysql-安装">MySQL 安装</a><ul>
<li><a href="#zip-压缩版">ZIP 压缩版</a></li>
<li><a href="#msi-安装包安装">MSI 安装包安装</a></li>
<li><a href="#第三方可视化工具-patchnavicat">第三方可视化工具 PatchNavicat</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="MySQL-简介"><a href="#MySQL-简介" class="headerlink" title="MySQL 简介"></a>MySQL 简介</h2><p>关系型数据库</p>
<h2 id="MySQL-安装"><a href="#MySQL-安装" class="headerlink" title="MySQL 安装"></a>MySQL 安装</h2><p><a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">https://dev.mysql.com/downloads/mysql/</a></p>
<h3 id="ZIP-压缩版"><a href="#ZIP-压缩版" class="headerlink" title="ZIP 压缩版"></a>ZIP 压缩版</h3><p><img src="/2019/03/15/数据库——MySQL/download.png" alt="download.png"></p>
<p><img src="/2019/03/15/数据库——MySQL/download2.png" alt="download2.png"></p>
<p>详细配置见菜鸟联盟：<a href="http://www.runoob.com/mysql/mysql-install.html" target="_blank" rel="noopener">http://www.runoob.com/mysql/mysql-install.html</a></p>
<h3 id="MSI-安装包安装"><a href="#MSI-安装包安装" class="headerlink" title="MSI 安装包安装"></a>MSI 安装包安装</h3><p>见收藏的百度云视频：</p>
<p>链接：<a href="https://pan.baidu.com/s/1dBn2UqrIvR-5ebJQZ_lOmg" target="_blank" rel="noopener">https://pan.baidu.com/s/1dBn2UqrIvR-5ebJQZ_lOmg</a><br>提取码：d041<br>复制这段内容后打开百度网盘手机App，操作更方便哦</p>
<h3 id="第三方可视化工具-PatchNavicat"><a href="#第三方可视化工具-PatchNavicat" class="headerlink" title="第三方可视化工具 PatchNavicat"></a>第三方可视化工具 PatchNavicat</h3><p>见收藏的百度云视频：</p>
<p>链接：<a href="https://pan.baidu.com/s/1dBn2UqrIvR-5ebJQZ_lOmg" target="_blank" rel="noopener">https://pan.baidu.com/s/1dBn2UqrIvR-5ebJQZ_lOmg</a><br>提取码：d041<br>复制这段内容后打开百度网盘手机App，操作更方便哦</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/15/数据库——MySQL/" data-id="cjy01amga001nosut0uxbskqx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BOM/">BOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DOM/">DOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECharts/">ECharts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EcamScript6/">EcamScript6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Html-Css/">Html/Css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/">Node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后端/">后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务器/">服务器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/框架/">框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器兼容/">浏览器兼容</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动端/">移动端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件配置/">软件配置</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 19px;">Android</a> <a href="/tags/BOM/" style="font-size: 10px;">BOM</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/DOM/" style="font-size: 10px;">DOM</a> <a href="/tags/ECharts/" style="font-size: 10px;">ECharts</a> <a href="/tags/EcamScript6/" style="font-size: 10px;">EcamScript6</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Html-Css/" style="font-size: 11px;">Html/Css</a> <a href="/tags/JavaScript/" style="font-size: 17px;">JavaScript</a> <a href="/tags/Node/" style="font-size: 14px;">Node</a> <a href="/tags/Python/" style="font-size: 16px;">Python</a> <a href="/tags/Vue/" style="font-size: 14px;">Vue</a> <a href="/tags/blog/" style="font-size: 11px;">blog</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/tool/" style="font-size: 10px;">tool</a> <a href="/tags/前端/" style="font-size: 18px;">前端</a> <a href="/tags/后端/" style="font-size: 13px;">后端</a> <a href="/tags/小程序/" style="font-size: 10px;">小程序</a> <a href="/tags/数据库/" style="font-size: 12px;">数据库</a> <a href="/tags/服务器/" style="font-size: 10px;">服务器</a> <a href="/tags/框架/" style="font-size: 15px;">框架</a> <a href="/tags/浏览器兼容/" style="font-size: 10px;">浏览器兼容</a> <a href="/tags/移动端/" style="font-size: 20px;">移动端</a> <a href="/tags/软件配置/" style="font-size: 10px;">软件配置</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/12/前端-CSS预处理器/">前端-CSS预处理器</a>
          </li>
        
          <li>
            <a href="/2019/05/22/阿里云服务器配置/">阿里云服务器配置</a>
          </li>
        
          <li>
            <a href="/2019/04/25/框架-Vuex/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/04/11/框架-全栈开发/">Vue+Node+Mongodb全栈开发</a>
          </li>
        
          <li>
            <a href="/2019/04/10/框架-Vue-cli3/">框架-Vue-cli 3.x脚手架</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Ai Junhao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>