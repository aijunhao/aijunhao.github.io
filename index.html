<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hello, I&#39;m Junhao Ai.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hello, I&#39;m Junhao Ai.">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hello, I&#39;m Junhao Ai.">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hello, I&#39;m Junhao Ai.">
  
    <link rel="alternate" href="/atom.xml" title="Hello, I&#39;m Junhao Ai." type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hello, I&#39;m Junhao Ai.</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-JavaScript基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/18/JavaScript基础/" class="article-date">
  <time datetime="2018-12-18T12:57:31.000Z" itemprop="datePublished">2018-12-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/18/JavaScript基础/">JavaScript基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>JavaScript目录：</p>
<ul>
<li>JavaScript简介</li>
</ul>
<hr>
<h3 id="JavaScript简介"><a href="#JavaScript简介" class="headerlink" title="JavaScript简介"></a>JavaScript简介</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/12/18/JavaScript基础/" data-id="cjptr8u72000k68utdl86ljgp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-前端-Html_Css常见问题解决" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/14/前端-Html_Css常见问题解决/" class="article-date">
  <time datetime="2018-12-14T11:24:18.000Z" itemprop="datePublished">2018-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/14/前端-Html_Css常见问题解决/">前端 - Html_Css常见问题解决</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>目录：</p>
<ul>
<li>高度塌陷问题<ul>
<li>父容器的高度塌陷问题</li>
<li>元素浮动造成的高度塌陷问题</li>
</ul>
</li>
<li>父子元素外边距重叠</li>
<li>背景闪烁问题</li>
</ul>
<hr>
<h2 id="高度塌陷问题"><a href="#高度塌陷问题" class="headerlink" title="高度塌陷问题"></a>高度塌陷问题</h2><h3 id="父容器的高度塌陷问题"><a href="#父容器的高度塌陷问题" class="headerlink" title="父容器的高度塌陷问题"></a>父容器的高度塌陷问题</h3><h5 id="代码、截图如下："><a href="#代码、截图如下：" class="headerlink" title="代码、截图如下："></a>代码、截图如下：</h5><p>高度塌陷问题的代码如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box1&#123;</span></span><br><span class="line"><span class="undefined">                border: 10px red solid;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box2&#123;</span></span><br><span class="line"><span class="undefined">                height: 100px;</span></span><br><span class="line"><span class="undefined">                width: 100px;</span></span><br><span class="line"><span class="undefined">                background-color: blue;</span></span><br><span class="line"><span class="undefined">                float: left;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box3&#123;</span></span><br><span class="line"><span class="undefined">                height: 100px;</span></span><br><span class="line"><span class="undefined">                background-color: yellow;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box3"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>高度塌陷的示意图：<br><img src="/2018/12/14/前端-Html_Css常见问题解决/高度塌陷问题.jpg" alt=""></p>
<p>正常的示意图：<br><img src="/2018/12/14/前端-Html_Css常见问题解决/解决高度缺陷.jpg" alt=""></p>
<h5 id="问题描述："><a href="#问题描述：" class="headerlink" title="问题描述："></a>问题描述：</h5><p>在文档流中，父元素的高度默认是被子元素撑开的，也就是子元素多高，父元素就多高。但是当子元素设置浮动以后，子元素就完全脱离文档流，此时将会导致子元素无法撑起父元素的高度，导致父元素的高度塌陷，父元素下的所有元素都会向上移动，这样讲导致页面布局混乱。如案例中的子元素div（box2）设置浮动之后，父元素div（box1）高度塌陷，div（box3）向上移动。</p>
<h5 id="原理及解决方法："><a href="#原理及解决方法：" class="headerlink" title="原理及解决方法："></a>原理及解决方法：</h5><p><font color="red">方法一：</font>根据W3C的标准，在页面中元素都隐含的一个元素叫做Block Formatting Context，简称BFC，该属性可以设置打开或者关闭，默认是关闭的。</p>
<p>当开启元素的BFC以后，元素将会具有如下的特性：</p>
<ol>
<li>父元素的垂直边距不会和子元素重叠</li>
<li>开启BFC的元素不会被浮动元素所覆盖</li>
<li>开启BFC的元素可以包含浮动的子元素</li>
</ol>
<p>开启元素的BFC，各有缺陷：</p>
<ol>
<li><p>设置元素浮动。不推荐。</p>
<p> 使用这种方式开启，虽然可以撑开父元素，但是会导致父元素的宽度丢失，也会导致下边元素上移，不能解决问题。</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.box1&#123;</span><br><span class="line">    border: 10px red solid;</span><br><span class="line">    float: left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> <img src="/2018/12/14/前端-Html_Css常见问题解决/设置父容器浮动.jpg" alt=""></p>
</li>
<li><p>设置元素绝对定位。不推荐。</p>
<p> 同上。</p>
</li>
<li><p>设置元素display属性为inline-block，将元素转化为内联块元素。不推荐。</p>
<p> 可以解决问题，但是会导致宽度丢失，不推荐使用。</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.box1&#123;</span><br><span class="line">    border: 10px red solid;</span><br><span class="line">    display: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> <img src="/2018/12/14/前端-Html_Css常见问题解决/元素转化为内联元素.jpg" alt=""></p>
</li>
<li><p>大部分浏览器将元素的overflow设置为非visible的值，推荐hidden。推荐。</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.box1&#123;</span><br><span class="line">    border: 10px red solid;</span><br><span class="line"></span><br><span class="line">    zoom: 1;        /* 解决IE6及以下浏览器高度塌陷问题*/</span><br><span class="line">    overflow: hidden;      /* 解决大部分浏览器高度塌陷问题 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> <img src="/2018/12/14/前端-Html_Css常见问题解决/解决高度缺陷.jpg" alt=""></p>
</li>
</ol>
<p>IE6及以下浏览器中并不支持BFC，IE6中有另一个隐含的属性叫hasLayout，作用和BFC类似，所以在IE6及以下浏览器可以开启hasLayout来解决高度塌陷问题。</p>
<p>开启hasLayout副作用最小的方法是将元素的zoom设置为1即可。zoom表示将元素放大几倍。<br>开启hasLayout的方法：</p>
<ol>
<li><p>IE6及以下浏览器设置zoom: 1，推荐。</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.box1&#123;</span><br><span class="line">    border: 10px red solid;</span><br><span class="line"></span><br><span class="line">    zoom: 1;        /* 解决IE6及以下浏览器高度塌陷问题*/</span><br><span class="line">    overflow: hidden;      /* 解决大部分浏览器高度塌陷问题 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置width和height，推荐。</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.box1&#123;</span><br><span class="line">    border: 10px red solid;</span><br><span class="line"></span><br><span class="line">    height: xxx;</span><br><span class="line">    width: xxx;        /* 解决IE6及以下浏览器高度塌陷问题*/</span><br><span class="line">    overflow: hidden;      /* 解决大部分浏览器高度塌陷问题 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><font color="red">方法二：</font>尽管上述方法用起来副作用比较小，但是还有一种W3C推荐的方法，使用额外的div和clear的方法来无副作用地清除高度塌陷。</p>
<p>代码如下，在div（box2）中添加一个新的div专门用来清除浮动，这样就能完美解决高度塌陷问题。但是有一点不好的地方就是，会在代码中加入多余的div结构，但是这样影响并不大。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box1&#123;</span></span><br><span class="line"><span class="undefined">                border: 10px red solid;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box2&#123;</span></span><br><span class="line"><span class="undefined">                height: 100px;</span></span><br><span class="line"><span class="undefined">                width: 100px;</span></span><br><span class="line"><span class="undefined">                background-color: blue;</span></span><br><span class="line"><span class="undefined">                float: left;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box3&#123;</span></span><br><span class="line"><span class="undefined">                height: 100px;</span></span><br><span class="line"><span class="undefined">                background-color: yellow;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">            </span></span><br><span class="line"><span class="undefined">            .clear&#123;</span></span><br><span class="line"><span class="undefined">                clear: both;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"clear"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box3"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><font color="red">最优，方法三：</font>在方法二的基础上进行完善。即不添加多余的div结构，又要解决高度塌陷问题。使用CSS的方法，通过after伪类，向元素后添加一个空白的块元素，然后清除浮动，实现html方法添加div并设置clear的效果。</p>
<p>关键代码如下，只需要在出现高度塌陷的元素中使用这个类就能实现高度缺陷问题。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.clearfix:after&#123;</span><br><span class="line">    /* 添加一个空的内容 */</span><br><span class="line">    content: "";</span><br><span class="line">    /* 转换为一个块元素，block、table都行 */</span><br><span class="line">    display: block;</span><br><span class="line">    /* 清除浮动 */</span><br><span class="line">    clear: both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 兼容IE6 */</span><br><span class="line">.clearfix&#123;</span><br><span class="line">    zoom: 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="元素浮动造成的高度塌陷问题"><a href="#元素浮动造成的高度塌陷问题" class="headerlink" title="元素浮动造成的高度塌陷问题"></a>元素浮动造成的高度塌陷问题</h3><h5 id="代码、截图如下：-1"><a href="#代码、截图如下：-1" class="headerlink" title="代码、截图如下："></a>代码、截图如下：</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>ttt<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box1&#123;</span></span><br><span class="line"><span class="undefined">                width: 100px;</span></span><br><span class="line"><span class="undefined">                height: 100px;</span></span><br><span class="line"><span class="undefined">                background-color: yellow;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                float: left;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box2&#123;</span></span><br><span class="line"><span class="undefined">                width: 200px;</span></span><br><span class="line"><span class="undefined">                height: 200px;</span></span><br><span class="line"><span class="undefined">                background-color: yellowgreen;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                float: right;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box3&#123;</span></span><br><span class="line"><span class="undefined">                width: 300px;</span></span><br><span class="line"><span class="undefined">                height: 300px;</span></span><br><span class="line"><span class="undefined">                background-color: skyblue;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box3"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2018/12/14/前端-Html_Css常见问题解决/浮动造成的高度塌陷.jpg" alt=""></p>
<h5 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h5><p>设置div（box1）向左浮动，div（box2）向右浮动，div（box3）受到其他元素影响，向上偏移。</p>
<h5 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h5><p>使用clear属性清除其他元素浮动对当前元素的影响。</p>
<p>可选值：</p>
<ul>
<li>none：不清除</li>
<li><p>left：清除左侧元素浮动对当前元素的影响。</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.box3&#123;</span><br><span class="line">    width: 300px;</span><br><span class="line">    height: 300px;</span><br><span class="line">    background-color: skyblue;</span><br><span class="line"></span><br><span class="line">    clear: left;</span><br><span class="line">&#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure>
<p>  <img src="/2018/12/14/前端-Html_Css常见问题解决/clearleft.jpg" alt=""></p>
</li>
<li><p>right：清除右侧元素浮动对当前元素的影响。</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.box3&#123;</span><br><span class="line">    width: 300px;</span><br><span class="line">    height: 300px;</span><br><span class="line">    background-color: skyblue;</span><br><span class="line"></span><br><span class="line">    clear: right;</span><br><span class="line">&#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure>
<p>  <img src="/2018/12/14/前端-Html_Css常见问题解决/clearright.jpg" alt=""></p>
</li>
<li><p>both：清除左侧和右侧元素浮动对当前元素的影响。就是清除最大影响。</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.box3&#123;</span><br><span class="line">    width: 300px;</span><br><span class="line">    height: 300px;</span><br><span class="line">    background-color: skyblue;</span><br><span class="line"></span><br><span class="line">    clear: both;</span><br><span class="line">&#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure>
<p>  <img src="/2018/12/14/前端-Html_Css常见问题解决/clearright.jpg" alt=""></p>
</li>
</ul>
<hr>
<h2 id="父子元素外边距重叠"><a href="#父子元素外边距重叠" class="headerlink" title="父子元素外边距重叠"></a>父子元素外边距重叠</h2><h5 id="代码、截图如下：-2"><a href="#代码、截图如下：-2" class="headerlink" title="代码、截图如下："></a>代码、截图如下：</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box1&#123;</span></span><br><span class="line"><span class="undefined">                height: 200px;</span></span><br><span class="line"><span class="undefined">                width: 200px;</span></span><br><span class="line"><span class="undefined">                background-color: greenyellow;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            .box2&#123;</span></span><br><span class="line"><span class="undefined">                margin-top: 100px;</span></span><br><span class="line"><span class="undefined">                height: 100px;</span></span><br><span class="line"><span class="undefined">                width: 100px;</span></span><br><span class="line"><span class="undefined">                background-color: yellow;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>外边距重叠示意图：<br><img src="/2018/12/14/前端-Html_Css常见问题解决/外边距重叠.jpg" alt=""></p>
<p>正常示意图：</p>
<h5 id="问题描述-1"><a href="#问题描述-1" class="headerlink" title="问题描述"></a>问题描述</h5><p>当div（box2）设置上外边距的时候，与父容器div（box1）的外边距重叠了。</p>
<h5 id="原理及解决方法"><a href="#原理及解决方法" class="headerlink" title="原理及解决方法"></a>原理及解决方法</h5><p>父子容器相邻的垂直外边距会发生重叠，子元素的外边距会传递给父元素。</p>
<p>和上一个高度塌陷问题一样，可以同样使用一个额外的结构或者CSS方式来解决父子容器边距重合问题。</p>
<p>最简单的就是使用CSS的方法，通过before伪类，向元素前添加一个空白的块元素将父子元素之间隔开，这样子元素就不能将外边距传递给父元素了。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.clearfix:before&#123;</span><br><span class="line">    /* 添加一个空的内容 */</span><br><span class="line">    content: "";</span><br><span class="line">    /* 转换为一个块元素 */</span><br><span class="line">    display: table;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将类给父元素就行了。</p>
<hr>
<h3 id="背景闪烁问题"><a href="#背景闪烁问题" class="headerlink" title="背景闪烁问题"></a>背景闪烁问题</h3><p>关键：图片整合技术 CSS-Sprite，也称雪碧图。</p>
<p>网页资源在加载外部资源的时候并不是同时加载的，浏览器会在资源被使用时才去加载资源，由于加载图片需要一定的时间，所以在加载和显示的过程中会有一段时间背景图片无法显示，导致闪烁问题。</p>
<p>比如，使用超链接来设置按钮时，如果将link、hover、active的背景图片加载不同的外部资源时，由于新的外部资源要重新加载，会导致闪烁问题。</p>
<p>为了解决该问题，可以将三个图片整合为一张图片，这样可以同时将三张图片一起加载（因为合成之后已经是一张图片了，只用加载一次），就不会出现闪烁问题，然后通过background-position设置背景图片的偏移量来切换要显示的图片的位置，这种技术叫图片整合技术（CSS-Sprite）。</p>
<p>优点：</p>
<ol>
<li>将多个图片整合为一张图片，浏览器只需要发送一次请求就可以加载多个图片，提高访问效率，提高用户体验。</li>
<li>将多个图片整合为一张图片，减小图片的总大小，提高请求的速度，提高用户体验。</li>
</ol>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/12/14/前端-Html_Css常见问题解决/" data-id="cjptr8u91002368utvwlcv4x3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Html-Css/">Html_Css</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-《第一行代码-Android》第12章_最佳的UI体验" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/" class="article-date">
  <time datetime="2018-12-11T02:59:15.000Z" itemprop="datePublished">2018-12-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/">《第一行代码_Android》第12章_最佳的UI体验</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>此博客使用教材为《第一行代码 Android》第2版。</p>
<h1 id="第12章-最佳的UI体验——Material-Design实战"><a href="#第12章-最佳的UI体验——Material-Design实战" class="headerlink" title="第12章 最佳的UI体验——Material Design实战"></a>第12章 最佳的UI体验——Material Design实战</h1><p>目录：</p>
<ul>
<li>ActionBar的代替——Toolbar</li>
<li>滑动菜单——DrawerLayout控件</li>
<li>布局优化——NavigationView</li>
<li>悬浮按钮——FloatingActionButton控件</li>
<li>交互式提醒——Snackbar控件</li>
<li>加强版的FrameLayout——CoordinatorLayout</li>
</ul>
<hr>
<h3 id="ActionBar的代替——Toolbar"><a href="#ActionBar的代替——Toolbar" class="headerlink" title="ActionBar的代替——Toolbar"></a>ActionBar的代替——Toolbar</h3><p>ActionBar就是标题栏，使用Toolbar来代替ActionBar的话，就需要设置ActionBar为空。</p>
<p>styles.xml:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Base application theme. --&gt;</span><br><span class="line">    &lt;style name=<span class="string">"AppTheme"</span> parent=<span class="string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;</span><br><span class="line">        &lt;!-- Customize your theme here. --&gt;</span><br><span class="line">        &lt;item name="colorPrimary"&gt;@color/colorPrimary&lt;/item&gt;</span><br><span class="line">        &lt;item name="colorPrimaryDark"&gt;@color/colorPrimaryDark&lt;/item&gt;</span><br><span class="line">        &lt;item name="colorAccent"&gt;@color/colorAccent&lt;/item&gt;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p>
<p>activity_main.xml:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line">&lt;FrameLayout</span><br><span class="line">    xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    xmlns:app=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span><br><span class="line">    xmlns:tools=<span class="string">"http://schemas.android.com/tools"</span></span><br><span class="line">    android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">    android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">    tools:context=<span class="string">".MainActivity"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.v7.widget.Toolbar</span><br><span class="line">        android:id=<span class="string">"@+id/toolbar"</span></span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"?attr/actionBarSize"</span></span><br><span class="line">        android:background=<span class="string">"?attr/colorPrimary"</span></span><br><span class="line">        android:theme=<span class="string">"@style/ThemeOverlay.AppCompat.Dark.ActionBar"</span></span><br><span class="line">        app:popupTheme=<span class="string">"@style/ThemeOverlay.AppCompat.Light"</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/FrameLayout&gt;</span><br></pre></td></tr></table></figure></p>
<p>在res目录下新建“menu”菜单，然后在里面新建toolbar.xml资源文件，用来添加菜单选项。showAsAction属性always表示永远显示在Toolbar中，如果屏幕空间不够则不显示；ifRoom表示屏幕空间足够的情况下显示在Toolbar中，不够就显示在菜单中；never表示永远显示在菜单中。</p>
<p>然后，item中有一个icon属性和title属性，Toolbar中的只显示图标，菜单中只显示文字，最好两个都写上：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line">&lt;menu xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    xmlns:app=<span class="string">"http://schemas.android.com/apk/res-auto"</span>&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:title=<span class="string">"Backup"</span></span><br><span class="line">        android:id=<span class="string">"@+id/backup"</span></span><br><span class="line">        android:icon=<span class="string">"@drawable/backup"</span></span><br><span class="line">        app:showAsAction=<span class="string">"always"</span>/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;item</span><br><span class="line">        android:title=<span class="string">"Delete"</span></span><br><span class="line">        android:id=<span class="string">"@+id/delete"</span></span><br><span class="line">        android:icon=<span class="string">"@drawable/delete"</span></span><br><span class="line">        app:showAsAction=<span class="string">"ifRoom"</span>/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;item</span><br><span class="line">        android:title=<span class="string">"Settings"</span></span><br><span class="line">        android:id=<span class="string">"@+id/settings"</span></span><br><span class="line">        android:icon=<span class="string">"@drawable/backup"</span></span><br><span class="line">        app:showAsAction=<span class="string">"never"</span>/&gt;</span><br><span class="line">&lt;/menu&gt;</span><br></pre></td></tr></table></figure>
<p>在MainActivity中加载Toolbar控件和菜单，并设置菜单的点击事件：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.me.drawerlayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.widget.Toolbar;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);     <span class="comment">// 加载toolbar</span></span><br><span class="line">        setSupportActionBar(toolbar);       <span class="comment">// 将Toolbar实例传入</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreatePanelMenu</span><span class="params">(<span class="keyword">int</span> featureId, Menu menu)</span> </span>&#123;</span><br><span class="line">        getMenuInflater().inflate(R.menu.toolbar, menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (item.getItemId())&#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.backup:</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">"You Clicked Backup"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.delete:</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">"You Clicked Delete"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.settings:</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">"You Clicked Settings"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="滑动菜单-DrawerLayout"><a href="#滑动菜单-DrawerLayout" class="headerlink" title="滑动菜单 DrawerLayout"></a>滑动菜单 DrawerLayout</h3><p>滑动菜单，可以在屏幕侧边往中间滑动就能拉出滑动菜单，但是官方建议添加一个导航按钮（HomeAsUp按钮），来告知用户有导航按钮，并弹出。</p>
<p>此处结合Toolbar，一起来写，也可以不用。在滑动菜单的最外层布局一定要加android:layout_gravity，用来控制滑动菜单在屏幕的左面还是右面，left表示左面，right表示右面，start根据系统语言判断在左面还是右面：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">"?attr/colorPrimary"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:theme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Dark.ActionBar"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:popupTheme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Light"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 左边弹出布局区，可以将布局全部写里面，也可以include一个布局 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">"start"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"This is menu"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"30sp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">"#FFF"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>MainActivity.java:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.me.drawerlayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.support.v4.view.GravityCompat;</span><br><span class="line"><span class="keyword">import</span> android.support.v4.widget.DrawerLayout;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.ActionBar;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.widget.Toolbar;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DrawerLayout mDrawerLayout;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);</span><br><span class="line">        setSupportActionBar(toolbar);</span><br><span class="line">        mDrawerLayout = (DrawerLayout) findViewById(R.id.drawer_layout);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取actionBar对象，就是自定义的toolbar</span></span><br><span class="line">        ActionBar actionBar = getSupportActionBar();</span><br><span class="line">        <span class="comment">// 如果actionBar对象不为空，在toolbar最左侧加入一个导航（HomeAsUp按钮），并设置图标，HomeAsUp按钮的id永远都是android.R.id.home。</span></span><br><span class="line">        <span class="keyword">if</span> (actionBar != <span class="keyword">null</span>)&#123;</span><br><span class="line">            actionBar.setDisplayHomeAsUpEnabled(<span class="keyword">true</span>);</span><br><span class="line">            <span class="comment">// 图表默认是返回箭头</span></span><br><span class="line">            actionBar.setHomeAsUpIndicator(R.drawable.menu);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreatePanelMenu</span><span class="params">(<span class="keyword">int</span> featureId, Menu menu)</span> </span>&#123;</span><br><span class="line">        getMenuInflater().inflate(R.menu.toolbar, menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (item.getItemId())&#123;</span><br><span class="line">            <span class="keyword">case</span> android.R.id.home:</span><br><span class="line">                mDrawerLayout.openDrawer(GravityCompat.START);</span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                 * 关闭滑动界面</span></span><br><span class="line"><span class="comment">                 * mDrawerLayout.closeDrawers();</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.backup:</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">"You Clicked Backup"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.delete:</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">"You Clicked Delete"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.settings:</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">"You Clicked Settings"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/drawerLayout.JPG" alt=""></p>
<hr>
<h3 id="NavigationView"><a href="#NavigationView" class="headerlink" title="NavigationView"></a>NavigationView</h3><p>当前的滑动菜单界面还是比较丑的，Google提供的NavigationView控件可以美化滑动菜单页面。</p>
<p>添加第三方框架<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">implementation 'com.android.support:design:28.0.0'</span><br><span class="line">// 实现图片圆形化的第三方框架</span><br><span class="line">implementation 'de.hdodenhof:circleimageview:2.2.0'</span><br></pre></td></tr></table></figure></p>
<p>添加菜单nav_menu.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span> <span class="attr">android:checkableBehavior</span>=<span class="string">"single"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/nav_profile"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:icon</span>=<span class="string">"@drawable/head"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">"Profile"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/nav_location"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:icon</span>=<span class="string">"@drawable/location"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">"Location"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/nav_settings"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:icon</span>=<span class="string">"@drawable/settings"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">"Settings"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>添加头部文件nav_header.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"180dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:padding</span>=<span class="string">"10dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"?attr/colorPrimary"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">de.hdodenhof.circleimageview.CircleImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/icon_image"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"70dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"70dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">"@drawable/mine"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerInParent</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/mail"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"1172949809@qq.com"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"14sp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"#fff"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/username"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_above</span>=<span class="string">"@id/mail"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Ai Junhao"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"#fff"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"14sp"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>在activity_main.xml文件中添加navigationView控件，控件有连个app属性，一个是menu，添加菜单文件，一个是headerLayout，添加头部文件：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 左边弹出布局区，可以将布局全部写里面，也可以include一个布局 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.NavigationView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/nav_view"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">"start"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:menu</span>=<span class="string">"@menu/nav_menu"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:headerLayout</span>=<span class="string">"@layout/nav_header"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>在MainActivity.java中加载控件并添加点击事件，头布局和memu布局的点击事件设置方式不同：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DrawerLayout mDrawerLayout;</span><br><span class="line">    <span class="keyword">private</span> Toolbar toolbar;</span><br><span class="line">    <span class="keyword">private</span> NavigationView navView;</span><br><span class="line">    <span class="keyword">private</span> View headerView;</span><br><span class="line">    <span class="keyword">private</span> TextView userName;</span><br><span class="line">    <span class="keyword">private</span> TextView email;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line">        navView = (NavigationView) findViewById(R.id.nav_view);</span><br><span class="line">        <span class="comment">// 获取头布局</span></span><br><span class="line">        headerView = navView.getHeaderView(<span class="number">0</span>);</span><br><span class="line">        iconImage = (ImageView) headerView.findViewById(R.id.icon_image);</span><br><span class="line">        userName = (TextView) headerView.findViewById(R.id.username);</span><br><span class="line">        email = (TextView) headerView.findViewById(R.id.mail);</span><br><span class="line"></span><br><span class="line">        iconImage.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"点击了头像"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        userName.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"点击了用户名"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        email.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"点击了邮箱"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置navView的默认选中项，可以不设置</span></span><br><span class="line">        navView.setCheckedItem(R.id.nav_profile);</span><br><span class="line">        navView.setNavigationItemSelectedListener(<span class="keyword">new</span> NavigationView.OnNavigationItemSelectedListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onNavigationItemSelected</span><span class="params">(@NonNull MenuItem menuItem)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">switch</span> (menuItem.getItemId())&#123;</span><br><span class="line">                    <span class="keyword">case</span> R.id.nav_profile:</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"点击了profile"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> R.id.nav_location:</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"点击了location"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> R.id.nav_settings:</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"点击了settings"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                mDrawerLayout.closeDrawers();</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/navigationView.JPG" alt=""></p>
<hr>
<h3 id="悬浮按钮-FloatingActionButton控件"><a href="#悬浮按钮-FloatingActionButton控件" class="headerlink" title="悬浮按钮 FloatingActionButton控件"></a>悬浮按钮 FloatingActionButton控件</h3><p>activity_main.xml中添加FloatingActionButton控件，app:backgroundTint设置背景色，app:rippleColor点击时的背景色，app:elevation悬浮高度，决定阴影的大小:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.design.widget.FloatingActionButton</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/fab"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_gravity</span>=<span class="string">"bottom|end"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_margin</span>=<span class="string">"16dp"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:src</span>=<span class="string">"@drawable/done"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:backgroundTint</span>=<span class="string">"@null"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:rippleColor</span>=<span class="string">"#00ff00"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:elevation</span>=<span class="string">"8dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>在MainActivity.java文件中添加入点击事件即可。</p>
<p><img src="/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/FloatingActionButton.JPG" alt=""></p>
<hr>
<h3 id="交互式提醒-Snackbar控件"><a href="#交互式提醒-Snackbar控件" class="headerlink" title="交互式提醒 Snackbar控件"></a>交互式提醒 Snackbar控件</h3><p>Snackbar是比Toast更先进的提示工具。但是Snackbar并不是Toast的替代品，两者之间有不同的使用场景。Toast告知用户现在发生了什么，Snackbar在告知的同时在提示中加入一个可交互的按钮，当用户点击按钮的时候可以执行一些额外的操作。</p>
<p>MainActivity.java:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fab.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        Snackbar.make(v, <span class="string">"Data deleted"</span>, Snackbar.LENGTH_LONG).setAction(<span class="string">"Undo"</span>, <span class="keyword">new</span> View.OnClickListener()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"Data restored"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/snackbar.JPG" alt=""></p>
<hr>
<h3 id="加强版的FrameLayout——CoordinatorLayout"><a href="#加强版的FrameLayout——CoordinatorLayout" class="headerlink" title="加强版的FrameLayout——CoordinatorLayout"></a>加强版的FrameLayout——CoordinatorLayout</h3><p>在普通情况下，CoordinatorLayout的作用与FrameLayout基本一致，不同的是，CoordinatorLayout可以监听器所有子控件的各种事件，然后自动帮助我们做出最为合理的响应。如，当Snackbar提示将悬浮按钮FloatingActionButton遮挡住了，而如果我们能让CoordinatorLayout监听到Snackbar的弹出事件，那么它会自动将内部的FloatingActionButton向上偏移，从而确保不会被Snackbar遮挡到。</p>
<p>activity_main.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.CoordinatorLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">......</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.design.widget.FloatingActionButton</span></span></span><br><span class="line"><span class="tag">            <span class="attr">......</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.design.widget.CoordinatorLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>如此即可。</p>
<hr>
<h3 id="卡片式布局"><a href="#卡片式布局" class="headerlink" title="卡片式布局"></a>卡片式布局</h3><p>添加库文件：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">implementation 'com.android.support:recyclerview-v7:28.0.0'</span><br><span class="line">implementation 'com.android.support:cardview-v7:28.0.0'</span><br><span class="line">// 图片加载库</span><br><span class="line">implementation 'com.github.bumptech.glide:glide:4.8.0'</span><br></pre></td></tr></table></figure></p>
<p>添加滚动组件，activity_main.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.CoordinatorLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/recycler_view"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.design.widget.CoordinatorLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>实体类Fruit:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> imageId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Fruit</span><span class="params">(String name, <span class="keyword">int</span> imageId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.imageId = imageId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getImageId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> imageId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setImageId</span><span class="params">(<span class="keyword">int</span> imageId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.imageId = imageId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>RecyclerView的自定义布局fruit_item:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v7.widget.CardView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">"5dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:cardCornerRadius</span>=<span class="string">"4dp"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/fruit_image"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"100dp"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/fruit_name"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_gravity</span>=<span class="string">"center_horizontal"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_margin</span>=<span class="string">"5dp"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">"16sp"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v7.widget.CardView</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>适配器FruitAdapter:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FruitAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">FruitAdapter</span>.<span class="title">ViewHolder</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context mComtext;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Fruit&gt; mFruitList;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FruitAdapter</span><span class="params">(List&lt;Fruit&gt; fruitList)</span></span>&#123;</span><br><span class="line">        mFruitList = fruitList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup viewGroup, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mComtext == <span class="keyword">null</span>)&#123;</span><br><span class="line">            mComtext = viewGroup.getContext();</span><br><span class="line">        &#125;</span><br><span class="line">        View view = LayoutInflater.from(mComtext).inflate(R.layout.fruit_item, viewGroup, <span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ViewHolder(view);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(ViewHolder viewHolder, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        Fruit fruit = mFruitList.get(i);</span><br><span class="line">        viewHolder.fruitName.setText(fruit.getName());</span><br><span class="line">        Glide.with(mComtext).load(fruit.getImageId()).into(viewHolder.fruitImage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mFruitList.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span></span>&#123;</span><br><span class="line">        CardView cardView;</span><br><span class="line">        ImageView fruitImage;</span><br><span class="line">        TextView fruitName;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ViewHolder</span><span class="params">(View itemView)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(itemView);</span><br><span class="line">            cardView = (CardView) itemView;</span><br><span class="line">            fruitImage = (ImageView) itemView.findViewById(R.id.fruit_image);</span><br><span class="line">            fruitName = (TextView) itemView.findViewById(R.id.fruit_name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>MainActivity.java:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Fruit[] fruits = &#123;<span class="keyword">new</span> Fruit(<span class="string">"Apple"</span>, R.drawable.apple),</span><br><span class="line">            <span class="keyword">new</span> Fruit(<span class="string">"Orange"</span>, R.drawable.orange),</span><br><span class="line">            <span class="keyword">new</span> Fruit(<span class="string">"Pear"</span>, R.drawable.pear),</span><br><span class="line">            <span class="keyword">new</span> Fruit(<span class="string">"Pineapple"</span>, R.drawable.pineapple),</span><br><span class="line">            <span class="keyword">new</span> Fruit(<span class="string">"Cheery"</span>, R.drawable.cheery)&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Fruit&gt; fruitList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> FruitAdapter adapter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line"></span><br><span class="line">        initFruits();</span><br><span class="line">        RecyclerView recyclerView = (RecyclerView) findViewById(R.id.recycler_view);</span><br><span class="line">        GridLayoutManager layoutManager = <span class="keyword">new</span> GridLayoutManager(<span class="keyword">this</span>, <span class="number">2</span>);</span><br><span class="line">        recyclerView.setLayoutManager(layoutManager);</span><br><span class="line">        adapter = <span class="keyword">new</span> FruitAdapter(fruitList);</span><br><span class="line">        recyclerView.setAdapter(adapter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initFruits</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        fruitList.clear();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">50</span>; i++)&#123;</span><br><span class="line">            Random random = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">int</span> index = random.nextInt(fruits.length);</span><br><span class="line">            fruitList.add(fruits[index]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如此，滚动组件和卡片式布局已经实现了，但是还是有一些小的不足，toolbar部分被遮盖了：</p>
<p><img src="/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/cardview.JPG" alt=""></p>
<hr>
<h3 id="AppBarLayout解决混动事件中的控件遮挡"><a href="#AppBarLayout解决混动事件中的控件遮挡" class="headerlink" title="AppBarLayout解决混动事件中的控件遮挡"></a>AppBarLayout解决混动事件中的控件遮挡</h3><p>AppBarLayout实际上是一个垂直方向上的LinearLayout，它在内部做了很多滚动事件的封装。</p>
<p>在Toolbar放置在AppBarLayout里面，然后在RecyclerView中使用app:layout_behavior属性指定了一个布局行为。AppBarLayout内部的子控件其实就可以指定如何去影响这些事件的，通过app:layout_scrollFlags属性就能实现。scoll表示当RecyclerVView向上混动的时候，Toolbar会跟着一起向上滚动实现隐蔽；enterAlways表示当RecyclerView向下滚动的时候，Toolbar一起向下滚动并重新显示；snap表示当Toolbar还没有完全隐蔽或者显示的时候，会根据当前滚动的距离自动是隐藏还是显示。activity_main.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.CoordinatorLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.design.widget.AppBarLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"?attr/colorPrimary"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:theme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Dark.ActionBar"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:popupTheme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Light"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|enterAlways|snap"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">android.support.design.widget.AppBarLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/recycler_view"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_behavior</span>=<span class="string">"@string/appbar_scrolling_view_behavior"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.design.widget.CoordinatorLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="下拉刷新"><a href="#下拉刷新" class="headerlink" title="下拉刷新"></a>下拉刷新</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.CoordinatorLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.v4.widget.SwipeRefreshLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/swip_refresh"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_behavior</span>=<span class="string">"@string/appbar_scrolling_view_behavior"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">"@+id/recycler_view"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">android.support.v4.widget.SwipeRefreshLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.design.widget.CoordinatorLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line">    <span class="keyword">private</span> SwipeRefreshLayout swipeRefreshLayout;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Fruit[] fruits = &#123;<span class="keyword">new</span> Fruit(<span class="string">"Apple"</span>, R.drawable.apple),</span><br><span class="line">            <span class="keyword">new</span> Fruit(<span class="string">"Orange"</span>, R.drawable.orange),</span><br><span class="line">            <span class="keyword">new</span> Fruit(<span class="string">"Pear"</span>, R.drawable.pear),</span><br><span class="line">            <span class="keyword">new</span> Fruit(<span class="string">"Pineapple"</span>, R.drawable.pineapple),</span><br><span class="line">            <span class="keyword">new</span> Fruit(<span class="string">"Cheery"</span>, R.drawable.cheery)&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Fruit&gt; fruitList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> FruitAdapter adapter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line">        swipeRefreshLayout = (SwipeRefreshLayout) findViewById(R.id.swip_refresh);</span><br><span class="line">        swipeRefreshLayout.setColorSchemeResources(R.color.colorPrimary);</span><br><span class="line">        swipeRefreshLayout.setOnRefreshListener(<span class="keyword">new</span> SwipeRefreshLayout.OnRefreshListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                refreshFruits();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        ......</span><br><span class="line"></span><br><span class="line">        initFruits();</span><br><span class="line">        RecyclerView recyclerView = (RecyclerView) findViewById(R.id.recycler_view);</span><br><span class="line">        GridLayoutManager layoutManager = <span class="keyword">new</span> GridLayoutManager(<span class="keyword">this</span>, <span class="number">2</span>);</span><br><span class="line">        recyclerView.setLayoutManager(layoutManager);</span><br><span class="line">        adapter = <span class="keyword">new</span> FruitAdapter(fruitList);</span><br><span class="line">        recyclerView.setAdapter(adapter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">refreshFruits</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                runOnUiThread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        initFruits();</span><br><span class="line">                        adapter.notifyDataSetChanged();</span><br><span class="line">                        swipeRefreshLayout.setRefreshing(<span class="keyword">false</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initFruits</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        fruitList.clear();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">50</span>; i++)&#123;</span><br><span class="line">            Random random = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">int</span> index = random.nextInt(fruits.length);</span><br><span class="line">            fruitList.add(fruits[index]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/" data-id="cjptr8u8i001o68utscrcxln3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-《Android开发艺术探索》第1章_Activity的生命周期和启动模式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/04/《Android开发艺术探索》第1章_Activity的生命周期和启动模式/" class="article-date">
  <time datetime="2018-12-04T10:45:15.000Z" itemprop="datePublished">2018-12-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/04/《Android开发艺术探索》第1章_Activity的生命周期和启动模式/">《Android开发艺术探索》第1章_Activity的生命周期和启动模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/12/04/《Android开发艺术探索》第1章_Activity的生命周期和启动模式/" data-id="cjptr8u87001g68utpgzn9mhe" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android技术——LBS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/12/Android技术——LBS/" class="article-date">
  <time datetime="2018-11-12T10:30:28.000Z" itemprop="datePublished">2018-11-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/12/Android技术——LBS/">Android特色开发—LBS(基于位置的服务)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>目录</p>
<ul>
<li><p>基于位置的服务简介</p>
</li>
<li><p>申请百度开发者账号及获取API Key和SDK</p>
</li>
<li><p>Android Studio中配置SDK</p>
</li>
<li><p>获取位置信息</p>
<ol>
<li>获取经纬度</li>
<li>获取地址</li>
<li>获取位置描述</li>
<li>获取周边的POI</li>
<li>获取室内定位</li>
</ol>
</li>
<li><p>地图</p>
<ol>
<li>显示基础地图</li>
</ol>
</li>
</ul>
<hr>
<h3 id="基于位置的服务简介"><a href="#基于位置的服务简介" class="headerlink" title="基于位置的服务简介"></a>基于位置的服务简介</h3><p>基于位置的服务围绕的核心就是要先确定用户所在的位置。</p>
<p>通常有两种技术方式：</p>
<ol>
<li><p>一种是通过GPS定位：GPS定位的工作原理是基于手机内置的GPS硬件直接和卫星交互来获取当前的经纬度信息。</p>
<ul>
<li>优点：定位精确度非常高。</li>
<li>缺点：只能在室外使用，室内基本无法收到卫星信号。</li>
</ul>
</li>
<li><p>一种是通过网络定位：网络定位的工作原理是根据手机当前网络附近的三个基站进行测速，以此确定出一个大概的位置。</p>
<ul>
<li>优点：在室内室外都能使用。</li>
<li>缺点：定位精确度不高。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="申请百度开发者账号及获取API-Key和SDK"><a href="#申请百度开发者账号及获取API-Key和SDK" class="headerlink" title="申请百度开发者账号及获取API Key和SDK"></a>申请百度开发者账号及获取API Key和SDK</h3><p>此节我们使用的是第三方公司的SDK，国内在此领域做得比较好的一个是百度，一个是高德。</p>
<p>这里我们采用百度的LBS。</p>
<ol>
<li><p>首先申请百度账号。不解释。</p>
</li>
<li><p>申请成为一名百度开发者。</p>
<p> 打开网址：<a href="http://developer.baidu.com/user/info" target="_blank" rel="noopener">http://developer.baidu.com/user/info</a><br> 如下图填写个人信息，填写带‘*’号的即可：<br> <img src="/2018/11/12/Android技术——LBS/百度开发者.png" alt=""></p>
</li>
<li><p>进入百度地图开放平台  </p>
<p> 网址：<a href="http://lbsyun.baidu.com/apiconsole/key" target="_blank" rel="noopener">http://lbsyun.baidu.com/apiconsole/key</a><br> 刚注册的账号的应用列表是空的，这里我已经使用过这个平台，应有列表有我的项目信息。<br> <img src="/2018/11/12/Android技术——LBS/百度地图开放平台.png" alt=""></p>
</li>
<li><p>点击创建应用</p>
<p> 如下图所示，应用名称自定义，应用类型自定义(这里我们使用Android SDK，给Android设备使用的)，启用服务默认即可。<br> <img src="/2018/11/12/Android技术——LBS/创建应用.png" alt=""></p>
<p> 开发版SHA1：是在Android Studio项目中的，打开Android Studio，点击右侧的“Gradle”，点击“:app/Tasks/android/signingReport”，在下面会弹出一些信息，找到里面的SHA1复制即可。<br> <img src="/2018/11/12/Android技术——LBS/SHA1.png" alt=""></p>
<p> 包名：就是Android Studio中SHA1对应项目的包名。</p>
</li>
<li><p>点击“提交”按钮</p>
<p> 此时，在应用列表中就有我们创建出来的项目了，其中“访问位置（AK）”就是API Key。</p>
</li>
<li><p>获取SDK</p>
<p> 网址：<a href="http://lbsyun.baidu.com/index.php?title=sdk/download&amp;action#selected=mapsdk_basicmap,mapsdk_searchfunction,mapsdk_lbscloudsearch,mapsdk_calculationtool,mapsdk_radar" target="_blank" rel="noopener">http://lbsyun.baidu.com/index.php?title=sdk/download&amp;action#selected=mapsdk_basicmap,mapsdk_searchfunction,mapsdk_lbscloudsearch,mapsdk_calculationtool,mapsdk_radar</a></p>
<p> 百度地图开放平台首页中也可以进入下载SDK页面：<a href="http://lbsyun.baidu.com/index.php?title=首页" target="_blank" rel="noopener">http://lbsyun.baidu.com/index.php?title=首页</a></p>
<p> 根据需求选择，然后下载sdk。<br> <img src="/2018/11/12/Android技术——LBS/SDK.PNG" alt=""></p>
<p> 那个“BaiduLBS_AndroidSDK_Lib.zip”就是我们需要的LBS的SDK。</p>
</li>
</ol>
<h3 id="Android-Studio中配置SDK"><a href="#Android-Studio中配置SDK" class="headerlink" title="Android Studio中配置SDK"></a>Android Studio中配置SDK</h3><p>官方推荐的配置方法：<a href="http://lbsyun.baidu.com/index.php?title=androidsdk/guide/create-project/androidstudio" target="_blank" rel="noopener">http://lbsyun.baidu.com/index.php?title=androidsdk/guide/create-project/androidstudio</a></p>
<p>这里进行更详细的介绍：</p>
<ol>
<li><p>解压</p>
<p> 将我们下载好的SDK文件“BaiduLBS_AndroidSDK_Lib.zip”解压。</p>
<p> <img src="/2018/11/12/Android技术——LBS/解压.PNG" alt=""></p>
<p> <img src="/2018/11/12/Android技术——LBS/解压2.PNG" alt=""></p>
<p> 在libs目录下有一个BaiduLBS_Android.jar包，这是给java层使用的，功能包内容如下：基础地图、室内地图、个性化地图、检索、云检索、计算工具、路线规划、定位等。 libs目录下其他的文件夹下有一些os文件，那是Native层使用的。</p>
</li>
<li><p>Android Studio中配置文件</p>
<p> 将BaiduLBS_Android.jar等jar包复制到项目额libs目录下，右键“Add As Library…”添加类库。 在src/main目录下新建一个jniLibs文件夹，将其他文件复制到里面。</p>
<p> <img src="/2018/11/12/Android技术——LBS/libs.PNG" alt=""></p>
</li>
<li><p>配置秘钥和服务</p>
</li>
</ol>
<p>AndroidManifest.xml中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">    <span class="attr">...</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"com.baidu.lbsapi.API_KEY"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:value</span>=<span class="string">"密匙"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">service</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"com.baidu.location.f"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:enabled</span>=<span class="string">"true"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:process</span>=<span class="string">":remote"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="获取位置信息"><a href="#获取位置信息" class="headerlink" title="获取位置信息"></a>获取位置信息</h3><p><img src="/2018/11/12/Android技术——LBS/LBS.jpg" alt=""></p>
<h4 id="官方权限说明"><a href="#官方权限说明" class="headerlink" title="官方权限说明"></a>官方权限说明</h4><p>部分危险权限需要运行时权限。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 这个权限用于进行网络定位--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_COARSE_LOCATION"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 这个权限用于访问GPS定位--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_FINE_LOCATION"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 用于访问wifi网络信息，wifi信息会用于进行网络定位--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_WIFI_STATE"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 获取运营商信息，用于支持提供运营商信息相关的接口--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 这个权限用于获取wifi的获取权限，wifi信息会用来进行网络定位--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.CHANGE_WIFI_STATE"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 用于读取手机当前的状态--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.READ_PHONE_STATE"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 写入扩展存储，向扩展卡写入数据，用于写入离线定位数据--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.WRITE_EXTERNAL_STORAGE"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 访问网络，网络定位需要上网--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- SD卡读取权限，用户写入离线定位数据--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.MOUNT_UNMOUNT_FILESYSTEMS"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h4><p>页面布局xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".LBSTest.MapActivity"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/tv_position"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"位置"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="获取经纬度"><a href="#获取经纬度" class="headerlink" title="获取经纬度"></a>获取经纬度</h4><p>配置定位SDK参数有如下一些可选参数：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">LocationClientOption option = <span class="keyword">new</span> LocationClientOption();</span><br><span class="line"></span><br><span class="line">option.setLocationMode(LocationMode.Hight_Accuracy);</span><br><span class="line"><span class="comment">//可选，设置定位模式，默认高精度</span></span><br><span class="line"><span class="comment">//LocationMode.Hight_Accuracy：高精度，优先使用GPS，其次网络；</span></span><br><span class="line"><span class="comment">//LocationMode. Battery_Saving：低功耗，仅使用网络；</span></span><br><span class="line"><span class="comment">//LocationMode. Device_Sensors：仅使用设备，GPS；</span></span><br><span class="line">	</span><br><span class="line">option.setCoorType(<span class="string">"bd09ll"</span>);</span><br><span class="line"><span class="comment">//可选，设置返回经纬度坐标类型，默认GCJ02</span></span><br><span class="line"><span class="comment">//GCJ02：国测局坐标；</span></span><br><span class="line"><span class="comment">//BD09ll：百度经纬度坐标；</span></span><br><span class="line"><span class="comment">//BD09：百度墨卡托坐标；</span></span><br><span class="line"><span class="comment">//海外地区定位，无需设置坐标类型，统一返回WGS84类型坐标</span></span><br><span class="line"> 	</span><br><span class="line">option.setScanSpan(<span class="number">1000</span>);</span><br><span class="line"><span class="comment">//可选，设置发起定位请求的间隔，int类型，单位ms</span></span><br><span class="line"><span class="comment">//如果设置为0，则代表单次定位，即仅定位一次，默认为0</span></span><br><span class="line"><span class="comment">//如果设置非0，需设置1000ms以上才有效</span></span><br><span class="line">	</span><br><span class="line">option.setOpenGps(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//可选，设置是否使用gps，默认false</span></span><br><span class="line"><span class="comment">//使用高精度和仅用设备两种定位模式的，参数必须设置为true</span></span><br><span class="line">	</span><br><span class="line">option.setLocationNotify(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//可选，设置是否当GPS有效时按照1S/1次频率输出GPS结果，默认false</span></span><br><span class="line">	</span><br><span class="line">option.setIgnoreKillProcess(<span class="keyword">false</span>);</span><br><span class="line"><span class="comment">//可选，定位SDK内部是一个service，并放到了独立进程。</span></span><br><span class="line"><span class="comment">//设置是否在stop的时候杀死这个进程，默认（建议）不杀死，即setIgnoreKillProcess(true)</span></span><br><span class="line">	</span><br><span class="line">option.SetIgnoreCacheException(<span class="keyword">false</span>);</span><br><span class="line"><span class="comment">//可选，设置是否收集Crash信息，默认收集，即参数为false</span></span><br><span class="line"></span><br><span class="line">option.setWifiCacheTimeOut(<span class="number">5</span>*<span class="number">60</span>*<span class="number">1000</span>);</span><br><span class="line"><span class="comment">//可选，V7.2版本新增能力</span></span><br><span class="line"><span class="comment">//如果设置了该接口，首次启动定位时，会先判断当前Wi-Fi是否超出有效期，若超出有效期，会先重新扫描Wi-Fi，然后定位</span></span><br><span class="line">	</span><br><span class="line">option.setEnableSimulateGps(<span class="keyword">false</span>);</span><br><span class="line"><span class="comment">//可选，设置是否需要过滤GPS仿真结果，默认需要，即参数为false</span></span><br><span class="line">	</span><br><span class="line">mLocationClient.setLocOption(option);</span><br><span class="line"><span class="comment">//mLocationClient为第二步初始化过的LocationClient对象</span></span><br><span class="line"><span class="comment">//需将配置好的LocationClientOption对象，通过setLocOption方法传递给LocationClient对象使用</span></span><br><span class="line"><span class="comment">//更多LocationClientOption的配置，请参照类参考中LocationClientOption类的详细说明</span></span><br></pre></td></tr></table></figure></p>
<p>注意，此处需要一些危险权限，需要动态申请。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.aijunhao.myproject.LBSTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.Manifest;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.pm.PackageManager;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.annotation.NonNull;</span><br><span class="line"><span class="keyword">import</span> android.support.v4.app.ActivityCompat;</span><br><span class="line"><span class="keyword">import</span> android.support.v4.content.ContextCompat;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baidu.location.BDAbstractLocationListener;</span><br><span class="line"><span class="keyword">import</span> com.baidu.location.BDLocation;</span><br><span class="line"><span class="keyword">import</span> com.baidu.location.BDLocationListener;</span><br><span class="line"><span class="keyword">import</span> com.baidu.location.LocationClient;</span><br><span class="line"><span class="keyword">import</span> com.baidu.location.LocationClientOption;</span><br><span class="line"><span class="keyword">import</span> com.baidu.mapapi.map.BaiduMap;</span><br><span class="line"><span class="keyword">import</span> com.example.aijunhao.myproject.MainActivity;</span><br><span class="line"><span class="keyword">import</span> com.example.aijunhao.myproject.R;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> butterknife.BindView;</span><br><span class="line"><span class="keyword">import</span> butterknife.ButterKnife;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BindView</span>(R.id.tv_position)</span><br><span class="line">    TextView tvPosition;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LocationClient mLocationClient;</span><br><span class="line">    <span class="keyword">private</span> LocationClientOption  option;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所有权限数组</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String[] permissions = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">            Manifest.permission.ACCESS_FINE_LOCATION,</span><br><span class="line">            Manifest.permission.READ_PHONE_STATE,</span><br><span class="line">            Manifest.permission.WRITE_EXTERNAL_STORAGE</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 需要申请权限的列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;String&gt; permissionList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        setContentView(R.layout.activity_map);</span><br><span class="line">        ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;permissions.length; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (ContextCompat.checkSelfPermission(MapActivity.<span class="keyword">this</span>, permissions[i]) != PackageManager.PERMISSION_GRANTED)&#123;</span><br><span class="line">                permissionList.add(permissions[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!permissionList.isEmpty())&#123;</span><br><span class="line">            String [] array = permissionList.toArray(<span class="keyword">new</span> String[permissionList.size()]);</span><br><span class="line">            ActivityCompat.requestPermissions(MapActivity.<span class="keyword">this</span>, array, <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            requestLocation();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">requestLocation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mLocationClient = <span class="keyword">new</span> LocationClient(getApplicationContext());</span><br><span class="line">        mLocationClient.registerLocationListener(<span class="keyword">new</span> MyLocationClickListener());</span><br><span class="line">        initLocationOption();</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 将配置好的LocationClientOption对象传递给LocationClient对象</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        mLocationClient.setLocOption(locationOption);</span><br><span class="line">        mLocationClient.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initLocationOption</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 配置定位SDK参数</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        option = <span class="keyword">new</span> LocationClientOption();</span><br><span class="line">        option.setLocationMode(LocationClientOption.LocationMode.Hight_Accuracy);</span><br><span class="line">        option.setScanSpan(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRequestPermissionsResult</span><span class="params">(<span class="keyword">int</span> requestCode, @NonNull String[] permissions, @NonNull <span class="keyword">int</span>[] grantResults)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (requestCode)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> (grantResults.length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> result : grantResults)&#123;</span><br><span class="line">                        <span class="keyword">if</span> (result != PackageManager.PERMISSION_GRANTED)&#123;</span><br><span class="line">                            Toast.makeText(<span class="keyword">this</span>, <span class="string">"必须同意所有权限才是使用本程序"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                            finish();</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    requestLocation();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>, <span class="string">"发生未知错误"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                    finish();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocationClickListener</span> <span class="keyword">implements</span> <span class="title">BDLocationListener</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceiveLocation</span><span class="params">(BDLocation location)</span> </span>&#123;</span><br><span class="line">            StringBuilder currentPosition = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 获取经纬度</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">double</span> latitude = location.getLatitude();</span><br><span class="line">            <span class="keyword">double</span> longitude = location.getLongitude();</span><br><span class="line"></span><br><span class="line">            currentPosition.append(<span class="string">"维度："</span>).append(latitude).append(<span class="string">"\n"</span>);</span><br><span class="line">            currentPosition.append(<span class="string">"经度："</span>).append(longitude).append(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 获取定位方式</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            String mode = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (location.getLocType() == BDLocation.TypeGpsLocation)&#123;</span><br><span class="line">                mode = <span class="string">"GPS"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (location.getLocType() == BDLocation.TypeNetWorkLocation)&#123;</span><br><span class="line">                mode = <span class="string">"网络"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            currentPosition.append(<span class="string">"定位方式："</span>).append(mode).append(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">            tvPosition.setText(currentPosition);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="获取地址"><a href="#获取地址" class="headerlink" title="获取地址"></a>获取地址</h4><p>配置定位SDK参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">LocationClientOption option = <span class="keyword">new</span> LocationClientOption()；</span><br><span class="line"></span><br><span class="line">option.setIsNeedAddress(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//可选，是否需要地址信息，默认为不需要，即参数为false</span></span><br><span class="line"><span class="comment">//如果开发者需要获得当前点的地址信息，此处必须为true</span></span><br><span class="line"></span><br><span class="line">mLocationClient.setLocOption(option);</span><br><span class="line"><span class="comment">//mLocationClient为第二步初始化过的LocationClient对象</span></span><br><span class="line"><span class="comment">//需将配置好的LocationClientOption对象，通过setLocOption方法传递给LocationClient对象使用</span></span><br><span class="line"><span class="comment">//更多LocationClientOption的配置，请参照类参考中LocationClientOption类的详细说明</span></span><br></pre></td></tr></table></figure>
<p>获取地址只需要在BDLocationListener中获取即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocationClickListener</span> <span class="keyword">implements</span> <span class="title">BDLocationListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceiveLocation</span><span class="params">(BDLocation location)</span> </span>&#123;</span><br><span class="line">        StringBuilder currentPosition = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 获取地址</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String address = location.getAddrStr();     <span class="comment">// 包括了以下全部</span></span><br><span class="line">        String country = location.getCountry();</span><br><span class="line">        String province = location.getProvince();</span><br><span class="line">        String city = location.getCity();</span><br><span class="line">        String district = location.getDistrict();</span><br><span class="line">        String street = location.getStreet();</span><br><span class="line">        currentPosition.append(<span class="string">"详细地址："</span>).append(address).append(<span class="string">"\n"</span>);</span><br><span class="line">        currentPosition.append(<span class="string">"国家："</span>).append(country).append(<span class="string">"\n"</span>);</span><br><span class="line">        currentPosition.append(<span class="string">"省份："</span>).append(province).append(<span class="string">"\n"</span>);</span><br><span class="line">        currentPosition.append(<span class="string">"城市："</span>).append(city).append(<span class="string">"\n"</span>);</span><br><span class="line">        currentPosition.append(<span class="string">"区县："</span>).append(district).append(<span class="string">"\n"</span>);</span><br><span class="line">        currentPosition.append(<span class="string">"街道："</span>).append(street).append(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">        tvPosition.setText(currentPosition);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取位置描述"><a href="#获取位置描述" class="headerlink" title="获取位置描述"></a>获取位置描述</h4><p>配置定位SDK参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">LocationClientOption option = <span class="keyword">new</span> LocationClientOption()；</span><br><span class="line"></span><br><span class="line">option.setIsNeedLocationDescribe(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//可选，是否需要位置描述信息，默认为不需要，即参数为false</span></span><br><span class="line"><span class="comment">//如果开发者需要获得当前点的位置信息，此处必须为true</span></span><br><span class="line"></span><br><span class="line">mLocationClient.setLocOption(option);</span><br><span class="line"><span class="comment">//mLocationClient为第二步初始化过的LocationClient对象</span></span><br><span class="line"><span class="comment">//需将配置好的LocationClientOption对象，通过setLocOption方法传递给LocationClient对象使用</span></span><br><span class="line"><span class="comment">//更多LocationClientOption的配置，请参照类参考中LocationClientOption类的详细说明</span></span><br></pre></td></tr></table></figure>
<p>获取位置描述只需要在BDLocationListener中获取即可。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocationClickListener</span> <span class="keyword">implements</span> <span class="title">BDLocationListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceiveLocation</span><span class="params">(BDLocation location)</span> </span>&#123;</span><br><span class="line">        StringBuilder currentPosition = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 位置描述</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String locationDescribe = location.getLocationDescribe();</span><br><span class="line">        currentPosition.append(<span class="string">"位置描述："</span>).append(locationDescribe).append(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">        tvPosition.setText(currentPosition);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="获取周边的POI（兴趣点坐标）"><a href="#获取周边的POI（兴趣点坐标）" class="headerlink" title="获取周边的POI（兴趣点坐标）"></a>获取周边的POI（兴趣点坐标）</h4><p>配置定位SDK参数：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">LocationClientOption option = <span class="keyword">new</span> LocationClientOption()；</span><br><span class="line"></span><br><span class="line">option.setIsNeedLocationPoiList(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//可选，是否需要周边POI信息，默认为不需要，即参数为false</span></span><br><span class="line"><span class="comment">//如果开发者需要获得周边POI信息，此处必须为true</span></span><br><span class="line"></span><br><span class="line">mLocationClient.setLocOption(option);</span><br><span class="line"><span class="comment">//mLocationClient为第二步初始化过的LocationClient对象</span></span><br><span class="line"><span class="comment">//需将配置好的LocationClientOption对象，通过setLocOption方法传递给LocationClient对象使用</span></span><br><span class="line"><span class="comment">//更多LocationClientOption的配置，请参照类参考中LocationClientOption类的详细说明</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">获取周边POI只需要在BDLocationListener中获取即可。</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">    private class MyLocationClickListener implements BDLocationListener &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void onReceiveLocation(BDLocation location) &#123;</span><br><span class="line">            StringBuilder currentPosition = new StringBuilder();</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">             * 周边POI信息</span><br><span class="line">             */</span><br><span class="line">            List&lt;Poi&gt; poiList = location.getPoiList();</span><br><span class="line">            for (int i=0; i&lt;poiList.size(); i++)&#123;</span><br><span class="line">                currentPosition.append(&quot;周边POI[&quot; + i + &quot;]:&quot; + &quot;\n&quot;);</span><br><span class="line">                currentPosition.append(&quot;ID:&quot; + poiList.get(i).getId());</span><br><span class="line">                currentPosition.append(&quot;name:&quot; + poiList.get(i).getName());</span><br><span class="line">                currentPosition.append(&quot;rank:&quot; + poiList.get(i).getRank() + &quot;\n&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            tvPosition.setText(currentPosition);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取室内定位"><a href="#获取室内定位" class="headerlink" title="获取室内定位"></a>获取室内定位</h4><p>获取室内定位只需要在BDLocationListener中获取即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocationClickListener</span> <span class="keyword">implements</span> <span class="title">BDLocationListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceiveLocation</span><span class="params">(BDLocation location)</span> </span>&#123;</span><br><span class="line">        StringBuilder currentPosition = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 室内定位</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (location.getFloor() != <span class="keyword">null</span>)&#123;</span><br><span class="line">            String buildingID = location.getBuildingID();</span><br><span class="line">            String buildingName = location.getBuildingName();       <span class="comment">// 百度内部建筑物ID</span></span><br><span class="line">            String floor = location.getFloor();     <span class="comment">// 室内定位楼层信息</span></span><br><span class="line">            mLocationClient.startIndoorMode();</span><br><span class="line">            currentPosition.append(<span class="string">"室内定位："</span> + <span class="string">"\n"</span>);</span><br><span class="line">            currentPosition.append(<span class="string">"buildingID: "</span> + buildingID);</span><br><span class="line">            currentPosition.append(<span class="string">"buildingName: "</span> + buildingName);</span><br><span class="line">            currentPosition.append(<span class="string">"floor: "</span> + floor + <span class="string">"\n"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            currentPosition.append(<span class="string">"当前位置不支持室内定位"</span> + <span class="string">"\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        tvPosition.setText(currentPosition);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="停止定位"><a href="#停止定位" class="headerlink" title="停止定位"></a>停止定位</h4><p>活动销毁时一定要停止定位，否则程序会一直在后台进行定位，消耗手机电量。</p>
<p>重写onDestroy()方法，调用LocationClient的stop()方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    mLocationClient.stopIndoorMode();       <span class="comment">// 关闭室内定位</span></span><br><span class="line">    mLocationClient.stop();     <span class="comment">// 关闭定位</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="地图"><a href="#地图" class="headerlink" title="地图"></a>地图</h3><h4 id="官方权限说明-1"><a href="#官方权限说明-1" class="headerlink" title="官方权限说明"></a>官方权限说明</h4><p>部分危险权限需要运行时权限。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 获取设备网络状态，禁用后无法获取网络状态 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span>/&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 网络权限，当禁用后，无法进行检索等相关业务 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span>/&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 读取设备硬件信息，统计数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.READ_PHONE_STATE"</span> /&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 读取系统信息，包含系统版本等信息，用作统计 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"com.android.launcher.permission.READ_SETTINGS"</span> /&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 获取设备的网络状态，鉴权所需网络代理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_WIFI_STATE"</span> /&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 允许sd卡写权限，需写入地图数据，禁用后无法显示地图 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.WRITE_EXTERNAL_STORAGE"</span>/&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 获取统计数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.WRITE_SETTINGS"</span> /&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 使用步行AR导航，配置Camera权限 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.CAMERA"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="布局-1"><a href="#布局-1" class="headerlink" title="布局"></a>布局</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".LBSTest.MyMapActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ……</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.baidu.mapapi.map.MapView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/mapview"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:clickable</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="显示地图"><a href="#显示地图" class="headerlink" title="显示地图"></a>显示地图</h4><p>目前百度地图SDK所提供的地图等级为3-21级，所包含的信息有建筑物、道路、河流、学校、公园等内容。 </p>
<p>在21级时，不支持显示卫星图、热力图、交通路况图层。</p>
<p>当地图从20级放大到21级后，卫星图、热力图、交通路况图层将不再显示；缩小到20级后，卫星图、热力图、交通路况图层，会再正常显示。</p>
<table>
<thead>
<tr>
<th>类型名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>MAP_TYPE_NORMAL</td>
<td>普通地图（包含3D地图）</td>
</tr>
<tr>
<td>MAP_TYPE_SATELLITE</td>
<td>卫星图</td>
</tr>
<tr>
<td>MAP_TYPE_NONE</td>
<td>空白地图</td>
</tr>
</tbody>
</table>
<ul>
<li><p>普通地图</p>
<p>  基础的道路地图。 显示道路、建筑物、绿地以及河流等重要的自然特征。 </p>
</li>
<li><p>卫星地图</p>
<p>  显示卫星照片数据。 </p>
</li>
<li><p>空白地图</p>
<p>  无地图瓦片,地图将渲染为空白地图。不加载任何图块，将不会使用流量下载基础地图瓦片图层。支持叠加任何覆盖物。</p>
</li>
</ul>
<pre><code>适用场景：与瓦片图层（tileOverlay）一起使用，节省流量，提升自定义瓦片图下载速度。 
</code></pre><ul>
<li><p>实时路况图，嵌入地图中使用</p>
<p>  全国范围内已支持绝大部分城市实时路况查询。普通地图和卫星地图，均支持叠加实时路况图。 </p>
</li>
<li><p>百度城市热力图，嵌入地图中使用</p>
<p>  百度城市热力图是用不同颜色的区块叠加在地图上描述人群分布、密度和变化趋势的一个产品。地图层级介于11-20级时，可显示城市热力图。</p>
<p>  百度城市热力图的性质及使用与实时路况图类似，只需要简单的接口调用，即可在地图上展现样式丰富的百度城市热力图。 </p>
</li>
</ul>
<p>在java中，需要重写activity的生命周期的几个方法来管理地图的生命周期，初始化SDK的方法一定要在设置布局之前进行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.aijunhao.myproject.LBSTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baidu.mapapi.SDKInitializer;</span><br><span class="line"><span class="keyword">import</span> com.baidu.mapapi.map.BaiduMap;</span><br><span class="line"><span class="keyword">import</span> com.baidu.mapapi.map.MapView;</span><br><span class="line"><span class="keyword">import</span> com.example.aijunhao.myproject.R;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> butterknife.BindView;</span><br><span class="line"><span class="keyword">import</span> butterknife.ButterKnife;</span><br><span class="line"><span class="keyword">import</span> butterknife.OnClick;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMapActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BindView</span>(R.id.mapview)</span><br><span class="line">    MapView mapview;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.btn_normal)</span><br><span class="line">    TextView btnNormal;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.btn_satellite)</span><br><span class="line">    TextView btnSatellite;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.btn_none)</span><br><span class="line">    TextView btnNone;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.btn_traffic_map)</span><br><span class="line">    TextView btnTrafficMap;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.btn_heat_map)</span><br><span class="line">    TextView btnHeatMap;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BaiduMap baiduMap;      <span class="comment">// 百度地图对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> trafficEnabled = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> heatMapEnabled = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        SDKInitializer.initialize(getApplicationContext());     <span class="comment">// 初始化地图SDK，需要在setContentView()方法之前使用</span></span><br><span class="line"></span><br><span class="line">        setContentView(R.layout.activity_my_map);</span><br><span class="line">        ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        baiduMap = mapview.getMap();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OnClick</span>(&#123;R.id.btn_normal, R.id.btn_satellite, R.id.btn_none, R.id.btn_traffic_map, R.id.btn_heat_map&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewClicked</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (view.getId()) &#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_normal:</span><br><span class="line">                <span class="comment">// 普通地图</span></span><br><span class="line">                baiduMap.setMapType(BaiduMap.MAP_TYPE_NORMAL);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_satellite:</span><br><span class="line">                <span class="comment">// 卫星地图</span></span><br><span class="line">                baiduMap.setMapType(BaiduMap.MAP_TYPE_SATELLITE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_none:</span><br><span class="line">                <span class="comment">// 空白图，一般与瓦片图层一起使用</span></span><br><span class="line">                baiduMap.setMapType(BaiduMap.MAP_TYPE_NONE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_traffic_map:</span><br><span class="line">                <span class="comment">// 路况图</span></span><br><span class="line">                baiduMap.setTrafficEnabled(trafficEnabled);</span><br><span class="line">                <span class="keyword">if</span> (trafficEnabled == <span class="keyword">true</span>)&#123;</span><br><span class="line">                    btnTrafficMap.setText(<span class="string">"路况图：开启状态"</span>);</span><br><span class="line">                    trafficEnabled = <span class="keyword">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    btnTrafficMap.setText(<span class="string">"路况图：关闭状态"</span>);</span><br><span class="line">                    trafficEnabled = <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.btn_heat_map:</span><br><span class="line">                <span class="comment">// 热力图</span></span><br><span class="line">                baiduMap.setBaiduHeatMapEnabled(heatMapEnabled);</span><br><span class="line">                <span class="keyword">if</span> (heatMapEnabled == <span class="keyword">true</span>)&#123;</span><br><span class="line">                    btnHeatMap.setText(<span class="string">"热力图：开启状态"</span>);</span><br><span class="line">                    heatMapEnabled = <span class="keyword">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    btnHeatMap.setText(<span class="string">"热力图：关闭状态"</span>);</span><br><span class="line">                    heatMapEnabled = <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onResume();</span><br><span class="line">        mapview.onResume();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onPause();</span><br><span class="line">        mapview.onPause();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        mapview.onDestroy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="在地图中显示定位"><a href="#在地图中显示定位" class="headerlink" title="在地图中显示定位"></a>在地图中显示定位</h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/12/Android技术——LBS/" data-id="cjptr8u3q000468utfi5439cj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android技术——JSON" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/10/Android技术——JSON/" class="article-date">
  <time datetime="2018-11-10T06:34:36.000Z" itemprop="datePublished">2018-11-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/10/Android技术——JSON/">Android技术——JSON</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>此节主要讲Android中的JSON及JSON的各种解析方法。</p>
<ul>
<li><p>JSON简介</p>
</li>
<li><p>工具：</p>
<ol>
<li>GsonFormat插件工具</li>
<li>HiJson格式化工具</li>
</ol>
</li>
<li><p>解析方法：</p>
<ol>
<li>Android原生解析</li>
<li>第三方框架Gson解析</li>
<li>第三方框架FastJson解析</li>
</ol>
</li>
</ul>
<hr>
<h2 id="JSON简介"><a href="#JSON简介" class="headerlink" title="JSON简介"></a>JSON简介</h2><p>JSON 全称是JavaScript Object Notation，是一种轻量级的数据交换格式。</p>
<p>特点：</p>
<ol>
<li>本质就是具有特定格式的字符串。</li>
<li>JSON完全独立于编程语言</li>
<li>JSON比XML数据传输的有效性要高出很多。 </li>
</ol>
<p>JSON对象结构：{key1:value1, key2:value2, key3:value3}</p>
<p>JSON数组结构：[value1, value2, value3]</p>
<p>key的数据类型：字符串。value对的数据类型：数值、字符串、null、json数组[]，json对象{}</p>
<h3 id="JSON解析方向"><a href="#JSON解析方向" class="headerlink" title="JSON解析方向"></a>JSON解析方向</h3><ol>
<li>将java对象(包含集合)转化为json格式字符串。——在服务器端应用</li>
<li>将json格式字符串转换为java对象(包含集合)。——在客户端应用</li>
</ol>
<hr>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="GsonFormat插件工具"><a href="#GsonFormat插件工具" class="headerlink" title="GsonFormat插件工具"></a>GsonFormat插件工具</h3><p>GsonFormat是Android Studio中的一个插件，主要用于使用Gson库将JSONObject格式的String 解析成实体，该插件可以加快开发进度，使用非常方便，效率高。</p>
<p>在File-&gt;Settings-&gt;Plugins中查找安装即可。</p>
<p>在创建JSON的实体类JavaBean时，右键generate-&gt;GsonFormat，将JSON数据张贴到对话框中，点击OK即可生成对应的JavaBean实体类。</p>
<p><img src="/2018/11/10/Android技术——JSON/GsonFormat.png" alt=""></p>
<h3 id="HiJson格式化工具"><a href="#HiJson格式化工具" class="headerlink" title="HiJson格式化工具"></a>HiJson格式化工具</h3><p>直接百度搜索下载即可，是JSON的格式化工具，帮助开发人员更轻易地分析JSON格式。</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="/2018/11/10/Android技术——JSON/HiJson.png" alt=""></h2><h2 id="解析方法"><a href="#解析方法" class="headerlink" title="解析方法"></a>解析方法</h2><h3 id="Android原生的JSON解析技术"><a href="#Android原生的JSON解析技术" class="headerlink" title="Android原生的JSON解析技术"></a>Android原生的JSON解析技术</h3><p>原生技术编程相对麻烦，但是有些特殊的json数据只能用原生来解析。</p>
<p>原生技术只能将json数据转为java数据，官方并没有提供将java转化为json的API接口。</p>
<h4 id="将json格式的字符串-转换为Java对象"><a href="#将json格式的字符串-转换为Java对象" class="headerlink" title="将json格式的字符串{}转换为Java对象"></a>将json格式的字符串{}转换为Java对象</h4><p>API:</p>
<ul>
<li>JSONObject(String json): 将json字符串解析为json对象。</li>
<li>XXX getXXX(String name): 根据name，在json对象中得到对象的value，没有默认值，会出现空指针异常。</li>
<li>XXX optXXX(String name): 根据name，在json对象中得到对象的value，有默认值，不会出现空指针异常。</li>
</ul>
<font color="red">重要的事情说三遍！！！<br><br>写bean对象的时候，务必！务必！务必！重写toString()方法。<br><br>写bean对象的时候，务必！务必！务必！重写toString()方法。<br><br>写bean对象的时候，务必！务必！务必！重写toString()方法。<br></font>

<p>ShopInfo.java：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.aijunhao.myproject.bean;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> Aijunhao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Time</span> 2018-11-10 15:20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShopInfo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id : 2</span></span><br><span class="line"><span class="comment">     * name : 大虾</span></span><br><span class="line"><span class="comment">     * price : 12.3</span></span><br><span class="line"><span class="comment">     * imagePath : http://120.79.254.54/name.jpg</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price;</span><br><span class="line">    <span class="keyword">private</span> String imagePath;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ShopInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ShopInfo</span><span class="params">(<span class="keyword">int</span> id, String name, <span class="keyword">double</span> price, String imagePath)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">        <span class="keyword">this</span>.imagePath = imagePath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getImagePath</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> imagePath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setImagePath</span><span class="params">(String imagePath)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.imagePath = imagePath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ShopInfo&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", price="</span> + price +</span><br><span class="line">                <span class="string">", imagePath='"</span> + imagePath + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将json格式的字符串&#123;&#125;转换为java数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">jsonToJavaObjectByNative</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 获取或创建JSON数据</span></span><br><span class="line">        String json = <span class="string">"&#123;\n"</span> +</span><br><span class="line">                <span class="string">"\t\"id\": 2, \n"</span> +</span><br><span class="line">                <span class="string">"\t\"name\": \"大虾\",\n"</span> +</span><br><span class="line">                <span class="string">"\t\"price\": 12.3,\n"</span> +</span><br><span class="line">                <span class="string">"\t\"imagePath\": \"http://120.79.254.54/name.jpg\"\n"</span> +</span><br><span class="line">                <span class="string">"&#125;\n"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析json</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JSONObject object = <span class="keyword">new</span> JSONObject(json);</span><br><span class="line">            <span class="keyword">int</span> id = object.optInt(<span class="string">"id"</span>);</span><br><span class="line">            String name = object.optString(<span class="string">"name"</span>);</span><br><span class="line">            <span class="keyword">double</span> price = object.optDouble(<span class="string">"price"</span>);</span><br><span class="line">            String imagePath = object.optString(<span class="string">"imagePath"</span>);</span><br><span class="line"></span><br><span class="line">            shopInfo = <span class="keyword">new</span> ShopInfo(id, name, price, imagePath);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 显示原始的json数据</span></span><br><span class="line">        tvNativeOrignal.setText(json);</span><br><span class="line">        <span class="comment">// 显示转化后的json数据</span></span><br><span class="line">        tvNativeLast.setText(shopInfo.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="将json格式的字符串-转换为Java对象的List"><a href="#将json格式的字符串-转换为Java对象的List" class="headerlink" title="将json格式的字符串[]转换为Java对象的List"></a>将json格式的字符串[]转换为Java对象的List</h4><font color="red"><br>为避免空指针异常，在遍历list并创建JSONObject对象的时候需要判断JSONObject是否为空。<br></font>

<p>API：</p>
<ul>
<li>JSONArray(String json): 将json字符串解析为json数组</li>
<li>int length()：得到json数组中元素的个数</li>
<li>XXX getXXX(int index): 根据下标得到json数组中对应的元素数据，无默认值，会出现空指针异常。</li>
<li>XXX optXXX(int index): 根据下标得到json数组中对应的元素数据，有默认值，不会出现空指针异常。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  将json格式的字符串[]转换为java集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">jsonToJavaListByNative</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String json = <span class="string">"[\n"</span> +</span><br><span class="line">            <span class="string">"    &#123;\n"</span> +</span><br><span class="line">            <span class="string">"        \"id\": 1,\n"</span> +</span><br><span class="line">            <span class="string">"        \"imagePath\": \"http://120.79.254.54/name.jpg\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"name\": \"大虾1\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"price\": 12.3\n"</span> +</span><br><span class="line">            <span class="string">"    &#125;,\n"</span> +</span><br><span class="line">            <span class="string">"    &#123;\n"</span> +</span><br><span class="line">            <span class="string">"        \"id\": 2,\n"</span> +</span><br><span class="line">            <span class="string">"        \"imagePath\": \"http://120.79.254.54/name2.jpg\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"name\": \"大虾2\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"price\": 12.5\n"</span> +</span><br><span class="line">            <span class="string">"    &#125;\n"</span> +</span><br><span class="line">            <span class="string">"]"</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;ShopInfo&gt; shopInfoList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        JSONArray jsonArray = <span class="keyword">new</span> JSONArray(json);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;jsonArray.length(); i++)&#123;</span><br><span class="line">            JSONObject jsonObject = jsonArray.getJSONObject(i);</span><br><span class="line">            <span class="keyword">if</span> (jsonObject != <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> id = jsonObject.optInt(<span class="string">"id"</span>);</span><br><span class="line">                String name = jsonObject.optString(<span class="string">"name"</span>);</span><br><span class="line">                <span class="keyword">double</span> price = jsonObject.optDouble(<span class="string">"price"</span>);</span><br><span class="line">                String imagePath = jsonObject.optString(<span class="string">"imagePath"</span>);</span><br><span class="line"></span><br><span class="line">                shopInfo = <span class="keyword">new</span> ShopInfo(id, name, price, imagePath);</span><br><span class="line">                shopInfoList.add(shopInfo);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    tvNativeOrignal.setText(json);</span><br><span class="line">    tvNativeLast.setText(shopInfoList.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="复杂的json数据解析"><a href="#复杂的json数据解析" class="headerlink" title="复杂的json数据解析"></a>复杂的json数据解析</h4><p>DataInfo.java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.aijunhao.myproject.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> Aijunhao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Time</span> 2018-11-10 15:56</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataInfo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * data : &#123;"count":5,"items":[&#123;"id":45,"title":"坚果"&#125;,&#123;"id":132,"title":"炒货"&#125;,&#123;"id":166,"title":"蜜饯"&#125;,&#123;"id":195,"title":"果楠"&#125;,&#123;"id":196,"title":"礼盒"&#125;]&#125;</span></span><br><span class="line"><span class="comment">     * rs_code : 1000</span></span><br><span class="line"><span class="comment">     * rs_msg : success</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DataBean data;</span><br><span class="line">    <span class="keyword">private</span> String rs_code;</span><br><span class="line">    <span class="keyword">private</span> String rs_msg;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"DataInfo&#123;"</span> +</span><br><span class="line">                <span class="string">"data="</span> + data +</span><br><span class="line">                <span class="string">", rs_code='"</span> + rs_code + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", rs_msg='"</span> + rs_msg + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataBean <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(DataBean data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRs_code</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> rs_code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRs_code</span><span class="params">(String rs_code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.rs_code = rs_code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRs_msg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> rs_msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRs_msg</span><span class="params">(String rs_msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.rs_msg = rs_msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DataBean</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * count : 5</span></span><br><span class="line"><span class="comment">         * items : [&#123;"id":45,"title":"坚果"&#125;,&#123;"id":132,"title":"炒货"&#125;,&#123;"id":166,"title":"蜜饯"&#125;,&#123;"id":195,"title":"果楠"&#125;,&#123;"id":196,"title":"礼盒"&#125;]</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line">        <span class="keyword">private</span> List&lt;ItemsBean&gt; items;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"DataBean&#123;"</span> +</span><br><span class="line">                    <span class="string">"count="</span> + count +</span><br><span class="line">                    <span class="string">", items="</span> + items +</span><br><span class="line">                    <span class="string">'&#125;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCount</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.count = count;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;ItemsBean&gt; <span class="title">getItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> items;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setItems</span><span class="params">(List&lt;ItemsBean&gt; items)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.items = items;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsBean</span> </span>&#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * id : 45</span></span><br><span class="line"><span class="comment">             * title : 坚果</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">            <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"ItemsBean&#123;"</span> +</span><br><span class="line">                        <span class="string">"id="</span> + id +</span><br><span class="line">                        <span class="string">", title='"</span> + title + <span class="string">'\''</span> +</span><br><span class="line">                        <span class="string">'&#125;'</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> id;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.id = id;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> title;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.title = title;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 复杂的json数据解析</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">jsonToJavaOfComplex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String json = <span class="string">"&#123;\n"</span> +</span><br><span class="line">            <span class="string">"    \"data\": &#123;\n"</span> +</span><br><span class="line">            <span class="string">"        \"count\": 5,\n"</span> +</span><br><span class="line">            <span class="string">"        \"items\": [\n"</span> +</span><br><span class="line">            <span class="string">"            &#123;\n"</span> +</span><br><span class="line">            <span class="string">"                \"id\": 45,\n"</span> +</span><br><span class="line">            <span class="string">"                \"title\": \"坚果\"\n"</span> +</span><br><span class="line">            <span class="string">"            &#125;,\n"</span> +</span><br><span class="line">            <span class="string">"            &#123;\n"</span> +</span><br><span class="line">            <span class="string">"                \"id\": 132,\n"</span> +</span><br><span class="line">            <span class="string">"                \"title\": \"炒货\"\n"</span> +</span><br><span class="line">            <span class="string">"            &#125;,\n"</span> +</span><br><span class="line">            <span class="string">"            &#123;\n"</span> +</span><br><span class="line">            <span class="string">"                \"id\": 166,\n"</span> +</span><br><span class="line">            <span class="string">"                \"title\": \"蜜饯\"\n"</span> +</span><br><span class="line">            <span class="string">"            &#125;,\n"</span> +</span><br><span class="line">            <span class="string">"            &#123;\n"</span> +</span><br><span class="line">            <span class="string">"                \"id\": 195,\n"</span> +</span><br><span class="line">            <span class="string">"                \"title\": \"果楠\"\n"</span> +</span><br><span class="line">            <span class="string">"            &#125;,\n"</span> +</span><br><span class="line">            <span class="string">"            &#123;\n"</span> +</span><br><span class="line">            <span class="string">"                \"id\": 196,\n"</span> +</span><br><span class="line">            <span class="string">"                \"title\": \"礼盒\"\n"</span> +</span><br><span class="line">            <span class="string">"            &#125;\n"</span> +</span><br><span class="line">            <span class="string">"        ]\n"</span> +</span><br><span class="line">            <span class="string">"    &#125;,\n"</span> +</span><br><span class="line">            <span class="string">"    \"rs_code\": \"1000\",\n"</span> +</span><br><span class="line">            <span class="string">"    \"rs_msg\": \"success\"\n"</span> +</span><br><span class="line">            <span class="string">"&#125;"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 封装对象</span></span><br><span class="line">    DataInfo dataInfo = <span class="keyword">new</span> DataInfo();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        JSONObject object = <span class="keyword">new</span> JSONObject(json);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 第一层解析</span></span><br><span class="line">        JSONObject data = object.optJSONObject(<span class="string">"data"</span>);</span><br><span class="line">        String rs_code = object.optString(<span class="string">"rs_code"</span>);</span><br><span class="line">        String rs_msg = object.optString(<span class="string">"rs_msg"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 第一层封装</span></span><br><span class="line">        dataInfo.setRs_code(rs_code);</span><br><span class="line">        dataInfo.setRs_msg(rs_msg);</span><br><span class="line">        DataInfo.DataBean dataBean = <span class="keyword">new</span> DataInfo.DataBean();</span><br><span class="line">        dataInfo.setData(dataBean);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 第二层解析</span></span><br><span class="line">        <span class="keyword">int</span> count = data.optInt(<span class="string">"count"</span>);</span><br><span class="line">        JSONArray items = data.getJSONArray(<span class="string">"items"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 第二层封装</span></span><br><span class="line">        dataBean.setCount(count);</span><br><span class="line">        List&lt;DataInfo.DataBean.ItemsBean&gt; itemsBean = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        dataBean.setItems(itemsBean);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 第三层解析</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;items.length(); i++) &#123;</span><br><span class="line">            JSONObject jsonObject = items.optJSONObject(i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (jsonObject != <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> id = jsonObject.optInt(<span class="string">"id"</span>);</span><br><span class="line">                String title = jsonObject.optString(<span class="string">"title"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 第三层封装</span></span><br><span class="line">                DataInfo.DataBean.ItemsBean bean = <span class="keyword">new</span> DataInfo.DataBean.ItemsBean();</span><br><span class="line">                bean.setId(id);</span><br><span class="line">                bean.setTitle(title);</span><br><span class="line">                itemsBean.add(bean);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    tvNativeOrignal.setText(json);</span><br><span class="line">    tvNativeLast.setText(dataInfo.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="特殊JSON数据解析"><a href="#特殊JSON数据解析" class="headerlink" title="特殊JSON数据解析"></a>特殊JSON数据解析</h4><p>按我们之前说的，json格式是键值对的方式，但是如下的json，它的list中的键很特殊，不是特定的字符串。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;code&quot;:0, </span><br><span class="line">	&quot;list&quot;:&#123;</span><br><span class="line">		&quot;0&quot;:&#123;</span><br><span class="line">			&quot;aid&quot;:&quot;6008965,</span><br><span class="line">			&quot;author&quot;:&quot;不知道&quot;,</span><br><span class="line">			&quot;coins&quot; 170,</span><br><span class="line">			&quot;copyright&quot;: &quot;Copy&quot;,</span><br><span class="line">			&quot;create&quot;:&quot;2016-08-25 21:34&quot;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;1&quot;:&#123;</span><br><span class="line">			&quot;aid&quot;:&quot;6008938&quot;,</span><br><span class="line">			&quot;author&quot;:&quot;不清楚&quot;,</span><br><span class="line">			&quot;coins&quot;:404,</span><br><span class="line">			&quot;copyright&quot;:&quot;Copy&quot;,</span><br><span class="line">			&quot;create&quot;:&quot;2016-08-25 21:33&quot;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>此时就要将list看成一个json对象，然后根据特殊的键”0”，”1”，来获对应的值。</p>
<hr>
<h2 id="第三方框架GSON解析"><a href="#第三方框架GSON解析" class="headerlink" title="第三方框架GSON解析"></a>第三方框架GSON解析</h2><p>编码简洁，是google官方推荐的。</p>
<p>支持的解析方向：</p>
<ol>
<li>将json格式的字符串{}转换为Java对象</li>
<li>将json格式的字符串[]转换为Java对象的List</li>
<li>将Java对象想转换为json字符串{}</li>
<li>将Java对象的List转换为json字符串[]</li>
</ol>
<h3 id="导入架包"><a href="#导入架包" class="headerlink" title="导入架包"></a>导入架包</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gson</span></span><br><span class="line">implementation <span class="string">'com.google.code.gson:gson:2.8.5'</span></span><br></pre></td></tr></table></figure>
<h3 id="将JSON格式的字符串-转换为JAVA对象"><a href="#将JSON格式的字符串-转换为JAVA对象" class="headerlink" title="将JSON格式的字符串{}转换为JAVA对象"></a>将JSON格式的字符串{}转换为JAVA对象</h3><p>API：</p>
<ul>
<li><t> T fromJson(String json, Class<t> classOfT);</t></t></li>
</ul>
<p>注意：要求JSON对象中的KEY的名称与java对象对应的类中的属性名要相同，否则不能转换。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">jsonToJavaObjectByGson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String json = <span class="string">"&#123;\n"</span> +</span><br><span class="line">            <span class="string">"\t\"id\": 2, \n"</span> +</span><br><span class="line">            <span class="string">"\t\"name\": \"大虾\",\n"</span> +</span><br><span class="line">            <span class="string">"\t\"price\": 12.3,\n"</span> +</span><br><span class="line">            <span class="string">"\t\"imagePath\": \"http://120.79.254.54/name.jpg\"\n"</span> +</span><br><span class="line">            <span class="string">"&#125;\n"</span>;</span><br><span class="line"></span><br><span class="line">    Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">    ShopInfo shopInfo = gson.fromJson(json, ShopInfo.class);</span><br><span class="line"></span><br><span class="line">    tvGsonOrignal.setText(json);</span><br><span class="line">    tvGsonLast.setText(shopInfo.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="将JSON格式的字符串-转换为JAVA对象的List"><a href="#将JSON格式的字符串-转换为JAVA对象的List" class="headerlink" title="将JSON格式的字符串[]转换为JAVA对象的List"></a>将JSON格式的字符串[]转换为JAVA对象的List</h3><p>API:</p>
<ul>
<li>fromJson(String json, Type typeOfT);</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">jsonToJavaListByGson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String json = <span class="string">"[\n"</span> +</span><br><span class="line">            <span class="string">"    &#123;\n"</span> +</span><br><span class="line">            <span class="string">"        \"id\": 1,\n"</span> +</span><br><span class="line">            <span class="string">"        \"imagePath\": \"http://120.79.254.54/name.jpg\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"name\": \"大虾1\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"price\": 12.3\n"</span> +</span><br><span class="line">            <span class="string">"    &#125;,\n"</span> +</span><br><span class="line">            <span class="string">"    &#123;\n"</span> +</span><br><span class="line">            <span class="string">"        \"id\": 2,\n"</span> +</span><br><span class="line">            <span class="string">"        \"imagePath\": \"http://120.79.254.54/name2.jpg\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"name\": \"大虾2\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"price\": 12.5\n"</span> +</span><br><span class="line">            <span class="string">"    &#125;\n"</span> +</span><br><span class="line">            <span class="string">"]"</span>;</span><br><span class="line"></span><br><span class="line">    Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">    List&lt;ShopInfo&gt; shopInfoList = gson.fromJson(json, <span class="keyword">new</span> TypeToken&lt;List&lt;ShopInfo&gt;&gt;() &#123;</span><br><span class="line">    &#125;.getType());</span><br><span class="line"></span><br><span class="line">    tvGsonOrignal.setText(json);</span><br><span class="line">    tvGsonLast.setText(shopInfoList.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="将JAVA对下岗转换为JSON字符串"><a href="#将JAVA对下岗转换为JSON字符串" class="headerlink" title="将JAVA对下岗转换为JSON字符串{}"></a>将JAVA对下岗转换为JSON字符串{}</h3><p>API:</p>
<ul>
<li>String toJson(Object src);</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">javaToJsonByGson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ShopInfo shopInfo = <span class="keyword">new</span> ShopInfo(<span class="number">1</span>, <span class="string">"鲍鱼"</span>, <span class="number">250.0</span>, <span class="string">"baoyu"</span>);</span><br><span class="line">    Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">    String json = gson.toJson(shopInfo);</span><br><span class="line">    tvGsonOrignal.setText(shopInfo.toString());</span><br><span class="line">    tvGsonLast.setText(json);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="将JAVA对象的List转换为json字符串"><a href="#将JAVA对象的List转换为json字符串" class="headerlink" title="将JAVA对象的List转换为json字符串[]"></a>将JAVA对象的List转换为json字符串[]</h3><p>API:</p>
<ul>
<li>String toJson(Object src);</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">javaToJsonArrayByGson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;ShopInfo&gt; shopInfoList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    ShopInfo baoyu = <span class="keyword">new</span> ShopInfo(<span class="number">1</span>, <span class="string">"鲍鱼"</span>, <span class="number">250.0</span>, <span class="string">"baoyu"</span>);</span><br><span class="line">    ShopInfo longxia = <span class="keyword">new</span> ShopInfo(<span class="number">2</span>, <span class="string">"龙虾"</span>, <span class="number">251.0</span>, <span class="string">"longxia"</span>);</span><br><span class="line">    shopInfoList.add(baoyu);</span><br><span class="line">    shopInfoList.add(longxia);</span><br><span class="line"></span><br><span class="line">    Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">    String json = gson.toJson(shopInfoList);</span><br><span class="line"></span><br><span class="line">    tvGsonOrignal.setText(shopInfoList.toString());</span><br><span class="line">    tvGsonLast.setText(json);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="第三方框架FastJson解析"><a href="#第三方框架FastJson解析" class="headerlink" title="第三方框架FastJson解析"></a>第三方框架FastJson解析</h2><p>FastJson是一个Java语言编写的高性能功能完善的JSON库，采用一种“假定有序快速匹配”的算法，把JSON Parse的性能提升到极致，是目前Java语言中最快的JSON库。</p>
<p>是阿里巴巴推出的开源库。</p>
<p><a href="https://github.com/alibaba/fastjson/wiki/Quick-Start-CN" target="_blank" rel="noopener">https://github.com/alibaba/fastjson/wiki/Quick-Start-CN</a></p>
<h3 id="新手指南"><a href="#新手指南" class="headerlink" title="新手指南"></a>新手指南</h3><h4 id="1-什么是fastjson"><a href="#1-什么是fastjson" class="headerlink" title="1. 什么是fastjson?"></a>1. 什么是fastjson?</h4><p>fastjson是阿里巴巴的开源JSON解析库，它可以解析JSON格式的字符串，支持将Java Bean序列化为JSON字符串，也可以从JSON字符串反序列化到JavaBean。</p>
<h4 id="2-fastjson的优点"><a href="#2-fastjson的优点" class="headerlink" title="2.fastjson的优点"></a>2.fastjson的优点</h4><h5 id="2-1-速度快"><a href="#2-1-速度快" class="headerlink" title="2.1 速度快"></a>2.1 速度快</h5><p>fastjson相对其他JSON库的特点是快，从2011年fastjson发布1.1.x版本之后，其性能从未被其他Java实现的JSON库超越。</p>
<h5 id="2-2-使用广泛"><a href="#2-2-使用广泛" class="headerlink" title="2.2 使用广泛"></a>2.2 使用广泛</h5><p>fastjson在阿里巴巴大规模使用，在数万台服务器上部署，fastjson在业界被广泛接受。在2012年被开源中国评选为最受欢迎的国产开源软件之一。</p>
<h5 id="2-3-测试完备"><a href="#2-3-测试完备" class="headerlink" title="2.3 测试完备"></a>2.3 测试完备</h5><p>fastjson有非常多的testcase，在1.2.11版本中，testcase超过3321个。每次发布都会进行回归测试，保证质量稳定。</p>
<h5 id="2-4-使用简单"><a href="#2-4-使用简单" class="headerlink" title="2.4 使用简单"></a>2.4 使用简单</h5><p>fastjson的API十分简洁。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String text = JSON.toJSONString(obj); <span class="comment">//序列化</span></span><br><span class="line">String text = JSON.toJSONString(obj); <span class="comment">//序列化</span></span><br><span class="line">VO vo = JSON.parseObject(<span class="string">"&#123;...&#125;"</span>, VO.class); <span class="comment">//反序列化</span></span><br><span class="line">List&lt;VO&gt; voList = JSON.parseArray(<span class="string">"&#123;...&#125;"</span>, VO.class); <span class="comment">//反序列化</span></span><br></pre></td></tr></table></figure>
<h5 id="2-5-功能完备"><a href="#2-5-功能完备" class="headerlink" title="2.5 功能完备"></a>2.5 功能完备</h5><p>支持泛型，支持流处理超大文本，支持枚举，支持序列化和反序列化扩展。</p>
<p>支持的解析方向：</p>
<ol>
<li>将json格式的字符串{}转换为Java对象</li>
<li>将json格式的字符串[]转换为Java对象的List</li>
<li>将Java对象想转换为json字符串{}</li>
<li>将Java对象的List转换为json字符串[]</li>
</ol>
<h3 id="导入架包-1"><a href="#导入架包-1" class="headerlink" title="导入架包"></a>导入架包</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// FastJson</span><br><span class="line">implementation 'com.alibaba:fastjson:1.2.10'</span><br></pre></td></tr></table></figure>
<h3 id="将json格式的字符串-转换为Java对象-1"><a href="#将json格式的字符串-转换为Java对象-1" class="headerlink" title="将json格式的字符串{}转换为Java对象"></a>将json格式的字符串{}转换为Java对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">jsonToJavaObjectByFastJson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String json = <span class="string">"&#123;\n"</span> +</span><br><span class="line">            <span class="string">"\t\"id\": 2, \n"</span> +</span><br><span class="line">            <span class="string">"\t\"name\": \"大虾\",\n"</span> +</span><br><span class="line">            <span class="string">"\t\"price\": 12.3,\n"</span> +</span><br><span class="line">            <span class="string">"\t\"imagePath\": \"http://120.79.254.54/name.jpg\"\n"</span> +</span><br><span class="line">            <span class="string">"&#125;\n"</span>;</span><br><span class="line"></span><br><span class="line">    ShopInfo shopInfo = JSON.parseObject(json, ShopInfo.class);</span><br><span class="line"></span><br><span class="line">    tvFastJsonOrignal.setText(json);</span><br><span class="line">    tvFastJsonLast.setText(shopInfo.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="将json格式的字符串-转换为Java对象的List-1"><a href="#将json格式的字符串-转换为Java对象的List-1" class="headerlink" title="将json格式的字符串[]转换为Java对象的List"></a>将json格式的字符串[]转换为Java对象的List</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">jsonToJavaListByFastJson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String json = <span class="string">"[\n"</span> +</span><br><span class="line">            <span class="string">"    &#123;\n"</span> +</span><br><span class="line">            <span class="string">"        \"id\": 1,\n"</span> +</span><br><span class="line">            <span class="string">"        \"imagePath\": \"http://120.79.254.54/name.jpg\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"name\": \"大虾1\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"price\": 12.3\n"</span> +</span><br><span class="line">            <span class="string">"    &#125;,\n"</span> +</span><br><span class="line">            <span class="string">"    &#123;\n"</span> +</span><br><span class="line">            <span class="string">"        \"id\": 2,\n"</span> +</span><br><span class="line">            <span class="string">"        \"imagePath\": \"http://120.79.254.54/name2.jpg\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"name\": \"大虾2\",\n"</span> +</span><br><span class="line">            <span class="string">"        \"price\": 12.5\n"</span> +</span><br><span class="line">            <span class="string">"    &#125;\n"</span> +</span><br><span class="line">            <span class="string">"]"</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;ShopInfo&gt; shopInfoList = JSON.parseArray(json, ShopInfo.class);</span><br><span class="line"></span><br><span class="line">    tvFastJsonOrignal.setText(json);</span><br><span class="line">    tvFastJsonLast.setText(shopInfoList.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="将Java对象想转换为json字符串"><a href="#将Java对象想转换为json字符串" class="headerlink" title="将Java对象想转换为json字符串{}"></a>将Java对象想转换为json字符串{}</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">javaToJsonByFastJson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ShopInfo shopInfo = <span class="keyword">new</span> ShopInfo(<span class="number">1</span>, <span class="string">"鲍鱼"</span>, <span class="number">250.0</span>, <span class="string">"baoyu"</span>);</span><br><span class="line">    </span><br><span class="line">    String json = JSON.toJSONString(shopInfo);</span><br><span class="line">    </span><br><span class="line">    tvFastJsonOrignal.setText(shopInfo.toString());</span><br><span class="line">    tvFastJsonLast.setText(json);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="将Java对象的List转换为json字符串"><a href="#将Java对象的List转换为json字符串" class="headerlink" title="将Java对象的List转换为json字符串[]"></a>将Java对象的List转换为json字符串[]</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">javaToJsonArrayByFastJson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;ShopInfo&gt; shopInfoList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    ShopInfo baoyu = <span class="keyword">new</span> ShopInfo(<span class="number">1</span>, <span class="string">"鲍鱼"</span>, <span class="number">250.0</span>, <span class="string">"baoyu"</span>);</span><br><span class="line">    ShopInfo longxia = <span class="keyword">new</span> ShopInfo(<span class="number">2</span>, <span class="string">"龙虾"</span>, <span class="number">251.0</span>, <span class="string">"longxia"</span>);</span><br><span class="line">    shopInfoList.add(baoyu);</span><br><span class="line">    shopInfoList.add(longxia);</span><br><span class="line"></span><br><span class="line">    String json = JSON.toJSONString(shopInfoList);</span><br><span class="line"></span><br><span class="line">    tvFastJsonOrignal.setText(shopInfoList.toString());</span><br><span class="line">    tvFastJsonLast.setText(json);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/10/Android技术——JSON/" data-id="cjptr8u3y000868utzktps8q0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android技术——StickyListHeaders黏连头部表" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/02/Android技术——StickyListHeaders黏连头部表/" class="article-date">
  <time datetime="2018-11-02T09:34:20.000Z" itemprop="datePublished">2018-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/02/Android技术——StickyListHeaders黏连头部表/">Android技术——StickyListHeaders黏连头部表</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>StickyListHeaders是在ListView之上封装的一个控件，在设置适配器的时候不仅要继承BaseAdapter还要实现StickyListHeadersAdapter。</p>
<p><img src="/2018/11/02/Android技术——StickyListHeaders黏连头部表/demo.gif" alt=""></p>
<hr>
<h3 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h3><p>github地址：<a href="https://github.com/emilsjolander/StickyListHeaders" target="_blank" rel="noopener">https://github.com/emilsjolander/StickyListHeaders</a></p>
<hr>
<h3 id="导入第三方框架"><a href="#导入第三方框架" class="headerlink" title="导入第三方框架"></a>导入第三方框架</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// StickyListHeaders</span><br><span class="line">implementation 'se.emilsjolander:stickylistheaders:2.7.0'</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="页面布局"><a href="#页面布局" class="headerlink" title="页面布局"></a>页面布局</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/02/Android技术——StickyListHeaders黏连头部表/" data-id="cjptr8u3s000568utg7mqk8hn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android技术——BottomSheetLayout底部弹出框" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/02/Android技术——BottomSheetLayout底部弹出框/" class="article-date">
  <time datetime="2018-11-02T09:03:00.000Z" itemprop="datePublished">2018-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/02/Android技术——BottomSheetLayout底部弹出框/">Android技术——BottomSheetLayout底部弹出框</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>类似于饿了么美团等点餐界面会有点击商家底部弹出购物车的界面，就可以用BottomSheetLayout底部弹出框控件实现。</p>
<p><img src="/2018/11/02/Android技术——BottomSheetLayout底部弹出框/demo.jpg" alt=""></p>
<hr>
<h3 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h3><p>github地址：<a href="https://github.com/Flipboard/bottomsheet" target="_blank" rel="noopener">https://github.com/Flipboard/bottomsheet</a></p>
<hr>
<h3 id="导入第三方框架"><a href="#导入第三方框架" class="headerlink" title="导入第三方框架"></a>导入第三方框架</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// BottomSheet</span><br><span class="line">implementation 'com.flipboard:bottomsheet-core:1.5.3'</span><br><span class="line">implementation 'com.flipboard:bottomsheet-commons:1.5.3'</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="页面布局"><a href="#页面布局" class="headerlink" title="页面布局"></a>页面布局</h3><p>主界面为activity_bottom_sheet.xml:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:padding</span>=<span class="string">"16dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".BottomSheet.BottomSheetActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 底部弹出长提的控件，只能有一个子节点，必须设置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.flipboard.bottomsheet.BottomSheetLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/bottomSheetLayout"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_above</span>=<span class="string">"@id/btn_show_bottomsheet"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">com.flipboard.bottomsheet.BottomSheetLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/btn_show_bottomsheet"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerHorizontal</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">"center_horizontal"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"显示BottomSheet"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>弹出界面bottom_sheet.xml，布局中包含三个按钮：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/button"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Button"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/button2"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Button"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/button3"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Button"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="控制"><a href="#控制" class="headerlink" title="控制"></a>控制</h3><p>BottomSheetActivity:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BottomSheetActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BindView</span>(R.id.bottomSheetLayout)</span><br><span class="line">    BottomSheetLayout bottomSheetLayout;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.btn_show_bottomsheet)</span><br><span class="line">    Button btnShowBottomsheet;</span><br><span class="line">    <span class="keyword">private</span> View bottomSheetView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_bottom_sheet);</span><br><span class="line">        ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OnClick</span>(R.id.btn_show_bottomsheet)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewClicked</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (bottomSheetView == <span class="keyword">null</span>) &#123;</span><br><span class="line">            bottomSheetView = View.inflate(<span class="keyword">this</span>, R.layout.bottom_sheet, <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 是否已经显示</span></span><br><span class="line">        <span class="keyword">if</span> (bottomSheetLayout.isSheetShowing())&#123;</span><br><span class="line">            <span class="comment">// 隐藏</span></span><br><span class="line">            bottomSheetLayout.dismissSheet();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 显示</span></span><br><span class="line">            bottomSheetLayout.showWithSheetView(bottomSheetView);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/11/02/Android技术——BottomSheetLayout底部弹出框/Gif.gif" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/02/Android技术——BottomSheetLayout底部弹出框/" data-id="cjptr8u3f000168utvsj82uew" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android技术——杂记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/30/Android技术——杂记/" class="article-date">
  <time datetime="2018-10-30T11:05:17.000Z" itemprop="datePublished">2018-10-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/30/Android技术——杂记/">Android技术——杂记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>目录</p>
<ol>
<li>随RecyclerView的滚动改变控件状态</li>
<li>沉浸式状态栏</li>
</ol>
<h3 id="技巧1：随RecyclerView的滚动改变控件状态"><a href="#技巧1：随RecyclerView的滚动改变控件状态" class="headerlink" title="技巧1：随RecyclerView的滚动改变控件状态"></a>技巧1：随RecyclerView的滚动改变控件状态</h3><p>技术点：RecyclerView的onScrollListener()；</p>
<p>注意上下层关系。<br>activity_recycler_view.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".jiqiao.RecyclerViewActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/rv_home"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/view"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"50dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">"#553190E8"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">"horizontal"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>RecyclerViewActivity.java:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.aijunhao.myproject.jiqiao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.animation.ArgbEvaluator;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.widget.LinearLayoutManager;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.widget.RecyclerView;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.aijunhao.myproject.R;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> butterknife.BindView;</span><br><span class="line"><span class="keyword">import</span> butterknife.ButterKnife;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RecyclerViewActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TRANSPARENT_COLOR = <span class="number">0x553190E8</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> UN_TRANSPARENT_COLOR = <span class="number">0xff3190E8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BindView</span>(R.id.rv_home)</span><br><span class="line">    RecyclerView rvHome;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.view)</span><br><span class="line">    View view;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * recyclerView滚动量及头部透明度设置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> sumY = <span class="number">0</span>;       <span class="comment">// recyclerView移动的增量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> duration = <span class="number">150.0f</span>;     <span class="comment">// 增量的最大值</span></span><br><span class="line">    <span class="keyword">private</span> ArgbEvaluator evaluator = <span class="keyword">new</span> ArgbEvaluator();      <span class="comment">// 透明度计算器</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_recycler_view);</span><br><span class="line">        ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        rvHome.setAdapter(<span class="keyword">new</span> HomeRecyclerViewAdapter());</span><br><span class="line">        rvHome.setLayoutManager(<span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>, LinearLayoutManager.VERTICAL, <span class="keyword">false</span>));</span><br><span class="line"></span><br><span class="line">        rvHome.addOnScrollListener(listener);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RecyclerView.OnScrollListener listener = <span class="keyword">new</span> RecyclerView.OnScrollListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrolled</span><span class="params">(RecyclerView recyclerView, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>.onScrolled(recyclerView, dx, dy);</span><br><span class="line">            <span class="comment">// 滑动增量</span></span><br><span class="line">            sumY += dy;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 根据增量值得到透明度</span></span><br><span class="line">            <span class="keyword">int</span> bgColor;</span><br><span class="line">            <span class="keyword">if</span> (sumY &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                bgColor = TRANSPARENT_COLOR;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sumY &gt; duration) &#123;</span><br><span class="line">                bgColor = UN_TRANSPARENT_COLOR;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                bgColor = (<span class="keyword">int</span>) evaluator.evaluate(sumY / duration, TRANSPARENT_COLOR, UN_TRANSPARENT_COLOR);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 设置头容器的背景色</span></span><br><span class="line">            view.setBackgroundColor(bgColor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeRecyclerViewAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">RecyclerView</span>.<span class="title">ViewHolder</span>&gt; </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> RecyclerView.<span class="function">ViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span> </span>&#123;</span><br><span class="line">            View view = View.inflate(parent.getContext(), R.layout.item_home_common, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> CommonHolder(view);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(RecyclerView.ViewHolder holder, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            ((CommonHolder) holder).tv.setText(<span class="string">"position:"</span> + position);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">50</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> </span>&#123;</span><br><span class="line">        TextView tv;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">CommonHolder</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(view);</span><br><span class="line">            tv = (TextView) view.findViewById(R.id.tv);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>item_home_common.xml:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/tv"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerHorizontal</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">" "</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="技巧2：沉浸式状态栏"><a href="#技巧2：沉浸式状态栏" class="headerlink" title="技巧2：沉浸式状态栏"></a>技巧2：沉浸式状态栏</h3><p>沉浸式状态栏，就是设置android页面的顶部的一个状态栏透明，并且让界面中的内容嵌入到状态栏中。只要设置style的样式即可。</p>
<p>因为android版本问题，需要针对不用的版本设置不同的style，系统会根据版本去使用相应的style样式。</p>
<p>普通values包下的styles.xml默认即可：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Base application theme. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- Customize your theme here. --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>values-v19包下的styles.xml：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Base application theme. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- Customize your theme here. --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowTranslucentStatus"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowTranslucentNavigation"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>values-v21包下的styles.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Base application theme. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- Customize your theme here. --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowTranslucentStatus"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowTranslucentNavigation"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:statusBarColor"</span>&gt;</span>@android:color/transparent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>如此，就可以实现沉浸式状态栏。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/30/Android技术——杂记/" data-id="cjptr8u6y000h68ut0mzgghnn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Android技术——软件框架" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/27/Android技术——软件框架/" class="article-date">
  <time datetime="2018-10-27T07:26:14.000Z" itemprop="datePublished">2018-10-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/27/Android技术——软件框架/">Android技术——主流项目架构(重点)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>此节主要讲的是项目开发过程中的一些技巧和软件框架的搭建。</p>
<hr>
<h2 id="MVP模式"><a href="#MVP模式" class="headerlink" title="MVP模式"></a>MVP模式</h2><p>简称：MVP 全称：Model-View-Presenter ；MVP 是从经典的模式MVC演变而来，它们的基本思想有相通的地方：Controller/Presenter负责逻辑的处理，Model提供数据，View负责显示。</p>
<h3 id="MVC模式"><a href="#MVC模式" class="headerlink" title="MVC模式"></a>MVC模式</h3><p>MVC模式的结构分为三部分，实体层的Model，视图层的View，以及控制层的Controller。</p>
<p><img src="/2018/10/27/Android技术——软件框架/mvc.png" alt=""></p>
<ul>
<li>其中View层其实就是程序的UI界面，用于向用户展示数据以及接收用户的输入</li>
<li>而Model层就是JavaBean实体类，用于保存实例数据</li>
<li>Controller控制器用于更新UI界面和数据实例</li>
</ul>
<h3 id="MVP模式-1"><a href="#MVP模式-1" class="headerlink" title="MVP模式"></a>MVP模式</h3><p>在Android项目中，Activity和Fragment占据了大部分的开发工作。如果有一种设计模式（或者说代码结构）专门是为优化Activity和Fragment的代码而产生的，你说这种模式重要不？这就是MVP设计模式。</p>
<p>按照MVC的分层，Activity和Fragment（后面只说Activity）应该属于View层，用于展示UI界面，以及接收用户的输入，此外还要承担一些生命周期的工作。Activity是在Android开发中充当非常重要的角色，特别是TA的生命周期的功能，所以开发的时候我们经常把一些业务逻辑直接写在Activity里面，这非常直观方便，代价就是Activity会越来越臃肿，超过1000行代码是常有的事，而且如果是一些可以通用的业务逻辑（比如用户登录），写在具体的Activity里就意味着这个逻辑不能复用了。如果有进行代码重构经验的人，看到1000+行的类肯定会有所顾虑。因此，Activity不仅承担了View的角色，还承担了一部分的Controller角色，这样一来V和C就耦合在一起了，虽然这样写方便，但是如果业务调整的话，要维护起来就难了，而且在一个臃肿的Activity类查找业务逻辑的代码也会非常蛋疼，所以看起来有必要在Activity中，把View和Controller抽离开来，而这就是MVP模式的工作。</p>
<p><img src="/2018/10/27/Android技术——软件框架/mvp.png" alt=""></p>
<p>优点：</p>
<ol>
<li>模型与视图完全分离，我们可以修改视图而不影响模型</li>
<li>可以更高效地使用模型，因为所有的交互都发生在一个地方——Presenter内部</li>
<li>我们可以将一个Presenter用于多个视图，而不需要改变Presenter的逻辑。这个特性非常的有用，因为视图的变化总是比模型的变化频繁。</li>
<li>如果我们把逻辑放在Presenter中，那么我们就可以脱离用户接口来测试这些逻辑（单元测试）</li>
</ol>
<hr>
<h2 id="Dagger2降低层与层之间的耦合"><a href="#Dagger2降低层与层之间的耦合" class="headerlink" title="Dagger2降低层与层之间的耦合"></a>Dagger2降低层与层之间的耦合</h2><p>使用MVP模式之后，虽然层与层之间已经拆分开来，但是层与层之间的耦合还是非常高，<br>Dagger是为Android和Java平台提供的在编译时进行依赖注入的框架。降低MVP层与层之间的耦合。</p>
<h3 id="dagger2的依赖配置"><a href="#dagger2的依赖配置" class="headerlink" title="dagger2的依赖配置"></a>dagger2的依赖配置</h3><p>在Project的build.gradle中添加butterknife插件：</p>
<p>在module:xx的build.gradle中：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line"></span><br><span class="line">    // butterknife</span><br><span class="line">    implementation 'com.jakewharton:butterknife:8.8.1'</span><br><span class="line">    annotationProcessor 'com.jakewharton:butterknife-compiler:8.8.1'</span><br><span class="line"></span><br><span class="line">    // dagger2</span><br><span class="line">    implementation 'com.google.dagger:dagger:2.18'</span><br><span class="line">    annotationProcessor 'com.google.dagger:dagger-compiler:2.18'</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="ButterKnife插件"><a href="#ButterKnife插件" class="headerlink" title="ButterKnife插件"></a>ButterKnife插件</h2><p>ButterKnife是一个专注于Android系统的View注入框架,以前总是要写很多findViewById来找到View对象，有了ButterKnife可以很轻松的省去这些步骤。是大神JakeWharton的力作，目前使用很广。最重要的一点，使用ButterKnife对性能基本没有损失，因为ButterKnife用到的注解并不是在运行时反射的，而是在编译的时候生成新的class。项目集成起来也是特别方便，使用起来也是特别简单。</p>
<p>ButterKnife项目地址: <a href="https://github.com/JakeWharton/butterknife" target="_blank" rel="noopener">https://github.com/JakeWharton/butterknife</a></p>
<h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><p>打开Android Studio中的设置界面,并且点击左边的插件Plugins，在搜索框中输入 “Android ButterKnife Zelezny “</p>
<p><img src="/2018/10/27/Android技术——软件框架/find.png" alt=""></p>
<p>点击”Search in repositories”。</p>
<p><img src="/2018/10/27/Android技术——软件框架/butterknife.png" alt=""></p>
<p>点击“Install”，完成下载后重新AS即可。</p>
<h3 id="添加依赖和使用插件"><a href="#添加依赖和使用插件" class="headerlink" title="添加依赖和使用插件"></a>添加依赖和使用插件</h3><p>ButterKnife插件使用时需要在响应的module中添加依赖并在mudule中使用插件。</p>
<p>在Project的build.gradle中添加butterknife插件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    </span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath 'com.android.tools.build:gradle:3.1.2'</span><br><span class="line"></span><br><span class="line">        // 生成代码工具，butterknife插件</span><br><span class="line">        classpath 'com.jakewharton:butterknife-gradle-plugin:8.8.1'</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在module:xx的build.gradle中：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: 'com.jakewharton.butterknife'     // 如果出错，这一行删掉</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line"></span><br><span class="line">    // 这两行需要</span><br><span class="line">    implementation 'com.jakewharton:butterknife:8.8.1'</span><br><span class="line">    annotationProcessor 'com.jakewharton:butterknife-compiler:8.8.1'</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="使用插件"><a href="#使用插件" class="headerlink" title="使用插件"></a>使用插件</h3><p>在java文件中，选中setContnetView中的布局文件，右键选择”Generate”：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_main);</span><br><span class="line">    ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>点击Butterknife。</p>
<p><img src="/2018/10/27/Android技术——软件框架/generate.png" alt=""></p>
<p>选择需要创建的项目。</p>
<p><img src="/2018/10/27/Android技术——软件框架/jb.png" alt=""></p>
<p>如下界面就是使用butterknife快速创建好的代码。<br><img src="/2018/10/27/Android技术——软件框架/main.png" alt=""></p>
<hr>
<h2 id="Retrofit联网框架"><a href="#Retrofit联网框架" class="headerlink" title="Retrofit联网框架"></a>Retrofit联网框架</h2><p>Retrofit是一个功能强大的联网工具，可以看成OKHttp + 数据解析的组合。</p>
<p>项目地址：<a href="https://github.com/square/retrofit" target="_blank" rel="noopener">https://github.com/square/retrofit</a></p>
<p>文档介绍：<a href="https://square.github.io/retrofit/" target="_blank" rel="noopener">https://square.github.io/retrofit/</a></p>
<h3 id="配置Retrofit"><a href="#配置Retrofit" class="headerlink" title="配置Retrofit"></a>配置Retrofit</h3><p>比如添加retrofit 和 gson 以及两者之间的关联：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// retrofit + gson + 关联</span><br><span class="line">implementation 'com.squareup.retrofit2:retrofit:2.4.0'</span><br><span class="line">implementation 'com.google.code.gson:gson:2.8.5'</span><br><span class="line">implementation 'com.squareup.retrofit2:converter-gson:2.4.0'</span><br></pre></td></tr></table></figure></p>
<p>需要解析时要添加如下对应的依赖。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Gson: com.squareup.retrofit2:converter-gson</span><br><span class="line">Jackson: com.squareup.retrofit2:converter-jackson</span><br><span class="line">Moshi: com.squareup.retrofit2:converter-moshi</span><br><span class="line">Protobuf: com.squareup.retrofit2:converter-protobuf</span><br><span class="line">Wire: com.squareup.retrofit2:converter-wire</span><br><span class="line">Simple XML: com.squareup.retrofit2:converter-simplexml</span><br><span class="line">Scalars (primitives, boxed, and String): com.squareup.retrofit2:converter-scalars</span><br></pre></td></tr></table></figure></p>
<h3 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h3><ol>
<li><p>创建Retorfit.Builder对象，通过Builder指定j基本配置信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Retrofit.Builder builder = <span class="keyword">new</span> Retrofit.Builder();</span><br><span class="line">    builder.baseUrl(URL);</span><br><span class="line">    builder.addConverterFactory(GsonConverterFactory.create());     <span class="comment">// Gson解析</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置链接和参数</p>
</li>
</ol>
<hr>
<h2 id="Ormlite数据库操作工具"><a href="#Ormlite数据库操作工具" class="headerlink" title="Ormlite数据库操作工具"></a>Ormlite数据库操作工具</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/27/Android技术——软件框架/" data-id="cjptr8u70000i68utwil9dvxn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Html5-Css/">Html5/Css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Html-Css/">Html_Css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book/">book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/介绍/">介绍</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Html5-Css/" style="font-size: 10px;">Html5/Css</a> <a href="/tags/Html-Css/" style="font-size: 10px;">Html_Css</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/book/" style="font-size: 10px;">book</a> <a href="/tags/介绍/" style="font-size: 10px;">介绍</a> <a href="/tags/小程序/" style="font-size: 10px;">小程序</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/12/18/JavaScript基础/">JavaScript基础</a>
          </li>
        
          <li>
            <a href="/2018/12/14/前端-Html_Css常见问题解决/">前端 - Html_Css常见问题解决</a>
          </li>
        
          <li>
            <a href="/2018/12/11/《第一行代码-Android》第12章_最佳的UI体验/">《第一行代码_Android》第12章_最佳的UI体验</a>
          </li>
        
          <li>
            <a href="/2018/12/04/《Android开发艺术探索》第1章_Activity的生命周期和启动模式/">《Android开发艺术探索》第1章_Activity的生命周期和启动模式</a>
          </li>
        
          <li>
            <a href="/2018/11/12/Android技术——LBS/">Android特色开发—LBS(基于位置的服务)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Ai Junhao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>