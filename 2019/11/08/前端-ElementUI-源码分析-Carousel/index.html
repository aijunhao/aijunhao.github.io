<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>前端-ElementUI-源码分析-Carousel | Hello, I&#39;m Junhao Ai.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Carousel 介绍 Carousel 属性 Carousel 事件 Carousel 方法 Carousel-Item 子项属性 Carousel 基础用法 Carousel 源码分析 思路简介 文件说明 生命周期 created setActiveItem(index) items(val) activeIndex(val, oldVal) resetItemPosition(oldIn">
<meta name="keywords" content="前端,JavaScript,Vue,ElementUI">
<meta property="og:type" content="article">
<meta property="og:title" content="前端-ElementUI-源码分析-Carousel">
<meta property="og:url" content="http://yoursite.com/2019/11/08/前端-ElementUI-源码分析-Carousel/index.html">
<meta property="og:site_name" content="Hello, I&#39;m Junhao Ai.">
<meta property="og:description" content="Carousel 介绍 Carousel 属性 Carousel 事件 Carousel 方法 Carousel-Item 子项属性 Carousel 基础用法 Carousel 源码分析 思路简介 文件说明 生命周期 created setActiveItem(index) items(val) activeIndex(val, oldVal) resetItemPosition(oldIn">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-11-21T12:41:44.370Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="前端-ElementUI-源码分析-Carousel">
<meta name="twitter:description" content="Carousel 介绍 Carousel 属性 Carousel 事件 Carousel 方法 Carousel-Item 子项属性 Carousel 基础用法 Carousel 源码分析 思路简介 文件说明 生命周期 created setActiveItem(index) items(val) activeIndex(val, oldVal) resetItemPosition(oldIn">
  
    <link rel="alternate" href="/atom.xml" title="Hello, I&#39;m Junhao Ai." type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hello, I&#39;m Junhao Ai.</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-前端-ElementUI-源码分析-Carousel" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/11/08/前端-ElementUI-源码分析-Carousel/" class="article-date">
  <time datetime="2019-11-08T02:30:00.000Z" itemprop="datePublished">2019-11-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      前端-ElementUI-源码分析-Carousel
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- TOC -->
<ul>
<li><a href="#carousel-介绍">Carousel 介绍</a></li>
<li><a href="#carousel-属性">Carousel 属性</a></li>
<li><a href="#carousel-事件">Carousel 事件</a></li>
<li><a href="#carousel-方法">Carousel 方法</a></li>
<li><a href="#carousel-item-子项属性">Carousel-Item 子项属性</a></li>
<li><a href="#carousel-基础用法">Carousel 基础用法</a></li>
<li><a href="#carousel-源码分析">Carousel 源码分析</a><ul>
<li><a href="#思路简介">思路简介</a></li>
<li><a href="#文件说明">文件说明</a></li>
<li><a href="#生命周期">生命周期</a><ul>
<li><a href="#created">created</a><ul>
<li><a href="#setactiveitemindex">setActiveItem(index)</a></li>
<li><a href="#itemsval">items(val)</a></li>
<li><a href="#activeindexval-oldval">activeIndex(val, oldVal)</a></li>
<li><a href="#resetitempositionoldindex">resetItemPosition(oldIndex)</a></li>
<li><a href="#handleindicatorhoverindex">handleIndicatorHover(index)</a></li>
</ul>
</li>
<li><a href="#mounted">mounted</a><ul>
<li><a href="#updateitems">updateItems()</a></li>
<li><a href="#nexttick--">nextTick(() =&gt; {})</a></li>
<li><a href="#starttimer">startTimer()</a></li>
<li><a href="#playslides">playSlides()</a></li>
</ul>
</li>
<li><a href="#beforedestroy">beforeDestroy</a></li>
</ul>
</li>
<li><a href="#结构及样式分析">结构及样式分析</a><ul>
<li><a href="#轮播图组件整体">轮播图组件整体</a><ul>
<li><a href="#carouselclasses">carouselClasses</a><ul>
<li><a href="#el-carousel">el-carousel</a></li>
<li><a href="#el-carousel--horizontalvertical">el-carousel–[horizontal/vertical]</a></li>
<li><a href="#el-carousel--card">el-carousel–card</a></li>
</ul>
</li>
<li><a href="#handlemouseenter--handlemouseleave">handleMouseEnter() / handleMouseLeave()</a></li>
</ul>
</li>
<li><a href="#轮播图主体部分">轮播图主体部分</a><ul>
<li><a href="#el-carousel__container">el-carousel__container</a></li>
</ul>
</li>
<li><a href="#箭头按钮">箭头按钮</a><ul>
<li><a href="#transition-按钮过渡动画">transition 按钮过渡动画</a></li>
<li><a href="#button-按钮主体">button 按钮主体</a><ul>
<li><a href="#handlebuttonenterarrow--handlebuttonleave">handleButtonEnter(arrow) / handleButtonLeave()</a></li>
<li><a href="#iteminstage">itemInStage()</a></li>
<li><a href="#throttledarrowclick">throttledArrowClick()</a></li>
<li><a href="#el-carousel__arrow">el-carousel__arrow</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#子组件插槽">子组件插槽</a></li>
<li><a href="#指示器部分">指示器部分</a><pre><code>- [indicatorsClasses](#indicatorsclasses)
- [el-carousel__indicators](#el-carousel__indicators)
- [el-carousel__indicators--[horizontal/vertical]](#el-carousel__indicators--horizontalvertical)
- [el-carousel__indicators--outside](#el-carousel__indicators--outside)
- [el-carousel__indicators--labels](#el-carousel__indicators--labels)
</code></pre></li>
</ul>
</li>
</ul>
</li>
<li><a href="#carousel-item-源码分析">Carousel-item 源码分析</a><ul>
<li><a href="#生命周期-1">生命周期</a><ul>
<li><a href="#created--destroyed">created / destroyed</a></li>
</ul>
</li>
<li><a href="#结构及样式分析-1">结构及样式分析</a><ul>
<li><a href="#子组件整体">子组件整体</a><ul>
<li><a href="#translateitemindex-activeindex-oldindex">translateItem(index, activeIndex, oldIndex)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="Carousel-介绍"><a href="#Carousel-介绍" class="headerlink" title="Carousel 介绍"></a>Carousel 介绍</h2><p> <code>Carousel</code> 指走马灯/轮播图等。即在有限空间内，循环播放同一类型的图片、文字等内容。</p>
<p>一个完整的 <code>Carousel</code> 由 <code>el-carousel</code> 父容器和 <code>el-carousel-item</code> 子项标签组成。通常我们在<code>el-carousel</code> 父容器标签中的 <code>el-carousel-item</code> 子项标签上使用 <code>v-for</code> 指令来遍历数组，生成需要的子项。</p>
<p>这个 <code>Carousel</code> 有一个轮播时间间隔，以及底部的指示器和切换箭头按钮。组件有做防抖和节流。</p>
<h2 id="Carousel-属性"><a href="#Carousel-属性" class="headerlink" title="Carousel 属性"></a>Carousel 属性</h2><table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>类型</th>
<th>可选值</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>height</td>
<td>走马灯的高度</td>
<td>string</td>
<td>—</td>
<td>—</td>
</tr>
<tr>
<td>initial-index</td>
<td>初始状态激活的幻灯片的索引，从 0 开始</td>
<td>number</td>
<td>—</td>
<td>0</td>
</tr>
<tr>
<td>trigger</td>
<td>指示器的触发方式</td>
<td>string</td>
<td>click</td>
<td>—</td>
</tr>
<tr>
<td>autoplay</td>
<td>是否自动切换</td>
<td>boolean</td>
<td>—</td>
<td>true</td>
</tr>
<tr>
<td>interval</td>
<td>自动切换的时间间隔，单位为毫秒</td>
<td>number</td>
<td>—</td>
<td>3000</td>
</tr>
<tr>
<td>indicator-position</td>
<td>指示器的位置</td>
<td>string</td>
<td>outside/none</td>
<td>—</td>
</tr>
<tr>
<td>arrow</td>
<td>切换箭头的显示时机</td>
<td>string</td>
<td>always/hover/never</td>
<td>hover</td>
</tr>
<tr>
<td>type</td>
<td>走马灯的类型</td>
<td>string</td>
<td>card</td>
<td>—</td>
</tr>
<tr>
<td>loop</td>
<td>是否循环显示</td>
<td>boolean</td>
<td>-</td>
<td>true</td>
</tr>
<tr>
<td>direction</td>
<td>走马灯展示的方向</td>
<td>string</td>
<td>horizontal/vertical</td>
<td>horizontal</td>
</tr>
</tbody>
</table>
<h2 id="Carousel-事件"><a href="#Carousel-事件" class="headerlink" title="Carousel 事件"></a>Carousel 事件</h2><table>
<thead>
<tr>
<th>事件名称</th>
<th>说明</th>
<th>回调参数</th>
</tr>
</thead>
<tbody>
<tr>
<td>change</td>
<td>幻灯片切换时触发</td>
<td>目前激活的幻灯片的索引，原幻灯片的索引</td>
</tr>
</tbody>
</table>
<h2 id="Carousel-方法"><a href="#Carousel-方法" class="headerlink" title="Carousel 方法"></a>Carousel 方法</h2><table>
<thead>
<tr>
<th>方法名</th>
<th>说明</th>
<th>参数</th>
</tr>
</thead>
<tbody>
<tr>
<td>setActiveItem</td>
<td>手动切换幻灯片</td>
<td>需要切换的幻灯片的索引，从 0 开始；或相应 <code>el-carousel-item</code> 的 <code>name</code> 属性值</td>
</tr>
<tr>
<td>prev</td>
<td>切换至上一张幻灯片</td>
<td>—</td>
</tr>
<tr>
<td>next</td>
<td>切换至下一张幻灯片</td>
<td>—</td>
</tr>
</tbody>
</table>
<h2 id="Carousel-Item-子项属性"><a href="#Carousel-Item-子项属性" class="headerlink" title="Carousel-Item 子项属性"></a>Carousel-Item 子项属性</h2><table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>类型</th>
<th>可选值</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>幻灯片的名字，可用作 <code>setActiveItem</code> 的参数</td>
<td>string</td>
<td>—</td>
<td>—</td>
</tr>
<tr>
<td>label</td>
<td>该幻灯片所对应指示器的文本</td>
<td>string</td>
<td>—</td>
<td>—</td>
</tr>
</tbody>
</table>
<h2 id="Carousel-基础用法"><a href="#Carousel-基础用法" class="headerlink" title="Carousel 基础用法"></a>Carousel 基础用法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-carousel&gt;</span><br><span class="line">      &lt;el-carousel-item v-for=&quot;item in 4&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;h3&gt;&#123;&#123; item &#125;&#125;&lt;/h3&gt;</span><br><span class="line">      &lt;/el-carousel-item&gt;</span><br><span class="line">    &lt;/el-carousel&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.el-carousel__item h3 &#123;</span><br><span class="line">  color: #475669;</span><br><span class="line">  font-size: 14px;</span><br><span class="line">  opacity: 0.75;</span><br><span class="line">  line-height: 200px;</span><br><span class="line">  margin: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-carousel__item:nth-child(2n) &#123;</span><br><span class="line">  background-color: #99a9bf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-carousel__item:nth-child(2n + 1) &#123;</span><br><span class="line">  background-color: #d3dce6;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Carousel-源码分析"><a href="#Carousel-源码分析" class="headerlink" title="Carousel 源码分析"></a>Carousel 源码分析</h2><h3 id="思路简介"><a href="#思路简介" class="headerlink" title="思路简介"></a>思路简介</h3><p>在传统的轮播图中，采用的往往都是创建一个重复项放在轮播图 -1 页，然后将所有子项拼接成一个大整体，对整体进行平移复位操作。而在 <code>ElementUI</code> 采用的是分别平移复位众多子项，这样的作法的好处就是不用创建轮播图，并且方便对不同子项进行操作，比如缩放子项实现卡片切换。</p>
<font color="red">这样的作法也有一个坏处。当我们快速切换页面的时候如果不能实现协调，将造成一瞬间的空白页。可以前往官网首页快速反复滑动指示器进行切换尝试。</font>

<h3 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明"></a>文件说明</h3><p>相关文件路径：</p>
<p><code>packages/theme-chalk/src/common/var.scss</code> 变量名文件</p>
<p><code>packages/theme-chalk/carousel.scss</code> 父容器样式文件</p>
<p><code>packages/theme-chalk/carousel-item.scss</code> 子项样式文件</p>
<p><code>packages/theme-chalk/minxins.scss</code> 混入样式文件</p>
<p>源码见：<br><a href="https://github.com/ElemeFE/element/blob/dev/packages/carousel/src/main.vue" target="_blank" rel="noopener">https://github.com/ElemeFE/element/blob/dev/packages/carousel/src/main.vue</a></p>
<p>注解见：<a href="https://github.com/aijunhao/ElementUINote/blob/master/packages/carousel/src/main.vue" target="_blank" rel="noopener">https://github.com/aijunhao/ElementUINote/blob/master/packages/carousel/src/main.vue</a></p>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><h4 id="created"><a href="#created" class="headerlink" title="created"></a>created</h4><p>在 <code>created</code> 阶段主要就是定义了箭头按钮和指示器鼠标悬浮的函数，规定 300ms 内只能执行一次。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">  <span class="comment">// 箭头点击的回调函数，使用 throttle 节流, 300ms 内只调用一次</span></span><br><span class="line">  <span class="keyword">this</span>.throttledArrowClick = throttle(<span class="number">300</span>, <span class="literal">true</span>, index =&gt; &#123;</span><br><span class="line">    <span class="keyword">this</span>.setActiveItem(index);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 鼠标悬浮指示器的回调函数，使用 throttle 节流，300ms 内只调用一次</span></span><br><span class="line">  <span class="keyword">this</span>.throttledIndicatorHover = throttle(<span class="number">300</span>, index =&gt; &#123;</span><br><span class="line">    <span class="keyword">this</span>.handleIndicatorHover(index);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><code>throttle</code> 是一个第三方工具，节流函数，通过 <code>import throttle from &#39;throttle-debounce/throttle&#39;;</code> 导入。</p>
<p>其作用是用来在一定时间内限定某函数的调用。第二个参数 <code>noTrailing</code> ，当其设置为 <code>true</code> 时，保证函数在一定时间内只能执行一次，如果设置为<code>false</code>或者没有指定，则会在最后一次函数调用后重置计时器。</p>
<p><code>throttle</code> 函数详情见 <code>npm</code> ：<a href="https://www.npmjs.com/package/throttle-debounce" target="_blank" rel="noopener">https://www.npmjs.com/package/throttle-debounce</a></p>
<h5 id="setActiveItem-index"><a href="#setActiveItem-index" class="headerlink" title="setActiveItem(index)"></a>setActiveItem(index)</h5><p><code>setActiveItem</code> 是用来设置当前页。允许使用指定名字和指定索引两种方式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置当前页</span></span><br><span class="line"><span class="comment">     * index: 索引</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    setActiveItem(index) &#123;</span><br><span class="line">      <span class="comment">// 字符串处理，如果索引是字符串，说明是指定名字的</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> index === <span class="string">'string'</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> filteredItems = <span class="keyword">this</span>.items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.name === index);</span><br><span class="line">        <span class="keyword">if</span> (filteredItems.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          index = <span class="keyword">this</span>.items.indexOf(filteredItems[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      index = <span class="built_in">Number</span>(index);</span><br><span class="line">      <span class="comment">// 非正常数字和浮点数处理</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">isNaN</span>(index) || index !== <span class="built_in">Math</span>.floor(index)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.warn(<span class="string">'[Element Warn][Carousel]index must be an integer.'</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> length = <span class="keyword">this</span>.items.length;</span><br><span class="line">      <span class="keyword">const</span> oldIndex = <span class="keyword">this</span>.activeIndex;</span><br><span class="line">      <span class="keyword">if</span> (index &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 右移尽头处理</span></span><br><span class="line">        <span class="keyword">this</span>.activeIndex = <span class="keyword">this</span>.loop ? length - <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index &gt;= length) &#123;</span><br><span class="line">        <span class="comment">// 左移尽头处理</span></span><br><span class="line">        <span class="keyword">this</span>.activeIndex = <span class="keyword">this</span>.loop ? <span class="number">0</span> : length - <span class="number">1</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 普通情况</span></span><br><span class="line">        <span class="keyword">this</span>.activeIndex = index;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (oldIndex === <span class="keyword">this</span>.activeIndex) &#123;</span><br><span class="line">        <span class="keyword">this</span>.resetItemPosition(oldIndex);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用的属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// carousel-item 的 dom 节点数组</span></span><br><span class="line">    items: [],</span><br><span class="line">    <span class="comment">// 激活的 index</span></span><br><span class="line">    activeIndex: <span class="number">-1</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h5 id="items-val"><a href="#items-val" class="headerlink" title="items(val)"></a>items(val)</h5><p>对 <code>items</code> 进行监听，当数组变动时重新设置当前页。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  items(val) &#123;</span><br><span class="line">    <span class="keyword">if</span> (val.length &gt; <span class="number">0</span>) <span class="keyword">this</span>.setActiveItem(<span class="keyword">this</span>.initialIndex);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h5 id="activeIndex-val-oldVal"><a href="#activeIndex-val-oldVal" class="headerlink" title="activeIndex(val, oldVal)"></a>activeIndex(val, oldVal)</h5><p>对 <code>activeIndex</code> 进行监听，当前激活索引改变时，重置子项位置并发送 <code>change</code> 事件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  <span class="comment">// 激活的 index 索引</span></span><br><span class="line">  activeIndex(val, oldVal) &#123;</span><br><span class="line">    <span class="keyword">this</span>.resetItemPosition(oldVal);</span><br><span class="line">    <span class="comment">// 发送change事件</span></span><br><span class="line">    <span class="keyword">if</span> (oldVal &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">'change'</span>, val, oldVal);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h5 id="resetItemPosition-oldIndex"><a href="#resetItemPosition-oldIndex" class="headerlink" title="resetItemPosition(oldIndex)"></a>resetItemPosition(oldIndex)</h5><p><code>resetItemPosition</code> 是重置子项位置。其中 <code>item.translateItem()</code> 是子组件 <code>Carousel-item</code> 的方法，是用来子组件移动的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> methods: &#123;    </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 重置 item 子项位置</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   resetItemPosition(oldIndex) &#123;</span><br><span class="line">     <span class="keyword">this</span>.items.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="comment">// 子组件方法</span></span><br><span class="line">       item.translateItem(index, <span class="keyword">this</span>.activeIndex, oldIndex);</span><br><span class="line">     &#125;);</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h5 id="handleIndicatorHover-index"><a href="#handleIndicatorHover-index" class="headerlink" title="handleIndicatorHover(index)"></a>handleIndicatorHover(index)</h5><p>只有 <code>trigger</code> 指示器触发方式为 <code>hover</code> 时使用，进行索引切换。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 指示器鼠标悬浮事件</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  handleIndicatorHover(index) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.trigger === <span class="string">'hover'</span> &amp;&amp; index !== <span class="keyword">this</span>.activeIndex) &#123;</span><br><span class="line">      <span class="keyword">this</span>.activeIndex = index;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  <span class="comment">// 指示器的触发方式</span></span><br><span class="line">  trigger: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">'hover'</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h4 id="mounted"><a href="#mounted" class="headerlink" title="mounted"></a>mounted</h4><p>进行初始化 <code>items</code> 数组，尺寸更新监听和启动计时器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  <span class="keyword">this</span>.updateItems();</span><br><span class="line">  <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 添加尺寸更新监听</span></span><br><span class="line">    addResizeListener(<span class="keyword">this</span>.$el, <span class="keyword">this</span>.resetItemPosition);</span><br><span class="line">    <span class="comment">// 初始化索引</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.initialIndex &lt; <span class="keyword">this</span>.items.length &amp;&amp; <span class="keyword">this</span>.initialIndex &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.activeIndex = <span class="keyword">this</span>.initialIndex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.startTimer();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h5 id="updateItems"><a href="#updateItems" class="headerlink" title="updateItems()"></a>updateItems()</h5><p><code>this</code> 就是父组件 <code>Vue</code> 实例，通过 <code>$children</code> 获取子组件数组，筛选出子组件中 <code>name</code> 字段为 <code>ElCarouselItem</code> 的组件。</p>
<font color="red">也就是说，在我们使用的使用必须将需要轮播的内容放在子组件 <el-carousel-item></el-carousel-item> 标签中，否则将无法加入轮播，只能是背景。</font>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 更新子组件节点</span></span><br><span class="line"><span class="comment">   * 子组件的 name 为 ElCarouselItem，筛选出所有符合要求的子组件，即</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  updateItems() &#123;</span><br><span class="line">    <span class="keyword">this</span>.items = <span class="keyword">this</span>.$children.filter(<span class="function"><span class="params">child</span> =&gt;</span> child.$options.name === <span class="string">'ElCarouselItem'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// item.vue</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: <span class="string">'ElCarouselItem'</span>,</span><br><span class="line"></span><br><span class="line">    props: &#123;</span><br><span class="line">      name: <span class="built_in">String</span>,</span><br><span class="line">      label: &#123;</span><br><span class="line">        type: [<span class="built_in">String</span>, <span class="built_in">Number</span>],</span><br><span class="line">        <span class="keyword">default</span>: <span class="string">''</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h5 id="nextTick-gt"><a href="#nextTick-gt" class="headerlink" title="nextTick(() =&gt; {})"></a>nextTick(() =&gt; {})</h5><p> 在下次 DOM 更新循环结束之后执行延迟回调。 </p>
<p>添加 <code>resize</code> 事件的回调和初始化索引。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  <span class="comment">// 初始状态激活的幻灯片的索引，从 0 开始</span></span><br><span class="line">  initialIndex: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h5 id="startTimer"><a href="#startTimer" class="headerlink" title="startTimer()"></a>startTimer()</h5><p><code>startTimer</code> 是开启定时器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="comment">// 开始轮播</span></span><br><span class="line">  startTimer() &#123;</span><br><span class="line">    <span class="comment">// (interval 间隔时间为负数，autoplay 为 false，timer 定时器不为空) 时返回</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.interval &lt;= <span class="number">0</span> || !<span class="keyword">this</span>.autoplay || <span class="keyword">this</span>.timer) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">this</span>.timer = setInterval(<span class="keyword">this</span>.playSlides, <span class="keyword">this</span>.interval);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中 <code>interval</code> 是切换时间间隔，<code>autoplay</code> 是自动播放，<code>timer</code> 是全局定时器对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  autoplay: &#123;</span><br><span class="line">    type: <span class="built_in">Boolean</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 自动切换的时间间隔</span></span><br><span class="line">  interval: &#123;</span><br><span class="line">    type: <span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="number">3000</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">    </span><br><span class="line">data() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 定时器对象</span></span><br><span class="line">    timer: <span class="literal">null</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h5 id="playSlides"><a href="#playSlides" class="headerlink" title="playSlides()"></a>playSlides()</h5><p><code>playSlides</code> 是改变索引的方法，切换 <code>activeIndex</code> 进行换页。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="comment">// 开始轮播，只是控制索引</span></span><br><span class="line">  playSlides() &#123;</span><br><span class="line">    <span class="comment">// 如果 当前激活索引 &lt; (数组长度-1)，索引自加翻页。</span></span><br><span class="line">    <span class="comment">// 如果超出了，并且 loop 为 true 循环，则索引置 0</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.activeIndex &lt; <span class="keyword">this</span>.items.length - <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.activeIndex++;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.loop) &#123;</span><br><span class="line">      <span class="keyword">this</span>.activeIndex = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="beforeDestroy"><a href="#beforeDestroy" class="headerlink" title="beforeDestroy"></a>beforeDestroy</h4><p> 销毁前移除事件监听和定时器。 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">beforeDestroy() &#123;</span><br><span class="line">  <span class="comment">// 移除尺寸更新监听</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.$el) removeResizeListener(<span class="keyword">this</span>.$el, <span class="keyword">this</span>.resetItemPosition);</span><br><span class="line">  <span class="keyword">this</span>.pauseTimer();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="结构及样式分析"><a href="#结构及样式分析" class="headerlink" title="结构及样式分析"></a>结构及样式分析</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">// main.vue 主要结构简化代码</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div :class=&quot;carouselClasses&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 切换按钮及轮播内容 --&gt;</span><br><span class="line">    &lt;div class=&quot;el-carousel__container&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- </span><br><span class="line">        左右切换箭头按钮</span><br><span class="line">       --&gt;</span><br><span class="line">      &lt;transition&gt;</span><br><span class="line">        &lt;button&gt;</span><br><span class="line">          &lt;i class=&quot;el-icon-arrow-left&quot;&gt;&lt;/i&gt;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/transition&gt;</span><br><span class="line">      &lt;transition&gt;</span><br><span class="line">        &lt;button&gt;</span><br><span class="line">          &lt;i class=&quot;el-icon-arrow-right&quot;&gt;&lt;/i&gt;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/transition&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- carousel-item 子组件插槽 --&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- </span><br><span class="line">      指示器</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;ul :class=&quot;indicatorsClasses&quot;&gt;</span><br><span class="line">      &lt;li&gt;</span><br><span class="line">        &lt;button class=&quot;el-carousel__button&quot;&gt;</span><br><span class="line">          &lt;span&gt;&#123;&#123; item.label &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<h4 id="轮播图组件整体"><a href="#轮播图组件整体" class="headerlink" title="轮播图组件整体"></a>轮播图组件整体</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    :class=&quot;carouselClasses&quot;</span><br><span class="line">    @mouseenter.stop=&quot;handleMouseEnter&quot;</span><br><span class="line">    @mouseleave.stop=&quot;handleMouseLeave&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<h5 id="carouselClasses"><a href="#carouselClasses" class="headerlink" title="carouselClasses"></a>carouselClasses</h5><p><code>carouselClasses</code> 是一个计算属性，返回一个数组。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * carousel 全局类</span></span><br><span class="line"><span class="comment">   * el-carousel: 父类</span></span><br><span class="line"><span class="comment">   * el-carousel--[horizontal/vertical]: 水平/垂直样式类</span></span><br><span class="line"><span class="comment">   * el-carousel--card: 卡片样式类</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  carouselClasses() &#123;</span><br><span class="line">    <span class="keyword">const</span> classes = [<span class="string">'el-carousel'</span>, <span class="string">'el-carousel--'</span> + <span class="keyword">this</span>.direction];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.type === <span class="string">'card'</span>) &#123;</span><br><span class="line">      classes.push(<span class="string">'el-carousel--card'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> classes;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><code>type</code> 是走马灯轮播图的类型，默认空值为普通轮播图，<code>card</code> 是卡片类型。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  <span class="comment">// 走马灯的类型，轮播图和卡片</span></span><br><span class="line">  type: <span class="built_in">String</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h6 id="el-carousel"><a href="#el-carousel" class="headerlink" title="el-carousel"></a>el-carousel</h6><p><code>@include b(carousel)</code> 生成全局父类 <code>el-carousel</code>  。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// carousel.scss</span><br><span class="line">@<span class="keyword">include</span> b(carousel) &#123;</span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">relative</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// mixins/mixins.scss</span><br><span class="line">@<span class="keyword">mixin</span> b($block) &#123;</span><br><span class="line">  $B: $namespace+'-'+$block !global;</span><br><span class="line"></span><br><span class="line">  .#&#123;$B&#125; &#123;</span><br><span class="line">    @<span class="keyword">content</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// mixins/config.scss</span><br><span class="line">$namespace: 'el';</span><br></pre></td></tr></table></figure>
<p>编译之后生成全局样式。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.el-carousel</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="el-carousel–-horizontal-vertical"><a href="#el-carousel–-horizontal-vertical" class="headerlink" title="el-carousel–[horizontal/vertical]"></a>el-carousel–[horizontal/vertical]</h6><p>通过 <code>@include m()</code> 生成。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// carousel.scss</span><br><span class="line"></span><br><span class="line">@<span class="keyword">include</span> b(carousel) &#123;</span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">relative</span>;</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">include</span> m(horizontal) &#123;</span><br><span class="line">    <span class="selector-tag">overflow-x</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">include</span> m(vertical) &#123;</span><br><span class="line">    <span class="selector-tag">overflow-y</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// mixins/mixins.scss</span><br><span class="line"></span><br><span class="line">@<span class="keyword">mixin</span> m($modifier) &#123;</span><br><span class="line">  $selector: &amp;;</span><br><span class="line">  $currentSelector: "";</span><br><span class="line">  @<span class="keyword">each</span> $unit in $modifier &#123;</span><br><span class="line">    $currentSelector: #&#123;$currentSelector + &amp; + $modifier-separator + $unit + ","&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">at</span>-<span class="keyword">root</span> &#123;</span><br><span class="line">    #&#123;$currentSelector&#125; &#123;</span><br><span class="line">      @<span class="keyword">content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// mixins/config.scss</span><br><span class="line"></span><br><span class="line">$modifier-separator: '--';</span><br></pre></td></tr></table></figure>
<p>编译成</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.el-carousel</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.el-carousel--horizontal</span> &#123;</span><br><span class="line">  <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.el-carousel--vertical</span> &#123;</span><br><span class="line">  <span class="attribute">overflow-y</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="el-carousel–card"><a href="#el-carousel–card" class="headerlink" title="el-carousel–card"></a>el-carousel–card</h6><p>详细说明稍后在 <code>Carousel-item</code> 中介绍。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// carousel-item.scss</span><br><span class="line"></span><br><span class="line">@<span class="keyword">include</span> b(carousel) &#123;</span><br><span class="line">  @<span class="keyword">include</span> e(item) &#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    @<span class="keyword">include</span> m(card) &#123;</span><br><span class="line">      <span class="selector-tag">width</span>: 50%;</span><br><span class="line">      <span class="selector-tag">transition</span>: <span class="selector-tag">transform</span> <span class="selector-class">.4s</span> <span class="selector-tag">ease-in-out</span>;</span><br><span class="line">      &amp;<span class="selector-class">.is-in-stage</span> &#123;</span><br><span class="line">        <span class="attribute">cursor</span>: pointer;</span><br><span class="line">        <span class="attribute">z-index</span>: $--index-normal;</span><br><span class="line">        &amp;:hover .el-carousel__mask,</span><br><span class="line">        &amp;<span class="selector-class">.is-hover</span> <span class="selector-class">.el-carousel__mask</span> &#123;</span><br><span class="line">          <span class="attribute">opacity</span>: <span class="number">0.12</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &amp;<span class="selector-class">.is-active</span> &#123;</span><br><span class="line">        <span class="attribute">z-index</span>: #&#123;$--index-normal + <span class="number">1</span>&#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="handleMouseEnter-handleMouseLeave"><a href="#handleMouseEnter-handleMouseLeave" class="headerlink" title="handleMouseEnter() / handleMouseLeave()"></a>handleMouseEnter() / handleMouseLeave()</h5><p>切换全局属性 <code>hover</code> ，并开启和关闭定时器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 鼠标进入 Carousel 组件</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  handleMouseEnter() &#123;</span><br><span class="line">    <span class="keyword">this</span>.hover = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">this</span>.pauseTimer();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 鼠标离开 Carousel 组件</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  handleMouseLeave() &#123;</span><br><span class="line">    <span class="keyword">this</span>.hover = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">this</span>.startTimer();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>hover</code> 是值鼠标是否悬浮在则整体组件上。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 是否为 hover 状态</span></span><br><span class="line">    hover: <span class="literal">false</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h4 id="轮播图主体部分"><a href="#轮播图主体部分" class="headerlink" title="轮播图主体部分"></a>轮播图主体部分</h4><p>这部分是指轮播图和左右切换按钮部分，不包括指示器部分。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    :class=&quot;carouselClasses&quot;</span><br><span class="line">    @mouseenter.stop=&quot;handleMouseEnter&quot;</span><br><span class="line">    @mouseleave.stop=&quot;handleMouseLeave&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 切换按钮及轮播内容，轮播图主体内容 --&gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      class=&quot;el-carousel__container&quot;</span><br><span class="line">      :style=&quot;&#123; height: height &#125;&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 左右切换箭头按钮 --&gt;</span><br><span class="line">        </span><br><span class="line">      &lt;!-- carousel-item 子组件插槽 --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<h5 id="el-carousel-container"><a href="#el-carousel-container" class="headerlink" title="el-carousel__container"></a>el-carousel__container</h5><p>通过 <code>@include e()</code> 生成。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// carousel.scss</span></span><br><span class="line"></span><br><span class="line">@include b(carousel) &#123;</span><br><span class="line"></span><br><span class="line">  @include e(container) &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    height: <span class="number">300</span>px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>e()</code> 稍微有些复杂，一开时也是生成选择器 <code>el-carousel__tontaier,</code> 这里的 <code>$B</code> 我认为是父容器中的 <code>$B</code> 即 <code>el-carousel</code> 。之后要通过 <code>hitAllSpecialNestRule()</code> 函数进行判断再生成样式，总体来说与 <code>m()</code> 相似。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// mixins/mixins.scss</span><br><span class="line"></span><br><span class="line">@<span class="keyword">mixin</span> e($element) &#123;</span><br><span class="line">  $E: $element !global;</span><br><span class="line">  $selector: &amp;;</span><br><span class="line">  $currentSelector: "";</span><br><span class="line">  @<span class="keyword">each</span> $unit in $element &#123;</span><br><span class="line">    $currentSelector: #&#123;$currentSelector + "." + $B + $element-separator + $unit + ","&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">if</span> hitAllSpecialNestRule($selector) &#123;</span><br><span class="line">    @<span class="keyword">at</span>-<span class="keyword">root</span> &#123;</span><br><span class="line">      #&#123;$selector&#125; &#123;</span><br><span class="line">        #&#123;$currentSelector&#125; &#123;</span><br><span class="line">          @<span class="keyword">content</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @<span class="keyword">else</span> &#123;</span><br><span class="line">    @<span class="keyword">at</span>-<span class="keyword">root</span> &#123;</span><br><span class="line">      #&#123;$currentSelector&#125; &#123;</span><br><span class="line">        @<span class="keyword">content</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="箭头按钮"><a href="#箭头按钮" class="headerlink" title="箭头按钮"></a>箭头按钮</h4><p>左右箭头按钮逻辑基本一致。只有轮播图水平方向上才左右箭头按钮。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- </span><br><span class="line">  左右切换箭头按钮</span><br><span class="line">  1. 添加了动画</span><br><span class="line">  2. 按钮中 v-show 设置显示时机。</span><br><span class="line">  3. @mouseenter 是鼠标进入按钮事件 handleButtonEnter()</span><br><span class="line">  4. @mouseleave 是鼠标离开按钮事件 handleButtonLeave()</span><br><span class="line">  5. @click.stop 绑定事件，阻止事件冒泡 throttledArrowClick()</span><br><span class="line"> --&gt;</span><br><span class="line">&lt;transition</span><br><span class="line">  v-if=&quot;arrowDisplay&quot;</span><br><span class="line">  name=&quot;carousel-arrow-left&quot;&gt;</span><br><span class="line">  &lt;button</span><br><span class="line">    type=&quot;button&quot;</span><br><span class="line">    v-show=&quot;(arrow === &apos;always&apos; || hover) &amp;&amp; (loop || activeIndex &gt; 0)&quot;</span><br><span class="line">    @mouseenter=&quot;handleButtonEnter(&apos;left&apos;)&quot;</span><br><span class="line">    @mouseleave=&quot;handleButtonLeave&quot;</span><br><span class="line">    @click.stop=&quot;throttledArrowClick(activeIndex - 1)&quot;</span><br><span class="line">    class=&quot;el-carousel__arrow el-carousel__arrow--left&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;el-icon-arrow-left&quot;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;/button&gt;</span><br><span class="line">&lt;/transition&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;transition</span><br><span class="line">  v-if=&quot;arrowDisplay&quot;</span><br><span class="line">  name=&quot;carousel-arrow-right&quot;&gt;</span><br><span class="line">  &lt;button</span><br><span class="line">    type=&quot;button&quot;</span><br><span class="line">    v-show=&quot;(arrow === &apos;always&apos; || hover) &amp;&amp; (loop || activeIndex &lt; items.length - 1)&quot;</span><br><span class="line">    @mouseenter=&quot;handleButtonEnter(&apos;right&apos;)&quot;</span><br><span class="line">    @mouseleave=&quot;handleButtonLeave&quot;</span><br><span class="line">    @click.stop=&quot;throttledArrowClick(activeIndex + 1)&quot;</span><br><span class="line">    class=&quot;el-carousel__arrow el-carousel__arrow--right&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;el-icon-arrow-right&quot;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;/button&gt;</span><br><span class="line">&lt;/transition&gt;</span><br></pre></td></tr></table></figure>
<p><code>arrowDisplay</code> 是一个计算函数，用来判断是否显示箭头按钮。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">computed: &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 箭头按钮是否显示</span></span><br><span class="line"><span class="comment">   * arrow 为 never 或者 direction 为 vertical 垂直时不显示</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  arrowDisplay() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.arrow !== <span class="string">'never'</span> &amp;&amp; <span class="keyword">this</span>.direction !== <span class="string">'vertical'</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h5 id="transition-按钮过渡动画"><a href="#transition-按钮过渡动画" class="headerlink" title="transition 按钮过渡动画"></a>transition 按钮过渡动画</h5><p>这里定义了过渡开始和生效时的状态。初始状态见 <code>button</code> 主体。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// carousel.scss</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.carousel-arrow-left-enter</span>,</span><br><span class="line"><span class="selector-class">.carousel-arrow-left-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-50%) <span class="built_in">translateX</span>(-10px);</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.carousel-arrow-right-enter</span>,</span><br><span class="line"><span class="selector-class">.carousel-arrow-right-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-50%) <span class="built_in">translateX</span>(10px);</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="button-按钮主体"><a href="#button-按钮主体" class="headerlink" title="button 按钮主体"></a>button 按钮主体</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;button</span><br><span class="line">  type=&quot;button&quot;</span><br><span class="line">  v-show=&quot;(arrow === &apos;always&apos; || hover) &amp;&amp; (loop || activeIndex &gt; 0)&quot;</span><br><span class="line">  @mouseenter=&quot;handleButtonEnter(&apos;left&apos;)&quot;</span><br><span class="line">  @mouseleave=&quot;handleButtonLeave&quot;</span><br><span class="line">  @click.stop=&quot;throttledArrowClick(activeIndex - 1)&quot;</span><br><span class="line">  class=&quot;el-carousel__arrow el-carousel__arrow--left&quot;&gt;</span><br><span class="line">  &lt;i class=&quot;el-icon-arrow-left&quot;&gt;&lt;/i&gt;</span><br><span class="line">&lt;/button&gt;</span><br></pre></td></tr></table></figure>
<h6 id="handleButtonEnter-arrow-handleButtonLeave"><a href="#handleButtonEnter-arrow-handleButtonLeave" class="headerlink" title="handleButtonEnter(arrow) / handleButtonLeave()"></a>handleButtonEnter(arrow) / handleButtonLeave()</h6><p> 鼠标进入按钮的时候将触发 <code>handleButtonEnter(&#39;left&#39;)</code> 这一函数，它将对每一个轮播的项目通过 <code>itemInStage</code> 方法处理后和方向进行对比，设置项目的 <code>hover</code> 属性。  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">methods</span>: &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 鼠标进入箭头按钮</span></span><br><span class="line"><span class="comment">   * arraw: 'left' / 'right'</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  handleButtonEnter(arrow) &#123;</span><br><span class="line">    // 垂直无效</span><br><span class="line">    if (this.direction === 'vertical') return;</span><br><span class="line">    this.items.forEach((item, index) =&gt; &#123;</span><br><span class="line">      if (arrow === this.itemInStage(item, index)) &#123;</span><br><span class="line">        item.hover = true;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 鼠标离开箭头按钮</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="selector-tag">handleButtonLeave</span>() &#123;</span><br><span class="line">    // 垂直无效</span><br><span class="line">    if (this.direction === 'vertical') return;</span><br><span class="line">    this.items.forEach(item =&gt; &#123;</span><br><span class="line">      item.hover = false;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="itemInStage"><a href="#itemInStage" class="headerlink" title="itemInStage()"></a>itemInStage()</h6><p><code>itemInStage(item, index)</code> 传入的值一个是子组件实例对象，一个是索引。</p>
<font color="red">这一块不是很懂，慢慢理解。</font>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 项目是否在场景内</span></span><br><span class="line"><span class="comment">   * item: 子项</span></span><br><span class="line"><span class="comment">   * index: 索引</span></span><br><span class="line"><span class="comment">   * return：'left'/'right'/false</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  itemInStage(item, index) &#123;</span><br><span class="line">    <span class="keyword">const</span> length = <span class="keyword">this</span>.items.length;</span><br><span class="line">    <span class="comment">// index === length-1 当前为最后一项</span></span><br><span class="line">    <span class="comment">// item.inStage 当前项目在场景内</span></span><br><span class="line">    <span class="comment">// items[0].active 第一个项目激活状态</span></span><br><span class="line">    <span class="comment">// items[index + 1] 当前项目后有至少一个项目</span></span><br><span class="line">    <span class="comment">// items[index + 1].active 当前项目后一个项目处于激活状态</span></span><br><span class="line">    <span class="comment">// 判断结果为左移，return 'left'</span></span><br><span class="line">    <span class="keyword">if</span> (index === length - <span class="number">1</span> &amp;&amp; item.inStage &amp;&amp; <span class="keyword">this</span>.items[<span class="number">0</span>].active ||</span><br><span class="line">      (item.inStage &amp;&amp; <span class="keyword">this</span>.items[index + <span class="number">1</span>] &amp;&amp; <span class="keyword">this</span>.items[index + <span class="number">1</span>].active)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">'left'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index === <span class="number">0</span> &amp;&amp; item.inStage &amp;&amp; <span class="keyword">this</span>.items[length - <span class="number">1</span>].active ||</span><br><span class="line">      (item.inStage &amp;&amp; <span class="keyword">this</span>.items[index - <span class="number">1</span>] &amp;&amp; <span class="keyword">this</span>.items[index - <span class="number">1</span>].active)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">'right'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="throttledArrowClick"><a href="#throttledArrowClick" class="headerlink" title="throttledArrowClick()"></a>throttledArrowClick()</h6><p><code>throttledArrowClick</code> 就是箭头点击回调函数，加了 <code>throttle</code> ，详细见 <code>created</code> 。</p>
<p><a href="mailto:`@click.stop" target="_blank" rel="noopener">`@click.stop</a>` 的作用是组织事件冒泡。</p>
<h6 id="el-carousel-arrow"><a href="#el-carousel-arrow" class="headerlink" title="el-carousel__arrow"></a>el-carousel__arrow</h6><p>这个理解起来难度不大，就是有很多变量。<code>el-carousel__arrow--left</code> 和 <code>el-carousel__arrow--right</code> 是通过 <code>m()</code> 来实现的。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">include</span> b(carousel) &#123;</span><br><span class="line">    </span><br><span class="line">  @<span class="keyword">include</span> e(arrow) &#123;</span><br><span class="line">    <span class="selector-tag">border</span>: <span class="selector-tag">none</span>;</span><br><span class="line">    <span class="selector-tag">outline</span>: <span class="selector-tag">none</span>;</span><br><span class="line">    <span class="selector-tag">padding</span>: 0;</span><br><span class="line">    <span class="selector-tag">margin</span>: 0;</span><br><span class="line">    height: $--carousel-arrow-size;		// 36px !default;</span><br><span class="line">    width: $--carousel-arrow-size;		// 36px !default;</span><br><span class="line">    <span class="selector-tag">cursor</span>: <span class="selector-tag">pointer</span>;</span><br><span class="line">    <span class="selector-tag">transition</span>: <span class="selector-class">.3s</span>;</span><br><span class="line">    <span class="selector-tag">border-radius</span>: 50%;</span><br><span class="line">    background-color: $--carousel-arrow-background;		// rgba(31, 45, 61, 0.11) !default;</span><br><span class="line">    color: $--color-white;		// white</span><br><span class="line">    <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span>;</span><br><span class="line">    <span class="selector-tag">top</span>: 50%;</span><br><span class="line">    <span class="selector-tag">z-index</span>: 10;</span><br><span class="line">    <span class="selector-tag">transform</span>: <span class="selector-tag">translateY</span>(<span class="selector-tag">-50</span>%);</span><br><span class="line">    <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span><br><span class="line">    font-size: $--carousel-arrow-font-size;		// 12px !default;</span><br><span class="line"></span><br><span class="line">    @<span class="keyword">include</span> m(left) &#123;</span><br><span class="line">      <span class="selector-tag">left</span>: 16<span class="selector-tag">px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @<span class="keyword">include</span> m(right) &#123;</span><br><span class="line">      <span class="selector-tag">right</span>: 16<span class="selector-tag">px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      background-color: $--carousel-arrow-hover-background;		// rgba(31, 45, 61, 0.23) !default;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp; <span class="selector-tag">i</span> &#123;</span><br><span class="line">      <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="子组件插槽"><a href="#子组件插槽" class="headerlink" title="子组件插槽"></a>子组件插槽</h4><p>使用 <code>&lt;slot&gt;&lt;/slot&gt;</code> 将子组件插入。</p>
<h4 id="指示器部分"><a href="#指示器部分" class="headerlink" title="指示器部分"></a>指示器部分</h4><p>指示器是一个无序列表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 切换按钮及轮播内容，轮播图主体内容 --&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 左右切换箭头按钮 --&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- carousel-item 子组件插槽 --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- </span><br><span class="line">      指示器</span><br><span class="line">      1. indicatorPosition 指示器位置</span><br><span class="line">      2. @mouseenter 是鼠标进入事件 throttledIndicatorHover() 节流方法</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;ul</span><br><span class="line">      v-if=&quot;indicatorPosition !== &apos;none&apos;&quot;</span><br><span class="line">      :class=&quot;indicatorsClasses&quot;&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-for=&quot;(item, index) in items&quot;</span><br><span class="line">        :key=&quot;index&quot;</span><br><span class="line">        :class=&quot;[</span><br><span class="line">          &apos;el-carousel__indicator&apos;,</span><br><span class="line">          &apos;el-carousel__indicator--&apos; + direction,</span><br><span class="line">          &#123; &apos;is-active&apos;: index === activeIndex &#125;]&quot;</span><br><span class="line">        @mouseenter=&quot;throttledIndicatorHover(index)&quot;</span><br><span class="line">        @click.stop=&quot;handleIndicatorClick(index)&quot;&gt;</span><br><span class="line">        &lt;button class=&quot;el-carousel__button&quot;&gt;</span><br><span class="line">          &lt;span v-if=&quot;hasLabel&quot;&gt;&#123;&#123; item.label &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul</span><br><span class="line">  v-if=&quot;indicatorPosition !== &apos;none&apos;&quot;</span><br><span class="line">  :class=&quot;indicatorsClasses&quot;&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<p><code>indicatorPosition</code> 是一个 <code>props</code> 传入值，表示指示器位置，<code>none</code> 不渲染指示器，<code>outside</code> 会显示在轮播图外部下方，默认现在在轮播图内侧下方。</p>
<h6 id="indicatorsClasses"><a href="#indicatorsClasses" class="headerlink" title="indicatorsClasses"></a>indicatorsClasses</h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 指示器样式类</span></span><br><span class="line"><span class="comment">   * el-carousel__indicators: 父类</span></span><br><span class="line"><span class="comment">   * el-carousel__indicators--[horizontal/vertical]: 水平/垂直样式类</span></span><br><span class="line"><span class="comment">   * el-carousel__indicators--labels：？？？</span></span><br><span class="line"><span class="comment">   * el-carousel__indicators--outside: type 为 card 卡片或者 indicatorPosition 为 outside 外侧时样式</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  indicatorsClasses() &#123;</span><br><span class="line">    <span class="keyword">const</span> classes = [<span class="string">'el-carousel__indicators'</span>, <span class="string">'el-carousel__indicators--'</span> + <span class="keyword">this</span>.direction];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.hasLabel) &#123;</span><br><span class="line">      classes.push(<span class="string">'el-carousel__indicators--labels'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.indicatorPosition === <span class="string">'outside'</span> || <span class="keyword">this</span>.type === <span class="string">'card'</span>) &#123;</span><br><span class="line">      classes.push(<span class="string">'el-carousel__indicators--outside'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> classes;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h6 id="el-carousel-indicators"><a href="#el-carousel-indicators" class="headerlink" title="el-carousel__indicators"></a>el-carousel__indicators</h6><p>指示器样式父类。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@<span class="keyword">include</span> b(carousel) &#123;</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">include</span> e(indicators) &#123;</span><br><span class="line">    <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span>;</span><br><span class="line">    <span class="selector-tag">list-style</span>: <span class="selector-tag">none</span>;</span><br><span class="line">    <span class="selector-tag">margin</span>: 0;</span><br><span class="line">    <span class="selector-tag">padding</span>: 0;</span><br><span class="line">    z-index: #&#123;$--index-normal + 1&#125;;	// 1 !default;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="el-carousel-indicators–-horizontal-vertical"><a href="#el-carousel-indicators–-horizontal-vertical" class="headerlink" title="el-carousel__indicators–[horizontal/vertical]"></a>el-carousel__indicators–[horizontal/vertical]</h6><p>设置水平垂直方向上居中。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@<span class="keyword">include</span> b(carousel) &#123;</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">include</span> e(indicators) &#123;</span><br><span class="line"></span><br><span class="line">    @<span class="keyword">include</span> m(horizontal) &#123;</span><br><span class="line">      <span class="selector-tag">bottom</span>: 0;</span><br><span class="line">      <span class="selector-tag">left</span>: 50%;</span><br><span class="line">      <span class="selector-tag">transform</span>: <span class="selector-tag">translateX</span>(<span class="selector-tag">-50</span>%);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @<span class="keyword">include</span> m(vertical) &#123;</span><br><span class="line">      <span class="selector-tag">right</span>: 0;</span><br><span class="line">      <span class="selector-tag">top</span>: 50%;</span><br><span class="line">      <span class="selector-tag">transform</span>: <span class="selector-tag">translateY</span>(<span class="selector-tag">-50</span>%);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="el-carousel-indicators–outside"><a href="#el-carousel-indicators–outside" class="headerlink" title="el-carousel__indicators–outside"></a>el-carousel__indicators–outside</h6><p>这个样式会覆盖之前的样式哦。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">include</span> b(carousel) &#123;</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">include</span> e(indicators) &#123;</span><br><span class="line"></span><br><span class="line">    @<span class="keyword">include</span> m(outside) &#123;</span><br><span class="line">      bottom: #&#123;$--carousel-indicator-height + $--carousel-indicator-padding-vertical * 2&#125;;		// 2px !default; 12px !default;</span><br><span class="line">      <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span><br><span class="line">      <span class="selector-tag">position</span>: <span class="selector-tag">static</span>;</span><br><span class="line">      <span class="selector-tag">transform</span>: <span class="selector-tag">none</span>;</span><br><span class="line">      <span class="selector-class">.el-carousel__indicator</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0.64</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-tag">button</span> &#123;</span><br><span class="line">        background-color: $--carousel-indicator-out-color;		// #C0C4CC</span><br><span class="line">        <span class="selector-tag">opacity</span>: 0<span class="selector-class">.24</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="el-carousel-indicators–labels"><a href="#el-carousel-indicators–labels" class="headerlink" title="el-carousel__indicators–labels"></a>el-carousel__indicators–labels</h6><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">include</span> b(carousel) &#123;</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">include</span> e(indicators) &#123;</span><br><span class="line"></span><br><span class="line">    @<span class="keyword">include</span> m(labels) &#123;</span><br><span class="line">      <span class="selector-tag">left</span>: 0;</span><br><span class="line">      <span class="selector-tag">right</span>: 0;</span><br><span class="line">      <span class="selector-tag">transform</span>: <span class="selector-tag">none</span>;</span><br><span class="line">      <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.el-carousel__button</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: auto;</span><br><span class="line">        <span class="attribute">width</span>: auto;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">18px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.el-carousel__indicator</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">4px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Carousel-item-源码分析"><a href="#Carousel-item-源码分析" class="headerlink" title="Carousel-item 源码分析"></a>Carousel-item 源码分析</h2><h3 id="生命周期-1"><a href="#生命周期-1" class="headerlink" title="生命周期"></a>生命周期</h3><h4 id="created-destroyed"><a href="#created-destroyed" class="headerlink" title="created / destroyed"></a>created / destroyed</h4><p>调用父组件的方法，更新 <code>items</code> 数组。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">  <span class="keyword">this</span>.$parent &amp;&amp; <span class="keyword">this</span>.$parent.updateItems();</span><br><span class="line">&#125;,</span><br><span class="line">    </span><br><span class="line">destroyed() &#123;</span><br><span class="line">  <span class="keyword">this</span>.$parent &amp;&amp; <span class="keyword">this</span>.$parent.updateItems();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="结构及样式分析-1"><a href="#结构及样式分析-1" class="headerlink" title="结构及样式分析"></a>结构及样式分析</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;el-carousel__item&quot;&gt;</span><br><span class="line">    &lt;!-- card 类型 --&gt;</span><br><span class="line">    &lt;div class=&quot;el-carousel__mask&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 插槽 --&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<h4 id="子组件整体"><a href="#子组件整体" class="headerlink" title="子组件整体"></a>子组件整体</h4><p><code>ready</code> 是一个全局变量，当组件渲染完成时变成 <code>true</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    v-show=&quot;ready&quot;</span><br><span class="line">    class=&quot;el-carousel__item&quot;</span><br><span class="line">    :class=&quot;&#123;</span><br><span class="line">      &apos;is-active&apos;: active,</span><br><span class="line">      &apos;el-carousel__item--card&apos;: $parent.type === &apos;card&apos;,</span><br><span class="line">      &apos;is-in-stage&apos;: inStage,</span><br><span class="line">      &apos;is-hover&apos;: hover,</span><br><span class="line">      &apos;is-animating&apos;: animating</span><br><span class="line">    &#125;&quot;</span><br><span class="line">    @click=&quot;handleItemClick&quot;</span><br><span class="line">    :style=&quot;itemStyle&quot;&gt;</span><br><span class="line">      </span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<h5 id="translateItem-index-activeIndex-oldIndex"><a href="#translateItem-index-activeIndex-oldIndex" class="headerlink" title="translateItem(index, activeIndex, oldIndex)"></a>translateItem(index, activeIndex, oldIndex)</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  translateItem(index, activeIndex, oldIndex) &#123;</span><br><span class="line">    <span class="keyword">const</span> parentType = <span class="keyword">this</span>.$parent.type;</span><br><span class="line">    <span class="keyword">const</span> parentDirection = <span class="keyword">this</span>.parentDirection;</span><br><span class="line">    <span class="keyword">const</span> length = <span class="keyword">this</span>.$parent.items.length;</span><br><span class="line">    <span class="keyword">if</span> (parentType !== <span class="string">'card'</span> &amp;&amp; oldIndex !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.animating = index === activeIndex || index === oldIndex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (index !== activeIndex &amp;&amp; length &gt; <span class="number">2</span> &amp;&amp; <span class="keyword">this</span>.$parent.loop) &#123;</span><br><span class="line">      index = <span class="keyword">this</span>.processIndex(index, activeIndex, length);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (parentType === <span class="string">'card'</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (parentDirection === <span class="string">'vertical'</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.warn(<span class="string">'[Element Warn][Carousel]vertical directionis not supported in card mode'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.inStage = <span class="built_in">Math</span>.round(<span class="built_in">Math</span>.abs(index - activeIndex)) &lt;= <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">this</span>.active = index === activeIndex;</span><br><span class="line">      <span class="keyword">this</span>.translate = <span class="keyword">this</span>.calcCardTranslate(index, activeIndex);</span><br><span class="line">      <span class="keyword">this</span>.scale = <span class="keyword">this</span>.active ? <span class="number">1</span> : CARD_SCALE;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.active = index === activeIndex;</span><br><span class="line">      <span class="keyword">const</span> isVertical = parentDirection === <span class="string">'vertical'</span>;</span><br><span class="line">      <span class="keyword">this</span>.translate = <span class="keyword">this</span>.calcTranslate(index, activeIndex, isVertical);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.ready = <span class="literal">true</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/11/08/前端-ElementUI-源码分析-Carousel/" data-id="ck37cm65p000048ut54uxtqyd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ElementUI/">ElementUI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/11/09/前端-ElementUI-源码分析-Scss简介/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          前端-ElementUI-源码分析-Sass简介
        
      </div>
    </a>
  
  
    <a href="/2019/11/08/前端-ElementUI-源码分析-Button/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">前端-ElementUI-源码分析-Button</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BOM/">BOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DOM/">DOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECharts/">ECharts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EcamScript6/">EcamScript6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ElementUI/">ElementUI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Html-Css/">Html/Css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/">Node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后端/">后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务器/">服务器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/框架/">框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器兼容/">浏览器兼容</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动端/">移动端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件配置/">软件配置</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面经/">面经</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 17.5px;">Android</a> <a href="/tags/BOM/" style="font-size: 10px;">BOM</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/DOM/" style="font-size: 10px;">DOM</a> <a href="/tags/ECharts/" style="font-size: 10px;">ECharts</a> <a href="/tags/EcamScript6/" style="font-size: 11.67px;">EcamScript6</a> <a href="/tags/ElementUI/" style="font-size: 12.5px;">ElementUI</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Html-Css/" style="font-size: 10.83px;">Html/Css</a> <a href="/tags/JavaScript/" style="font-size: 18.33px;">JavaScript</a> <a href="/tags/Node/" style="font-size: 14.17px;">Node</a> <a href="/tags/Python/" style="font-size: 16.67px;">Python</a> <a href="/tags/Vue/" style="font-size: 15.83px;">Vue</a> <a href="/tags/blog/" style="font-size: 10.83px;">blog</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/tool/" style="font-size: 10px;">tool</a> <a href="/tags/前端/" style="font-size: 19.17px;">前端</a> <a href="/tags/后端/" style="font-size: 13.33px;">后端</a> <a href="/tags/小程序/" style="font-size: 10px;">小程序</a> <a href="/tags/数据库/" style="font-size: 11.67px;">数据库</a> <a href="/tags/服务器/" style="font-size: 10px;">服务器</a> <a href="/tags/框架/" style="font-size: 15px;">框架</a> <a href="/tags/浏览器兼容/" style="font-size: 10px;">浏览器兼容</a> <a href="/tags/移动端/" style="font-size: 20px;">移动端</a> <a href="/tags/软件配置/" style="font-size: 10px;">软件配置</a> <a href="/tags/面经/" style="font-size: 10px;">面经</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/11/09/前端-ElementUI-源码分析-Scss简介/">前端-ElementUI-源码分析-Sass简介</a>
          </li>
        
          <li>
            <a href="/2019/11/08/前端-ElementUI-源码分析-Carousel/">前端-ElementUI-源码分析-Carousel</a>
          </li>
        
          <li>
            <a href="/2019/11/08/前端-ElementUI-源码分析-Button/">前端-ElementUI-源码分析-Button</a>
          </li>
        
          <li>
            <a href="/2019/11/07/前端-ElementUI-源码分析-架构/">前端-ElementUI-源码分析-架构介绍</a>
          </li>
        
          <li>
            <a href="/2019/09/13/前端-JavaScript基础-异步操作原理及方法/">前端-JavaScript基础-异步操作原理及方法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Ai Junhao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>